(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var F0={exports:{}},td={},z0={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kl=Symbol.for("react.element"),RE=Symbol.for("react.portal"),PE=Symbol.for("react.fragment"),DE=Symbol.for("react.strict_mode"),jE=Symbol.for("react.profiler"),VE=Symbol.for("react.provider"),ME=Symbol.for("react.context"),OE=Symbol.for("react.forward_ref"),LE=Symbol.for("react.suspense"),FE=Symbol.for("react.memo"),zE=Symbol.for("react.lazy"),zg=Symbol.iterator;function UE(n){return n===null||typeof n!="object"?null:(n=zg&&n[zg]||n["@@iterator"],typeof n=="function"?n:null)}var U0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B0=Object.assign,$0={};function $o(n,e,t){this.props=n,this.context=e,this.refs=$0,this.updater=t||U0}$o.prototype.isReactComponent={};$o.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};$o.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function q0(){}q0.prototype=$o.prototype;function pp(n,e,t){this.props=n,this.context=e,this.refs=$0,this.updater=t||U0}var mp=pp.prototype=new q0;mp.constructor=pp;B0(mp,$o.prototype);mp.isPureReactComponent=!0;var Ug=Array.isArray,G0=Object.prototype.hasOwnProperty,gp={current:null},H0={key:!0,ref:!0,__self:!0,__source:!0};function K0(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)G0.call(e,r)&&!H0.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];s.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:kl,type:n,key:i,ref:o,props:s,_owner:gp.current}}function BE(n,e){return{$$typeof:kl,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function yp(n){return typeof n=="object"&&n!==null&&n.$$typeof===kl}function $E(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Bg=/\/+/g;function Zd(n,e){return typeof n=="object"&&n!==null&&n.key!=null?$E(""+n.key):e.toString(36)}function Lc(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case kl:case RE:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Zd(o,0):r,Ug(s)?(t="",n!=null&&(t=n.replace(Bg,"$&/")+"/"),Lc(s,e,t,"",function(d){return d})):s!=null&&(yp(s)&&(s=BE(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Bg,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Ug(n))for(var a=0;a<n.length;a++){i=n[a];var u=r+Zd(i,a);o+=Lc(i,e,t,u,s)}else if(u=UE(n),typeof u=="function")for(n=u.call(n),a=0;!(i=n.next()).done;)i=i.value,u=r+Zd(i,a++),o+=Lc(i,e,t,u,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function fc(n,e,t){if(n==null)return n;var r=[],s=0;return Lc(n,r,"","",function(i){return e.call(t,i,s++)}),r}function qE(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Yt={current:null},Fc={transition:null},GE={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:Fc,ReactCurrentOwner:gp};function W0(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:fc,forEach:function(n,e,t){fc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return fc(n,function(){e++}),e},toArray:function(n){return fc(n,function(e){return e})||[]},only:function(n){if(!yp(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};be.Component=$o;be.Fragment=PE;be.Profiler=jE;be.PureComponent=pp;be.StrictMode=DE;be.Suspense=LE;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GE;be.act=W0;be.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=B0({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=gp.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)G0.call(e,u)&&!H0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:kl,type:n.type,key:s,ref:i,props:r,_owner:o}};be.createContext=function(n){return n={$$typeof:ME,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:VE,_context:n},n.Consumer=n};be.createElement=K0;be.createFactory=function(n){var e=K0.bind(null,n);return e.type=n,e};be.createRef=function(){return{current:null}};be.forwardRef=function(n){return{$$typeof:OE,render:n}};be.isValidElement=yp;be.lazy=function(n){return{$$typeof:zE,_payload:{_status:-1,_result:n},_init:qE}};be.memo=function(n,e){return{$$typeof:FE,type:n,compare:e===void 0?null:e}};be.startTransition=function(n){var e=Fc.transition;Fc.transition={};try{n()}finally{Fc.transition=e}};be.unstable_act=W0;be.useCallback=function(n,e){return Yt.current.useCallback(n,e)};be.useContext=function(n){return Yt.current.useContext(n)};be.useDebugValue=function(){};be.useDeferredValue=function(n){return Yt.current.useDeferredValue(n)};be.useEffect=function(n,e){return Yt.current.useEffect(n,e)};be.useId=function(){return Yt.current.useId()};be.useImperativeHandle=function(n,e,t){return Yt.current.useImperativeHandle(n,e,t)};be.useInsertionEffect=function(n,e){return Yt.current.useInsertionEffect(n,e)};be.useLayoutEffect=function(n,e){return Yt.current.useLayoutEffect(n,e)};be.useMemo=function(n,e){return Yt.current.useMemo(n,e)};be.useReducer=function(n,e,t){return Yt.current.useReducer(n,e,t)};be.useRef=function(n){return Yt.current.useRef(n)};be.useState=function(n){return Yt.current.useState(n)};be.useSyncExternalStore=function(n,e,t){return Yt.current.useSyncExternalStore(n,e,t)};be.useTransition=function(){return Yt.current.useTransition()};be.version="18.3.1";z0.exports=be;var U=z0.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HE=U,KE=Symbol.for("react.element"),WE=Symbol.for("react.fragment"),QE=Object.prototype.hasOwnProperty,YE=HE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JE={key:!0,ref:!0,__self:!0,__source:!0};function Q0(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)QE.call(e,r)&&!JE.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:KE,type:n,key:i,ref:o,props:s,_owner:YE.current}}td.Fragment=WE;td.jsx=Q0;td.jsxs=Q0;F0.exports=td;var c=F0.exports,Y0={exports:{}},vn={},J0={exports:{}},X0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(q,W){var ne=q.length;q.push(W);e:for(;0<ne;){var ye=ne-1>>>1,he=q[ye];if(0<s(he,W))q[ye]=W,q[ne]=he,ne=ye;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var W=q[0],ne=q.pop();if(ne!==W){q[0]=ne;e:for(var ye=0,he=q.length,$=he>>>1;ye<$;){var H=2*(ye+1)-1,ae=q[H],Ie=H+1,Ne=q[Ie];if(0>s(ae,ne))Ie<he&&0>s(Ne,ae)?(q[ye]=Ne,q[Ie]=ne,ye=Ie):(q[ye]=ae,q[H]=ne,ye=H);else if(Ie<he&&0>s(Ne,ne))q[ye]=Ne,q[Ie]=ne,ye=Ie;else break e}}return W}function s(q,W){var ne=q.sortIndex-W.sortIndex;return ne!==0?ne:q.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],d=[],f=1,m=null,y=3,_=!1,R=!1,A=!1,k=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(q){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=q)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function I(q){if(A=!1,b(q),!R)if(t(u)!==null)R=!0,xe(D);else{var W=t(d);W!==null&&we(I,W.startTime-q)}}function D(q,W){R=!1,A&&(A=!1,E(g),g=-1),_=!0;var ne=y;try{for(b(W),m=t(u);m!==null&&(!(m.expirationTime>W)||q&&!C());){var ye=m.callback;if(typeof ye=="function"){m.callback=null,y=m.priorityLevel;var he=ye(m.expirationTime<=W);W=n.unstable_now(),typeof he=="function"?m.callback=he:m===t(u)&&r(u),b(W)}else r(u);m=t(u)}if(m!==null)var $=!0;else{var H=t(d);H!==null&&we(I,H.startTime-W),$=!1}return $}finally{m=null,y=ne,_=!1}}var P=!1,w=null,g=-1,x=5,S=-1;function C(){return!(n.unstable_now()-S<x)}function j(){if(w!==null){var q=n.unstable_now();S=q;var W=!0;try{W=w(!0,q)}finally{W?N():(P=!1,w=null)}}else P=!1}var N;if(typeof v=="function")N=function(){v(j)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,L=Y.port2;Y.port1.onmessage=j,N=function(){L.postMessage(null)}}else N=function(){k(j,0)};function xe(q){w=q,P||(P=!0,N())}function we(q,W){g=k(function(){q(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){R||_||(R=!0,xe(D))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(q){switch(y){case 1:case 2:case 3:var W=3;break;default:W=y}var ne=y;y=W;try{return q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,W){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ne=y;y=q;try{return W()}finally{y=ne}},n.unstable_scheduleCallback=function(q,W,ne){var ye=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ye+ne:ye):ne=ye,q){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ne+he,q={id:f++,callback:W,priorityLevel:q,startTime:ne,expirationTime:he,sortIndex:-1},ne>ye?(q.sortIndex=ne,e(d,q),t(u)===null&&q===t(d)&&(A?(E(g),g=-1):A=!0,we(I,ne-ye))):(q.sortIndex=he,e(u,q),R||_||(R=!0,xe(D))),q},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(q){var W=y;return function(){var ne=y;y=W;try{return q.apply(this,arguments)}finally{y=ne}}}})(X0);J0.exports=X0;var XE=J0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZE=U,gn=XE;function K(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z0=new Set,Ja={};function wi(n,e){wo(n,e),wo(n+"Capture",e)}function wo(n,e){for(Ja[n]=e,n=0;n<e.length;n++)Z0.add(e[n])}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uh=Object.prototype.hasOwnProperty,e1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$g={},qg={};function t1(n){return Uh.call(qg,n)?!0:Uh.call($g,n)?!1:e1.test(n)?qg[n]=!0:($g[n]=!0,!1)}function n1(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function r1(n,e,t,r){if(e===null||typeof e>"u"||n1(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Mt[n]=new Jt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Mt[e]=new Jt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Mt[n]=new Jt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Mt[n]=new Jt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Mt[n]=new Jt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Mt[n]=new Jt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Mt[n]=new Jt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Mt[n]=new Jt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Mt[n]=new Jt(n,5,!1,n.toLowerCase(),null,!1,!1)});var vp=/[\-:]([a-z])/g;function _p(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(vp,_p);Mt[e]=new Jt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(vp,_p);Mt[e]=new Jt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(vp,_p);Mt[e]=new Jt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Mt[n]=new Jt(n,1,!1,n.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Mt[n]=new Jt(n,1,!1,n.toLowerCase(),null,!0,!0)});function xp(n,e,t,r){var s=Mt.hasOwnProperty(e)?Mt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(r1(e,t,s,r)&&(t=null),r||s===null?t1(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Rr=ZE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pc=Symbol.for("react.element"),Qi=Symbol.for("react.portal"),Yi=Symbol.for("react.fragment"),wp=Symbol.for("react.strict_mode"),Bh=Symbol.for("react.profiler"),e_=Symbol.for("react.provider"),t_=Symbol.for("react.context"),Ip=Symbol.for("react.forward_ref"),$h=Symbol.for("react.suspense"),qh=Symbol.for("react.suspense_list"),Tp=Symbol.for("react.memo"),Hr=Symbol.for("react.lazy"),n_=Symbol.for("react.offscreen"),Gg=Symbol.iterator;function ha(n){return n===null||typeof n!="object"?null:(n=Gg&&n[Gg]||n["@@iterator"],typeof n=="function"?n:null)}var ot=Object.assign,eh;function ba(n){if(eh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);eh=e&&e[1]||""}return`
`+eh+n}var th=!1;function nh(n,e){if(!n||th)return"";th=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{th=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ba(n):""}function s1(n){switch(n.tag){case 5:return ba(n.type);case 16:return ba("Lazy");case 13:return ba("Suspense");case 19:return ba("SuspenseList");case 0:case 2:case 15:return n=nh(n.type,!1),n;case 11:return n=nh(n.type.render,!1),n;case 1:return n=nh(n.type,!0),n;default:return""}}function Gh(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Yi:return"Fragment";case Qi:return"Portal";case Bh:return"Profiler";case wp:return"StrictMode";case $h:return"Suspense";case qh:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case t_:return(n.displayName||"Context")+".Consumer";case e_:return(n._context.displayName||"Context")+".Provider";case Ip:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Tp:return e=n.displayName||null,e!==null?e:Gh(n.type)||"Memo";case Hr:e=n._payload,n=n._init;try{return Gh(n(e))}catch{}}return null}function i1(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gh(e);case 8:return e===wp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xs(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function r_(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function o1(n){var e=r_(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function mc(n){n._valueTracker||(n._valueTracker=o1(n))}function s_(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=r_(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function cu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Hh(n,e){var t=e.checked;return ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Hg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=xs(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function i_(n,e){e=e.checked,e!=null&&xp(n,"checked",e,!1)}function Kh(n,e){i_(n,e);var t=xs(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Wh(n,e.type,t):e.hasOwnProperty("defaultValue")&&Wh(n,e.type,xs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Kg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Wh(n,e,t){(e!=="number"||cu(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Sa=Array.isArray;function co(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+xs(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Qh(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return ot({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Wg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(K(92));if(Sa(t)){if(1<t.length)throw Error(K(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:xs(t)}}function o_(n,e){var t=xs(e.value),r=xs(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Qg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function a_(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?a_(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var gc,l_=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(gc=gc||document.createElement("div"),gc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Xa(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a1=["Webkit","ms","Moz","O"];Object.keys(ja).forEach(function(n){a1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ja[e]=ja[n]})});function c_(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ja.hasOwnProperty(n)&&ja[n]?(""+e).trim():e+"px"}function u_(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=c_(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var l1=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jh(n,e){if(e){if(l1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function Xh(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zh=null;function Ep(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ef=null,uo=null,ho=null;function Yg(n){if(n=Rl(n)){if(typeof ef!="function")throw Error(K(280));var e=n.stateNode;e&&(e=od(e),ef(n.stateNode,n.type,e))}}function d_(n){uo?ho?ho.push(n):ho=[n]:uo=n}function h_(){if(uo){var n=uo,e=ho;if(ho=uo=null,Yg(n),e)for(n=0;n<e.length;n++)Yg(e[n])}}function f_(n,e){return n(e)}function p_(){}var rh=!1;function m_(n,e,t){if(rh)return n(e,t);rh=!0;try{return f_(n,e,t)}finally{rh=!1,(uo!==null||ho!==null)&&(p_(),h_())}}function Za(n,e){var t=n.stateNode;if(t===null)return null;var r=od(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(K(231,e,typeof t));return t}var tf=!1;if(Tr)try{var fa={};Object.defineProperty(fa,"passive",{get:function(){tf=!0}}),window.addEventListener("test",fa,fa),window.removeEventListener("test",fa,fa)}catch{tf=!1}function c1(n,e,t,r,s,i,o,a,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(f){this.onError(f)}}var Va=!1,uu=null,du=!1,nf=null,u1={onError:function(n){Va=!0,uu=n}};function d1(n,e,t,r,s,i,o,a,u){Va=!1,uu=null,c1.apply(u1,arguments)}function h1(n,e,t,r,s,i,o,a,u){if(d1.apply(this,arguments),Va){if(Va){var d=uu;Va=!1,uu=null}else throw Error(K(198));du||(du=!0,nf=d)}}function Ii(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function g_(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Jg(n){if(Ii(n)!==n)throw Error(K(188))}function f1(n){var e=n.alternate;if(!e){if(e=Ii(n),e===null)throw Error(K(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return Jg(s),n;if(i===r)return Jg(s),e;i=i.sibling}throw Error(K(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(K(189))}}if(t.alternate!==r)throw Error(K(190))}if(t.tag!==3)throw Error(K(188));return t.stateNode.current===t?n:e}function y_(n){return n=f1(n),n!==null?v_(n):null}function v_(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=v_(n);if(e!==null)return e;n=n.sibling}return null}var __=gn.unstable_scheduleCallback,Xg=gn.unstable_cancelCallback,p1=gn.unstable_shouldYield,m1=gn.unstable_requestPaint,ht=gn.unstable_now,g1=gn.unstable_getCurrentPriorityLevel,bp=gn.unstable_ImmediatePriority,x_=gn.unstable_UserBlockingPriority,hu=gn.unstable_NormalPriority,y1=gn.unstable_LowPriority,w_=gn.unstable_IdlePriority,nd=null,Xn=null;function v1(n){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(nd,n,void 0,(n.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:w1,_1=Math.log,x1=Math.LN2;function w1(n){return n>>>=0,n===0?32:31-(_1(n)/x1|0)|0}var yc=64,vc=4194304;function Na(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function fu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Na(a):(i&=o,i!==0&&(r=Na(i)))}else o=t&~s,o!==0?r=Na(o):i!==0&&(r=Na(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ln(e),s=1<<t,r|=n[t],e&=~s;return r}function I1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T1(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Ln(i),a=1<<o,u=s[o];u===-1?(!(a&t)||a&r)&&(s[o]=I1(a,e)):u<=e&&(n.expiredLanes|=a),i&=~a}}function rf(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function I_(){var n=yc;return yc<<=1,!(yc&4194240)&&(yc=64),n}function sh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Cl(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ln(e),n[e]=t}function E1(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Ln(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function Sp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ln(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Me=0;function T_(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var E_,Np,b_,S_,N_,sf=!1,_c=[],is=null,os=null,as=null,el=new Map,tl=new Map,Wr=[],b1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zg(n,e){switch(n){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":os=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":el.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(e.pointerId)}}function pa(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Rl(e),e!==null&&Np(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function S1(n,e,t,r,s){switch(e){case"focusin":return is=pa(is,n,e,t,r,s),!0;case"dragenter":return os=pa(os,n,e,t,r,s),!0;case"mouseover":return as=pa(as,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return el.set(i,pa(el.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,tl.set(i,pa(tl.get(i)||null,n,e,t,r,s)),!0}return!1}function k_(n){var e=Zs(n.target);if(e!==null){var t=Ii(e);if(t!==null){if(e=t.tag,e===13){if(e=g_(t),e!==null){n.blockedOn=e,N_(n.priority,function(){b_(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function zc(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=of(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Zh=r,t.target.dispatchEvent(r),Zh=null}else return e=Rl(t),e!==null&&Np(e),n.blockedOn=t,!1;e.shift()}return!0}function ey(n,e,t){zc(n)&&t.delete(e)}function N1(){sf=!1,is!==null&&zc(is)&&(is=null),os!==null&&zc(os)&&(os=null),as!==null&&zc(as)&&(as=null),el.forEach(ey),tl.forEach(ey)}function ma(n,e){n.blockedOn===e&&(n.blockedOn=null,sf||(sf=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,N1)))}function nl(n){function e(s){return ma(s,n)}if(0<_c.length){ma(_c[0],n);for(var t=1;t<_c.length;t++){var r=_c[t];r.blockedOn===n&&(r.blockedOn=null)}}for(is!==null&&ma(is,n),os!==null&&ma(os,n),as!==null&&ma(as,n),el.forEach(e),tl.forEach(e),t=0;t<Wr.length;t++)r=Wr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Wr.length&&(t=Wr[0],t.blockedOn===null);)k_(t),t.blockedOn===null&&Wr.shift()}var fo=Rr.ReactCurrentBatchConfig,pu=!0;function k1(n,e,t,r){var s=Me,i=fo.transition;fo.transition=null;try{Me=1,kp(n,e,t,r)}finally{Me=s,fo.transition=i}}function C1(n,e,t,r){var s=Me,i=fo.transition;fo.transition=null;try{Me=4,kp(n,e,t,r)}finally{Me=s,fo.transition=i}}function kp(n,e,t,r){if(pu){var s=of(n,e,t,r);if(s===null)ph(n,e,r,mu,t),Zg(n,r);else if(S1(s,n,e,t,r))r.stopPropagation();else if(Zg(n,r),e&4&&-1<b1.indexOf(n)){for(;s!==null;){var i=Rl(s);if(i!==null&&E_(i),i=of(n,e,t,r),i===null&&ph(n,e,r,mu,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else ph(n,e,r,null,t)}}var mu=null;function of(n,e,t,r){if(mu=null,n=Ep(r),n=Zs(n),n!==null)if(e=Ii(n),e===null)n=null;else if(t=e.tag,t===13){if(n=g_(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return mu=n,null}function C_(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g1()){case bp:return 1;case x_:return 4;case hu:case y1:return 16;case w_:return 536870912;default:return 16}default:return 16}}var ts=null,Cp=null,Uc=null;function A_(){if(Uc)return Uc;var n,e=Cp,t=e.length,r,s="value"in ts?ts.value:ts.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Uc=s.slice(n,1<r?1-r:void 0)}function Bc(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function xc(){return!0}function ty(){return!1}function _n(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?xc:ty,this.isPropagationStopped=ty,this}return ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){},isPersistent:xc}),e}var qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ap=_n(qo),Al=ot({},qo,{view:0,detail:0}),A1=_n(Al),ih,oh,ga,rd=ot({},Al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ga&&(ga&&n.type==="mousemove"?(ih=n.screenX-ga.screenX,oh=n.screenY-ga.screenY):oh=ih=0,ga=n),ih)},movementY:function(n){return"movementY"in n?n.movementY:oh}}),ny=_n(rd),R1=ot({},rd,{dataTransfer:0}),P1=_n(R1),D1=ot({},Al,{relatedTarget:0}),ah=_n(D1),j1=ot({},qo,{animationName:0,elapsedTime:0,pseudoElement:0}),V1=_n(j1),M1=ot({},qo,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),O1=_n(M1),L1=ot({},qo,{data:0}),ry=_n(L1),F1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function B1(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=U1[n])?!!e[n]:!1}function Rp(){return B1}var $1=ot({},Al,{key:function(n){if(n.key){var e=F1[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Bc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?z1[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rp,charCode:function(n){return n.type==="keypress"?Bc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Bc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),q1=_n($1),G1=ot({},rd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sy=_n(G1),H1=ot({},Al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rp}),K1=_n(H1),W1=ot({},qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q1=_n(W1),Y1=ot({},rd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),J1=_n(Y1),X1=[9,13,27,32],Pp=Tr&&"CompositionEvent"in window,Ma=null;Tr&&"documentMode"in document&&(Ma=document.documentMode);var Z1=Tr&&"TextEvent"in window&&!Ma,R_=Tr&&(!Pp||Ma&&8<Ma&&11>=Ma),iy=" ",oy=!1;function P_(n,e){switch(n){case"keyup":return X1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function D_(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ji=!1;function eb(n,e){switch(n){case"compositionend":return D_(e);case"keypress":return e.which!==32?null:(oy=!0,iy);case"textInput":return n=e.data,n===iy&&oy?null:n;default:return null}}function tb(n,e){if(Ji)return n==="compositionend"||!Pp&&P_(n,e)?(n=A_(),Uc=Cp=ts=null,Ji=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return R_&&e.locale!=="ko"?null:e.data;default:return null}}var nb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ay(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!nb[n.type]:e==="textarea"}function j_(n,e,t,r){d_(r),e=gu(e,"onChange"),0<e.length&&(t=new Ap("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Oa=null,rl=null;function rb(n){G_(n,0)}function sd(n){var e=eo(n);if(s_(e))return n}function sb(n,e){if(n==="change")return e}var V_=!1;if(Tr){var lh;if(Tr){var ch="oninput"in document;if(!ch){var ly=document.createElement("div");ly.setAttribute("oninput","return;"),ch=typeof ly.oninput=="function"}lh=ch}else lh=!1;V_=lh&&(!document.documentMode||9<document.documentMode)}function cy(){Oa&&(Oa.detachEvent("onpropertychange",M_),rl=Oa=null)}function M_(n){if(n.propertyName==="value"&&sd(rl)){var e=[];j_(e,rl,n,Ep(n)),m_(rb,e)}}function ib(n,e,t){n==="focusin"?(cy(),Oa=e,rl=t,Oa.attachEvent("onpropertychange",M_)):n==="focusout"&&cy()}function ob(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return sd(rl)}function ab(n,e){if(n==="click")return sd(e)}function lb(n,e){if(n==="input"||n==="change")return sd(e)}function cb(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Un=typeof Object.is=="function"?Object.is:cb;function sl(n,e){if(Un(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!Uh.call(e,s)||!Un(n[s],e[s]))return!1}return!0}function uy(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function dy(n,e){var t=uy(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=uy(t)}}function O_(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?O_(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function L_(){for(var n=window,e=cu();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=cu(n.document)}return e}function Dp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function ub(n){var e=L_(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&O_(t.ownerDocument.documentElement,t)){if(r!==null&&Dp(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=dy(t,i);var o=dy(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var db=Tr&&"documentMode"in document&&11>=document.documentMode,Xi=null,af=null,La=null,lf=!1;function hy(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;lf||Xi==null||Xi!==cu(r)||(r=Xi,"selectionStart"in r&&Dp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),La&&sl(La,r)||(La=r,r=gu(af,"onSelect"),0<r.length&&(e=new Ap("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Xi)))}function wc(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Zi={animationend:wc("Animation","AnimationEnd"),animationiteration:wc("Animation","AnimationIteration"),animationstart:wc("Animation","AnimationStart"),transitionend:wc("Transition","TransitionEnd")},uh={},F_={};Tr&&(F_=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function id(n){if(uh[n])return uh[n];if(!Zi[n])return n;var e=Zi[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in F_)return uh[n]=e[t];return n}var z_=id("animationend"),U_=id("animationiteration"),B_=id("animationstart"),$_=id("transitionend"),q_=new Map,fy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ns(n,e){q_.set(n,e),wi(e,[n])}for(var dh=0;dh<fy.length;dh++){var hh=fy[dh],hb=hh.toLowerCase(),fb=hh[0].toUpperCase()+hh.slice(1);Ns(hb,"on"+fb)}Ns(z_,"onAnimationEnd");Ns(U_,"onAnimationIteration");Ns(B_,"onAnimationStart");Ns("dblclick","onDoubleClick");Ns("focusin","onFocus");Ns("focusout","onBlur");Ns($_,"onTransitionEnd");wo("onMouseEnter",["mouseout","mouseover"]);wo("onMouseLeave",["mouseout","mouseover"]);wo("onPointerEnter",["pointerout","pointerover"]);wo("onPointerLeave",["pointerout","pointerover"]);wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wi("onBeforeInput",["compositionend","keypress","textInput","paste"]);wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ka="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ka));function py(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,h1(r,e,void 0,n),n.currentTarget=null}function G_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;py(s,a,d),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,d=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;py(s,a,d),i=u}}}if(du)throw n=nf,du=!1,nf=null,n}function Ke(n,e){var t=e[ff];t===void 0&&(t=e[ff]=new Set);var r=n+"__bubble";t.has(r)||(H_(e,n,2,!1),t.add(r))}function fh(n,e,t){var r=0;e&&(r|=4),H_(t,n,r,e)}var Ic="_reactListening"+Math.random().toString(36).slice(2);function il(n){if(!n[Ic]){n[Ic]=!0,Z0.forEach(function(t){t!=="selectionchange"&&(pb.has(t)||fh(t,!1,n),fh(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Ic]||(e[Ic]=!0,fh("selectionchange",!1,e))}}function H_(n,e,t,r){switch(C_(e)){case 1:var s=k1;break;case 4:s=C1;break;default:s=kp}t=s.bind(null,e,t,n),s=void 0,!tf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function ph(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Zs(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}m_(function(){var d=i,f=Ep(t),m=[];e:{var y=q_.get(n);if(y!==void 0){var _=Ap,R=n;switch(n){case"keypress":if(Bc(t)===0)break e;case"keydown":case"keyup":_=q1;break;case"focusin":R="focus",_=ah;break;case"focusout":R="blur",_=ah;break;case"beforeblur":case"afterblur":_=ah;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=ny;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=P1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=K1;break;case z_:case U_:case B_:_=V1;break;case $_:_=Q1;break;case"scroll":_=A1;break;case"wheel":_=J1;break;case"copy":case"cut":case"paste":_=O1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=sy}var A=(e&4)!==0,k=!A&&n==="scroll",E=A?y!==null?y+"Capture":null:y;A=[];for(var v=d,b;v!==null;){b=v;var I=b.stateNode;if(b.tag===5&&I!==null&&(b=I,E!==null&&(I=Za(v,E),I!=null&&A.push(ol(v,I,b)))),k)break;v=v.return}0<A.length&&(y=new _(y,R,null,t,f),m.push({event:y,listeners:A}))}}if(!(e&7)){e:{if(y=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",y&&t!==Zh&&(R=t.relatedTarget||t.fromElement)&&(Zs(R)||R[Er]))break e;if((_||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,_?(R=t.relatedTarget||t.toElement,_=d,R=R?Zs(R):null,R!==null&&(k=Ii(R),R!==k||R.tag!==5&&R.tag!==6)&&(R=null)):(_=null,R=d),_!==R)){if(A=ny,I="onMouseLeave",E="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(A=sy,I="onPointerLeave",E="onPointerEnter",v="pointer"),k=_==null?y:eo(_),b=R==null?y:eo(R),y=new A(I,v+"leave",_,t,f),y.target=k,y.relatedTarget=b,I=null,Zs(f)===d&&(A=new A(E,v+"enter",R,t,f),A.target=b,A.relatedTarget=k,I=A),k=I,_&&R)t:{for(A=_,E=R,v=0,b=A;b;b=Li(b))v++;for(b=0,I=E;I;I=Li(I))b++;for(;0<v-b;)A=Li(A),v--;for(;0<b-v;)E=Li(E),b--;for(;v--;){if(A===E||E!==null&&A===E.alternate)break t;A=Li(A),E=Li(E)}A=null}else A=null;_!==null&&my(m,y,_,A,!1),R!==null&&k!==null&&my(m,k,R,A,!0)}}e:{if(y=d?eo(d):window,_=y.nodeName&&y.nodeName.toLowerCase(),_==="select"||_==="input"&&y.type==="file")var D=sb;else if(ay(y))if(V_)D=lb;else{D=ob;var P=ib}else(_=y.nodeName)&&_.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(D=ab);if(D&&(D=D(n,d))){j_(m,D,t,f);break e}P&&P(n,y,d),n==="focusout"&&(P=y._wrapperState)&&P.controlled&&y.type==="number"&&Wh(y,"number",y.value)}switch(P=d?eo(d):window,n){case"focusin":(ay(P)||P.contentEditable==="true")&&(Xi=P,af=d,La=null);break;case"focusout":La=af=Xi=null;break;case"mousedown":lf=!0;break;case"contextmenu":case"mouseup":case"dragend":lf=!1,hy(m,t,f);break;case"selectionchange":if(db)break;case"keydown":case"keyup":hy(m,t,f)}var w;if(Pp)e:{switch(n){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Ji?P_(n,t)&&(g="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(g="onCompositionStart");g&&(R_&&t.locale!=="ko"&&(Ji||g!=="onCompositionStart"?g==="onCompositionEnd"&&Ji&&(w=A_()):(ts=f,Cp="value"in ts?ts.value:ts.textContent,Ji=!0)),P=gu(d,g),0<P.length&&(g=new ry(g,n,null,t,f),m.push({event:g,listeners:P}),w?g.data=w:(w=D_(t),w!==null&&(g.data=w)))),(w=Z1?eb(n,t):tb(n,t))&&(d=gu(d,"onBeforeInput"),0<d.length&&(f=new ry("onBeforeInput","beforeinput",null,t,f),m.push({event:f,listeners:d}),f.data=w))}G_(m,e)})}function ol(n,e,t){return{instance:n,listener:e,currentTarget:t}}function gu(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Za(n,t),i!=null&&r.unshift(ol(n,i,s)),i=Za(n,e),i!=null&&r.push(ol(n,i,s))),n=n.return}return r}function Li(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function my(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,d=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&d!==null&&(a=d,s?(u=Za(t,i),u!=null&&o.unshift(ol(t,u,a))):s||(u=Za(t,i),u!=null&&o.push(ol(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var mb=/\r\n?/g,gb=/\u0000|\uFFFD/g;function gy(n){return(typeof n=="string"?n:""+n).replace(mb,`
`).replace(gb,"")}function Tc(n,e,t){if(e=gy(e),gy(n)!==e&&t)throw Error(K(425))}function yu(){}var cf=null,uf=null;function df(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hf=typeof setTimeout=="function"?setTimeout:void 0,yb=typeof clearTimeout=="function"?clearTimeout:void 0,yy=typeof Promise=="function"?Promise:void 0,vb=typeof queueMicrotask=="function"?queueMicrotask:typeof yy<"u"?function(n){return yy.resolve(null).then(n).catch(_b)}:hf;function _b(n){setTimeout(function(){throw n})}function mh(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),nl(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);nl(e)}function ls(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function vy(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Go=Math.random().toString(36).slice(2),Qn="__reactFiber$"+Go,al="__reactProps$"+Go,Er="__reactContainer$"+Go,ff="__reactEvents$"+Go,xb="__reactListeners$"+Go,wb="__reactHandles$"+Go;function Zs(n){var e=n[Qn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Er]||t[Qn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=vy(n);n!==null;){if(t=n[Qn])return t;n=vy(n)}return e}n=t,t=n.parentNode}return null}function Rl(n){return n=n[Qn]||n[Er],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function eo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(K(33))}function od(n){return n[al]||null}var pf=[],to=-1;function ks(n){return{current:n}}function We(n){0>to||(n.current=pf[to],pf[to]=null,to--)}function Be(n,e){to++,pf[to]=n.current,n.current=e}var ws={},Gt=ks(ws),rn=ks(!1),oi=ws;function Io(n,e){var t=n.type.contextTypes;if(!t)return ws;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function sn(n){return n=n.childContextTypes,n!=null}function vu(){We(rn),We(Gt)}function _y(n,e,t){if(Gt.current!==ws)throw Error(K(168));Be(Gt,e),Be(rn,t)}function K_(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,i1(n)||"Unknown",s));return ot({},t,r)}function _u(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ws,oi=Gt.current,Be(Gt,n),Be(rn,rn.current),!0}function xy(n,e,t){var r=n.stateNode;if(!r)throw Error(K(169));t?(n=K_(n,e,oi),r.__reactInternalMemoizedMergedChildContext=n,We(rn),We(Gt),Be(Gt,n)):We(rn),Be(rn,t)}var hr=null,ad=!1,gh=!1;function W_(n){hr===null?hr=[n]:hr.push(n)}function Ib(n){ad=!0,W_(n)}function Cs(){if(!gh&&hr!==null){gh=!0;var n=0,e=Me;try{var t=hr;for(Me=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}hr=null,ad=!1}catch(s){throw hr!==null&&(hr=hr.slice(n+1)),__(bp,Cs),s}finally{Me=e,gh=!1}}return null}var no=[],ro=0,xu=null,wu=0,In=[],Tn=0,ai=null,fr=1,pr="";function Gs(n,e){no[ro++]=wu,no[ro++]=xu,xu=n,wu=e}function Q_(n,e,t){In[Tn++]=fr,In[Tn++]=pr,In[Tn++]=ai,ai=n;var r=fr;n=pr;var s=32-Ln(r)-1;r&=~(1<<s),t+=1;var i=32-Ln(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,fr=1<<32-Ln(e)+s|t<<s|r,pr=i+n}else fr=1<<i|t<<s|r,pr=n}function jp(n){n.return!==null&&(Gs(n,1),Q_(n,1,0))}function Vp(n){for(;n===xu;)xu=no[--ro],no[ro]=null,wu=no[--ro],no[ro]=null;for(;n===ai;)ai=In[--Tn],In[Tn]=null,pr=In[--Tn],In[Tn]=null,fr=In[--Tn],In[Tn]=null}var fn=null,dn=null,Je=!1,Mn=null;function Y_(n,e){var t=En(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function wy(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,fn=n,dn=ls(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,fn=n,dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ai!==null?{id:fr,overflow:pr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=En(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,fn=n,dn=null,!0):!1;default:return!1}}function mf(n){return(n.mode&1)!==0&&(n.flags&128)===0}function gf(n){if(Je){var e=dn;if(e){var t=e;if(!wy(n,e)){if(mf(n))throw Error(K(418));e=ls(t.nextSibling);var r=fn;e&&wy(n,e)?Y_(r,t):(n.flags=n.flags&-4097|2,Je=!1,fn=n)}}else{if(mf(n))throw Error(K(418));n.flags=n.flags&-4097|2,Je=!1,fn=n}}}function Iy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;fn=n}function Ec(n){if(n!==fn)return!1;if(!Je)return Iy(n),Je=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!df(n.type,n.memoizedProps)),e&&(e=dn)){if(mf(n))throw J_(),Error(K(418));for(;e;)Y_(n,e),e=ls(e.nextSibling)}if(Iy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(K(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){dn=ls(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}dn=null}}else dn=fn?ls(n.stateNode.nextSibling):null;return!0}function J_(){for(var n=dn;n;)n=ls(n.nextSibling)}function To(){dn=fn=null,Je=!1}function Mp(n){Mn===null?Mn=[n]:Mn.push(n)}var Tb=Rr.ReactCurrentBatchConfig;function ya(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(K(309));var r=t.stateNode}if(!r)throw Error(K(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(K(284));if(!t._owner)throw Error(K(290,n))}return n}function bc(n,e){throw n=Object.prototype.toString.call(e),Error(K(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Ty(n){var e=n._init;return e(n._payload)}function X_(n){function e(E,v){if(n){var b=E.deletions;b===null?(E.deletions=[v],E.flags|=16):b.push(v)}}function t(E,v){if(!n)return null;for(;v!==null;)e(E,v),v=v.sibling;return null}function r(E,v){for(E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function s(E,v){return E=hs(E,v),E.index=0,E.sibling=null,E}function i(E,v,b){return E.index=b,n?(b=E.alternate,b!==null?(b=b.index,b<v?(E.flags|=2,v):b):(E.flags|=2,v)):(E.flags|=1048576,v)}function o(E){return n&&E.alternate===null&&(E.flags|=2),E}function a(E,v,b,I){return v===null||v.tag!==6?(v=Th(b,E.mode,I),v.return=E,v):(v=s(v,b),v.return=E,v)}function u(E,v,b,I){var D=b.type;return D===Yi?f(E,v,b.props.children,I,b.key):v!==null&&(v.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Hr&&Ty(D)===v.type)?(I=s(v,b.props),I.ref=ya(E,v,b),I.return=E,I):(I=Qc(b.type,b.key,b.props,null,E.mode,I),I.ref=ya(E,v,b),I.return=E,I)}function d(E,v,b,I){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Eh(b,E.mode,I),v.return=E,v):(v=s(v,b.children||[]),v.return=E,v)}function f(E,v,b,I,D){return v===null||v.tag!==7?(v=ri(b,E.mode,I,D),v.return=E,v):(v=s(v,b),v.return=E,v)}function m(E,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Th(""+v,E.mode,b),v.return=E,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case pc:return b=Qc(v.type,v.key,v.props,null,E.mode,b),b.ref=ya(E,null,v),b.return=E,b;case Qi:return v=Eh(v,E.mode,b),v.return=E,v;case Hr:var I=v._init;return m(E,I(v._payload),b)}if(Sa(v)||ha(v))return v=ri(v,E.mode,b,null),v.return=E,v;bc(E,v)}return null}function y(E,v,b,I){var D=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return D!==null?null:a(E,v,""+b,I);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case pc:return b.key===D?u(E,v,b,I):null;case Qi:return b.key===D?d(E,v,b,I):null;case Hr:return D=b._init,y(E,v,D(b._payload),I)}if(Sa(b)||ha(b))return D!==null?null:f(E,v,b,I,null);bc(E,b)}return null}function _(E,v,b,I,D){if(typeof I=="string"&&I!==""||typeof I=="number")return E=E.get(b)||null,a(v,E,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case pc:return E=E.get(I.key===null?b:I.key)||null,u(v,E,I,D);case Qi:return E=E.get(I.key===null?b:I.key)||null,d(v,E,I,D);case Hr:var P=I._init;return _(E,v,b,P(I._payload),D)}if(Sa(I)||ha(I))return E=E.get(b)||null,f(v,E,I,D,null);bc(v,I)}return null}function R(E,v,b,I){for(var D=null,P=null,w=v,g=v=0,x=null;w!==null&&g<b.length;g++){w.index>g?(x=w,w=null):x=w.sibling;var S=y(E,w,b[g],I);if(S===null){w===null&&(w=x);break}n&&w&&S.alternate===null&&e(E,w),v=i(S,v,g),P===null?D=S:P.sibling=S,P=S,w=x}if(g===b.length)return t(E,w),Je&&Gs(E,g),D;if(w===null){for(;g<b.length;g++)w=m(E,b[g],I),w!==null&&(v=i(w,v,g),P===null?D=w:P.sibling=w,P=w);return Je&&Gs(E,g),D}for(w=r(E,w);g<b.length;g++)x=_(w,E,g,b[g],I),x!==null&&(n&&x.alternate!==null&&w.delete(x.key===null?g:x.key),v=i(x,v,g),P===null?D=x:P.sibling=x,P=x);return n&&w.forEach(function(C){return e(E,C)}),Je&&Gs(E,g),D}function A(E,v,b,I){var D=ha(b);if(typeof D!="function")throw Error(K(150));if(b=D.call(b),b==null)throw Error(K(151));for(var P=D=null,w=v,g=v=0,x=null,S=b.next();w!==null&&!S.done;g++,S=b.next()){w.index>g?(x=w,w=null):x=w.sibling;var C=y(E,w,S.value,I);if(C===null){w===null&&(w=x);break}n&&w&&C.alternate===null&&e(E,w),v=i(C,v,g),P===null?D=C:P.sibling=C,P=C,w=x}if(S.done)return t(E,w),Je&&Gs(E,g),D;if(w===null){for(;!S.done;g++,S=b.next())S=m(E,S.value,I),S!==null&&(v=i(S,v,g),P===null?D=S:P.sibling=S,P=S);return Je&&Gs(E,g),D}for(w=r(E,w);!S.done;g++,S=b.next())S=_(w,E,g,S.value,I),S!==null&&(n&&S.alternate!==null&&w.delete(S.key===null?g:S.key),v=i(S,v,g),P===null?D=S:P.sibling=S,P=S);return n&&w.forEach(function(j){return e(E,j)}),Je&&Gs(E,g),D}function k(E,v,b,I){if(typeof b=="object"&&b!==null&&b.type===Yi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case pc:e:{for(var D=b.key,P=v;P!==null;){if(P.key===D){if(D=b.type,D===Yi){if(P.tag===7){t(E,P.sibling),v=s(P,b.props.children),v.return=E,E=v;break e}}else if(P.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Hr&&Ty(D)===P.type){t(E,P.sibling),v=s(P,b.props),v.ref=ya(E,P,b),v.return=E,E=v;break e}t(E,P);break}else e(E,P);P=P.sibling}b.type===Yi?(v=ri(b.props.children,E.mode,I,b.key),v.return=E,E=v):(I=Qc(b.type,b.key,b.props,null,E.mode,I),I.ref=ya(E,v,b),I.return=E,E=I)}return o(E);case Qi:e:{for(P=b.key;v!==null;){if(v.key===P)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){t(E,v.sibling),v=s(v,b.children||[]),v.return=E,E=v;break e}else{t(E,v);break}else e(E,v);v=v.sibling}v=Eh(b,E.mode,I),v.return=E,E=v}return o(E);case Hr:return P=b._init,k(E,v,P(b._payload),I)}if(Sa(b))return R(E,v,b,I);if(ha(b))return A(E,v,b,I);bc(E,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(t(E,v.sibling),v=s(v,b),v.return=E,E=v):(t(E,v),v=Th(b,E.mode,I),v.return=E,E=v),o(E)):t(E,v)}return k}var Eo=X_(!0),Z_=X_(!1),Iu=ks(null),Tu=null,so=null,Op=null;function Lp(){Op=so=Tu=null}function Fp(n){var e=Iu.current;We(Iu),n._currentValue=e}function yf(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function po(n,e){Tu=n,Op=so=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(en=!0),n.firstContext=null)}function Sn(n){var e=n._currentValue;if(Op!==n)if(n={context:n,memoizedValue:e,next:null},so===null){if(Tu===null)throw Error(K(308));so=n,Tu.dependencies={lanes:0,firstContext:n}}else so=so.next=n;return e}var ei=null;function zp(n){ei===null?ei=[n]:ei.push(n)}function ex(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,zp(e)):(t.next=s.next,s.next=t),e.interleaved=t,br(n,r)}function br(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Kr=!1;function Up(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tx(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function wr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function cs(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,br(n,t)}return s=r.interleaved,s===null?(e.next=e,zp(r)):(e.next=s.next,s.next=e),r.interleaved=e,br(n,t)}function $c(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Sp(n,t)}}function Ey(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Eu(n,e,t,r){var s=n.updateQueue;Kr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=n.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=d:a.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,f=d=u=null,a=i;do{var y=a.lane,_=a.eventTime;if((r&y)===y){f!==null&&(f=f.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=n,A=a;switch(y=e,_=t,A.tag){case 1:if(R=A.payload,typeof R=="function"){m=R.call(_,m,y);break e}m=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=A.payload,y=typeof R=="function"?R.call(_,m,y):R,y==null)break e;m=ot({},m,y);break e;case 2:Kr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,y=s.effects,y===null?s.effects=[a]:y.push(a))}else _={eventTime:_,lane:y,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(d=f=_,u=m):f=f.next=_,o|=y;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;y=a,a=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ci|=o,n.lanes=o,n.memoizedState=m}}function by(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Pl={},Zn=ks(Pl),ll=ks(Pl),cl=ks(Pl);function ti(n){if(n===Pl)throw Error(K(174));return n}function Bp(n,e){switch(Be(cl,e),Be(ll,n),Be(Zn,Pl),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yh(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Yh(e,n)}We(Zn),Be(Zn,e)}function bo(){We(Zn),We(ll),We(cl)}function nx(n){ti(cl.current);var e=ti(Zn.current),t=Yh(e,n.type);e!==t&&(Be(ll,n),Be(Zn,t))}function $p(n){ll.current===n&&(We(Zn),We(ll))}var nt=ks(0);function bu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yh=[];function qp(){for(var n=0;n<yh.length;n++)yh[n]._workInProgressVersionPrimary=null;yh.length=0}var qc=Rr.ReactCurrentDispatcher,vh=Rr.ReactCurrentBatchConfig,li=0,st=null,It=null,Nt=null,Su=!1,Fa=!1,ul=0,Eb=0;function Ft(){throw Error(K(321))}function Gp(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Un(n[t],e[t]))return!1;return!0}function Hp(n,e,t,r,s,i){if(li=i,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qc.current=n===null||n.memoizedState===null?kb:Cb,n=t(r,s),Fa){i=0;do{if(Fa=!1,ul=0,25<=i)throw Error(K(301));i+=1,Nt=It=null,e.updateQueue=null,qc.current=Ab,n=t(r,s)}while(Fa)}if(qc.current=Nu,e=It!==null&&It.next!==null,li=0,Nt=It=st=null,Su=!1,e)throw Error(K(300));return n}function Kp(){var n=ul!==0;return ul=0,n}function Wn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?st.memoizedState=Nt=n:Nt=Nt.next=n,Nt}function Nn(){if(It===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=It.next;var e=Nt===null?st.memoizedState:Nt.next;if(e!==null)Nt=e,It=n;else{if(n===null)throw Error(K(310));It=n,n={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Nt===null?st.memoizedState=Nt=n:Nt=Nt.next=n}return Nt}function dl(n,e){return typeof e=="function"?e(n):e}function _h(n){var e=Nn(),t=e.queue;if(t===null)throw Error(K(311));t.lastRenderedReducer=n;var r=It,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,d=i;do{var f=d.lane;if((li&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=m,o=r):u=u.next=m,st.lanes|=f,ci|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=a,Un(r,e.memoizedState)||(en=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,st.lanes|=i,ci|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function xh(n){var e=Nn(),t=e.queue;if(t===null)throw Error(K(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Un(i,e.memoizedState)||(en=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function rx(){}function sx(n,e){var t=st,r=Nn(),s=e(),i=!Un(r.memoizedState,s);if(i&&(r.memoizedState=s,en=!0),r=r.queue,Wp(ax.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Nt!==null&&Nt.memoizedState.tag&1){if(t.flags|=2048,hl(9,ox.bind(null,t,r,s,e),void 0,null),Ct===null)throw Error(K(349));li&30||ix(t,e,s)}return s}function ix(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function ox(n,e,t,r){e.value=t,e.getSnapshot=r,lx(e)&&cx(n)}function ax(n,e,t){return t(function(){lx(e)&&cx(n)})}function lx(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Un(n,t)}catch{return!0}}function cx(n){var e=br(n,1);e!==null&&Fn(e,n,1,-1)}function Sy(n){var e=Wn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dl,lastRenderedState:n},e.queue=n,n=n.dispatch=Nb.bind(null,st,n),[e.memoizedState,n]}function hl(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function ux(){return Nn().memoizedState}function Gc(n,e,t,r){var s=Wn();st.flags|=n,s.memoizedState=hl(1|e,t,void 0,r===void 0?null:r)}function ld(n,e,t,r){var s=Nn();r=r===void 0?null:r;var i=void 0;if(It!==null){var o=It.memoizedState;if(i=o.destroy,r!==null&&Gp(r,o.deps)){s.memoizedState=hl(e,t,i,r);return}}st.flags|=n,s.memoizedState=hl(1|e,t,i,r)}function Ny(n,e){return Gc(8390656,8,n,e)}function Wp(n,e){return ld(2048,8,n,e)}function dx(n,e){return ld(4,2,n,e)}function hx(n,e){return ld(4,4,n,e)}function fx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function px(n,e,t){return t=t!=null?t.concat([n]):null,ld(4,4,fx.bind(null,e,n),t)}function Qp(){}function mx(n,e){var t=Nn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function gx(n,e){var t=Nn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function yx(n,e,t){return li&21?(Un(t,e)||(t=I_(),st.lanes|=t,ci|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,en=!0),n.memoizedState=t)}function bb(n,e){var t=Me;Me=t!==0&&4>t?t:4,n(!0);var r=vh.transition;vh.transition={};try{n(!1),e()}finally{Me=t,vh.transition=r}}function vx(){return Nn().memoizedState}function Sb(n,e,t){var r=ds(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},_x(n))xx(e,t);else if(t=ex(n,e,t,r),t!==null){var s=Kt();Fn(t,n,r,s),wx(t,e,r)}}function Nb(n,e,t){var r=ds(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(_x(n))xx(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Un(a,o)){var u=e.interleaved;u===null?(s.next=s,zp(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}t=ex(n,e,s,r),t!==null&&(s=Kt(),Fn(t,n,r,s),wx(t,e,r))}}function _x(n){var e=n.alternate;return n===st||e!==null&&e===st}function xx(n,e){Fa=Su=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function wx(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Sp(n,t)}}var Nu={readContext:Sn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},kb={readContext:Sn,useCallback:function(n,e){return Wn().memoizedState=[n,e===void 0?null:e],n},useContext:Sn,useEffect:Ny,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Gc(4194308,4,fx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Gc(4194308,4,n,e)},useInsertionEffect:function(n,e){return Gc(4,2,n,e)},useMemo:function(n,e){var t=Wn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Wn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Sb.bind(null,st,n),[r.memoizedState,n]},useRef:function(n){var e=Wn();return n={current:n},e.memoizedState=n},useState:Sy,useDebugValue:Qp,useDeferredValue:function(n){return Wn().memoizedState=n},useTransition:function(){var n=Sy(!1),e=n[0];return n=bb.bind(null,n[1]),Wn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=st,s=Wn();if(Je){if(t===void 0)throw Error(K(407));t=t()}else{if(t=e(),Ct===null)throw Error(K(349));li&30||ix(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Ny(ax.bind(null,r,i,n),[n]),r.flags|=2048,hl(9,ox.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=Wn(),e=Ct.identifierPrefix;if(Je){var t=pr,r=fr;t=(r&~(1<<32-Ln(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=ul++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Eb++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Cb={readContext:Sn,useCallback:mx,useContext:Sn,useEffect:Wp,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:hx,useMemo:gx,useReducer:_h,useRef:ux,useState:function(){return _h(dl)},useDebugValue:Qp,useDeferredValue:function(n){var e=Nn();return yx(e,It.memoizedState,n)},useTransition:function(){var n=_h(dl)[0],e=Nn().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:sx,useId:vx,unstable_isNewReconciler:!1},Ab={readContext:Sn,useCallback:mx,useContext:Sn,useEffect:Wp,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:hx,useMemo:gx,useReducer:xh,useRef:ux,useState:function(){return xh(dl)},useDebugValue:Qp,useDeferredValue:function(n){var e=Nn();return It===null?e.memoizedState=n:yx(e,It.memoizedState,n)},useTransition:function(){var n=xh(dl)[0],e=Nn().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:sx,useId:vx,unstable_isNewReconciler:!1};function jn(n,e){if(n&&n.defaultProps){e=ot({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function vf(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:ot({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var cd={isMounted:function(n){return(n=n._reactInternals)?Ii(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=ds(n),i=wr(r,s);i.payload=e,t!=null&&(i.callback=t),e=cs(n,i,s),e!==null&&(Fn(e,n,s,r),$c(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=ds(n),i=wr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=cs(n,i,s),e!==null&&(Fn(e,n,s,r),$c(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Kt(),r=ds(n),s=wr(t,r);s.tag=2,e!=null&&(s.callback=e),e=cs(n,s,r),e!==null&&(Fn(e,n,r,t),$c(e,n,r))}};function ky(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!sl(t,r)||!sl(s,i):!0}function Ix(n,e,t){var r=!1,s=ws,i=e.contextType;return typeof i=="object"&&i!==null?i=Sn(i):(s=sn(e)?oi:Gt.current,r=e.contextTypes,i=(r=r!=null)?Io(n,s):ws),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cd,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function Cy(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&cd.enqueueReplaceState(e,e.state,null)}function _f(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Up(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Sn(i):(i=sn(e)?oi:Gt.current,s.context=Io(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vf(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&cd.enqueueReplaceState(s,s.state,null),Eu(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function So(n,e){try{var t="",r=e;do t+=s1(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function wh(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function xf(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Rb=typeof WeakMap=="function"?WeakMap:Map;function Tx(n,e,t){t=wr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Cu||(Cu=!0,Af=r),xf(n,e)},t}function Ex(n,e,t){t=wr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){xf(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){xf(n,e),typeof r!="function"&&(us===null?us=new Set([this]):us.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function Ay(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new Rb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=Gb.bind(null,n,e,t),e.then(n,n))}function Ry(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Py(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=wr(-1,1),e.tag=2,cs(t,e,1))),t.lanes|=1),n)}var Pb=Rr.ReactCurrentOwner,en=!1;function Ht(n,e,t,r){e.child=n===null?Z_(e,null,t,r):Eo(e,n.child,t,r)}function Dy(n,e,t,r,s){t=t.render;var i=e.ref;return po(e,s),r=Hp(n,e,t,r,i,s),t=Kp(),n!==null&&!en?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Sr(n,e,s)):(Je&&t&&jp(e),e.flags|=1,Ht(n,e,r,s),e.child)}function jy(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!rm(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,bx(n,e,i,r,s)):(n=Qc(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:sl,t(o,r)&&n.ref===e.ref)return Sr(n,e,s)}return e.flags|=1,n=hs(i,r),n.ref=e.ref,n.return=e,e.child=n}function bx(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(sl(i,r)&&n.ref===e.ref)if(en=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(en=!0);else return e.lanes=n.lanes,Sr(n,e,s)}return wf(n,e,t,r,s)}function Sx(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(oo,un),un|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Be(oo,un),un|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Be(oo,un),un|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Be(oo,un),un|=r;return Ht(n,e,s,t),e.child}function Nx(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function wf(n,e,t,r,s){var i=sn(t)?oi:Gt.current;return i=Io(e,i),po(e,s),t=Hp(n,e,t,r,i,s),r=Kp(),n!==null&&!en?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Sr(n,e,s)):(Je&&r&&jp(e),e.flags|=1,Ht(n,e,t,s),e.child)}function Vy(n,e,t,r,s){if(sn(t)){var i=!0;_u(e)}else i=!1;if(po(e,s),e.stateNode===null)Hc(n,e),Ix(e,t,r),_f(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=Sn(d):(d=sn(t)?oi:Gt.current,d=Io(e,d));var f=t.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==d)&&Cy(e,o,r,d),Kr=!1;var y=e.memoizedState;o.state=y,Eu(e,r,o,s),u=e.memoizedState,a!==r||y!==u||rn.current||Kr?(typeof f=="function"&&(vf(e,t,f,r),u=e.memoizedState),(a=Kr||ky(e,t,a,r,y,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tx(n,e),a=e.memoizedProps,d=e.type===e.elementType?a:jn(e.type,a),o.props=d,m=e.pendingProps,y=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=Sn(u):(u=sn(t)?oi:Gt.current,u=Io(e,u));var _=t.getDerivedStateFromProps;(f=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||y!==u)&&Cy(e,o,r,u),Kr=!1,y=e.memoizedState,o.state=y,Eu(e,r,o,s);var R=e.memoizedState;a!==m||y!==R||rn.current||Kr?(typeof _=="function"&&(vf(e,t,_,r),R=e.memoizedState),(d=Kr||ky(e,t,d,r,y,R,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),r=!1)}return If(n,e,t,r,i,s)}function If(n,e,t,r,s,i){Nx(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&xy(e,t,!1),Sr(n,e,i);r=e.stateNode,Pb.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Eo(e,n.child,null,i),e.child=Eo(e,null,a,i)):Ht(n,e,a,i),e.memoizedState=r.state,s&&xy(e,t,!0),e.child}function kx(n){var e=n.stateNode;e.pendingContext?_y(n,e.pendingContext,e.pendingContext!==e.context):e.context&&_y(n,e.context,!1),Bp(n,e.containerInfo)}function My(n,e,t,r,s){return To(),Mp(s),e.flags|=256,Ht(n,e,t,r),e.child}var Tf={dehydrated:null,treeContext:null,retryLane:0};function Ef(n){return{baseLanes:n,cachePool:null,transitions:null}}function Cx(n,e,t){var r=e.pendingProps,s=nt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Be(nt,s&1),n===null)return gf(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=hd(o,r,0,null),n=ri(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Ef(t),e.memoizedState=Tf,n):Yp(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Db(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=hs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=hs(a,i):(i=ri(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Ef(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Tf,r}return i=n.child,n=i.sibling,r=hs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Yp(n,e){return e=hd({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Sc(n,e,t,r){return r!==null&&Mp(r),Eo(e,n.child,null,t),n=Yp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Db(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=wh(Error(K(422))),Sc(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=hd({mode:"visible",children:r.children},s,0,null),i=ri(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Eo(e,n.child,null,o),e.child.memoizedState=Ef(o),e.memoizedState=Tf,i);if(!(e.mode&1))return Sc(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(K(419)),r=wh(i,r,void 0),Sc(n,e,o,r)}if(a=(o&n.childLanes)!==0,en||a){if(r=Ct,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,br(n,s),Fn(r,n,s,-1))}return nm(),r=wh(Error(K(421))),Sc(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=Hb.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,dn=ls(s.nextSibling),fn=e,Je=!0,Mn=null,n!==null&&(In[Tn++]=fr,In[Tn++]=pr,In[Tn++]=ai,fr=n.id,pr=n.overflow,ai=e),e=Yp(e,r.children),e.flags|=4096,e)}function Oy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),yf(n.return,e,t)}function Ih(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function Ax(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ht(n,e,r.children,t),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Oy(n,t,e);else if(n.tag===19)Oy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Be(nt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&bu(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Ih(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&bu(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Ih(e,!0,t,null,i);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Sr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ci|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(K(153));if(e.child!==null){for(n=e.child,t=hs(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=hs(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function jb(n,e,t){switch(e.tag){case 3:kx(e),To();break;case 5:nx(e);break;case 1:sn(e.type)&&_u(e);break;case 4:Bp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Be(Iu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(nt,nt.current&1),e.flags|=128,null):t&e.child.childLanes?Cx(n,e,t):(Be(nt,nt.current&1),n=Sr(n,e,t),n!==null?n.sibling:null);Be(nt,nt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Ax(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,Sx(n,e,t)}return Sr(n,e,t)}var Rx,bf,Px,Dx;Rx=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};bf=function(){};Px=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,ti(Zn.current);var i=null;switch(t){case"input":s=Hh(n,s),r=Hh(n,r),i=[];break;case"select":s=ot({},s,{value:void 0}),r=ot({},r,{value:void 0}),i=[];break;case"textarea":s=Qh(n,s),r=Qh(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=yu)}Jh(t,r);var o;t=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ja.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(i||(i=[]),i.push(d,t)),t=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ja.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ke("scroll",n),i||a===u||(i=[])):(i=i||[]).push(d,u))}t&&(i=i||[]).push("style",t);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Dx=function(n,e,t,r){t!==r&&(e.flags|=4)};function va(n,e){if(!Je)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function zt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Vb(n,e,t){var r=e.pendingProps;switch(Vp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return sn(e.type)&&vu(),zt(e),null;case 3:return r=e.stateNode,bo(),We(rn),We(Gt),qp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Ec(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(Df(Mn),Mn=null))),bf(n,e),zt(e),null;case 5:$p(e);var s=ti(cl.current);if(t=e.type,n!==null&&e.stateNode!=null)Px(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return zt(e),null}if(n=ti(Zn.current),Ec(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Qn]=e,r[al]=i,n=(e.mode&1)!==0,t){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(s=0;s<ka.length;s++)Ke(ka[s],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Hg(r,i),Ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ke("invalid",r);break;case"textarea":Wg(r,i),Ke("invalid",r)}Jh(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Tc(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Tc(r.textContent,a,n),s=["children",""+a]):Ja.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ke("scroll",r)}switch(t){case"input":mc(r),Kg(r,i,!0);break;case"textarea":mc(r),Qg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=yu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=a_(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Qn]=e,n[al]=r,Rx(n,e,!1,!1),e.stateNode=n;e:{switch(o=Xh(t,r),t){case"dialog":Ke("cancel",n),Ke("close",n),s=r;break;case"iframe":case"object":case"embed":Ke("load",n),s=r;break;case"video":case"audio":for(s=0;s<ka.length;s++)Ke(ka[s],n);s=r;break;case"source":Ke("error",n),s=r;break;case"img":case"image":case"link":Ke("error",n),Ke("load",n),s=r;break;case"details":Ke("toggle",n),s=r;break;case"input":Hg(n,r),s=Hh(n,r),Ke("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=ot({},r,{value:void 0}),Ke("invalid",n);break;case"textarea":Wg(n,r),s=Qh(n,r),Ke("invalid",n);break;default:s=r}Jh(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?u_(n,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&l_(n,u)):i==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&Xa(n,u):typeof u=="number"&&Xa(n,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ja.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ke("scroll",n):u!=null&&xp(n,i,u,o))}switch(t){case"input":mc(n),Kg(n,r,!1);break;case"textarea":mc(n),Qg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+xs(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?co(n,!!r.multiple,i,!1):r.defaultValue!=null&&co(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=yu)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(n&&e.stateNode!=null)Dx(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(t=ti(cl.current),ti(Zn.current),Ec(e)){if(r=e.stateNode,t=e.memoizedProps,r[Qn]=e,(i=r.nodeValue!==t)&&(n=fn,n!==null))switch(n.tag){case 3:Tc(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Tc(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Qn]=e,e.stateNode=r}return zt(e),null;case 13:if(We(nt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Je&&dn!==null&&e.mode&1&&!(e.flags&128))J_(),To(),e.flags|=98560,i=!1;else if(i=Ec(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[Qn]=e}else To(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),i=!1}else Mn!==null&&(Df(Mn),Mn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||nt.current&1?Tt===0&&(Tt=3):nm())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return bo(),bf(n,e),n===null&&il(e.stateNode.containerInfo),zt(e),null;case 10:return Fp(e.type._context),zt(e),null;case 17:return sn(e.type)&&vu(),zt(e),null;case 19:if(We(nt),i=e.memoizedState,i===null)return zt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)va(i,!1);else{if(Tt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=bu(n),o!==null){for(e.flags|=128,va(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Be(nt,nt.current&1|2),e.child}n=n.sibling}i.tail!==null&&ht()>No&&(e.flags|=128,r=!0,va(i,!1),e.lanes=4194304)}else{if(!r)if(n=bu(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),va(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Je)return zt(e),null}else 2*ht()-i.renderingStartTime>No&&t!==1073741824&&(e.flags|=128,r=!0,va(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ht(),e.sibling=null,t=nt.current,Be(nt,r?t&1|2:t&1),e):(zt(e),null);case 22:case 23:return tm(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function Mb(n,e){switch(Vp(e),e.tag){case 1:return sn(e.type)&&vu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return bo(),We(rn),We(Gt),qp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return $p(e),null;case 13:if(We(nt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(K(340));To()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return We(nt),null;case 4:return bo(),null;case 10:return Fp(e.type._context),null;case 22:case 23:return tm(),null;case 24:return null;default:return null}}var Nc=!1,$t=!1,Ob=typeof WeakSet=="function"?WeakSet:Set,se=null;function io(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ut(n,e,r)}else t.current=null}function Sf(n,e,t){try{t()}catch(r){ut(n,e,r)}}var Ly=!1;function Lb(n,e){if(cf=pu,n=L_(),Dp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,d=0,f=0,m=n,y=null;t:for(;;){for(var _;m!==t||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(_=m.firstChild)!==null;)y=m,m=_;for(;;){if(m===n)break t;if(y===t&&++d===s&&(a=o),y===i&&++f===r&&(u=o),(_=m.nextSibling)!==null)break;m=y,y=m.parentNode}m=_}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(uf={focusedElem:n,selectionRange:t},pu=!1,se=e;se!==null;)if(e=se,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,se=n;else for(;se!==null;){e=se;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var A=R.memoizedProps,k=R.memoizedState,E=e.stateNode,v=E.getSnapshotBeforeUpdate(e.elementType===e.type?A:jn(e.type,A),k);E.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(I){ut(e,e.return,I)}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}return R=Ly,Ly=!1,R}function za(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Sf(e,t,i)}s=s.next}while(s!==r)}}function ud(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Nf(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function jx(n){var e=n.alternate;e!==null&&(n.alternate=null,jx(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Qn],delete e[al],delete e[ff],delete e[xb],delete e[wb])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Vx(n){return n.tag===5||n.tag===3||n.tag===4}function Fy(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Vx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function kf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=yu));else if(r!==4&&(n=n.child,n!==null))for(kf(n,e,t),n=n.sibling;n!==null;)kf(n,e,t),n=n.sibling}function Cf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Cf(n,e,t),n=n.sibling;n!==null;)Cf(n,e,t),n=n.sibling}var Dt=null,Vn=!1;function Ur(n,e,t){for(t=t.child;t!==null;)Mx(n,e,t),t=t.sibling}function Mx(n,e,t){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(nd,t)}catch{}switch(t.tag){case 5:$t||io(t,e);case 6:var r=Dt,s=Vn;Dt=null,Ur(n,e,t),Dt=r,Vn=s,Dt!==null&&(Vn?(n=Dt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Dt.removeChild(t.stateNode));break;case 18:Dt!==null&&(Vn?(n=Dt,t=t.stateNode,n.nodeType===8?mh(n.parentNode,t):n.nodeType===1&&mh(n,t),nl(n)):mh(Dt,t.stateNode));break;case 4:r=Dt,s=Vn,Dt=t.stateNode.containerInfo,Vn=!0,Ur(n,e,t),Dt=r,Vn=s;break;case 0:case 11:case 14:case 15:if(!$t&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Sf(t,e,o),s=s.next}while(s!==r)}Ur(n,e,t);break;case 1:if(!$t&&(io(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){ut(t,e,a)}Ur(n,e,t);break;case 21:Ur(n,e,t);break;case 22:t.mode&1?($t=(r=$t)||t.memoizedState!==null,Ur(n,e,t),$t=r):Ur(n,e,t);break;default:Ur(n,e,t)}}function zy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Ob),e.forEach(function(r){var s=Kb.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Pn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Dt=a.stateNode,Vn=!1;break e;case 3:Dt=a.stateNode.containerInfo,Vn=!0;break e;case 4:Dt=a.stateNode.containerInfo,Vn=!0;break e}a=a.return}if(Dt===null)throw Error(K(160));Mx(i,o,s),Dt=null,Vn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){ut(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ox(e,n),e=e.sibling}function Ox(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Pn(e,n),Kn(n),r&4){try{za(3,n,n.return),ud(3,n)}catch(A){ut(n,n.return,A)}try{za(5,n,n.return)}catch(A){ut(n,n.return,A)}}break;case 1:Pn(e,n),Kn(n),r&512&&t!==null&&io(t,t.return);break;case 5:if(Pn(e,n),Kn(n),r&512&&t!==null&&io(t,t.return),n.flags&32){var s=n.stateNode;try{Xa(s,"")}catch(A){ut(n,n.return,A)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&i_(s,i),Xh(a,o);var d=Xh(a,i);for(o=0;o<u.length;o+=2){var f=u[o],m=u[o+1];f==="style"?u_(s,m):f==="dangerouslySetInnerHTML"?l_(s,m):f==="children"?Xa(s,m):xp(s,f,m,d)}switch(a){case"input":Kh(s,i);break;case"textarea":o_(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?co(s,!!i.multiple,_,!1):y!==!!i.multiple&&(i.defaultValue!=null?co(s,!!i.multiple,i.defaultValue,!0):co(s,!!i.multiple,i.multiple?[]:"",!1))}s[al]=i}catch(A){ut(n,n.return,A)}}break;case 6:if(Pn(e,n),Kn(n),r&4){if(n.stateNode===null)throw Error(K(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(A){ut(n,n.return,A)}}break;case 3:if(Pn(e,n),Kn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{nl(e.containerInfo)}catch(A){ut(n,n.return,A)}break;case 4:Pn(e,n),Kn(n);break;case 13:Pn(e,n),Kn(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zp=ht())),r&4&&zy(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?($t=(d=$t)||f,Pn(e,n),$t=d):Pn(e,n),Kn(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!f&&n.mode&1)for(se=n,f=n.child;f!==null;){for(m=se=f;se!==null;){switch(y=se,_=y.child,y.tag){case 0:case 11:case 14:case 15:za(4,y,y.return);break;case 1:io(y,y.return);var R=y.stateNode;if(typeof R.componentWillUnmount=="function"){r=y,t=y.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(A){ut(r,t,A)}}break;case 5:io(y,y.return);break;case 22:if(y.memoizedState!==null){By(m);continue}}_!==null?(_.return=y,se=_):By(m)}f=f.sibling}e:for(f=null,m=n;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=c_("display",o))}catch(A){ut(n,n.return,A)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(A){ut(n,n.return,A)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Pn(e,n),Kn(n),r&4&&zy(n);break;case 21:break;default:Pn(e,n),Kn(n)}}function Kn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Vx(t)){var r=t;break e}t=t.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xa(s,""),r.flags&=-33);var i=Fy(n);Cf(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Fy(n);kf(n,a,o);break;default:throw Error(K(161))}}catch(u){ut(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Fb(n,e,t){se=n,Lx(n)}function Lx(n,e,t){for(var r=(n.mode&1)!==0;se!==null;){var s=se,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Nc;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||$t;a=Nc;var d=$t;if(Nc=o,($t=u)&&!d)for(se=s;se!==null;)o=se,u=o.child,o.tag===22&&o.memoizedState!==null?$y(s):u!==null?(u.return=o,se=u):$y(s);for(;i!==null;)se=i,Lx(i),i=i.sibling;se=s,Nc=a,$t=d}Uy(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,se=i):Uy(n)}}function Uy(n){for(;se!==null;){var e=se;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||ud(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:jn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&by(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}by(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&nl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}$t||e.flags&512&&Nf(e)}catch(y){ut(e,e.return,y)}}if(e===n){se=null;break}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}}function By(n){for(;se!==null;){var e=se;if(e===n){se=null;break}var t=e.sibling;if(t!==null){t.return=e.return,se=t;break}se=e.return}}function $y(n){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ud(4,e)}catch(u){ut(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){ut(e,s,u)}}var i=e.return;try{Nf(e)}catch(u){ut(e,i,u)}break;case 5:var o=e.return;try{Nf(e)}catch(u){ut(e,o,u)}}}catch(u){ut(e,e.return,u)}if(e===n){se=null;break}var a=e.sibling;if(a!==null){a.return=e.return,se=a;break}se=e.return}}var zb=Math.ceil,ku=Rr.ReactCurrentDispatcher,Jp=Rr.ReactCurrentOwner,bn=Rr.ReactCurrentBatchConfig,Re=0,Ct=null,vt=null,Vt=0,un=0,oo=ks(0),Tt=0,fl=null,ci=0,dd=0,Xp=0,Ua=null,Zt=null,Zp=0,No=1/0,dr=null,Cu=!1,Af=null,us=null,kc=!1,ns=null,Au=0,Ba=0,Rf=null,Kc=-1,Wc=0;function Kt(){return Re&6?ht():Kc!==-1?Kc:Kc=ht()}function ds(n){return n.mode&1?Re&2&&Vt!==0?Vt&-Vt:Tb.transition!==null?(Wc===0&&(Wc=I_()),Wc):(n=Me,n!==0||(n=window.event,n=n===void 0?16:C_(n.type)),n):1}function Fn(n,e,t,r){if(50<Ba)throw Ba=0,Rf=null,Error(K(185));Cl(n,t,r),(!(Re&2)||n!==Ct)&&(n===Ct&&(!(Re&2)&&(dd|=t),Tt===4&&Qr(n,Vt)),on(n,r),t===1&&Re===0&&!(e.mode&1)&&(No=ht()+500,ad&&Cs()))}function on(n,e){var t=n.callbackNode;T1(n,e);var r=fu(n,n===Ct?Vt:0);if(r===0)t!==null&&Xg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Xg(t),e===1)n.tag===0?Ib(qy.bind(null,n)):W_(qy.bind(null,n)),vb(function(){!(Re&6)&&Cs()}),t=null;else{switch(T_(r)){case 1:t=bp;break;case 4:t=x_;break;case 16:t=hu;break;case 536870912:t=w_;break;default:t=hu}t=Hx(t,Fx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Fx(n,e){if(Kc=-1,Wc=0,Re&6)throw Error(K(327));var t=n.callbackNode;if(mo()&&n.callbackNode!==t)return null;var r=fu(n,n===Ct?Vt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Ru(n,r);else{e=r;var s=Re;Re|=2;var i=Ux();(Ct!==n||Vt!==e)&&(dr=null,No=ht()+500,ni(n,e));do try{$b();break}catch(a){zx(n,a)}while(!0);Lp(),ku.current=i,Re=s,vt!==null?e=0:(Ct=null,Vt=0,e=Tt)}if(e!==0){if(e===2&&(s=rf(n),s!==0&&(r=s,e=Pf(n,s))),e===1)throw t=fl,ni(n,0),Qr(n,r),on(n,ht()),t;if(e===6)Qr(n,r);else{if(s=n.current.alternate,!(r&30)&&!Ub(s)&&(e=Ru(n,r),e===2&&(i=rf(n),i!==0&&(r=i,e=Pf(n,i))),e===1))throw t=fl,ni(n,0),Qr(n,r),on(n,ht()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:Hs(n,Zt,dr);break;case 3:if(Qr(n,r),(r&130023424)===r&&(e=Zp+500-ht(),10<e)){if(fu(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Kt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=hf(Hs.bind(null,n,Zt,dr),e);break}Hs(n,Zt,dr);break;case 4:if(Qr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Ln(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zb(r/1960))-r,10<r){n.timeoutHandle=hf(Hs.bind(null,n,Zt,dr),r);break}Hs(n,Zt,dr);break;case 5:Hs(n,Zt,dr);break;default:throw Error(K(329))}}}return on(n,ht()),n.callbackNode===t?Fx.bind(null,n):null}function Pf(n,e){var t=Ua;return n.current.memoizedState.isDehydrated&&(ni(n,e).flags|=256),n=Ru(n,e),n!==2&&(e=Zt,Zt=t,e!==null&&Df(e)),n}function Df(n){Zt===null?Zt=n:Zt.push.apply(Zt,n)}function Ub(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Un(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qr(n,e){for(e&=~Xp,e&=~dd,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ln(e),r=1<<t;n[t]=-1,e&=~r}}function qy(n){if(Re&6)throw Error(K(327));mo();var e=fu(n,0);if(!(e&1))return on(n,ht()),null;var t=Ru(n,e);if(n.tag!==0&&t===2){var r=rf(n);r!==0&&(e=r,t=Pf(n,r))}if(t===1)throw t=fl,ni(n,0),Qr(n,e),on(n,ht()),t;if(t===6)throw Error(K(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Hs(n,Zt,dr),on(n,ht()),null}function em(n,e){var t=Re;Re|=1;try{return n(e)}finally{Re=t,Re===0&&(No=ht()+500,ad&&Cs())}}function ui(n){ns!==null&&ns.tag===0&&!(Re&6)&&mo();var e=Re;Re|=1;var t=bn.transition,r=Me;try{if(bn.transition=null,Me=1,n)return n()}finally{Me=r,bn.transition=t,Re=e,!(Re&6)&&Cs()}}function tm(){un=oo.current,We(oo)}function ni(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,yb(t)),vt!==null)for(t=vt.return;t!==null;){var r=t;switch(Vp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vu();break;case 3:bo(),We(rn),We(Gt),qp();break;case 5:$p(r);break;case 4:bo();break;case 13:We(nt);break;case 19:We(nt);break;case 10:Fp(r.type._context);break;case 22:case 23:tm()}t=t.return}if(Ct=n,vt=n=hs(n.current,null),Vt=un=e,Tt=0,fl=null,Xp=dd=ci=0,Zt=Ua=null,ei!==null){for(e=0;e<ei.length;e++)if(t=ei[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}ei=null}return n}function zx(n,e){do{var t=vt;try{if(Lp(),qc.current=Nu,Su){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Su=!1}if(li=0,Nt=It=st=null,Fa=!1,ul=0,Jp.current=null,t===null||t.return===null){Tt=1,fl=e,vt=null;break}e:{var i=n,o=t.return,a=t,u=e;if(e=Vt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var _=Ry(o);if(_!==null){_.flags&=-257,Py(_,o,a,i,e),_.mode&1&&Ay(i,d,e),e=_,u=d;var R=e.updateQueue;if(R===null){var A=new Set;A.add(u),e.updateQueue=A}else R.add(u);break e}else{if(!(e&1)){Ay(i,d,e),nm();break e}u=Error(K(426))}}else if(Je&&a.mode&1){var k=Ry(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Py(k,o,a,i,e),Mp(So(u,a));break e}}i=u=So(u,a),Tt!==4&&(Tt=2),Ua===null?Ua=[i]:Ua.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=Tx(i,u,e);Ey(i,E);break e;case 1:a=u;var v=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(us===null||!us.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=Ex(i,a,e);Ey(i,I);break e}}i=i.return}while(i!==null)}$x(t)}catch(D){e=D,vt===t&&t!==null&&(vt=t=t.return);continue}break}while(!0)}function Ux(){var n=ku.current;return ku.current=Nu,n===null?Nu:n}function nm(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Ct===null||!(ci&268435455)&&!(dd&268435455)||Qr(Ct,Vt)}function Ru(n,e){var t=Re;Re|=2;var r=Ux();(Ct!==n||Vt!==e)&&(dr=null,ni(n,e));do try{Bb();break}catch(s){zx(n,s)}while(!0);if(Lp(),Re=t,ku.current=r,vt!==null)throw Error(K(261));return Ct=null,Vt=0,Tt}function Bb(){for(;vt!==null;)Bx(vt)}function $b(){for(;vt!==null&&!p1();)Bx(vt)}function Bx(n){var e=Gx(n.alternate,n,un);n.memoizedProps=n.pendingProps,e===null?$x(n):vt=e,Jp.current=null}function $x(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Mb(t,e),t!==null){t.flags&=32767,vt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Tt=6,vt=null;return}}else if(t=Vb(t,e,un),t!==null){vt=t;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=n}while(e!==null);Tt===0&&(Tt=5)}function Hs(n,e,t){var r=Me,s=bn.transition;try{bn.transition=null,Me=1,qb(n,e,t,r)}finally{bn.transition=s,Me=r}return null}function qb(n,e,t,r){do mo();while(ns!==null);if(Re&6)throw Error(K(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(K(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(E1(n,i),n===Ct&&(vt=Ct=null,Vt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||kc||(kc=!0,Hx(hu,function(){return mo(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=bn.transition,bn.transition=null;var o=Me;Me=1;var a=Re;Re|=4,Jp.current=null,Lb(n,t),Ox(t,n),ub(uf),pu=!!cf,uf=cf=null,n.current=t,Fb(t),m1(),Re=a,Me=o,bn.transition=i}else n.current=t;if(kc&&(kc=!1,ns=n,Au=s),i=n.pendingLanes,i===0&&(us=null),v1(t.stateNode),on(n,ht()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cu)throw Cu=!1,n=Af,Af=null,n;return Au&1&&n.tag!==0&&mo(),i=n.pendingLanes,i&1?n===Rf?Ba++:(Ba=0,Rf=n):Ba=0,Cs(),null}function mo(){if(ns!==null){var n=T_(Au),e=bn.transition,t=Me;try{if(bn.transition=null,Me=16>n?16:n,ns===null)var r=!1;else{if(n=ns,ns=null,Au=0,Re&6)throw Error(K(331));var s=Re;for(Re|=4,se=n.current;se!==null;){var i=se,o=i.child;if(se.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(se=d;se!==null;){var f=se;switch(f.tag){case 0:case 11:case 15:za(8,f,i)}var m=f.child;if(m!==null)m.return=f,se=m;else for(;se!==null;){f=se;var y=f.sibling,_=f.return;if(jx(f),f===d){se=null;break}if(y!==null){y.return=_,se=y;break}se=_}}}var R=i.alternate;if(R!==null){var A=R.child;if(A!==null){R.child=null;do{var k=A.sibling;A.sibling=null,A=k}while(A!==null)}}se=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,se=o;else e:for(;se!==null;){if(i=se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:za(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,se=E;break e}se=i.return}}var v=n.current;for(se=v;se!==null;){o=se;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,se=b;else e:for(o=v;se!==null;){if(a=se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ud(9,a)}}catch(D){ut(a,a.return,D)}if(a===o){se=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,se=I;break e}se=a.return}}if(Re=s,Cs(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(nd,n)}catch{}r=!0}return r}finally{Me=t,bn.transition=e}}return!1}function Gy(n,e,t){e=So(t,e),e=Tx(n,e,1),n=cs(n,e,1),e=Kt(),n!==null&&(Cl(n,1,e),on(n,e))}function ut(n,e,t){if(n.tag===3)Gy(n,n,t);else for(;e!==null;){if(e.tag===3){Gy(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(us===null||!us.has(r))){n=So(t,n),n=Ex(e,n,1),e=cs(e,n,1),n=Kt(),e!==null&&(Cl(e,1,n),on(e,n));break}}e=e.return}}function Gb(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Kt(),n.pingedLanes|=n.suspendedLanes&t,Ct===n&&(Vt&t)===t&&(Tt===4||Tt===3&&(Vt&130023424)===Vt&&500>ht()-Zp?ni(n,0):Xp|=t),on(n,e)}function qx(n,e){e===0&&(n.mode&1?(e=vc,vc<<=1,!(vc&130023424)&&(vc=4194304)):e=1);var t=Kt();n=br(n,e),n!==null&&(Cl(n,e,t),on(n,t))}function Hb(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),qx(n,t)}function Kb(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),qx(n,t)}var Gx;Gx=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||rn.current)en=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return en=!1,jb(n,e,t);en=!!(n.flags&131072)}else en=!1,Je&&e.flags&1048576&&Q_(e,wu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Hc(n,e),n=e.pendingProps;var s=Io(e,Gt.current);po(e,t),s=Hp(null,e,r,n,s,t);var i=Kp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,sn(r)?(i=!0,_u(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Up(e),s.updater=cd,e.stateNode=s,s._reactInternals=e,_f(e,r,n,t),e=If(null,e,r,!0,i,t)):(e.tag=0,Je&&i&&jp(e),Ht(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Hc(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Qb(r),n=jn(r,n),s){case 0:e=wf(null,e,r,n,t);break e;case 1:e=Vy(null,e,r,n,t);break e;case 11:e=Dy(null,e,r,n,t);break e;case 14:e=jy(null,e,r,jn(r.type,n),t);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),wf(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Vy(n,e,r,s,t);case 3:e:{if(kx(e),n===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,tx(n,e),Eu(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=So(Error(K(423)),e),e=My(n,e,r,t,s);break e}else if(r!==s){s=So(Error(K(424)),e),e=My(n,e,r,t,s);break e}else for(dn=ls(e.stateNode.containerInfo.firstChild),fn=e,Je=!0,Mn=null,t=Z_(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(To(),r===s){e=Sr(n,e,t);break e}Ht(n,e,r,t)}e=e.child}return e;case 5:return nx(e),n===null&&gf(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,df(r,s)?o=null:i!==null&&df(r,i)&&(e.flags|=32),Nx(n,e),Ht(n,e,o,t),e.child;case 6:return n===null&&gf(e),null;case 13:return Cx(n,e,t);case 4:return Bp(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Eo(e,null,r,t):Ht(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Dy(n,e,r,s,t);case 7:return Ht(n,e,e.pendingProps,t),e.child;case 8:return Ht(n,e,e.pendingProps.children,t),e.child;case 12:return Ht(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Be(Iu,r._currentValue),r._currentValue=o,i!==null)if(Un(i.value,o)){if(i.children===s.children&&!rn.current){e=Sr(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=wr(-1,t&-t),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=t,u=i.alternate,u!==null&&(u.lanes|=t),yf(i.return,t,e),a.lanes|=t;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),yf(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ht(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,po(e,t),s=Sn(s),r=r(s),e.flags|=1,Ht(n,e,r,t),e.child;case 14:return r=e.type,s=jn(r,e.pendingProps),s=jn(r.type,s),jy(n,e,r,s,t);case 15:return bx(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Hc(n,e),e.tag=1,sn(r)?(n=!0,_u(e)):n=!1,po(e,t),Ix(e,r,s),_f(e,r,s,t),If(null,e,r,!0,n,t);case 19:return Ax(n,e,t);case 22:return Sx(n,e,t)}throw Error(K(156,e.tag))};function Hx(n,e){return __(n,e)}function Wb(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(n,e,t,r){return new Wb(n,e,t,r)}function rm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Qb(n){if(typeof n=="function")return rm(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ip)return 11;if(n===Tp)return 14}return 2}function hs(n,e){var t=n.alternate;return t===null?(t=En(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Qc(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")rm(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Yi:return ri(t.children,s,i,e);case wp:o=8,s|=8;break;case Bh:return n=En(12,t,e,s|2),n.elementType=Bh,n.lanes=i,n;case $h:return n=En(13,t,e,s),n.elementType=$h,n.lanes=i,n;case qh:return n=En(19,t,e,s),n.elementType=qh,n.lanes=i,n;case n_:return hd(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case e_:o=10;break e;case t_:o=9;break e;case Ip:o=11;break e;case Tp:o=14;break e;case Hr:o=16,r=null;break e}throw Error(K(130,n==null?n:typeof n,""))}return e=En(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ri(n,e,t,r){return n=En(7,n,r,e),n.lanes=t,n}function hd(n,e,t,r){return n=En(22,n,r,e),n.elementType=n_,n.lanes=t,n.stateNode={isHidden:!1},n}function Th(n,e,t){return n=En(6,n,null,e),n.lanes=t,n}function Eh(n,e,t){return e=En(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Yb(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sh(0),this.expirationTimes=sh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sm(n,e,t,r,s,i,o,a,u){return n=new Yb(n,e,t,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=En(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Up(i),n}function Jb(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Kx(n){if(!n)return ws;n=n._reactInternals;e:{if(Ii(n)!==n||n.tag!==1)throw Error(K(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(sn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(n.tag===1){var t=n.type;if(sn(t))return K_(n,t,e)}return e}function Wx(n,e,t,r,s,i,o,a,u){return n=sm(t,r,!0,n,s,i,o,a,u),n.context=Kx(null),t=n.current,r=Kt(),s=ds(t),i=wr(r,s),i.callback=e??null,cs(t,i,s),n.current.lanes=s,Cl(n,s,r),on(n,r),n}function fd(n,e,t,r){var s=e.current,i=Kt(),o=ds(s);return t=Kx(t),e.context===null?e.context=t:e.pendingContext=t,e=wr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=cs(s,e,o),n!==null&&(Fn(n,s,o,i),$c(n,s,o)),o}function Pu(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Hy(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function im(n,e){Hy(n,e),(n=n.alternate)&&Hy(n,e)}function Xb(){return null}var Qx=typeof reportError=="function"?reportError:function(n){console.error(n)};function om(n){this._internalRoot=n}pd.prototype.render=om.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(K(409));fd(n,e,null,null)};pd.prototype.unmount=om.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ui(function(){fd(null,n,null,null)}),e[Er]=null}};function pd(n){this._internalRoot=n}pd.prototype.unstable_scheduleHydration=function(n){if(n){var e=S_();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Wr.length&&e!==0&&e<Wr[t].priority;t++);Wr.splice(t,0,n),t===0&&k_(n)}};function am(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function md(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Ky(){}function Zb(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Pu(o);i.call(d)}}var o=Wx(e,r,n,0,null,!1,!1,"",Ky);return n._reactRootContainer=o,n[Er]=o.current,il(n.nodeType===8?n.parentNode:n),ui(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Pu(u);a.call(d)}}var u=sm(n,0,!1,null,null,!1,!1,"",Ky);return n._reactRootContainer=u,n[Er]=u.current,il(n.nodeType===8?n.parentNode:n),ui(function(){fd(e,u,t,r)}),u}function gd(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=Pu(o);a.call(u)}}fd(e,o,n,s)}else o=Zb(t,e,n,s,r);return Pu(o)}E_=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Na(e.pendingLanes);t!==0&&(Sp(e,t|1),on(e,ht()),!(Re&6)&&(No=ht()+500,Cs()))}break;case 13:ui(function(){var r=br(n,1);if(r!==null){var s=Kt();Fn(r,n,1,s)}}),im(n,1)}};Np=function(n){if(n.tag===13){var e=br(n,134217728);if(e!==null){var t=Kt();Fn(e,n,134217728,t)}im(n,134217728)}};b_=function(n){if(n.tag===13){var e=ds(n),t=br(n,e);if(t!==null){var r=Kt();Fn(t,n,e,r)}im(n,e)}};S_=function(){return Me};N_=function(n,e){var t=Me;try{return Me=n,e()}finally{Me=t}};ef=function(n,e,t){switch(e){case"input":if(Kh(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=od(r);if(!s)throw Error(K(90));s_(r),Kh(r,s)}}}break;case"textarea":o_(n,t);break;case"select":e=t.value,e!=null&&co(n,!!t.multiple,e,!1)}};f_=em;p_=ui;var eS={usingClientEntryPoint:!1,Events:[Rl,eo,od,d_,h_,em]},_a={findFiberByHostInstance:Zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tS={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=y_(n),n===null?null:n.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||Xb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cc.isDisabled&&Cc.supportsFiber)try{nd=Cc.inject(tS),Xn=Cc}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eS;vn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!am(e))throw Error(K(200));return Jb(n,e,null,t)};vn.createRoot=function(n,e){if(!am(n))throw Error(K(299));var t=!1,r="",s=Qx;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=sm(n,1,!1,null,null,t,!1,r,s),n[Er]=e.current,il(n.nodeType===8?n.parentNode:n),new om(e)};vn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(K(188)):(n=Object.keys(n).join(","),Error(K(268,n)));return n=y_(e),n=n===null?null:n.stateNode,n};vn.flushSync=function(n){return ui(n)};vn.hydrate=function(n,e,t){if(!md(e))throw Error(K(200));return gd(null,n,e,!0,t)};vn.hydrateRoot=function(n,e,t){if(!am(n))throw Error(K(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=Qx;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Wx(e,null,n,1,t??null,s,!1,i,o),n[Er]=e.current,il(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new pd(e)};vn.render=function(n,e,t){if(!md(e))throw Error(K(200));return gd(null,n,e,!1,t)};vn.unmountComponentAtNode=function(n){if(!md(n))throw Error(K(40));return n._reactRootContainer?(ui(function(){gd(null,null,n,!1,function(){n._reactRootContainer=null,n[Er]=null})}),!0):!1};vn.unstable_batchedUpdates=em;vn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!md(t))throw Error(K(200));if(n==null||n._reactInternals===void 0)throw Error(K(38));return gd(n,e,t,!1,r)};vn.version="18.3.1-next-f1338f8080-20240426";function Yx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yx)}catch(n){console.error(n)}}Yx(),Y0.exports=vn;var nS=Y0.exports,Jx,Wy=nS;Jx=Wy.createRoot,Wy.hydrateRoot;var Qy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},rS=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Zx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,d=u?n[s+2]:0,f=i>>2,m=(i&3)<<4|a>>4;let y=(a&15)<<2|d>>6,_=d&63;u||(_=64,o||(y=64)),r.push(t[f],t[m],t[y],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const d=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new sS;const y=i<<2|a>>4;if(r.push(y),d!==64){const _=a<<4&240|d>>2;if(r.push(_),m!==64){const R=d<<6&192|m;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iS=function(n){const e=Xx(n);return Zx.encodeByteArray(e,!0)},ew=function(n){return iS(n).replace(/\./g,"")},tw=function(n){try{return Zx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=()=>oS().__FIREBASE_DEFAULTS__,lS=()=>{if(typeof process>"u"||typeof Qy>"u")return;const n=Qy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tw(n[1]);return e&&JSON.parse(e)},yd=()=>{try{return aS()||lS()||cS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nw=n=>{var e,t;return(t=(e=yd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},uS=n=>{const e=nw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},rw=()=>{var n;return(n=yd())===null||n===void 0?void 0:n.config},sw=n=>{var e;return(e=yd())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Et())}function fS(){var n;const e=(n=yd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yS(){const n=Et();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function iw(){return!fS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ow(){try{return typeof indexedDB=="object"}catch{return!1}}function vS(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="FirebaseError";class sr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=_S,Object.setPrototypeOf(this,sr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dl.prototype.create)}}class Dl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?xS(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new sr(s,a,r)}}function xS(n,e){return n.replace(wS,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const wS=/\{\$([^}]+)}/g;function IS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function pl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Yy(i)&&Yy(o)){if(!pl(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Yy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function TS(n,e){const t=new ES(n,e);return t.subscribe.bind(t)}class ES{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");bS(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=bh),s.error===void 0&&(s.error=bh),s.complete===void 0&&(s.complete=bh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function bh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(n){return n&&n._delegate?n._delegate:n}class Is{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new dS;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kS(e))try{this.getOrInitializeService({instanceIdentifier:Ks})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ks){return this.instances.has(e)}getOptions(e=Ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:NS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ks){return this.component?this.component.multipleInstances?e:Ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NS(n){return n===Ks?void 0:n}function kS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new SS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Se||(Se={}));const AS={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},RS=Se.INFO,PS={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},DS=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=PS[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lm{constructor(e){this.name=e,this._logLevel=RS,this._logHandler=DS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...e),this._logHandler(this,Se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...e),this._logHandler(this,Se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...e),this._logHandler(this,Se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...e),this._logHandler(this,Se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...e),this._logHandler(this,Se.ERROR,...e)}}const jS=(n,e)=>e.some(t=>n instanceof t);let Jy,Xy;function VS(){return Jy||(Jy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MS(){return Xy||(Xy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aw=new WeakMap,jf=new WeakMap,lw=new WeakMap,Sh=new WeakMap,cm=new WeakMap;function OS(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(fs(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&aw.set(t,n)}).catch(()=>{}),cm.set(e,n),e}function LS(n){if(jf.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});jf.set(n,e)}let Vf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function FS(n){Vf=n(Vf)}function zS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Nh(this),e,...t);return lw.set(r,e.sort?e.sort():[e]),fs(r)}:MS().includes(n)?function(...e){return n.apply(Nh(this),e),fs(aw.get(this))}:function(...e){return fs(n.apply(Nh(this),e))}}function US(n){return typeof n=="function"?zS(n):(n instanceof IDBTransaction&&LS(n),jS(n,VS())?new Proxy(n,Vf):n)}function fs(n){if(n instanceof IDBRequest)return OS(n);if(Sh.has(n))return Sh.get(n);const e=US(n);return e!==n&&(Sh.set(n,e),cm.set(e,n)),e}const Nh=n=>cm.get(n);function BS(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=fs(o);return r&&o.addEventListener("upgradeneeded",u=>{r(fs(o.result),u.oldVersion,u.newVersion,fs(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const $S=["get","getKey","getAll","getAllKeys","count"],qS=["put","add","delete","clear"],kh=new Map;function Zy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(kh.get(e))return kh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=qS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||$S.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[t](...a),s&&u.done]))[0]};return kh.set(e,i),i}FS(n=>({...n,get:(e,t,r)=>Zy(e,t)||n.get(e,t,r),has:(e,t)=>!!Zy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HS(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function HS(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mf="@firebase/app",ev="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr=new lm("@firebase/app"),KS="@firebase/app-compat",WS="@firebase/analytics-compat",QS="@firebase/analytics",YS="@firebase/app-check-compat",JS="@firebase/app-check",XS="@firebase/auth",ZS="@firebase/auth-compat",eN="@firebase/database",tN="@firebase/data-connect",nN="@firebase/database-compat",rN="@firebase/functions",sN="@firebase/functions-compat",iN="@firebase/installations",oN="@firebase/installations-compat",aN="@firebase/messaging",lN="@firebase/messaging-compat",cN="@firebase/performance",uN="@firebase/performance-compat",dN="@firebase/remote-config",hN="@firebase/remote-config-compat",fN="@firebase/storage",pN="@firebase/storage-compat",mN="@firebase/firestore",gN="@firebase/vertexai-preview",yN="@firebase/firestore-compat",vN="firebase",_N="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Of="[DEFAULT]",xN={[Mf]:"fire-core",[KS]:"fire-core-compat",[QS]:"fire-analytics",[WS]:"fire-analytics-compat",[JS]:"fire-app-check",[YS]:"fire-app-check-compat",[XS]:"fire-auth",[ZS]:"fire-auth-compat",[eN]:"fire-rtdb",[tN]:"fire-data-connect",[nN]:"fire-rtdb-compat",[rN]:"fire-fn",[sN]:"fire-fn-compat",[iN]:"fire-iid",[oN]:"fire-iid-compat",[aN]:"fire-fcm",[lN]:"fire-fcm-compat",[cN]:"fire-perf",[uN]:"fire-perf-compat",[dN]:"fire-rc",[hN]:"fire-rc-compat",[fN]:"fire-gcs",[pN]:"fire-gcs-compat",[mN]:"fire-fst",[yN]:"fire-fst-compat",[gN]:"fire-vertex","fire-js":"fire-js",[vN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=new Map,wN=new Map,Lf=new Map;function tv(n,e){try{n.container.addComponent(e)}catch(t){Nr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function di(n){const e=n.name;if(Lf.has(e))return Nr.debug(`There were multiple attempts to register component ${e}.`),!1;Lf.set(e,n);for(const t of Du.values())tv(t,n);for(const t of wN.values())tv(t,n);return!0}function vd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function mr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ps=new Dl("app","Firebase",IN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ps.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho=_N;function cw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Of,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ps.create("bad-app-name",{appName:String(s)});if(t||(t=rw()),!t)throw ps.create("no-options");const i=Du.get(s);if(i){if(pl(t,i.options)&&pl(r,i.config))return i;throw ps.create("duplicate-app",{appName:s})}const o=new CS(s);for(const u of Lf.values())o.addComponent(u);const a=new TN(t,r,o);return Du.set(s,a),a}function uw(n=Of){const e=Du.get(n);if(!e&&n===Of&&rw())return cw();if(!e)throw ps.create("no-app",{appName:n});return e}function er(n,e,t){var r;let s=(r=xN[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nr.warn(a.join(" "));return}di(new Is(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="firebase-heartbeat-database",bN=1,ml="firebase-heartbeat-store";let Ch=null;function dw(){return Ch||(Ch=BS(EN,bN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ml)}catch(t){console.warn(t)}}}}).catch(n=>{throw ps.create("idb-open",{originalErrorMessage:n.message})})),Ch}async function SN(n){try{const t=(await dw()).transaction(ml),r=await t.objectStore(ml).get(hw(n));return await t.done,r}catch(e){if(e instanceof sr)Nr.warn(e.message);else{const t=ps.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Nr.warn(t.message)}}}async function nv(n,e){try{const r=(await dw()).transaction(ml,"readwrite");await r.objectStore(ml).put(e,hw(n)),await r.done}catch(t){if(t instanceof sr)Nr.warn(t.message);else{const r=ps.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Nr.warn(r.message)}}}function hw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=1024,kN=30*24*60*60*1e3;class CN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new RN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=kN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Nr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rv(),{heartbeatsToSend:r,unsentEntries:s}=AN(this._heartbeatsCache.heartbeats),i=ew(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Nr.warn(t),""}}}function rv(){return new Date().toISOString().substring(0,10)}function AN(n,e=NN){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),sv(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),sv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class RN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ow()?vS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await SN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function sv(n){return ew(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(n){di(new Is("platform-logger",e=>new GS(e),"PRIVATE")),di(new Is("heartbeat",e=>new CN(e),"PRIVATE")),er(Mf,ev,n),er(Mf,ev,"esm2017"),er("fire-js","")}PN("");var DN="firebase",jN="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */er(DN,jN,"app");function um(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function fw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VN=fw,pw=new Dl("auth","Firebase",fw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ju=new lm("@firebase/auth");function MN(n,...e){ju.logLevel<=Se.WARN&&ju.warn(`Auth (${Ho}): ${n}`,...e)}function Yc(n,...e){ju.logLevel<=Se.ERROR&&ju.error(`Auth (${Ho}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(n,...e){throw dm(n,...e)}function tr(n,...e){return dm(n,...e)}function mw(n,e,t){const r=Object.assign(Object.assign({},VN()),{[e]:t});return new Dl("auth","Firebase",r).create(e,{appName:n.name})}function ms(n){return mw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dm(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return pw.create(n,...e)}function ve(n,e,...t){if(!n)throw dm(e,...t)}function gr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Yc(e),new Error(e)}function Cr(n,e){n||gr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ON(){return iv()==="http:"||iv()==="https:"}function iv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ON()||mS()||"connection"in navigator)?navigator.onLine:!0}function FN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cr(t>e,"Short delay should be less than long delay!"),this.isMobile=hS()||gS()}get(){return LN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(n,e){Cr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN=new Vl(3e4,6e4);function _d(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ko(n,e,t,r,s={}){return yw(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=jl(Object.assign({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d=Object.assign({method:e,headers:u},i);return pS()||(d.referrerPolicy="no-referrer"),gw.fetch()(_w(n,n.config.apiHost,t,a),d)})}async function yw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},zN),e);try{const s=new BN(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ac(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,d]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ac(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ac(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ac(n,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw mw(n,f,d);kr(n,f)}}catch(s){if(s instanceof sr)throw s;kr(n,"network-request-failed",{message:String(s)})}}async function vw(n,e,t,r,s={}){const i=await Ko(n,e,t,r,s);return"mfaPendingCredential"in i&&kr(n,"multi-factor-auth-required",{_serverResponse:i}),i}function _w(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?hm(n.config,s):`${n.config.apiScheme}://${s}`}class BN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(tr(this.auth,"network-request-failed")),UN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ac(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=tr(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(n,e){return Ko(n,"POST","/v1/accounts:delete",e)}async function xw(n,e){return Ko(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function qN(n,e=!1){const t=pt(n),r=await t.getIdToken(e),s=fm(r);ve(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:$a(Ah(s.auth_time)),issuedAtTime:$a(Ah(s.iat)),expirationTime:$a(Ah(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ah(n){return Number(n)*1e3}function fm(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Yc("JWT malformed, contained fewer than 3 sections"),null;try{const s=tw(t);return s?JSON.parse(s):(Yc("Failed to decode base64 JWT payload"),null)}catch(s){return Yc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ov(n){const e=fm(n);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof sr&&GN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function GN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$a(this.lastLoginAt),this.creationTime=$a(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vu(n){var e;const t=n.auth,r=await n.getIdToken(),s=await gl(n,xw(t,{idToken:r}));ve(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?ww(i.providerUserInfo):[],a=WN(n.providerData,o),u=n.isAnonymous,d=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),f=u?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new zf(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(n,m)}async function KN(n){const e=pt(n);await Vu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function WN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ww(n){return n.map(e=>{var{providerId:t}=e,r=um(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QN(n,e){const t=await yw(n,{},async()=>{const r=jl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=_w(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",gw.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YN(n,e){return Ko(n,"POST","/v2/accounts:revokeToken",_d(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ov(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const t=ov(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await QN(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new go;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new go,this.toJSON())}_performRefresh(){return gr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(n,e){ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class yr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=um(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new HN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await gl(this,this.stsTokenManager.getToken(this.auth,e));return ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return qN(this,e)}reload(){return KN(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new yr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Vu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mr(this.auth.app))return Promise.reject(ms(this.auth));const e=await this.getIdToken();return await gl(this,$N(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,u,d,f;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(s=t.email)!==null&&s!==void 0?s:void 0,_=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,R=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,k=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,E=(d=t.createdAt)!==null&&d!==void 0?d:void 0,v=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:b,emailVerified:I,isAnonymous:D,providerData:P,stsTokenManager:w}=t;ve(b&&w,e,"internal-error");const g=go.fromJSON(this.name,w);ve(typeof b=="string",e,"internal-error"),Br(m,e.name),Br(y,e.name),ve(typeof I=="boolean",e,"internal-error"),ve(typeof D=="boolean",e,"internal-error"),Br(_,e.name),Br(R,e.name),Br(A,e.name),Br(k,e.name),Br(E,e.name),Br(v,e.name);const x=new yr({uid:b,auth:e,email:y,emailVerified:I,displayName:m,isAnonymous:D,photoURL:R,phoneNumber:_,tenantId:A,stsTokenManager:g,createdAt:E,lastLoginAt:v});return P&&Array.isArray(P)&&(x.providerData=P.map(S=>Object.assign({},S))),k&&(x._redirectEventId=k),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new go;s.updateFromServerResponse(t);const i=new yr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Vu(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ww(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new go;a.updateFromIdToken(r);const u=new yr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new zf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=new Map;function vr(n){Cr(n instanceof Function,"Expected a class definition");let e=av.get(n);return e?(Cr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,av.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Iw.type="NONE";const lv=Iw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jc(n,e,t){return`firebase:${n}:${e}:${t}`}class yo{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Jc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Jc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?yr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new yo(vr(lv),e,r);const s=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||vr(lv);const o=Jc(r,e.config.apiKey,e.name);let a=null;for(const d of t)try{const f=await d._get(o);if(f){const m=yr._fromJSON(e,f);d!==i&&(a=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new yo(i,e,r):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new yo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kw(e))return"Blackberry";if(Cw(e))return"Webos";if(Ew(e))return"Safari";if((e.includes("chrome/")||bw(e))&&!e.includes("edge/"))return"Chrome";if(Nw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Tw(n=Et()){return/firefox\//i.test(n)}function Ew(n=Et()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bw(n=Et()){return/crios\//i.test(n)}function Sw(n=Et()){return/iemobile/i.test(n)}function Nw(n=Et()){return/android/i.test(n)}function kw(n=Et()){return/blackberry/i.test(n)}function Cw(n=Et()){return/webos/i.test(n)}function pm(n=Et()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function JN(n=Et()){var e;return pm(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function XN(){return yS()&&document.documentMode===10}function Aw(n=Et()){return pm(n)||Nw(n)||Cw(n)||kw(n)||/windows phone/i.test(n)||Sw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(n,e=[]){let t;switch(n){case"Browser":t=cv(Et());break;case"Worker":t=`${cv(Et())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ho}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(n,e={}){return Ko(n,"GET","/v2/passwordPolicy",_d(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk=6;class nk{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:tk,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uv(this),this.idTokenSubscription=new uv(this),this.beforeStateQueue=new ZN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vr(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await yo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xw(this,{idToken:e}),r=await yr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(mr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mr(this.app))return Promise.reject(ms(this));const t=e?pt(e):null;return t&&ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mr(this.app)?Promise.reject(ms(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mr(this.app)?Promise.reject(ms(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ek(this),t=new nk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Dl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await YN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vr(e)||this._popupRedirectResolver;ve(t,this,"argument-error"),this.redirectPersistenceManager=await yo.create(this,[vr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&MN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function xd(n){return pt(n)}class uv{constructor(e){this.auth=e,this.observer=null,this.addObserver=TS(t=>this.observer=t)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sk(n){mm=n}function ik(n){return mm.loadJS(n)}function ok(){return mm.gapiScript}function ak(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(n,e){const t=vd(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(pl(i,e??{}))return s;kr(s,"already-initialized")}return t.initialize({options:e})}function ck(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(vr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function uk(n,e,t){const r=xd(n);ve(r._canInitEmulator,r,"emulator-config-failed"),ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Pw(e),{host:o,port:a}=dk(e),u=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),hk()}function Pw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function dk(n){const e=Pw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:dv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:dv(o)}}}function dv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function hk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gr("not implemented")}_getIdTokenResponse(e){return gr("not implemented")}_linkToIdToken(e,t){return gr("not implemented")}_getReauthenticationResolver(e){return gr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(n,e){return vw(n,"POST","/v1/accounts:signInWithIdp",_d(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk="http://localhost";class hi extends Dw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=um(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new hi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return vo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,vo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,vo(e,t)}buildRequest(){const e={requestUri:fk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=jl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends jw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends Ml{constructor(){super("facebook.com")}static credential(e){return hi._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yr.credential(e.oauthAccessToken)}catch{return null}}}Yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends Ml{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hi._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Jr.credential(t,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Ml{constructor(){super("github.com")}static credential(e){return hi._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.GITHUB_SIGN_IN_METHOD="github.com";Xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Ml{constructor(){super("twitter.com")}static credential(e,t){return hi._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Zr.credential(t,r)}catch{return null}}}Zr.TWITTER_SIGN_IN_METHOD="twitter.com";Zr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pk(n,e){return vw(n,"POST","/v1/accounts:signUp",_d(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await yr._fromIdTokenResponse(e,r,s),o=hv(r);return new Ts({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=hv(r);return new Ts({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function hv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mk(n){var e;if(mr(n.app))return Promise.reject(ms(n));const t=xd(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ts({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await pk(t,{returnSecureToken:!0}),s=await Ts._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu extends sr{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Mu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Mu(e,t,r,s)}}function Vw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Mu._fromErrorAndOperation(n,i,e,r):i})}async function gk(n,e,t=!1){const r=await gl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ts._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yk(n,e,t=!1){const{auth:r}=n;if(mr(r.app))return Promise.reject(ms(r));const s="reauthenticate";try{const i=await gl(n,Vw(r,s,e,n),t);ve(i.idToken,r,"internal-error");const o=fm(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(n.uid===a,r,"user-mismatch"),Ts._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&kr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vk(n,e,t=!1){if(mr(n.app))return Promise.reject(ms(n));const r="signIn",s=await Vw(n,r,e),i=await Ts._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function _k(n,e,t,r){return pt(n).onIdTokenChanged(e,t,r)}function xk(n,e,t){return pt(n).beforeAuthStateChanged(e,t)}function wk(n,e,t,r){return pt(n).onAuthStateChanged(e,t,r)}const Ou="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ou,"1"),this.storage.removeItem(Ou),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik=1e3,Tk=10;class Ow extends Mw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Aw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);XN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Tk):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Ik)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ow.type="LOCAL";const Ek=Ow;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw extends Mw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lw.type="SESSION";const Fw=Lw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new wd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(t.origin,i)),u=await bk(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const d=gm("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const y=m;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(y.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return window}function Nk(n){nr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(){return typeof nr().WorkerGlobalScope<"u"&&typeof nr().importScripts=="function"}async function kk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ck(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ak(){return zw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="firebaseLocalStorageDb",Rk=1,Lu="firebaseLocalStorage",Bw="fbase_key";class Ol{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Id(n,e){return n.transaction([Lu],e?"readwrite":"readonly").objectStore(Lu)}function Pk(){const n=indexedDB.deleteDatabase(Uw);return new Ol(n).toPromise()}function Uf(){const n=indexedDB.open(Uw,Rk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Lu,{keyPath:Bw})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Lu)?e(r):(r.close(),await Pk(),e(await Uf()))})})}async function fv(n,e,t){const r=Id(n,!0).put({[Bw]:e,value:t});return new Ol(r).toPromise()}async function Dk(n,e){const t=Id(n,!1).get(e),r=await new Ol(t).toPromise();return r===void 0?null:r.value}function pv(n,e){const t=Id(n,!0).delete(e);return new Ol(t).toPromise()}const jk=800,Vk=3;class $w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Uf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Vk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wd._getInstance(Ak()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await kk(),!this.activeServiceWorker)return;this.sender=new Sk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ck()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Uf();return await fv(e,Ou,"1"),await pv(e,Ou),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>fv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Dk(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>pv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Id(s,!1).getAll();return new Ol(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$w.type="LOCAL";const Mk=$w;new Vl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(n,e){return e?vr(e):(ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym extends Dw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return vo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Lk(n){return vk(n.auth,new ym(n),n.bypassAuthState)}function Fk(n){const{auth:e,user:t}=n;return ve(t,e,"internal-error"),yk(t,new ym(n),n.bypassAuthState)}async function zk(n){const{auth:e,user:t}=n;return ve(t,e,"internal-error"),gk(t,new ym(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lk;case"linkViaPopup":case"linkViaRedirect":return zk;case"reauthViaPopup":case"reauthViaRedirect":return Fk;default:kr(this.auth,"internal-error")}}resolve(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=new Vl(2e3,1e4);class ao extends qw{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ao.currentPopupAction&&ao.currentPopupAction.cancel(),ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){Cr(this.filter.length===1,"Popup operations only handle one event");const e=gm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Uk.get())};e()}}ao.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="pendingRedirect",Xc=new Map;class $k extends qw{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Xc.get(this.auth._key());if(!e){try{const r=await qk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Xc.set(this.auth._key(),e)}return this.bypassAuthState||Xc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qk(n,e){const t=Kk(e),r=Hk(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function Gk(n,e){Xc.set(n._key(),e)}function Hk(n){return vr(n._redirectPersistence)}function Kk(n){return Jc(Bk,n.config.apiKey,n.name)}async function Wk(n,e,t=!1){if(mr(n.app))return Promise.reject(ms(n));const r=xd(n),s=Ok(r,e),o=await new $k(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk=10*60*1e3;class Yk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Jk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Gw(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(tr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Qk&&this.cachedEventUids.clear(),this.cachedEventUids.has(mv(e))}saveEventToCache(e){this.cachedEventUids.add(mv(e)),this.lastProcessedEventTime=Date.now()}}function mv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Gw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Jk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n,e={}){return Ko(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eC=/^https?/;async function tC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Xk(n);for(const t of e)try{if(nC(t))return}catch{}kr(n,"unauthorized-domain")}function nC(n){const e=Ff(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!eC.test(t))return!1;if(Zk.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Vl(3e4,6e4);function gv(){const n=nr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function sC(n){return new Promise((e,t)=>{var r,s,i;function o(){gv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gv(),t(tr(n,"network-request-failed"))},timeout:rC.get()})}if(!((s=(r=nr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=nr().gapi)===null||i===void 0)&&i.load)o();else{const a=ak("iframefcb");return nr()[a]=()=>{gapi.load?o():t(tr(n,"network-request-failed"))},ik(`${ok()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Zc=null,e})}let Zc=null;function iC(n){return Zc=Zc||sC(n),Zc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=new Vl(5e3,15e3),aC="__/auth/iframe",lC="emulator/auth/iframe",cC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dC(n){const e=n.config;ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hm(e,lC):`https://${n.config.authDomain}/${aC}`,r={apiKey:e.apiKey,appName:n.name,v:Ho},s=uC.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${jl(r).slice(1)}`}async function hC(n){const e=await iC(n),t=nr().gapi;return ve(t,n,"internal-error"),e.open({where:document.body,url:dC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=tr(n,"network-request-failed"),a=nr().setTimeout(()=>{i(o)},oC.get());function u(){nr().clearTimeout(a),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pC=500,mC=600,gC="_blank",yC="http://localhost";class yv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function vC(n,e,t,r=pC,s=mC){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},fC),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Et().toLowerCase();t&&(a=bw(d)?gC:t),Tw(d)&&(e=e||yC,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[_,R])=>`${y}${_}=${R},`,"");if(JN(d)&&a!=="_self")return _C(e||"",a),new yv(null);const m=window.open(e||"",a,f);ve(m,n,"popup-blocked");try{m.focus()}catch{}return new yv(m)}function _C(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC="__/auth/handler",wC="emulator/auth/handler",IC=encodeURIComponent("fac");async function vv(n,e,t,r,s,i){ve(n.config.authDomain,n,"auth-domain-config-required"),ve(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ho,eventId:s};if(e instanceof jw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",IS(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Ml){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const u=await n._getAppCheckToken(),d=u?`#${IC}=${encodeURIComponent(u)}`:"";return`${TC(n)}?${jl(a).slice(1)}${d}`}function TC({config:n}){return n.emulator?hm(n,wC):`https://${n.authDomain}/${xC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh="webStorageSupport";class EC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Fw,this._completeRedirectFn=Wk,this._overrideRedirectResult=Gk}async _openPopup(e,t,r,s){var i;Cr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await vv(e,t,r,Ff(),s);return vC(e,o,gm())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await vv(e,t,r,Ff(),s);return Nk(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Cr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await hC(e),r=new Yk(e);return t.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rh,{type:Rh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Rh];o!==void 0&&t(!!o),kr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Aw()||Ew()||pm()}}const bC=EC;var _v="@firebase/auth",xv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kC(n){di(new Is("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rw(n)},d=new rk(r,s,i,u);return ck(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),di(new Is("auth-internal",e=>{const t=xd(e.getProvider("auth").getImmediate());return(r=>new SC(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),er(_v,xv,NC(n)),er(_v,xv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=5*60,AC=sw("authIdTokenMaxAge")||CC;let wv=null;const RC=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>AC)return;const s=t==null?void 0:t.token;wv!==s&&(wv=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function PC(n=uw()){const e=vd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=lk(n,{popupRedirectResolver:bC,persistence:[Mk,Ek,Fw]}),r=sw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=RC(i.toString());xk(t,o,()=>o(t.currentUser)),_k(t,a=>o(a))}}const s=nw("auth");return s&&uk(t,`http://${s}`),t}function DC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}sk({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=tr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",DC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kC("Browser");var Iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var si,Hw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,g){function x(){}x.prototype=g.prototype,w.D=g.prototype,w.prototype=new x,w.prototype.constructor=w,w.C=function(S,C,j){for(var N=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)N[Y-2]=arguments[Y];return g.prototype[C].apply(S,N)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,x){x||(x=0);var S=Array(16);if(typeof g=="string")for(var C=0;16>C;++C)S[C]=g.charCodeAt(x++)|g.charCodeAt(x++)<<8|g.charCodeAt(x++)<<16|g.charCodeAt(x++)<<24;else for(C=0;16>C;++C)S[C]=g[x++]|g[x++]<<8|g[x++]<<16|g[x++]<<24;g=w.g[0],x=w.g[1],C=w.g[2];var j=w.g[3],N=g+(j^x&(C^j))+S[0]+3614090360&4294967295;g=x+(N<<7&4294967295|N>>>25),N=j+(C^g&(x^C))+S[1]+3905402710&4294967295,j=g+(N<<12&4294967295|N>>>20),N=C+(x^j&(g^x))+S[2]+606105819&4294967295,C=j+(N<<17&4294967295|N>>>15),N=x+(g^C&(j^g))+S[3]+3250441966&4294967295,x=C+(N<<22&4294967295|N>>>10),N=g+(j^x&(C^j))+S[4]+4118548399&4294967295,g=x+(N<<7&4294967295|N>>>25),N=j+(C^g&(x^C))+S[5]+1200080426&4294967295,j=g+(N<<12&4294967295|N>>>20),N=C+(x^j&(g^x))+S[6]+2821735955&4294967295,C=j+(N<<17&4294967295|N>>>15),N=x+(g^C&(j^g))+S[7]+4249261313&4294967295,x=C+(N<<22&4294967295|N>>>10),N=g+(j^x&(C^j))+S[8]+1770035416&4294967295,g=x+(N<<7&4294967295|N>>>25),N=j+(C^g&(x^C))+S[9]+2336552879&4294967295,j=g+(N<<12&4294967295|N>>>20),N=C+(x^j&(g^x))+S[10]+4294925233&4294967295,C=j+(N<<17&4294967295|N>>>15),N=x+(g^C&(j^g))+S[11]+2304563134&4294967295,x=C+(N<<22&4294967295|N>>>10),N=g+(j^x&(C^j))+S[12]+1804603682&4294967295,g=x+(N<<7&4294967295|N>>>25),N=j+(C^g&(x^C))+S[13]+4254626195&4294967295,j=g+(N<<12&4294967295|N>>>20),N=C+(x^j&(g^x))+S[14]+2792965006&4294967295,C=j+(N<<17&4294967295|N>>>15),N=x+(g^C&(j^g))+S[15]+1236535329&4294967295,x=C+(N<<22&4294967295|N>>>10),N=g+(C^j&(x^C))+S[1]+4129170786&4294967295,g=x+(N<<5&4294967295|N>>>27),N=j+(x^C&(g^x))+S[6]+3225465664&4294967295,j=g+(N<<9&4294967295|N>>>23),N=C+(g^x&(j^g))+S[11]+643717713&4294967295,C=j+(N<<14&4294967295|N>>>18),N=x+(j^g&(C^j))+S[0]+3921069994&4294967295,x=C+(N<<20&4294967295|N>>>12),N=g+(C^j&(x^C))+S[5]+3593408605&4294967295,g=x+(N<<5&4294967295|N>>>27),N=j+(x^C&(g^x))+S[10]+38016083&4294967295,j=g+(N<<9&4294967295|N>>>23),N=C+(g^x&(j^g))+S[15]+3634488961&4294967295,C=j+(N<<14&4294967295|N>>>18),N=x+(j^g&(C^j))+S[4]+3889429448&4294967295,x=C+(N<<20&4294967295|N>>>12),N=g+(C^j&(x^C))+S[9]+568446438&4294967295,g=x+(N<<5&4294967295|N>>>27),N=j+(x^C&(g^x))+S[14]+3275163606&4294967295,j=g+(N<<9&4294967295|N>>>23),N=C+(g^x&(j^g))+S[3]+4107603335&4294967295,C=j+(N<<14&4294967295|N>>>18),N=x+(j^g&(C^j))+S[8]+1163531501&4294967295,x=C+(N<<20&4294967295|N>>>12),N=g+(C^j&(x^C))+S[13]+2850285829&4294967295,g=x+(N<<5&4294967295|N>>>27),N=j+(x^C&(g^x))+S[2]+4243563512&4294967295,j=g+(N<<9&4294967295|N>>>23),N=C+(g^x&(j^g))+S[7]+1735328473&4294967295,C=j+(N<<14&4294967295|N>>>18),N=x+(j^g&(C^j))+S[12]+2368359562&4294967295,x=C+(N<<20&4294967295|N>>>12),N=g+(x^C^j)+S[5]+4294588738&4294967295,g=x+(N<<4&4294967295|N>>>28),N=j+(g^x^C)+S[8]+2272392833&4294967295,j=g+(N<<11&4294967295|N>>>21),N=C+(j^g^x)+S[11]+1839030562&4294967295,C=j+(N<<16&4294967295|N>>>16),N=x+(C^j^g)+S[14]+4259657740&4294967295,x=C+(N<<23&4294967295|N>>>9),N=g+(x^C^j)+S[1]+2763975236&4294967295,g=x+(N<<4&4294967295|N>>>28),N=j+(g^x^C)+S[4]+1272893353&4294967295,j=g+(N<<11&4294967295|N>>>21),N=C+(j^g^x)+S[7]+4139469664&4294967295,C=j+(N<<16&4294967295|N>>>16),N=x+(C^j^g)+S[10]+3200236656&4294967295,x=C+(N<<23&4294967295|N>>>9),N=g+(x^C^j)+S[13]+681279174&4294967295,g=x+(N<<4&4294967295|N>>>28),N=j+(g^x^C)+S[0]+3936430074&4294967295,j=g+(N<<11&4294967295|N>>>21),N=C+(j^g^x)+S[3]+3572445317&4294967295,C=j+(N<<16&4294967295|N>>>16),N=x+(C^j^g)+S[6]+76029189&4294967295,x=C+(N<<23&4294967295|N>>>9),N=g+(x^C^j)+S[9]+3654602809&4294967295,g=x+(N<<4&4294967295|N>>>28),N=j+(g^x^C)+S[12]+3873151461&4294967295,j=g+(N<<11&4294967295|N>>>21),N=C+(j^g^x)+S[15]+530742520&4294967295,C=j+(N<<16&4294967295|N>>>16),N=x+(C^j^g)+S[2]+3299628645&4294967295,x=C+(N<<23&4294967295|N>>>9),N=g+(C^(x|~j))+S[0]+4096336452&4294967295,g=x+(N<<6&4294967295|N>>>26),N=j+(x^(g|~C))+S[7]+1126891415&4294967295,j=g+(N<<10&4294967295|N>>>22),N=C+(g^(j|~x))+S[14]+2878612391&4294967295,C=j+(N<<15&4294967295|N>>>17),N=x+(j^(C|~g))+S[5]+4237533241&4294967295,x=C+(N<<21&4294967295|N>>>11),N=g+(C^(x|~j))+S[12]+1700485571&4294967295,g=x+(N<<6&4294967295|N>>>26),N=j+(x^(g|~C))+S[3]+2399980690&4294967295,j=g+(N<<10&4294967295|N>>>22),N=C+(g^(j|~x))+S[10]+4293915773&4294967295,C=j+(N<<15&4294967295|N>>>17),N=x+(j^(C|~g))+S[1]+2240044497&4294967295,x=C+(N<<21&4294967295|N>>>11),N=g+(C^(x|~j))+S[8]+1873313359&4294967295,g=x+(N<<6&4294967295|N>>>26),N=j+(x^(g|~C))+S[15]+4264355552&4294967295,j=g+(N<<10&4294967295|N>>>22),N=C+(g^(j|~x))+S[6]+2734768916&4294967295,C=j+(N<<15&4294967295|N>>>17),N=x+(j^(C|~g))+S[13]+1309151649&4294967295,x=C+(N<<21&4294967295|N>>>11),N=g+(C^(x|~j))+S[4]+4149444226&4294967295,g=x+(N<<6&4294967295|N>>>26),N=j+(x^(g|~C))+S[11]+3174756917&4294967295,j=g+(N<<10&4294967295|N>>>22),N=C+(g^(j|~x))+S[2]+718787259&4294967295,C=j+(N<<15&4294967295|N>>>17),N=x+(j^(C|~g))+S[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(C+(N<<21&4294967295|N>>>11))&4294967295,w.g[2]=w.g[2]+C&4294967295,w.g[3]=w.g[3]+j&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var x=g-this.blockSize,S=this.B,C=this.h,j=0;j<g;){if(C==0)for(;j<=x;)s(this,w,j),j+=this.blockSize;if(typeof w=="string"){for(;j<g;)if(S[C++]=w.charCodeAt(j++),C==this.blockSize){s(this,S),C=0;break}}else for(;j<g;)if(S[C++]=w[j++],C==this.blockSize){s(this,S),C=0;break}}this.h=C,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var x=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=x&255,x/=256;for(this.u(w),w=Array(16),g=x=0;4>g;++g)for(var S=0;32>S;S+=8)w[x++]=this.g[g]>>>S&255;return w};function i(w,g){var x=a;return Object.prototype.hasOwnProperty.call(x,w)?x[w]:x[w]=g(w)}function o(w,g){this.h=g;for(var x=[],S=!0,C=w.length-1;0<=C;C--){var j=w[C]|0;S&&j==g||(x[C]=j,S=!1)}this.g=x}var a={};function u(w){return-128<=w&&128>w?i(w,function(g){return new o([g|0],0>g?-1:0)}):new o([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return m;if(0>w)return k(d(-w));for(var g=[],x=1,S=0;w>=x;S++)g[S]=w/x|0,x*=4294967296;return new o(g,0)}function f(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return k(f(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=d(Math.pow(g,8)),S=m,C=0;C<w.length;C+=8){var j=Math.min(8,w.length-C),N=parseInt(w.substring(C,C+j),g);8>j?(j=d(Math.pow(g,j)),S=S.j(j).add(d(N))):(S=S.j(x),S=S.add(d(N)))}return S}var m=u(0),y=u(1),_=u(16777216);n=o.prototype,n.m=function(){if(A(this))return-k(this).m();for(var w=0,g=1,x=0;x<this.g.length;x++){var S=this.i(x);w+=(0<=S?S:4294967296+S)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(A(this))return"-"+k(this).toString(w);for(var g=d(Math.pow(w,6)),x=this,S="";;){var C=I(x,g).g;x=E(x,C.j(g));var j=((0<x.g.length?x.g[0]:x.h)>>>0).toString(w);if(x=C,R(x))return j+S;for(;6>j.length;)j="0"+j;S=j+S}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function A(w){return w.h==-1}n.l=function(w){return w=E(this,w),A(w)?-1:R(w)?0:1};function k(w){for(var g=w.g.length,x=[],S=0;S<g;S++)x[S]=~w.g[S];return new o(x,~w.h).add(y)}n.abs=function(){return A(this)?k(this):this},n.add=function(w){for(var g=Math.max(this.g.length,w.g.length),x=[],S=0,C=0;C<=g;C++){var j=S+(this.i(C)&65535)+(w.i(C)&65535),N=(j>>>16)+(this.i(C)>>>16)+(w.i(C)>>>16);S=N>>>16,j&=65535,N&=65535,x[C]=N<<16|j}return new o(x,x[x.length-1]&-2147483648?-1:0)};function E(w,g){return w.add(k(g))}n.j=function(w){if(R(this)||R(w))return m;if(A(this))return A(w)?k(this).j(k(w)):k(k(this).j(w));if(A(w))return k(this.j(k(w)));if(0>this.l(_)&&0>w.l(_))return d(this.m()*w.m());for(var g=this.g.length+w.g.length,x=[],S=0;S<2*g;S++)x[S]=0;for(S=0;S<this.g.length;S++)for(var C=0;C<w.g.length;C++){var j=this.i(S)>>>16,N=this.i(S)&65535,Y=w.i(C)>>>16,L=w.i(C)&65535;x[2*S+2*C]+=N*L,v(x,2*S+2*C),x[2*S+2*C+1]+=j*L,v(x,2*S+2*C+1),x[2*S+2*C+1]+=N*Y,v(x,2*S+2*C+1),x[2*S+2*C+2]+=j*Y,v(x,2*S+2*C+2)}for(S=0;S<g;S++)x[S]=x[2*S+1]<<16|x[2*S];for(S=g;S<2*g;S++)x[S]=0;return new o(x,0)};function v(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function b(w,g){this.g=w,this.h=g}function I(w,g){if(R(g))throw Error("division by zero");if(R(w))return new b(m,m);if(A(w))return g=I(k(w),g),new b(k(g.g),k(g.h));if(A(g))return g=I(w,k(g)),new b(k(g.g),g.h);if(30<w.g.length){if(A(w)||A(g))throw Error("slowDivide_ only works with positive integers.");for(var x=y,S=g;0>=S.l(w);)x=D(x),S=D(S);var C=P(x,1),j=P(S,1);for(S=P(S,2),x=P(x,2);!R(S);){var N=j.add(S);0>=N.l(w)&&(C=C.add(x),j=N),S=P(S,1),x=P(x,1)}return g=E(w,C.j(g)),new b(C,g)}for(C=m;0<=w.l(g);){for(x=Math.max(1,Math.floor(w.m()/g.m())),S=Math.ceil(Math.log(x)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),j=d(x),N=j.j(g);A(N)||0<N.l(w);)x-=S,j=d(x),N=j.j(g);R(j)&&(j=y),C=C.add(j),w=E(w,N)}return new b(C,w)}n.A=function(w){return I(this,w).h},n.and=function(w){for(var g=Math.max(this.g.length,w.g.length),x=[],S=0;S<g;S++)x[S]=this.i(S)&w.i(S);return new o(x,this.h&w.h)},n.or=function(w){for(var g=Math.max(this.g.length,w.g.length),x=[],S=0;S<g;S++)x[S]=this.i(S)|w.i(S);return new o(x,this.h|w.h)},n.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),x=[],S=0;S<g;S++)x[S]=this.i(S)^w.i(S);return new o(x,this.h^w.h)};function D(w){for(var g=w.g.length+1,x=[],S=0;S<g;S++)x[S]=w.i(S)<<1|w.i(S-1)>>>31;return new o(x,w.h)}function P(w,g){var x=g>>5;g%=32;for(var S=w.g.length-x,C=[],j=0;j<S;j++)C[j]=0<g?w.i(j+x)>>>g|w.i(j+x+1)<<32-g:w.i(j+x);return new o(C,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Hw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,si=o}).apply(typeof Iv<"u"?Iv:typeof self<"u"?self:typeof window<"u"?window:{});var Rc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Kw,Ca,Ww,eu,Bf,Qw,Yw,Jw;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rc=="object"&&Rc];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var T=0;T<l.length-1;T++){var M=l[T];if(!(M in p))break e;p=p[M]}l=l[l.length-1],T=p[l],h=h(T),h!=T&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,T=!1,M={next:function(){if(!T&&p<l.length){var F=p++;return{value:h(F,l[F]),done:!1}}return T=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,p){return l.call.apply(l.bind,arguments)}function m(l,h,p){if(!l)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,T),l.apply(h,M)}}return function(){return l.apply(h,arguments)}}function y(l,h,p){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,y.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var T=p.slice();return T.push.apply(T,arguments),l.apply(this,T)}}function R(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(T,M,F){for(var J=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)J[ze-2]=arguments[ze];return h.prototype[M].apply(T,J)}}function A(l){const h=l.length;if(0<h){const p=Array(h);for(let T=0;T<h;T++)p[T]=l[T];return p}return[]}function k(l,h){for(let p=1;p<arguments.length;p++){const T=arguments[p];if(u(T)){const M=l.length||0,F=T.length||0;l.length=M+F;for(let J=0;J<F;J++)l[M+J]=T[J]}else l.push(T)}}class E{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(l){return/^[\s\xa0]*$/.test(l)}function b(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function I(l){return I[" "](l),l}I[" "]=function(){};var D=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function P(l,h,p){for(const T in l)h.call(p,l[T],T,l)}function w(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function g(l){const h={};for(const p in l)h[p]=l[p];return h}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(l,h){let p,T;for(let M=1;M<arguments.length;M++){T=arguments[M];for(p in T)l[p]=T[p];for(let F=0;F<x.length;F++)p=x[F],Object.prototype.hasOwnProperty.call(T,p)&&(l[p]=T[p])}}function C(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function j(l){a.setTimeout(()=>{throw l},0)}function N(){var l=W;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Y{constructor(){this.h=this.g=null}add(h,p){const T=L.get();T.set(h,p),this.h?this.h.next=T:this.g=T,this.h=T}}var L=new E(()=>new xe,l=>l.reset());class xe{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let we,q=!1,W=new Y,ne=()=>{const l=a.Promise.resolve(void 0);we=()=>{l.then(ye)}};var ye=()=>{for(var l;l=N();){try{l.h.call(l.g)}catch(p){j(p)}var h=L;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}q=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function ae(l,h){if($.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,T=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(D){e:{try{I(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Ie[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&ae.aa.h.call(this)}}R(ae,$);var Ie={2:"touch",3:"pen",4:"mouse"};ae.prototype.h=function(){ae.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Ne="closure_listenable_"+(1e6*Math.random()|0),Ze=0;function et(l,h,p,T,M){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!T,this.ha=M,this.key=++Ze,this.da=this.fa=!1}function Qe(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function je(l){this.src=l,this.g={},this.h=0}je.prototype.add=function(l,h,p,T,M){var F=l.toString();l=this.g[F],l||(l=this.g[F]=[],this.h++);var J=At(l,h,T,M);return-1<J?(h=l[J],p||(h.fa=!1)):(h=new et(h,this.src,F,!!T,M),h.fa=p,l.push(h)),h};function qe(l,h){var p=h.type;if(p in l.g){var T=l.g[p],M=Array.prototype.indexOf.call(T,h,void 0),F;(F=0<=M)&&Array.prototype.splice.call(T,M,1),F&&(Qe(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function At(l,h,p,T){for(var M=0;M<l.length;++M){var F=l[M];if(!F.da&&F.listener==h&&F.capture==!!p&&F.ha==T)return M}return-1}var kn="closure_lm_"+(1e6*Math.random()|0),js={};function bi(l,h,p,T,M){if(Array.isArray(h)){for(var F=0;F<h.length;F++)bi(l,h[F],p,T,M);return null}return p=jr(p),l&&l[Ne]?l.K(h,p,d(T)?!!T.capture:!1,M):ir(l,h,p,!1,T,M)}function ir(l,h,p,T,M,F){if(!h)throw Error("Invalid event type");var J=d(M)?!!M.capture:!!M,ze=Bn(l);if(ze||(l[kn]=ze=new je(l)),p=ze.add(h,p,T,J,F),p.proxy)return p;if(T=Dr(),p.proxy=T,T.src=l,T.listener=p,l.addEventListener)H||(M=J),M===void 0&&(M=!1),l.addEventListener(h.toString(),T,M);else if(l.attachEvent)l.attachEvent(Si(h.toString()),T);else if(l.addListener&&l.removeListener)l.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Dr(){function l(p){return h.call(l.src,l.listener,p)}const h=Zo;return l}function Cn(l,h,p,T,M){if(Array.isArray(h))for(var F=0;F<h.length;F++)Cn(l,h[F],p,T,M);else T=d(T)?!!T.capture:!!T,p=jr(p),l&&l[Ne]?(l=l.i,h=String(h).toString(),h in l.g&&(F=l.g[h],p=At(F,p,T,M),-1<p&&(Qe(F[p]),Array.prototype.splice.call(F,p,1),F.length==0&&(delete l.g[h],l.h--)))):l&&(l=Bn(l))&&(h=l.g[h.toString()],l=-1,h&&(l=At(h,p,T,M)),(p=-1<l?h[l]:null)&&Vs(p))}function Vs(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Ne])qe(h.i,l);else{var p=l.type,T=l.proxy;h.removeEventListener?h.removeEventListener(p,T,l.capture):h.detachEvent?h.detachEvent(Si(p),T):h.addListener&&h.removeListener&&h.removeListener(T),(p=Bn(h))?(qe(p,l),p.h==0&&(p.src=null,h[kn]=null)):Qe(l)}}}function Si(l){return l in js?js[l]:js[l]="on"+l}function Zo(l,h){if(l.da)l=!0;else{h=new ae(h,this);var p=l.listener,T=l.ha||l.src;l.fa&&Vs(l),l=p.call(T,h)}return l}function Bn(l){return l=l[kn],l instanceof je?l:null}var Ms="__closure_events_fn_"+(1e9*Math.random()>>>0);function jr(l){return typeof l=="function"?l:(l[Ms]||(l[Ms]=function(h){return l.handleEvent(h)}),l[Ms])}function Ue(){he.call(this),this.i=new je(this),this.M=this,this.F=null}R(Ue,he),Ue.prototype[Ne]=!0,Ue.prototype.removeEventListener=function(l,h,p,T){Cn(this,l,h,p,T)};function Ge(l,h){var p,T=l.F;if(T)for(p=[];T;T=T.F)p.push(T);if(l=l.M,T=h.type||h,typeof h=="string")h=new $(h,l);else if(h instanceof $)h.target=h.target||l;else{var M=h;h=new $(T,l),S(h,M)}if(M=!0,p)for(var F=p.length-1;0<=F;F--){var J=h.g=p[F];M=an(J,T,!0,h)&&M}if(J=h.g=l,M=an(J,T,!0,h)&&M,M=an(J,T,!1,h)&&M,p)for(F=0;F<p.length;F++)J=h.g=p[F],M=an(J,T,!1,h)&&M}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],T=0;T<p.length;T++)Qe(p[T]);delete l.g[h],l.h--}}this.F=null},Ue.prototype.K=function(l,h,p,T){return this.i.add(String(l),h,!1,p,T)},Ue.prototype.L=function(l,h,p,T){return this.i.add(String(l),h,!0,p,T)};function an(l,h,p,T){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,F=0;F<h.length;++F){var J=h[F];if(J&&!J.da&&J.capture==p){var ze=J.listener,Pt=J.ha||J.src;J.fa&&qe(l.i,J),M=ze.call(Pt,T)!==!1&&M}}return M&&!T.defaultPrevented}function Ni(l,h,p){if(typeof l=="function")p&&(l=y(l,p));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Vr(l){l.g=Ni(()=>{l.g=null,l.i&&(l.i=!1,Vr(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Os extends he{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Vr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $n(l){he.call(this),this.h=l,this.g={}}R($n,he);var X=[];function _t(l){P(l.g,function(h,p){this.g.hasOwnProperty(p)&&Vs(h)},l),l.g={}}$n.prototype.N=function(){$n.aa.N.call(this),_t(this)},$n.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xt=a.JSON.stringify,qn=a.JSON.parse,ea=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function or(){}or.prototype.h=null;function ki(l){return l.h||(l.h=l.i())}function Wl(){}var Ls={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ta(){$.call(this,"d")}R(ta,$);function na(){$.call(this,"c")}R(na,$);var ar={},Ql=null;function Ci(){return Ql=Ql||new Ue}ar.La="serverreachability";function Yl(l){$.call(this,ar.La,l)}R(Yl,$);function Mr(l){const h=Ci();Ge(h,new Yl(h))}ar.STAT_EVENT="statevent";function Jl(l,h){$.call(this,ar.STAT_EVENT,l),this.stat=h}R(Jl,$);function Rt(l){const h=Ci();Ge(h,new Jl(h,l))}ar.Ma="timingevent";function Xl(l,h){$.call(this,ar.Ma,l),this.size=h}R(Xl,$);function Fs(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function zs(){this.g=!0}zs.prototype.xa=function(){this.g=!1};function qd(l,h,p,T,M,F){l.info(function(){if(l.g)if(F)for(var J="",ze=F.split("&"),Pt=0;Pt<ze.length;Pt++){var De=ze[Pt].split("=");if(1<De.length){var Ot=De[0];De=De[1];var Lt=Ot.split("_");J=2<=Lt.length&&Lt[1]=="type"?J+(Ot+"="+De+"&"):J+(Ot+"=redacted&")}}else J=null;else J=F;return"XMLHTTP REQ ("+T+") [attempt "+M+"]: "+h+`
`+p+`
`+J})}function Gd(l,h,p,T,M,F,J){l.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+M+"]: "+h+`
`+p+`
`+F+" "+J})}function Or(l,h,p,T){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Kd(l,p)+(T?" "+T:"")})}function Hd(l,h){l.info(function(){return"TIMEOUT: "+h})}zs.prototype.info=function(){};function Kd(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var T=p[l];if(!(2>T.length)){var M=T[1];if(Array.isArray(M)&&!(1>M.length)){var F=M[0];if(F!="noop"&&F!="stop"&&F!="close")for(var J=1;J<M.length;J++)M[J]=""}}}}return xt(p)}catch{return h}}var Ai={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Zl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ra;function Ri(){}R(Ri,or),Ri.prototype.g=function(){return new XMLHttpRequest},Ri.prototype.i=function(){return{}},ra=new Ri;function Gn(l,h,p,T){this.j=l,this.i=h,this.l=p,this.R=T||1,this.U=new $n(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ec}function ec(){this.i=null,this.g="",this.h=!1}var tc={},wt={};function Pi(l,h,p){l.L=1,l.v=sc(lr(h)),l.m=p,l.P=!0,sa(l,null)}function sa(l,h){l.F=Date.now(),Q(l),l.A=lr(l.v);var p=l.A,T=l.R;Array.isArray(T)||(T=[String(T)]),vg(p.i,"t",T),l.C=0,p=l.j.J,l.h=new ec,l.g=Mg(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Os(y(l.Y,l,l.g),l.O)),h=l.U,p=l.g,T=l.ca;var M="readystatechange";Array.isArray(M)||(M&&(X[0]=M.toString()),M=X);for(var F=0;F<M.length;F++){var J=bi(p,M[F],T||h.handleEvent,!1,h.h||h);if(!J)break;h.g[J.key]=J}h=l.H?g(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Mr(),qd(l.i,l.u,l.A,l.l,l.R,l.m)}Gn.prototype.ca=function(l){l=l.target;const h=this.M;h&&cr(l)==3?h.j():this.Y(l)},Gn.prototype.Y=function(l){try{if(l==this.g)e:{const Lt=cr(this.g);var h=this.g.Ba();const Oi=this.g.Z();if(!(3>Lt)&&(Lt!=3||this.g&&(this.h.h||this.g.oa()||bg(this.g)))){this.J||Lt!=4||h==7||(h==8||0>=Oi?Mr(3):Mr(2)),le(this);var p=this.g.Z();this.X=p;t:if(V(this)){var T=bg(this.g);l="";var M=T.length,F=cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Oe(this),Pe(this);var J="";break t}this.h.i=new a.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,l+=this.h.i.decode(T[h],{stream:!(F&&h==M-1)});T.length=0,this.h.g+=l,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=p==200,Gd(this.i,this.u,this.A,this.l,this.R,Lt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ze,Pt=this.g;if((ze=Pt.g?Pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ze)){var De=ze;break t}}De=null}if(p=De)Or(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gt(this,p);else{this.o=!1,this.s=3,Rt(12),Oe(this),Pe(this);break e}}if(this.P){p=!0;let Rn;for(;!this.J&&this.C<J.length;)if(Rn=z(this,J),Rn==wt){Lt==4&&(this.s=4,Rt(14),p=!1),Or(this.i,this.l,null,"[Incomplete Response]");break}else if(Rn==tc){this.s=4,Rt(15),Or(this.i,this.l,J,"[Invalid Chunk]"),p=!1;break}else Or(this.i,this.l,Rn,null),gt(this,Rn);if(V(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Lt!=4||J.length!=0||this.h.h||(this.s=1,Rt(16),p=!1),this.o=this.o&&p,!p)Or(this.i,this.l,J,"[Invalid Chunked Response]"),Oe(this),Pe(this);else if(0<J.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Jd(Ot),Ot.M=!0,Rt(11))}}else Or(this.i,this.l,J,null),gt(this,J);Lt==4&&Oe(this),this.o&&!this.J&&(Lt==4?Pg(this.j,this):(this.o=!1,Q(this)))}else CE(this.g),p==400&&0<J.indexOf("Unknown SID")?(this.s=3,Rt(12)):(this.s=0,Rt(13)),Oe(this),Pe(this)}}}catch{}finally{}};function V(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function z(l,h){var p=l.C,T=h.indexOf(`
`,p);return T==-1?wt:(p=Number(h.substring(p,T)),isNaN(p)?tc:(T+=1,T+p>h.length?wt:(h=h.slice(T,T+p),l.C=T+p,h)))}Gn.prototype.cancel=function(){this.J=!0,Oe(this)};function Q(l){l.S=Date.now()+l.I,re(l,l.I)}function re(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Fs(y(l.ba,l),h)}function le(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Gn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Hd(this.i,this.A),this.L!=2&&(Mr(),Rt(17)),Oe(this),this.s=2,Pe(this)):re(this,this.S-l)};function Pe(l){l.j.G==0||l.J||Pg(l.j,l)}function Oe(l){le(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,_t(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function gt(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Lr(p.h,l))){if(!l.K&&Lr(p.h,l)&&p.G==3){try{var T=p.Da.g.parse(h)}catch{T=null}if(Array.isArray(T)&&T.length==3){var M=T;if(M[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)uc(p),lc(p);else break e;Yd(p),Rt(18)}}else p.za=M[1],0<p.za-p.T&&37500>M[2]&&p.F&&p.v==0&&!p.C&&(p.C=Fs(y(p.Za,p),6e3));if(1>=Di(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else $s(p,11)}else if((l.K||p.g==l)&&uc(p),!v(h))for(M=p.Da.g.parse(h),h=0;h<M.length;h++){let De=M[h];if(p.T=De[0],De=De[1],p.G==2)if(De[0]=="c"){p.K=De[1],p.ia=De[2];const Ot=De[3];Ot!=null&&(p.la=Ot,p.j.info("VER="+p.la));const Lt=De[4];Lt!=null&&(p.Aa=Lt,p.j.info("SVER="+p.Aa));const Oi=De[5];Oi!=null&&typeof Oi=="number"&&0<Oi&&(T=1.5*Oi,p.L=T,p.j.info("backChannelRequestTimeoutMs_="+T)),T=p;const Rn=l.g;if(Rn){const hc=Rn.g?Rn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hc){var F=T.h;F.g||hc.indexOf("spdy")==-1&&hc.indexOf("quic")==-1&&hc.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Us(F,F.h),F.h=null))}if(T.D){const Xd=Rn.g?Rn.g.getResponseHeader("X-HTTP-Session-Id"):null;Xd&&(T.ya=Xd,He(T.I,T.D,Xd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),T=p;var J=l;if(T.qa=Vg(T,T.J?T.ia:null,T.W),J.K){Hn(T.h,J);var ze=J,Pt=T.L;Pt&&(ze.I=Pt),ze.B&&(le(ze),Q(ze)),T.g=J}else Ag(T);0<p.i.length&&cc(p)}else De[0]!="stop"&&De[0]!="close"||$s(p,7);else p.G==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?$s(p,7):Qd(p):De[0]!="noop"&&p.l&&p.l.ta(De),p.v=0)}}Mr(4)}catch{}}var An=class{constructor(l,h){this.g=l,this.map=h}};function xn(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Di(l){return l.h?1:l.g?l.g.size:0}function Lr(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Us(l,h){l.g?l.g.add(h):l.h=h}function Hn(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}xn.prototype.cancel=function(){if(this.i=ji(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ji(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return A(l.i)}function tt(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],p=l.length,T=0;T<p;T++)h.push(l[T]);return h}h=[],p=0;for(T in l)h[p++]=l[T];return h}function Ae(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const T in l)h[p++]=T;return h}}}function ln(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=Ae(l),T=tt(l),M=T.length,F=0;F<M;F++)h.call(void 0,T[F],p&&p[F],l)}var fg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gE(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var T=l[p].indexOf("="),M=null;if(0<=T){var F=l[p].substring(0,T);M=l[p].substring(T+1)}else F=l[p];h(F,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Bs(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Bs){this.h=l.h,nc(this,l.j),this.o=l.o,this.g=l.g,rc(this,l.s),this.l=l.l;var h=l.i,p=new aa;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),pg(this,p),this.m=l.m}else l&&(h=String(l).match(fg))?(this.h=!1,nc(this,h[1]||"",!0),this.o=ia(h[2]||""),this.g=ia(h[3]||"",!0),rc(this,h[4]),this.l=ia(h[5]||"",!0),pg(this,h[6]||"",!0),this.m=ia(h[7]||"")):(this.h=!1,this.i=new aa(null,this.h))}Bs.prototype.toString=function(){var l=[],h=this.j;h&&l.push(oa(h,mg,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(oa(h,mg,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(oa(p,p.charAt(0)=="/"?_E:vE,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",oa(p,wE)),l.join("")};function lr(l){return new Bs(l)}function nc(l,h,p){l.j=p?ia(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function rc(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function pg(l,h,p){h instanceof aa?(l.i=h,IE(l.i,l.h)):(p||(h=oa(h,xE)),l.i=new aa(h,l.h))}function He(l,h,p){l.i.set(h,p)}function sc(l){return He(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ia(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function oa(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,yE),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function yE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var mg=/[#\/\?@]/g,vE=/[#\?:]/g,_E=/[#\?]/g,xE=/[#\?@]/g,wE=/#/g;function aa(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Fr(l){l.g||(l.g=new Map,l.h=0,l.i&&gE(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=aa.prototype,n.add=function(l,h){Fr(this),this.i=null,l=Vi(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function gg(l,h){Fr(l),h=Vi(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function yg(l,h){return Fr(l),h=Vi(l,h),l.g.has(h)}n.forEach=function(l,h){Fr(this),this.g.forEach(function(p,T){p.forEach(function(M){l.call(h,M,T,this)},this)},this)},n.na=function(){Fr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let T=0;T<h.length;T++){const M=l[T];for(let F=0;F<M.length;F++)p.push(h[T])}return p},n.V=function(l){Fr(this);let h=[];if(typeof l=="string")yg(this,l)&&(h=h.concat(this.g.get(Vi(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Fr(this),this.i=null,l=Vi(this,l),yg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function vg(l,h,p){gg(l,h),0<p.length&&(l.i=null,l.g.set(Vi(l,h),A(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var T=h[p];const F=encodeURIComponent(String(T)),J=this.V(T);for(T=0;T<J.length;T++){var M=F;J[T]!==""&&(M+="="+encodeURIComponent(String(J[T]))),l.push(M)}}return this.i=l.join("&")};function Vi(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function IE(l,h){h&&!l.j&&(Fr(l),l.i=null,l.g.forEach(function(p,T){var M=T.toLowerCase();T!=M&&(gg(this,T),vg(this,M,p))},l)),l.j=h}function TE(l,h){const p=new zs;if(a.Image){const T=new Image;T.onload=_(zr,p,"TestLoadImage: loaded",!0,h,T),T.onerror=_(zr,p,"TestLoadImage: error",!1,h,T),T.onabort=_(zr,p,"TestLoadImage: abort",!1,h,T),T.ontimeout=_(zr,p,"TestLoadImage: timeout",!1,h,T),a.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=l}else h(!1)}function EE(l,h){const p=new zs,T=new AbortController,M=setTimeout(()=>{T.abort(),zr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:T.signal}).then(F=>{clearTimeout(M),F.ok?zr(p,"TestPingServer: ok",!0,h):zr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),zr(p,"TestPingServer: error",!1,h)})}function zr(l,h,p,T,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),T(p)}catch{}}function bE(){this.g=new ea}function SE(l,h,p){const T=p||"";try{ln(l,function(M,F){let J=M;d(M)&&(J=xt(M)),h.push(T+F+"="+encodeURIComponent(J))})}catch(M){throw h.push(T+"type="+encodeURIComponent("_badmap")),M}}function ic(l){this.l=l.Ub||null,this.j=l.eb||!1}R(ic,or),ic.prototype.g=function(){return new oc(this.l,this.j)},ic.prototype.i=function(l){return function(){return l}}({});function oc(l,h){Ue.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(oc,Ue),n=oc.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ca(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,la(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_g(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function _g(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?la(this):ca(this),this.readyState==3&&_g(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,la(this))},n.Qa=function(l){this.g&&(this.response=l,la(this))},n.ga=function(){this.g&&la(this)};function la(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ca(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function ca(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(oc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function xg(l){let h="";return P(l,function(p,T){h+=T,h+=":",h+=p,h+=`\r
`}),h}function Wd(l,h,p){e:{for(T in p){var T=!1;break e}T=!0}T||(p=xg(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):He(l,h,p))}function at(l){Ue.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(at,Ue);var NE=/^https?$/i,kE=["POST","PUT"];n=at.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ra.g(),this.v=this.o?ki(this.o):ki(ra),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(F){wg(this,F);return}if(l=p||"",p=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var M in T)p.set(M,T[M]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const F of T.keys())p.set(F,T.get(F));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(p.keys()).find(F=>F.toLowerCase()=="content-type"),M=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(kE,h,void 0))||T||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of p)this.g.setRequestHeader(F,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Eg(this),this.u=!0,this.g.send(l),this.u=!1}catch(F){wg(this,F)}};function wg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Ig(l),ac(l)}function Ig(l){l.A||(l.A=!0,Ge(l,"complete"),Ge(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ge(this,"complete"),Ge(this,"abort"),ac(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ac(this,!0)),at.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Tg(this):this.bb())},n.bb=function(){Tg(this)};function Tg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||cr(l)!=4||l.Z()!=2)){if(l.u&&cr(l)==4)Ni(l.Ea,0,l);else if(Ge(l,"readystatechange"),cr(l)==4){l.h=!1;try{const J=l.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var T;if(T=J===0){var M=String(l.D).match(fg)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),T=!NE.test(M?M.toLowerCase():"")}p=T}if(p)Ge(l,"complete"),Ge(l,"success");else{l.m=6;try{var F=2<cr(l)?l.g.statusText:""}catch{F=""}l.l=F+" ["+l.Z()+"]",Ig(l)}}finally{ac(l)}}}}function ac(l,h){if(l.g){Eg(l);const p=l.g,T=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Ge(l,"ready");try{p.onreadystatechange=T}catch{}}}function Eg(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function cr(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<cr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),qn(h)}};function bg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function CE(l){const h={};l=(l.g&&2<=cr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<l.length;T++){if(v(l[T]))continue;var p=C(l[T]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const F=h[M]||[];h[M]=F,F.push(p)}w(h,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ua(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Sg(l){this.Aa=0,this.i=[],this.j=new zs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ua("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ua("baseRetryDelayMs",5e3,l),this.cb=ua("retryDelaySeedMs",1e4,l),this.Wa=ua("forwardChannelMaxRetries",2,l),this.wa=ua("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new xn(l&&l.concurrentRequestLimit),this.Da=new bE,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Sg.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,T){Rt(0),this.W=l,this.H=h||{},p&&T!==void 0&&(this.H.OSID=p,this.H.OAID=T),this.F=this.X,this.I=Vg(this,null,this.W),cc(this)};function Qd(l){if(Ng(l),l.G==3){var h=l.U++,p=lr(l.I);if(He(p,"SID",l.K),He(p,"RID",h),He(p,"TYPE","terminate"),da(l,p),h=new Gn(l,l.j,h),h.L=2,h.v=sc(lr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Mg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Q(h)}jg(l)}function lc(l){l.g&&(Jd(l),l.g.cancel(),l.g=null)}function Ng(l){lc(l),l.u&&(a.clearTimeout(l.u),l.u=null),uc(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function cc(l){if(!wn(l.h)&&!l.s){l.s=!0;var h=l.Ga;we||ne(),q||(we(),q=!0),W.add(h,l),l.B=0}}function AE(l,h){return Di(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Fs(y(l.Ga,l,h),Dg(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const M=new Gn(this,this.j,l);let F=this.o;if(this.S&&(F?(F=g(F),S(F,this.S)):F=this.S),this.m!==null||this.O||(M.H=F,F=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var T=this.i[p];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(h+=T,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Cg(this,M,h),p=lr(this.I),He(p,"RID",l),He(p,"CVER",22),this.D&&He(p,"X-HTTP-Session-Id",this.D),da(this,p),F&&(this.O?h="headers="+encodeURIComponent(String(xg(F)))+"&"+h:this.m&&Wd(p,this.m,F)),Us(this.h,M),this.Ua&&He(p,"TYPE","init"),this.P?(He(p,"$req",h),He(p,"SID","null"),M.T=!0,Pi(M,p,null)):Pi(M,p,h),this.G=2}}else this.G==3&&(l?kg(this,l):this.i.length==0||wn(this.h)||kg(this))};function kg(l,h){var p;h?p=h.l:p=l.U++;const T=lr(l.I);He(T,"SID",l.K),He(T,"RID",p),He(T,"AID",l.T),da(l,T),l.m&&l.o&&Wd(T,l.m,l.o),p=new Gn(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Cg(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Us(l.h,p),Pi(p,T,h)}function da(l,h){l.H&&P(l.H,function(p,T){He(h,T,p)}),l.l&&ln({},function(p,T){He(h,T,p)})}function Cg(l,h,p){p=Math.min(l.i.length,p);var T=l.l?y(l.l.Na,l.l,l):null;e:{var M=l.i;let F=-1;for(;;){const J=["count="+p];F==-1?0<p?(F=M[0].g,J.push("ofs="+F)):F=0:J.push("ofs="+F);let ze=!0;for(let Pt=0;Pt<p;Pt++){let De=M[Pt].g;const Ot=M[Pt].map;if(De-=F,0>De)F=Math.max(0,M[Pt].g-100),ze=!1;else try{SE(Ot,J,"req"+De+"_")}catch{T&&T(Ot)}}if(ze){T=J.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,T}function Ag(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;we||ne(),q||(we(),q=!0),W.add(h,l),l.v=0}}function Yd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Fs(y(l.Fa,l),Dg(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,Rg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Fs(y(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Rt(10),lc(this),Rg(this))};function Jd(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Rg(l){l.g=new Gn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=lr(l.qa);He(h,"RID","rpc"),He(h,"SID",l.K),He(h,"AID",l.T),He(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&He(h,"TO",l.ja),He(h,"TYPE","xmlhttp"),da(l,h),l.m&&l.o&&Wd(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=sc(lr(h)),p.m=null,p.P=!0,sa(p,l)}n.Za=function(){this.C!=null&&(this.C=null,lc(this),Yd(this),Rt(19))};function uc(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Pg(l,h){var p=null;if(l.g==h){uc(l),Jd(l),l.g=null;var T=2}else if(Lr(l.h,h))p=h.D,Hn(l.h,h),T=1;else return;if(l.G!=0){if(h.o)if(T==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var M=l.B;T=Ci(),Ge(T,new Xl(T,p)),cc(l)}else Ag(l);else if(M=h.s,M==3||M==0&&0<h.X||!(T==1&&AE(l,h)||T==2&&Yd(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),M){case 1:$s(l,5);break;case 4:$s(l,10);break;case 3:$s(l,6);break;default:$s(l,2)}}}function Dg(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function $s(l,h){if(l.j.info("Error code "+h),h==2){var p=y(l.fb,l),T=l.Xa;const M=!T;T=new Bs(T||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||nc(T,"https"),sc(T),M?TE(T.toString(),p):EE(T.toString(),p)}else Rt(2);l.G=0,l.l&&l.l.sa(h),jg(l),Ng(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function jg(l){if(l.G=0,l.ka=[],l.l){const h=ji(l.h);(h.length!=0||l.i.length!=0)&&(k(l.ka,h),k(l.ka,l.i),l.h.i.length=0,A(l.i),l.i.length=0),l.l.ra()}}function Vg(l,h,p){var T=p instanceof Bs?lr(p):new Bs(p);if(T.g!="")h&&(T.g=h+"."+T.g),rc(T,T.s);else{var M=a.location;T=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var F=new Bs(null);T&&nc(F,T),h&&(F.g=h),M&&rc(F,M),p&&(F.l=p),T=F}return p=l.D,h=l.ya,p&&h&&He(T,p,h),He(T,"VER",l.la),da(l,T),T}function Mg(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new at(new ic({eb:p})):new at(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Og(){}n=Og.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function dc(){}dc.prototype.g=function(l,h){return new cn(l,h)};function cn(l,h){Ue.call(this),this.g=new Sg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!v(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Mi(this)}R(cn,Ue),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Qd(this.g)},cn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=xt(l),l=p);h.i.push(new An(h.Ya++,l)),h.G==3&&cc(h)},cn.prototype.N=function(){this.g.l=null,delete this.j,Qd(this.g),delete this.g,cn.aa.N.call(this)};function Lg(l){ta.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}R(Lg,ta);function Fg(){na.call(this),this.status=1}R(Fg,na);function Mi(l){this.g=l}R(Mi,Og),Mi.prototype.ua=function(){Ge(this.g,"a")},Mi.prototype.ta=function(l){Ge(this.g,new Lg(l))},Mi.prototype.sa=function(l){Ge(this.g,new Fg)},Mi.prototype.ra=function(){Ge(this.g,"b")},dc.prototype.createWebChannel=dc.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Jw=function(){return new dc},Yw=function(){return Ci()},Qw=ar,Bf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ai.NO_ERROR=0,Ai.TIMEOUT=8,Ai.HTTP_ERROR=6,eu=Ai,Zl.COMPLETE="complete",Ww=Zl,Wl.EventType=Ls,Ls.OPEN="a",Ls.CLOSE="b",Ls.ERROR="c",Ls.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,Ca=Wl,at.prototype.listenOnce=at.prototype.L,at.prototype.getLastError=at.prototype.Ka,at.prototype.getLastErrorCode=at.prototype.Ba,at.prototype.getStatus=at.prototype.Z,at.prototype.getResponseJson=at.prototype.Oa,at.prototype.getResponseText=at.prototype.oa,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Ha,Kw=at}).apply(typeof Rc<"u"?Rc:typeof self<"u"?self:typeof window<"u"?window:{});const Tv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new lm("@firebase/firestore");function qi(){return fi.logLevel}function G(n,...e){if(fi.logLevel<=Se.DEBUG){const t=e.map(vm);fi.debug(`Firestore (${Wo}): ${n}`,...t)}}function ft(n,...e){if(fi.logLevel<=Se.ERROR){const t=e.map(vm);fi.error(`Firestore (${Wo}): ${n}`,...t)}}function yl(n,...e){if(fi.logLevel<=Se.WARN){const t=e.map(vm);fi.warn(`Firestore (${Wo}): ${n}`,...t)}}function vm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(n="Unexpected state"){const e=`FIRESTORE (${Wo}) INTERNAL ASSERTION FAILED: `+n;throw ft(e),new Error(e)}function de(n,e){n||oe()}function ce(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends sr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Bt.UNAUTHENTICATED))}shutdown(){}}class MC{constructor(e){this.t=e,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){de(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new gs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new gs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(de(typeof r.accessToken=="string"),new jC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return de(e===null||typeof e=="string"),new Bt(e)}}class OC{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class LC{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new OC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class FC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){de(this.o===void 0);const r=i=>{i.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,G("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(de(typeof t.token=="string"),this.R=t.token,new FC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=UC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function _e(n,e){return n<e?-1:n>e?1:0}function ko(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Zw(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new te(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new it(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new it(0,0))}static max(){return new pe(new it(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t,r){t===void 0?t=0:t>e.length&&oe(),r===void 0?r=e.length-t:r>e.length-t&&oe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return vl.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vl?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ve extends vl{construct(e,t,r){return new Ve(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Ve(t)}static emptyPath(){return new Ve([])}}const BC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rt extends vl{construct(e,t,r){return new rt(e,t,r)}static isValidIdentifier(e){return BC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new rt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new te(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new te(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new te(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rt(t)}static emptyPath(){return new rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Ve.fromString(e))}static fromName(e){return new ee(Ve.fromString(e).popFirst(5))}static empty(){return new ee(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ve.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Ve(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function $f(n){return n.fields.find(e=>e.kind===2)}function Ws(n){return n.fields.filter(e=>e.kind!==2)}Fu.UNKNOWN_ID=-1;class tu{constructor(e,t){this.fieldPath=e,this.kind=t}}class _l{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _l(0,yn.min())}}function eI(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new it(t+1,0):new it(t,r));return new yn(s,ee.empty(),e)}function tI(n){return new yn(n.readTime,n.key,-1)}class yn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new yn(pe.min(),ee.empty(),-1)}static max(){return new yn(pe.max(),ee.empty(),-1)}}function _m(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ee.comparator(n.documentKey,e.documentKey),t!==0?t:_e(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function As(n){if(n.code!==B.FAILED_PRECONDITION||n.message!==nI)throw n;G("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):O.reject(t)}static resolve(e){return new O((t,r)=>{t(e)})}static reject(e){return new O((t,r)=>{r(e)})}static waitFor(e){return new O((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=O.resolve(!1);for(const r of e)t=t.next(s=>s?O.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const d=u;t(e[d]).next(f=>{o[d]=f,++a,a===i&&r(o)},f=>s(f))}})}static doWhile(e,t){return new O((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new gs,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new qa(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=xm(r.target.error);this.V.reject(new qa(e,s))}}static open(e,t,r,s){try{return new Td(t,e.transaction(s,r))}catch(i){throw new qa(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(G("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new qC(t)}}class ys{constructor(e,t,r){this.name=e,this.version=t,this.p=r,ys.S(Et())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return G("SimpleDb","Removing database:",e),Qs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ow())return!1;if(ys.v())return!0;const e=Et(),t=ys.S(e),r=0<t&&t<10,s=sI(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(G("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new qa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new te(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new te(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new qa(e,o))},s.onupgradeneeded=i=>{G("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{G("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Td.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(d=>(a.g(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,d=u.name!=="FirebaseError"&&o<3;if(G("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class $C{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Qs(this.B.delete())}}class qa extends te{constructor(e,t){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Rs(n){return n.name==="IndexedDbTransactionError"}class qC{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(G("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(G("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Qs(r)}add(e){return G("SimpleDb","ADD",this.store.name,e,e),Qs(this.store.add(e))}get(e){return Qs(this.store.get(e)).next(t=>(t===void 0&&(t=null),G("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return G("SimpleDb","DELETE",this.store.name,e),Qs(this.store.delete(e))}count(){return G("SimpleDb","COUNT",this.store.name),Qs(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){G("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new O((r,s)=>{t.onerror=i=>{const o=xm(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new $C(a),d=t(a.primaryKey,a.value,u);if(d instanceof O){const f=d.catch(m=>(u.done(),O.reject(m)));r.push(f)}u.isDone?s():u.K===null?a.continue():a.continue(u.K)}}).next(()=>O.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Qs(n){return new O((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=xm(r.target.error);t(s)}})}let Ev=!1;function xm(n){const e=ys.S(Et());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new te("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ev||(Ev=!0,setTimeout(()=>{throw r},0)),r}}return n}class GC{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){G("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{G("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Rs(t)?G("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await As(t)}await this.X(6e4)})}}class HC{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return G("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(G("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=tI(i);_m(o,r)>0&&(r=o)}),new yn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}tn.oe=-1;function Ed(n){return n==null}function xl(n){return n===0&&1/n==-1/0}function iI(n){return typeof n=="number"&&Number.isInteger(n)&&!xl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=bv(e)),e=KC(n.get(t),e);return bv(e)}function KC(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function bv(n){return n+""}function Yn(n){const e=n.length;if(de(e>=2),e===2)return de(n.charAt(0)===""&&n.charAt(1)===""),Ve.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&oe(),n.charAt(o+1)){case"":const a=n.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:oe()}i=o+2}return new Ve(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(n,e){return[n,Wt(e)]}function oI(n,e,t){return[n,Wt(e),t]}const WC={},QC=["prefixPath","collectionGroup","readTime","documentId"],YC=["prefixPath","collectionGroup","documentId"],JC=["collectionGroup","readTime","prefixPath","documentId"],XC=["canonicalId","targetId"],ZC=["targetId","path"],eA=["path","targetId"],tA=["collectionId","parent"],nA=["indexId","uid"],rA=["uid","sequenceNumber"],sA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],iA=["indexId","uid","orderedDocumentKey"],oA=["userId","collectionPath","documentId"],aA=["userId","collectionPath","largestBatchId"],lA=["userId","collectionGroup","largestBatchId"],aI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],cA=[...aI,"documentOverlays"],lI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],cI=lI,wm=[...cI,"indexConfiguration","indexState","indexEntries"],uA=wm,dA=[...wm,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends rI{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function bt(n,e){const t=ce(n);return ys.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ti(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,t){this.comparator=e,this.root=t||jt.EMPTY}insert(e,t){return new $e(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new $e(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pc(this.root,e,this.comparator,!0)}}class Pc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??jt.RED,this.left=s??jt.EMPTY,this.right=i??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new jt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return jt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(e,t,r,s,i){return this}insert(e,t,r){return new jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.comparator=e,this.data=new $e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kv(this.data.getIterator())}getIteratorFrom(e){return new kv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Fe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Fe(this.comparator);return t.data=e,t}}class kv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(rt.comparator)}static empty(){return new nn([])}unionWith(e){let t=new Fe(rt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new nn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ko(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new dI("Invalid base64 string: "+i):i}}(e);return new mt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new mt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const hA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(n){if(de(!!n),typeof n=="string"){let e=0;const t=hA.exec(n);if(de(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(n.seconds),nanos:Ye(n.nanos)}}function Ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Es(n){return typeof n=="string"?mt.fromBase64String(n):mt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Tm(n){const e=n.mapValue.fields.__previous_value__;return Im(e)?Tm(e):e}function wl(n){const e=Ar(n.mapValue.fields.__local_write_time__.timestampValue);return new it(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,r,s,i,o,a,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=d}}class pi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof pi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ru={nullValue:"NULL_VALUE"};function mi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Im(n)?4:hI(n)?9007199254740991:bd(n)?10:11:oe()}function rr(n,e){if(n===e)return!0;const t=mi(n);if(t!==mi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wl(n).isEqual(wl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ar(s.timestampValue),a=Ar(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Es(s.bytesValue).isEqual(Es(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Ye(s.geoPointValue.latitude)===Ye(i.geoPointValue.latitude)&&Ye(s.geoPointValue.longitude)===Ye(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ye(s.integerValue)===Ye(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ye(s.doubleValue),a=Ye(i.doubleValue);return o===a?xl(o)===xl(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ko(n.arrayValue.values||[],e.arrayValue.values||[],rr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Nv(o)!==Nv(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!rr(o[u],a[u])))return!1;return!0}(n,e);default:return oe()}}function Il(n,e){return(n.values||[]).find(t=>rr(t,e))!==void 0}function bs(n,e){if(n===e)return 0;const t=mi(n),r=mi(e);if(t!==r)return _e(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return _e(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ye(i.integerValue||i.doubleValue),u=Ye(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return Cv(n.timestampValue,e.timestampValue);case 4:return Cv(wl(n),wl(e));case 5:return _e(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Es(i),u=Es(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let d=0;d<a.length&&d<u.length;d++){const f=_e(a[d],u[d]);if(f!==0)return f}return _e(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=_e(Ye(i.latitude),Ye(o.latitude));return a!==0?a:_e(Ye(i.longitude),Ye(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Av(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,u,d,f;const m=i.fields||{},y=o.fields||{},_=(a=m.value)===null||a===void 0?void 0:a.arrayValue,R=(u=y.value)===null||u===void 0?void 0:u.arrayValue,A=_e(((d=_==null?void 0:_.values)===null||d===void 0?void 0:d.length)||0,((f=R==null?void 0:R.values)===null||f===void 0?void 0:f.length)||0);return A!==0?A:Av(_,R)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===rs.mapValue&&o===rs.mapValue)return 0;if(i===rs.mapValue)return 1;if(o===rs.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const y=_e(u[m],f[m]);if(y!==0)return y;const _=bs(a[u[m]],d[f[m]]);if(_!==0)return _}return _e(u.length,f.length)}(n.mapValue,e.mapValue);default:throw oe()}}function Cv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return _e(n,e);const t=Ar(n),r=Ar(e),s=_e(t.seconds,r.seconds);return s!==0?s:_e(t.nanos,r.nanos)}function Av(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=bs(t[s],r[s]);if(i)return i}return _e(t.length,r.length)}function Co(n){return Gf(n)}function Gf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ar(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Es(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ee.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Gf(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Gf(t.fields[o])}`;return s+"}"}(n.mapValue):oe()}function Em(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Hf(n){return!!n&&"integerValue"in n}function Tl(n){return!!n&&"arrayValue"in n}function Rv(n){return!!n&&"nullValue"in n}function Pv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function su(n){return!!n&&"mapValue"in n}function bd(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ga(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ti(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ga(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ga(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const fI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function pA(n){return"nullValue"in n?ru:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Em(pi.empty(),ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?bd(n)?fI:{mapValue:{}}:oe()}function mA(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Em(pi.empty(),ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fI:"mapValue"in n?bd(n)?{mapValue:{}}:rs:oe()}function Dv(n,e){const t=bs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function jv(n,e){const t=bs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.value=e}static empty(){return new qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!su(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ga(t)}setAll(e){let t=rt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ga(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());su(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];su(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ti(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new qt(Ga(this.value))}}function pI(n){const e=[];return Ti(n.fields,(t,r)=>{const s=new rt([t]);if(su(r)){const i=pI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dt(e,0,pe.min(),pe.min(),pe.min(),qt.empty(),0)}static newFoundDocument(e,t,r,s){return new dt(e,1,t,pe.min(),r,s,0)}static newNoDocument(e,t){return new dt(e,2,t,pe.min(),pe.min(),qt.empty(),0)}static newUnknownDocument(e,t){return new dt(e,3,t,pe.min(),pe.min(),qt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t){this.position=e,this.inclusive=t}}function Vv(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),t.key):r=bs(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!rr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,t="asc"){this.field=e,this.dir=t}}function gA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{}class ke extends mI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new yA(e,t,r):t==="array-contains"?new xA(e,r):t==="in"?new wI(e,r):t==="not-in"?new wA(e,r):t==="array-contains-any"?new IA(e,r):new ke(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new vA(e,r):new _A(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(bs(t,this.value)):t!==null&&mi(this.value)===mi(t)&&this.matchesComparison(bs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Le extends mI{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Le(e,t)}matches(e){return Ro(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ro(n){return n.op==="and"}function Kf(n){return n.op==="or"}function bm(n){return gI(n)&&Ro(n)}function gI(n){for(const e of n.filters)if(e instanceof Le)return!1;return!0}function Wf(n){if(n instanceof ke)return n.field.canonicalString()+n.op.toString()+Co(n.value);if(bm(n))return n.filters.map(e=>Wf(e)).join(",");{const e=n.filters.map(t=>Wf(t)).join(",");return`${n.op}(${e})`}}function yI(n,e){return n instanceof ke?function(r,s){return s instanceof ke&&r.op===s.op&&r.field.isEqual(s.field)&&rr(r.value,s.value)}(n,e):n instanceof Le?function(r,s){return s instanceof Le&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&yI(o,s.filters[a]),!0):!1}(n,e):void oe()}function vI(n,e){const t=n.filters.concat(e);return Le.create(t,n.op)}function _I(n){return n instanceof ke?function(t){return`${t.field.canonicalString()} ${t.op} ${Co(t.value)}`}(n):n instanceof Le?function(t){return t.op.toString()+" {"+t.getFilters().map(_I).join(" ,")+"}"}(n):"Filter"}class yA extends ke{constructor(e,t,r){super(e,t,r),this.key=ee.fromName(r.referenceValue)}matches(e){const t=ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class vA extends ke{constructor(e,t){super(e,"in",t),this.keys=xI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _A extends ke{constructor(e,t){super(e,"not-in",t),this.keys=xI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ee.fromName(r.referenceValue))}class xA extends ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Tl(t)&&Il(t.arrayValue,this.value)}}class wI extends ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Il(this.value.arrayValue,t)}}class wA extends ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Il(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Il(this.value.arrayValue,t)}}class IA extends ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Tl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Il(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Qf(n,e=null,t=[],r=[],s=null,i=null,o=null){return new TA(n,e,t,r,s,i,o)}function gi(n){const e=ce(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Wf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ed(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Co(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Co(r)).join(",")),e.ue=t}return e.ue}function Ll(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!gA(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mv(n.startAt,e.startAt)&&Mv(n.endAt,e.endAt)}function Uu(n){return ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Bu(n,e){return n.filters.filter(t=>t instanceof ke&&t.field.isEqual(e))}function Ov(n,e,t){let r=ru,s=!0;for(const i of Bu(n,e)){let o=ru,a=!0;switch(i.op){case"<":case"<=":o=pA(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ru}Dv({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Dv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Lv(n,e,t){let r=rs,s=!0;for(const i of Bu(n,e)){let o=rs,a=!0;switch(i.op){case">=":case">":o=mA(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=rs}jv({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];jv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function II(n,e,t,r,s,i,o,a){return new Sd(n,e,t,r,s,i,o,a)}function Nd(n){return new Sd(n)}function Fv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function EA(n){return n.collectionGroup!==null}function Ha(n){const e=ce(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Fe(rt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new zu(i,r))}),t.has(rt.keyField().canonicalString())||e.ce.push(new zu(rt.keyField(),r))}return e.ce}function pn(n){const e=ce(n);return e.le||(e.le=bA(e,Ha(n))),e.le}function bA(n,e){if(n.limitType==="F")return Qf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new zu(s.field,i)});const t=n.endAt?new Ao(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ao(n.startAt.position,n.startAt.inclusive):null;return Qf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yf(n,e,t){return new Sd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kd(n,e){return Ll(pn(n),pn(e))&&n.limitType===e.limitType}function TI(n){return`${gi(pn(n))}|lt:${n.limitType}`}function Gi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>_I(s)).join(", ")}]`),Ed(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Co(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Co(s)).join(",")),`Target(${r})`}(pn(n))}; limitType=${n.limitType})`}function Fl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Ha(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const d=Vv(o,a,u);return o.inclusive?d<=0:d<0}(r.startAt,Ha(r),s)||r.endAt&&!function(o,a,u){const d=Vv(o,a,u);return o.inclusive?d>=0:d>0}(r.endAt,Ha(r),s))}(n,e)}function EI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bI(n){return(e,t)=>{let r=!1;for(const s of Ha(n)){const i=SA(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function SA(n,e,t){const r=n.field.isKeyField()?ee.comparator(e.key,t.key):function(i,o,a){const u=o.data.field(i),d=a.data.field(i);return u!==null&&d!==null?bs(u,d):oe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ti(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return uI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=new $e(ee.comparator);function hn(){return NA}const SI=new $e(ee.comparator);function Aa(...n){let e=SI;for(const t of n)e=e.insert(t.key,t);return e}function NI(n){let e=SI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Jn(){return Ka()}function kI(){return Ka()}function Ka(){return new Ps(n=>n.toString(),(n,e)=>n.isEqual(e))}const kA=new $e(ee.comparator),CA=new Fe(ee.comparator);function Te(...n){let e=CA;for(const t of n)e=e.add(t);return e}const AA=new Fe(_e);function Sm(){return AA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xl(e)?"-0":e}}function CI(n){return{integerValue:""+n}}function AI(n,e){return iI(e)?CI(e):Nm(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(){this._=void 0}}function RA(n,e,t){return n instanceof El?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Im(i)&&(i=Tm(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Po?PI(n,e):n instanceof Do?DI(n,e):function(s,i){const o=RI(s,i),a=zv(o)+zv(s.Pe);return Hf(o)&&Hf(s.Pe)?CI(a):Nm(s.serializer,a)}(n,e)}function PA(n,e,t){return n instanceof Po?PI(n,e):n instanceof Do?DI(n,e):t}function RI(n,e){return n instanceof jo?function(r){return Hf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class El extends Cd{}class Po extends Cd{constructor(e){super(),this.elements=e}}function PI(n,e){const t=jI(e);for(const r of n.elements)t.some(s=>rr(s,r))||t.push(r);return{arrayValue:{values:t}}}class Do extends Cd{constructor(e){super(),this.elements=e}}function DI(n,e){let t=jI(e);for(const r of n.elements)t=t.filter(s=>!rr(s,r));return{arrayValue:{values:t}}}class jo extends Cd{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function zv(n){return Ye(n.integerValue||n.doubleValue)}function jI(n){return Tl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t){this.field=e,this.transform=t}}function DA(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Po&&s instanceof Po||r instanceof Do&&s instanceof Do?ko(r.elements,s.elements,rr):r instanceof jo&&s instanceof jo?rr(r.Pe,s.Pe):r instanceof El&&s instanceof El}(n.transform,e.transform)}class jA{constructor(e,t){this.version=e,this.transformResults=t}}class kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kt}static exists(e){return new kt(void 0,e)}static updateTime(e){return new kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function iu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ad{}function MI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new zl(n.key,kt.none()):new Qo(n.key,n.data,kt.none());{const t=n.data,r=qt.empty();let s=new Fe(rt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Pr(n.key,r,new nn(s.toArray()),kt.none())}}function VA(n,e,t){n instanceof Qo?function(s,i,o){const a=s.value.clone(),u=Bv(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Pr?function(s,i,o){if(!iu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Bv(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(OI(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wa(n,e,t,r){return n instanceof Qo?function(i,o,a,u){if(!iu(i.precondition,o))return a;const d=i.value.clone(),f=$v(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Pr?function(i,o,a,u){if(!iu(i.precondition,o))return a;const d=$v(i.fieldTransforms,u,o),f=o.data;return f.setAll(OI(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(i,o,a){return iu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function MA(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=RI(r.transform,s||null);i!=null&&(t===null&&(t=qt.empty()),t.set(r.field,i))}return t||null}function Uv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ko(r,s,(i,o)=>DA(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Qo extends Ad{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Pr extends Ad{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function OI(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Bv(n,e,t){const r=new Map;de(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,PA(o,a,t[s]))}return r}function $v(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,RA(i,o,e))}return r}class zl extends Ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends Ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&VA(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=kI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=MI(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Te())}isEqual(e){return this.batchId===e.batchId&&ko(this.mutations,e.mutations,(t,r)=>Uv(t,r))&&ko(this.baseMutations,e.baseMutations,(t,r)=>Uv(t,r))}}class Cm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){de(e.mutations.length===r.length);let s=function(){return kA}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Cm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt,Ce;function LA(n){switch(n){default:return oe();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function FI(n){if(n===void 0)return ft("GRPC error has no .code"),B.UNKNOWN;switch(n){case yt.OK:return B.OK;case yt.CANCELLED:return B.CANCELLED;case yt.UNKNOWN:return B.UNKNOWN;case yt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case yt.INTERNAL:return B.INTERNAL;case yt.UNAVAILABLE:return B.UNAVAILABLE;case yt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case yt.NOT_FOUND:return B.NOT_FOUND;case yt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case yt.ABORTED:return B.ABORTED;case yt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case yt.DATA_LOSS:return B.DATA_LOSS;default:return oe()}}(Ce=yt||(yt={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=new si([4294967295,4294967295],0);function qv(n){const e=FA().encode(n),t=new Hw;return t.update(e),new Uint8Array(t.digest())}function Gv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new si([t,r],0),new si([s,i],0)]}class Rm{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ra(`Invalid padding: ${t}`);if(r<0)throw new Ra(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ra(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ra(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=si.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(si.fromNumber(r)));return s.compare(zA)===1&&(s=new si([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=qv(e),[r,s]=Gv(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Rm(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=qv(e),[r,s]=Gv(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Bl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ul(pe.min(),s,new $e(_e),hn(),Te())}}class Bl{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Bl(r,t,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class zI{constructor(e,t){this.targetId=e,this.me=t}}class UI{constructor(e,t,r=mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Hv{constructor(){this.fe=0,this.ge=Wv(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Te(),t=Te(),r=Te();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:oe()}}),new Bl(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Wv()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,de(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class UA{constructor(e){this.Le=e,this.Be=new Map,this.ke=hn(),this.qe=Kv(),this.Qe=new $e(_e)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:oe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Uu(i))if(r===0){const o=new ee(i.path);this.Ue(t,o,dt.newNoDocument(o,pe.min()))}else de(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Es(r).toUint8Array()}catch(u){if(u instanceof dI)return yl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Rm(o,s,i)}catch(u){return yl(u instanceof Ra?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Uu(a.target)){const u=new ee(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,dt.newNoDocument(u,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=Te();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Ul(e,t,this.Qe,this.ke,r);return this.ke=hn(),this.qe=Kv(),this.Qe=new $e(_e),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Hv,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Fe(_e),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||G("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hv),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Kv(){return new $e(ee.comparator)}function Wv(){return new $e(ee.comparator)}const BA={asc:"ASCENDING",desc:"DESCENDING"},$A={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qA={and:"AND",or:"OR"};class GA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Jf(n,e){return n.useProto3Json||Ed(e)?e:{value:e}}function Vo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function HA(n,e){return Vo(n,e.toTimestamp())}function Qt(n){return de(!!n),pe.fromTimestamp(function(t){const r=Ar(t);return new it(r.seconds,r.nanos)}(n))}function Pm(n,e){return Xf(n,e).canonicalString()}function Xf(n,e){const t=function(s){return new Ve(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function $I(n){const e=Ve.fromString(n);return de(XI(e)),e}function $u(n,e){return Pm(n.databaseId,e.path)}function ii(n,e){const t=$I(e);if(t.get(1)!==n.databaseId.projectId)throw new te(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ee(HI(t))}function qI(n,e){return Pm(n.databaseId,e)}function GI(n){const e=$I(n);return e.length===4?Ve.emptyPath():HI(e)}function Zf(n){return new Ve(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function HI(n){return de(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Qv(n,e,t){return{name:$u(n,e),fields:t.value.mapValue.fields}}function KA(n,e,t){const r=ii(n,e.name),s=Qt(e.updateTime),i=e.createTime?Qt(e.createTime):pe.min(),o=new qt({mapValue:{fields:e.fields}}),a=dt.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function WA(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(de(f===void 0||typeof f=="string"),mt.fromBase64String(f||"")):(de(f===void 0||f instanceof Buffer||f instanceof Uint8Array),mt.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const f=d.code===void 0?B.UNKNOWN:FI(d.code);return new te(f,d.message||"")}(o);t=new UI(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ii(n,r.document.name),i=Qt(r.document.updateTime),o=r.document.createTime?Qt(r.document.createTime):pe.min(),a=new qt({mapValue:{fields:r.document.fields}}),u=dt.newFoundDocument(s,i,o,a),d=r.targetIds||[],f=r.removedTargetIds||[];t=new ou(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ii(n,r.document),i=r.readTime?Qt(r.readTime):pe.min(),o=dt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new ou([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ii(n,r.document),i=r.removedTargetIds||[];t=new ou([],i,s,null)}else{if(!("filter"in e))return oe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new OA(s,i),a=r.targetId;t=new zI(a,o)}}return t}function qu(n,e){let t;if(e instanceof Qo)t={update:Qv(n,e.key,e.value)};else if(e instanceof zl)t={delete:$u(n,e.key)};else if(e instanceof Pr)t={update:Qv(n,e.key,e.data),updateMask:e2(e.fieldMask)};else{if(!(e instanceof LI))return oe();t={verify:$u(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof El)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Do)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof jo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw oe()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:HA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:oe()}(n,e.precondition)),t}function ep(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?kt.updateTime(Qt(i.updateTime)):i.exists!==void 0?kt.exists(i.exists):kt.none()}(e.currentDocument):kt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)de(a.setToServerValue==="REQUEST_TIME"),u=new El;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];u=new Po(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];u=new Do(f)}else"increment"in a?u=new jo(o,a.increment):oe();const d=rt.fromServerFormat(a.fieldPath);return new VI(d,u)}(n,s)):[];if(e.update){e.update.name;const s=ii(n,e.update.name),i=new qt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const d=u.fieldPaths||[];return new nn(d.map(f=>rt.fromServerFormat(f)))}(e.updateMask);return new Pr(s,i,o,t,r)}return new Qo(s,i,t,r)}if(e.delete){const s=ii(n,e.delete);return new zl(s,t)}if(e.verify){const s=ii(n,e.verify);return new LI(s,t)}return oe()}function QA(n,e){return n&&n.length>0?(de(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Qt(s.updateTime):Qt(i);return o.isEqual(pe.min())&&(o=Qt(i)),new jA(o,s.transformResults||[])}(t,e))):[]}function KI(n,e){return{documents:[qI(n,e.path)]}}function WI(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=qI(n,s);const i=function(d){if(d.length!==0)return JI(Le.create(d,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(y){return{field:Hi(y.field),direction:JA(y.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Jf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:s}}function QI(n){let e=GI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){de(r===1);const f=t.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=function(m){const y=YI(m);return y instanceof Le&&bm(y)?y.getFilters():[y]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(y=>function(R){return new zu(Ki(R.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(y))}(t.orderBy));let a=null;t.limit&&(a=function(m){let y;return y=typeof m=="object"?m.value:m,Ed(y)?null:y}(t.limit));let u=null;t.startAt&&(u=function(m){const y=!!m.before,_=m.values||[];return new Ao(_,y)}(t.startAt));let d=null;return t.endAt&&(d=function(m){const y=!m.before,_=m.values||[];return new Ao(_,y)}(t.endAt)),II(e,s,o,i,a,"F",u,d)}function YA(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function YI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ki(t.unaryFilter.field);return ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ki(t.unaryFilter.field);return ke.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ki(t.unaryFilter.field);return ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ki(t.unaryFilter.field);return ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(n):n.fieldFilter!==void 0?function(t){return ke.create(Ki(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Le.create(t.compositeFilter.filters.map(r=>YI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe()}}(t.compositeFilter.op))}(n):oe()}function JA(n){return BA[n]}function XA(n){return $A[n]}function ZA(n){return qA[n]}function Hi(n){return{fieldPath:n.canonicalString()}}function Ki(n){return rt.fromServerFormat(n.fieldPath)}function JI(n){return n instanceof ke?function(t){if(t.op==="=="){if(Pv(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NAN"}};if(Rv(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Pv(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NAN"}};if(Rv(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hi(t.field),op:XA(t.op),value:t.value}}}(n):n instanceof Le?function(t){const r=t.getFilters().map(s=>JI(s));return r.length===1?r[0]:{compositeFilter:{op:ZA(t.op),filters:r}}}(n):oe()}function e2(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function XI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t,r,s,i=pe.min(),o=pe.min(),a=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.ct=e}}function t2(n,e){let t;if(e.document)t=KA(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=vi(e.noDocument.readTime);t=dt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return oe();{const r=ee.fromSegments(e.unknownDocument.path),s=vi(e.unknownDocument.version);t=dt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new it(s[0],s[1]);return pe.fromTimestamp(i)}(e.readTime)),t}function Yv(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Gu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:$u(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Vo(i,o.version.toTimestamp()),createTime:Vo(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:yi(e.version)};else{if(!e.isUnknownDocument())return oe();r.unknownDocument={path:t.path.toArray(),version:yi(e.version)}}return r}function Gu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function yi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vi(n){const e=new it(n.seconds,n.nanoseconds);return pe.fromTimestamp(e)}function Ys(n,e){const t=(e.baseMutations||[]).map(i=>ep(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>ep(n.ct,i)),s=it.fromMillis(e.localWriteTimeMs);return new km(e.batchId,s,t,r)}function Pa(n){const e=vi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?vi(n.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return de(i.documents.length===1),pn(Nd(GI(i.documents[0])))}(n.query):function(i){return pn(QI(i))}(n.query),new _r(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,mt.fromBase64String(n.resumeToken))}function eT(n,e){const t=yi(e.snapshotVersion),r=yi(e.lastLimboFreeSnapshotVersion);let s;s=Uu(e.target)?KI(n.ct,e.target):WI(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:gi(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function tT(n){const e=QI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Yf(e,e.limit,"L"):e}function Ph(n,e){return new Am(e.largestBatchId,ep(n.ct,e.overlayMutation))}function Jv(n,e){const t=e.path.lastSegment();return[n,Wt(e.path.popLast()),t]}function Xv(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:yi(r.readTime),documentKey:Wt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{getBundleMetadata(e,t){return Zv(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:vi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Zv(e).put(function(s){return{bundleId:s.id,createTime:yi(Qt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return e0(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:tT(i.bundledQuery),readTime:vi(i.readTime)}}(r)})}saveNamedQuery(e,t){return e0(e).put(function(s){return{name:s.name,readTime:yi(Qt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Zv(n){return bt(n,"bundles")}function e0(n){return bt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Rd(e,r)}getOverlay(e,t){return xa(e).get(Jv(this.userId,t)).next(r=>r?Ph(this.serializer,r):null)}getOverlays(e,t){const r=Jn();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Am(t,o);s.push(this.ht(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Wt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(xa(e).j("collectionPathOverlayIndex",a))}),O.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Jn(),i=Wt(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return xa(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const d=Ph(this.serializer,u);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Jn();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xa(e).J({index:"collectionGroupOverlayIndex",range:a},(u,d,f)=>{const m=Ph(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>i)}ht(e,t){return xa(e).put(function(s,i,o){const[a,u,d]=Jv(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:qu(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function xa(n){return bt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{Pt(e){return bt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?mt.fromUint8Array(r):mt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ye(e.integerValue));else if("doubleValue"in e){const r=Ye(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),xl(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ar(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Es(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?hI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):bd(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):oe()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Ye(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),ee.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Js.vt=new Js;function s2(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function t0(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=s2(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class i2{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=t0(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=t0(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class o2{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class a2{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class wa{constructor(){this.jt=new i2,this.Ht=new o2(this.jt),this.Jt=new a2(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Xs(this.indexId,this.documentKey,this.arrayValue,r)}}function $r(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=n0(n.arrayValue,e.arrayValue),t!==0?t:(t=n0(n.directionalValue,e.directionalValue),t!==0?t:ee.comparator(n.documentKey,e.documentKey)))}function n0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e){this.Xt=new Fe((t,r)=>rt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(de(e.collectionGroup===this.collectionId),this.nn)return!1;const t=$f(e);if(t!==void 0&&!this.sn(t))return!1;const r=Ws(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Fe(rt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new tu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new tu(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new tu(r.field,r.dir==="asc"?0:1)));return new Fu(Fu.UNKNOWN_ID,this.collectionId,t,_l.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(n){var e,t;if(de(n instanceof ke||n instanceof Le),n instanceof ke){if(n instanceof wI){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ke.create(n.field,"==",i)))||[];return Le.create(s,"or")}return n}const r=n.filters.map(s=>nT(s));return Le.create(r,n.op)}function l2(n){if(n.getFilters().length===0)return[];const e=rp(nT(n));return de(rT(e)),tp(e)||np(e)?[e]:e.getFilters()}function tp(n){return n instanceof ke}function np(n){return n instanceof Le&&bm(n)}function rT(n){return tp(n)||np(n)||function(t){if(t instanceof Le&&Kf(t)){for(const r of t.getFilters())if(!tp(r)&&!np(r))return!1;return!0}return!1}(n)}function rp(n){if(de(n instanceof ke||n instanceof Le),n instanceof ke)return n;if(n.filters.length===1)return rp(n.filters[0]);const e=n.filters.map(r=>rp(r));let t=Le.create(e,n.op);return t=Hu(t),rT(t)?t:(de(t instanceof Le),de(Ro(t)),de(t.filters.length>1),t.filters.reduce((r,s)=>Dm(r,s)))}function Dm(n,e){let t;return de(n instanceof ke||n instanceof Le),de(e instanceof ke||e instanceof Le),t=n instanceof ke?e instanceof ke?function(s,i){return Le.create([s,i],"and")}(n,e):s0(n,e):e instanceof ke?s0(e,n):function(s,i){if(de(s.filters.length>0&&i.filters.length>0),Ro(s)&&Ro(i))return vI(s,i.getFilters());const o=Kf(s)?s:i,a=Kf(s)?i:s,u=o.filters.map(d=>Dm(d,a));return Le.create(u,"or")}(n,e),Hu(t)}function s0(n,e){if(Ro(e))return vI(e,n.getFilters());{const t=e.filters.map(r=>Dm(n,r));return Le.create(t,"or")}}function Hu(n){if(de(n instanceof ke||n instanceof Le),n instanceof ke)return n;const e=n.getFilters();if(e.length===1)return Hu(e[0]);if(gI(n))return n;const t=e.map(s=>Hu(s)),r=[];return t.forEach(s=>{s instanceof ke?r.push(s):s instanceof Le&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Le.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(){this.un=new jm}addToCollectionParentIndex(e,t){return this.un.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(yn.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(yn.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class jm{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Fe(Ve.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Fe(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=new Uint8Array(0);class u2{constructor(e,t){this.databaseId=t,this.cn=new jm,this.ln=new Ps(r=>gi(r),(r,s)=>Ll(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:Wt(s)};return i0(e).put(i)}return O.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Zw(t),""],!1,!0);return i0(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Yn(o.parent))}return r})}addFieldIndex(e,t){const r=Ia(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Ui(e);return i.next(a=>{o.put(Xv(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Ia(e),s=Ui(e),i=zi(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ia(e),r=zi(e),s=Ui(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return O.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new r0(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=zi(e);let s=!0;const i=new Map;return O.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Te();const a=[];return O.forEach(i,(u,d)=>{G("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(u)} to execute ${gi(t)}`);const f=function(b,I){const D=$f(I);if(D===void 0)return null;for(const P of Bu(b,D.fieldPath))switch(P.op){case"array-contains-any":return P.value.arrayValue.values||[];case"array-contains":return[P.value]}return null}(d,u),m=function(b,I){const D=new Map;for(const P of Ws(I))for(const w of Bu(b,P.fieldPath))switch(w.op){case"==":case"in":D.set(P.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return D.set(P.fieldPath.canonicalString(),w.value),Array.from(D.values())}return null}(d,u),y=function(b,I){const D=[];let P=!0;for(const w of Ws(I)){const g=w.kind===0?Ov(b,w.fieldPath,b.startAt):Lv(b,w.fieldPath,b.startAt);D.push(g.value),P&&(P=g.inclusive)}return new Ao(D,P)}(d,u),_=function(b,I){const D=[];let P=!0;for(const w of Ws(I)){const g=w.kind===0?Lv(b,w.fieldPath,b.endAt):Ov(b,w.fieldPath,b.endAt);D.push(g.value),P&&(P=g.inclusive)}return new Ao(D,P)}(d,u),R=this.In(u,d,y),A=this.In(u,d,_),k=this.Tn(u,d,m),E=this.En(u.indexId,f,R,y.inclusive,A,_.inclusive,k);return O.forEach(E,v=>r.G(v,t.limit).next(b=>{b.forEach(I=>{const D=ee.fromSegments(I.documentKey);o.has(D)||(o=o.add(D),a.push(D))})}))}).next(()=>a)}return O.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=l2(Le.create(e.filters,"and")).map(r=>Qf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,i.length),d=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){const y=t?this.dn(t[m/d]):Dc,_=this.An(e,y,r[m%d],s),R=this.Rn(e,y,i[m%d],o),A=a.map(k=>this.An(e,y,k,!0));f.push(...this.createRange(_,R,A))}return f}An(e,t,r,s){const i=new Xs(e,ee.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new Xs(e,ee.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new r0(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return O.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let d=new Fe(rt.comparator),f=!1;for(const m of u.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:d=d.add(y.field));for(const m of u.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new wa;for(const s of Ws(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Js.vt.It(i,o)}return r.zt()}dn(e){const t=new wa;return Js.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new wa;return Js.vt.It(Em(this.databaseId,t),r.Yt(function(i){const o=Ws(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new wa);let i=0;for(const o of Ws(e)){const a=r[i++];for(const u of s)if(this.fn(t,o.fieldPath)&&Tl(a))s=this.gn(s,o,a);else{const d=u.Yt(o.kind);Js.vt.It(a,d)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new wa;u.seed(a.zt()),Js.vt.It(o,u.Yt(t.kind)),i.push(u)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ke&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ia(e),s=Ui(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(f,m){const y=m?new _l(m.sequenceNumber,new yn(vi(m.readTime),new ee(Yn(m.documentKey)),m.largestBatchId)):_l.empty(),_=f.fields.map(([R,A])=>new tu(rt.fromServerFormat(R),A));return new Fu(f.indexId,f.collectionGroup,_,y)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:_e(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Ia(e),i=Ui(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>O.forEach(a,u=>i.put(Xv(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return O.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,u=>this.wn(e,s,u).next(d=>{const f=this.Sn(i,u);return d.isEqual(f)?O.resolve():this.bn(e,i,u,d,f)}))))})}Dn(e,t,r,s){return zi(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return zi(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=zi(e);let i=new Fe($r);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new Xs(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new Fe($r);const s=this.Vn(t,e);if(s==null)return r;const i=$f(t);if(i!=null){const o=e.data.field(i.fieldPath);if(Tl(o))for(const a of o.arrayValue.values||[])r=r.add(new Xs(t.indexId,e.key,this.dn(a),s))}else r=r.add(new Xs(t.indexId,e.key,Dc,s));return r}bn(e,t,r,s,i){G("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,d,f,m,y){const _=u.getIterator(),R=d.getIterator();let A=Fi(_),k=Fi(R);for(;A||k;){let E=!1,v=!1;if(A&&k){const b=f(A,k);b<0?v=!0:b>0&&(E=!0)}else A!=null?v=!0:E=!0;E?(m(k),k=Fi(R)):v?(y(A),A=Fi(_)):(A=Fi(_),k=Fi(R))}}(s,i,$r,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),O.waitFor(o)}yn(e){let t=1;return Ui(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>$r(o,a)).filter((o,a,u)=>!a||$r(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=$r(o,e),u=$r(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&u<0)s.push(o),s.push(o.Zt());else if(u>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Dc,[]],u=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Dc,[]];i.push(IDBKeyRange.bound(a,u))}return i}Cn(e,t){return $r(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(o0)}getMinOffset(e,t){return O.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||oe())).next(o0)}}function i0(n){return bt(n,"collectionParents")}function zi(n){return bt(n,"indexEntries")}function Ia(n){return bt(n,"indexConfiguration")}function Ui(n){return bt(n,"indexState")}function o0(n){de(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;_m(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new yn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Xt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Xt(e,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.J({range:o},(f,m,y)=>(a++,y.delete()));i.push(u.next(()=>{de(a===1)}));const d=[];for(const f of t.mutations){const m=oI(e,f.key.path,t.batchId);i.push(s.delete(m)),d.push(f.key)}return O.waitFor(i).next(()=>d)}function Ku(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw oe();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(41943040,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);class Pd{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){de(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Pd(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=Wi(e),o=qr(e);return o.add({}).next(a=>{de(typeof a=="number");const u=new km(a,t,r,s),d=function(_,R,A){const k=A.baseMutations.map(v=>qu(_.ct,v)),E=A.mutations.map(v=>qu(_.ct,v));return{userId:R,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:k,mutations:E}}(this.serializer,this.userId,u),f=[];let m=new Fe((y,_)=>_e(y.canonicalString(),_.canonicalString()));for(const y of s){const _=oI(this.userId,y.key.path,a);m=m.add(y.key.path.popLast()),f.push(o.put(d)),f.push(i.put(_,WC))}return m.forEach(y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),O.waitFor(f).next(()=>u)})}lookupMutationBatch(e,t){return qr(e).get(t).next(r=>r?(de(r.userId===this.userId),Ys(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?O.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return qr(e).J({index:"userMutationsIndex",range:s},(o,a,u)=>{a.userId===this.userId&&(de(a.batchId>=r),i=Ys(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return qr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).U("userMutationsIndex",t).next(r=>r.map(s=>Ys(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=nu(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Wi(e).J({range:s},(o,a,u)=>{const[d,f,m]=o,y=Yn(f);if(d===this.userId&&t.path.isEqual(y))return qr(e).get(m).next(_=>{if(!_)throw oe();de(_.userId===this.userId),i.push(Ys(this.serializer,_))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Fe(_e);const s=[];return t.forEach(i=>{const o=nu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=Wi(e).J({range:a},(d,f,m)=>{const[y,_,R]=d,A=Yn(_);y===this.userId&&i.path.isEqual(A)?r=r.add(R):m.done()});s.push(u)}),O.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=nu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Fe(_e);return Wi(e).J({range:o},(u,d,f)=>{const[m,y,_]=u,R=Yn(y);m===this.userId&&r.isPrefixOf(R)?R.length===s&&(a=a.add(_)):f.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(qr(e).get(i).next(o=>{if(o===null)throw oe();de(o.userId===this.userId),r.push(Ys(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return sT(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Wi(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=Yn(i[1]);s.push(u)}else a.done()}).next(()=>{de(s.length===0)})})}containsKey(e,t){return iT(e,this.userId,t)}Nn(e){return oT(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function iT(n,e,t){const r=nu(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Wi(n).J({range:i,H:!0},(a,u,d)=>{const[f,m,y]=a;f===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function qr(n){return bt(n,"mutations")}function Wi(n){return bt(n,"documentMutations")}function oT(n){return bt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _i(0)}static kn(){return new _i(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new _i(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>pe.fromTimestamp(new it(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Bi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(de(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Bi(e).J((o,a)=>{const u=Pa(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Bi(e).J((r,s)=>{const i=Pa(s);t(i)})}qn(e){return l0(e).get("targetGlobalKey").next(t=>(de(t!==null),t))}Qn(e,t){return l0(e).put("targetGlobalKey",t)}Kn(e,t){return Bi(e).put(eT(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=gi(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Bi(e).J({range:s,index:"queryTargetsIndex"},(o,a,u)=>{const d=Pa(a);Ll(t,d.target)&&(i=d,u.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=es(e);return t.forEach(o=>{const a=Wt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,t,r){const s=es(e);return O.forEach(t,i=>{const o=Wt(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=es(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=es(e);let i=Te();return s.J({range:r,H:!0},(o,a,u)=>{const d=Yn(o[1]),f=new ee(d);i=i.add(f)}).next(()=>i)}containsKey(e,t){const r=Wt(t.path),s=IDBKeyRange.bound([r],[Zw(r)],!1,!0);let i=0;return es(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],u,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,t){return Bi(e).get(t).next(r=>r?Pa(r):null)}}function Bi(n){return bt(n,"targets")}function l0(n){return bt(n,"targetGlobal")}function es(n){return bt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0([n,e],[t,r]){const s=_e(n,t);return s===0?_e(e,r):s}class h2{constructor(e){this.Un=e,this.buffer=new Fe(c0),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();c0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class f2{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){G("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Rs(t)?G("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await As(t)}await this.Hn(3e5)})}}class p2{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return O.resolve(tn.oe);const r=new h2(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(G("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(a0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(G("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),a0):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(G("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,t))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),qi()<=Se.DEBUG&&G("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function m2(n,e){return new p2(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,t){this.db=e,this.garbageCollector=m2(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return jc(e,r)}removeReference(e,t,r){return jc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return jc(e,t)}nr(e,t){return function(s,i){let o=!1;return oT(s).Y(a=>iT(s,a,i).next(u=>(u&&(o=!0),O.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const u=this.nr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),es(e).delete(function(m){return[0,Wt(m.path)]}(o))))});s.push(u)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return jc(e,t)}tr(e,t){const r=es(e);let s,i=tn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:d})=>{o===0?(i!==tn.oe&&t(new ee(Yn(s)),i),i=d,s=u):i=tn.oe}).next(()=>{i!==tn.oe&&t(new ee(Yn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function jc(n,e){return es(n).put(function(r,s){return{targetId:0,path:Wt(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(){this.changes=new Ps(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return qs(e).put(r)}removeEntry(e,t,r){return qs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Gu(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=dt.newInvalidDocument(t);return qs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ta(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:dt.newInvalidDocument(t)};return qs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ta(t))},(s,i)=>{r={document:this.ir(t,i),size:Ku(i)}}).next(()=>r)}getEntries(e,t){let r=hn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=hn(),s=new $e(ee.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Ku(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return O.resolve();let s=new Fe(h0);t.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(Ta(s.first()),Ta(s.last())),o=s.getIterator();let a=o.getNext();return qs(e).J({index:"documentKeyIndex",range:i},(u,d,f)=>{const m=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&h0(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?f.$(Ta(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Gu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qs(e).U(IDBKeyRange.bound(a,u,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let f=hn();for(const m of d){const y=this.ir(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(Fl(t,y)||s.has(y.key))&&(f=f.insert(y.key,y))}return f})}getAllFromCollectionGroup(e,t,r,s){let i=hn();const o=d0(t,r),a=d0(t,yn.max());return qs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,d,f)=>{const m=this.ir(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&f.done()}).next(()=>i)}newChangeBuffer(e){return new v2(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return u0(e).get("remoteDocumentGlobalKey").next(t=>(de(!!t),t))}rr(e,t){return u0(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=t2(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return dt.newInvalidDocument(e)}}function lT(n){return new y2(n)}class v2 extends aT{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Ps(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new Fe((i,o)=>_e(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=Yv(this.cr.serializer,o);s=s.add(i.path.popLast());const d=Ku(u);r+=d-a.size,t.push(this.cr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=Yv(this.cr.serializer,o.convertToNoDocument(pe.min()));t.push(this.cr.addEntry(e,i,u))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),O.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function u0(n){return bt(n,"remoteDocumentGlobal")}function qs(n){return bt(n,"remoteDocumentsV14")}function Ta(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function d0(n,e){const t=e.documentKey.path.toArray();return[n,Gu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function h0(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=_e(t[i],r[i]),s)return s;return s=_e(t.length,r.length),s||(s=_e(t[t.length-2],r[r.length-2]),s||_e(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Wa(r.mutation,s,nn.empty(),it.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Te()){const s=Jn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Aa();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Jn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Te()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=hn();const o=Ka(),a=function(){return Ka()}();return t.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Pr)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),Wa(f.mutation,d,f.mutation.getFieldMask(),it.now())):o.set(d.key,nn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),t.forEach((d,f)=>{var m;return a.set(d,new _2(f,(m=o.get(d))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Ka();let s=new $e((o,a)=>o-a),i=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const d=t.get(u);if(d===null)return;let f=r.get(u)||nn.empty();f=a.applyToLocalView(d,f),r.set(u,f);const m=(s.get(a.batchId)||Te()).add(u);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),d=u.key,f=u.value,m=kI();f.forEach(y=>{if(!i.has(y)){const _=MI(t.get(y),r.get(y));_!==null&&m.set(y,_),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):EA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):O.resolve(Jn());let a=-1,u=i;return o.next(d=>O.forEach(d,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(f)?O.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{u=u.insert(f,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Te())).next(f=>({batchId:a,changes:NI(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next(r=>{let s=Aa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Aa();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,u=>{const d=function(m,y){return new Sd(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,y)=>{o=o.insert(m,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,dt.newInvalidDocument(f)))});let a=Aa();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Wa(f.mutation,d,nn.empty(),it.now()),Fl(t,d)&&(a=a.insert(u,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return O.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Qt(s.createTime)}}(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:tT(s.bundledQuery),readTime:Qt(s.readTime)}}(t)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(){this.overlays=new $e(ee.comparator),this.Ir=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Jn();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),O.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){const s=Jn(),i=t.length+1,o=new ee(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return O.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new $e((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Jn(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const a=Jn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>a.set(d,f)),!(a.size()>=s)););return O.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Am(t,r));let i=this.Ir.get(t);i===void 0&&(i=Te(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(){this.Tr=new Fe(St.Er),this.dr=new Fe(St.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new St(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new St(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new ee(new Ve([])),r=new St(t,e),s=new St(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ee(new Ve([])),r=new St(t,e),s=new St(t,e+1);let i=Te();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new St(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class St{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ee.comparator(e.key,t.key)||_e(e.wr,t.wr)}static Ar(e,t){return _e(e.wr,t.wr)||ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Fe(St.Er)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new km(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new St(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,t){return O.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new St(t,0),s=new St(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Fe(_e);return t.forEach(s=>{const i=new St(s,0),o=new St(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),O.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new St(new ee(i),0);let a=new Fe(_e);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(u.wr)),!0)},o),O.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){de(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return O.forEach(t.mutations,s=>{const i=new St(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new St(t,0),s=this.br.firstAfterOrEqual(r);return O.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e){this.Mr=e,this.docs=function(){return new $e(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(t))}getEntries(e,t){let r=hn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():dt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=hn();const o=t.path,a=new ee(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||_m(tI(f),r)<=0||(s.has(f.key)||Fl(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,t,r,s){oe()}Or(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new b2(this)}getSize(e){return O.resolve(this.size)}}class b2 extends aT{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.persistence=e,this.Nr=new Ps(t=>gi(t),Ll),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vm,this.targetCount=0,this.kr=_i.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),O.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new _i(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Kn(t),O.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),O.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,t){this.qr={},this.overlays={},this.Qr=new tn(0),this.Kr=!1,this.Kr=!0,this.$r=new I2,this.referenceDelegate=e(this),this.Ur=new S2(this),this.indexManager=new c2,this.remoteDocumentCache=function(s){return new E2(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ZI(t),this.Gr=new x2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new w2,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new T2(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){G("MemoryPersistence","Starting transaction:",e);const s=new N2(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return O.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class N2 extends rI{constructor(e){super(),this.currentSequenceNumber=e}}class Dd{constructor(e){this.persistence=e,this.Jr=new Vm,this.Yr=null}static Zr(e){return new Dd(e)}get Xr(){if(this.Yr)return this.Yr;throw oe()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),O.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Xr,r=>{const s=ee.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,pe.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return O.or([()=>O.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Td("createOrUpgrade",t);r<1&&s>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sv,{unique:!0}),u.createObjectStore("documentMutations")}(e),f0(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),f0(e)),o=o.next(()=>function(u){const d=u.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",f)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,d){return d.store("mutations").U().next(f=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sv,{unique:!0});const m=d.store("mutations"),y=f.map(_=>m.put(_));return O.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const d=u.createObjectStore("documentOverlays",{keyPath:oA});d.createIndex("collectionPathOverlayIndex",aA,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",lA,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const d=u.createObjectStore("remoteDocumentsV14",{keyPath:QC});d.createIndex("documentKeyIndex",YC),d.createIndex("collectionGroupIndex",JC)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:nA}).createIndex("sequenceNumberIndex",rA,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:sA}).createIndex("documentKeyIndex",iA,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Ku(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>O.forEach(a,u=>{de(u.userId===i.userId);const d=Ys(this.serializer,u);return sT(e,i.userId,d).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const u=new Ve(o),d=function(m){return[0,Wt(m)]}(u);i.push(t.get(d).next(f=>f?O.resolve():(m=>t.put({targetId:0,path:Wt(m),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>O.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:tA});const r=t.store("collectionParents"),s=new jm,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Wt(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new Ve(o);return i(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],d)=>{const f=Yn(a);return i(f.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Pa(s),o=eT(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),u=function(m){return m.document?new ee(Ve.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):oe()}(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=lT(this.serializer),i=new uT(Dd.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var d;let f=(d=a.get(u.userId))!==null&&d!==void 0?d:Te();Ys(this.serializer,u).keys().forEach(m=>f=f.add(m)),a.set(u.userId,f)}),O.forEach(a,(u,d)=>{const f=new Bt(d),m=Rd.lt(this.serializer,f),y=i.getIndexManager(f),_=Pd.lt(f,this.serializer,y,i.referenceDelegate);return new cT(s,_,m,y).recalculateAndSaveOverlaysForDocumentKeys(new qf(t,tn.oe),u).next()})})}}function f0(n){n.createObjectStore("targetDocuments",{keyPath:ZC}).createIndex("documentTargetsIndex",eA,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",XC,{unique:!0}),n.createObjectStore("targetGlobal")}const Dh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Mm{constructor(e,t,r,s,i,o,a,u,d,f,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=d,this.li=f,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=y=>Promise.resolve(),!Mm.D())throw new te(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new g2(this,s),this.Ai=t+"main",this.serializer=new ZI(u),this.Ri=new ys(this.Ai,this.hi,new k2(this.serializer)),this.$r=new r2,this.Ur=new d2(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lT(this.serializer),this.Gr=new n2,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,f===!1&&ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new te(B.FAILED_PRECONDITION,Dh);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new tn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Vc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Rs(e))return G("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return G("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ea(e).get("owner").next(t=>O.resolve(this.vi(t)))}Ci(e){return Vc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=bt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?O.resolve(!0):Ea(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new te(B.FAILED_PRECONDITION,Dh);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&G("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new qf(e,tn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Vc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Pd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new u2(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Rd.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){G("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(u){return u===17?dA:u===16?uA:u===15?wm:u===14?cI:u===13?lI:u===12?cA:u===11?aI:void oe()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new qf(a,this.Qr?this.Qr.next():tn.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new te(B.FAILED_PRECONDITION,nI);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Ea(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new te(B.FAILED_PRECONDITION,Dh)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ea(e).put("owner",t)}static D(){return ys.D()}bi(e){const t=Ea(e);return t.get("owner").next(r=>this.vi(r)?(G("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):O.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(ft(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;iw()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return G("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ft("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ea(n){return bt(n,"owner")}function Vc(n){return bt(n,"clientMetadata")}function dT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Te(),s=Te();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Om(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return iw()?8:sI(Et())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new C2;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(qi()<=Se.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",Gi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),O.resolve()):(qi()<=Se.DEBUG&&G("QueryEngine","Query:",Gi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(qi()<=Se.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",Gi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(t))):O.resolve())}Yi(e,t){if(Fv(t))return O.resolve(null);let r=pn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Yf(t,null,"F"),r=pn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Te(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(t,a);return this.ns(t,d,o,u.readTime)?this.Yi(e,Yf(t,null,"F")):this.rs(e,d,t,u)}))})))}Zi(e,t,r,s){return Fv(t)||s.isEqual(pe.min())?O.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?O.resolve(null):(qi()<=Se.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gi(t)),this.rs(e,o,t,eI(s,-1)).next(a=>a))})}ts(e,t){let r=new Fe(bI(e));return t.forEach((s,i)=>{Fl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return qi()<=Se.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",Gi(t)),this.Ji.getDocumentsMatchingQuery(e,t,yn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new $e(_e),this._s=new Ps(i=>gi(i),Ll),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function fT(n,e,t,r){return new A2(n,e,t,r)}async function pT(n,e){const t=ce(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=Te();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:a}))})})}function R2(n,e){const t=ce(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,d,f){const m=d.batch,y=m.keys();let _=O.resolve();return y.forEach(R=>{_=_.next(()=>f.getEntry(u,R)).next(A=>{const k=d.docVersions.get(R);de(k!==null),A.version.compareTo(k)<0&&(m.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),f.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,m))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Te();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(u=u.add(a.batch.mutations[d].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function mT(n){const e=ce(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function P2(n,e){const t=ce(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((f,m)=>{const y=s.get(m);if(!y)return;a.push(t.Ur.removeMatchingKeys(i,f.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(i,f.addedDocuments,m)));let _=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(mt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,r)),s=s.insert(m,_),function(A,k,E){return A.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(y,_,f)&&a.push(t.Ur.updateTargetData(i,_))});let u=hn(),d=Te();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))}),a.push(D2(i,o,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(pe.min())){const f=t.Ur.getLastRemoteSnapshotVersion(i).next(m=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(f)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(t.os=s,i))}function D2(n,e,t){let r=Te(),s=Te();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=hn();return t.forEach((a,u)=>{const d=i.get(a);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(pe.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):G("LocalStore","Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function j2(n,e){const t=ce(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Wu(n,e){const t=ce(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new _r(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Mo(n,e,t){const r=ce(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Rs(o))throw o;G("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function sp(n,e,t){const r=ce(n);let s=pe.min(),i=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const m=ce(u),y=m._s.get(f);return y!==void 0?O.resolve(m.os.get(y)):m.Ur.getTargetData(d,f)}(r,o,pn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:pe.min(),t?i:Te())).next(a=>(vT(r,EI(e),a),{documents:a,Ts:i})))}function gT(n,e){const t=ce(n),r=ce(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function yT(n,e){const t=ce(n),r=t.us.get(e)||pe.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,eI(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(vT(t,e,s),s))}function vT(n,e,t){let r=n.us.get(e)||pe.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}function p0(n,e){return`firestore_clients_${n}_${e}`}function m0(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function jh(n,e){return`firestore_targets_${n}_${e}`}class Qu{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new te(s.error.code,s.error.message))),o?new Qu(e,t,s.state,i):(ft("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qa{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new te(r.error.code,r.error.message))),i?new Qa(e,r.state,s):(ft("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Sm();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=iI(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Yu(e,i):(ft("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Lm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Lm(t.clientId,t.onlineState):(ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ip{constructor(){this.activeTargetIds=Sm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Vh{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new $e(_e),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=p0(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ip),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(p0(this.persistenceKey,r));if(s){const i=Yu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(jh(this.persistenceKey,e));if(s){const i=Qa.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(jh(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return G("SharedClientState","READ",e,t),t}setItem(e,t){G("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){G("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(G("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=tn.oe;if(i!=null)try{const a=JSON.parse(i);de(typeof a=="number"),o=a}catch(a){ft("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==tn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Qu(this.currentUser,e,t,r),i=m0(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=m0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=jh(this.persistenceKey,e),i=new Qa(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Yu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Qu.Rs(new Bt(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Qa.Rs(s,t)}Ls(e){return Lm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);G("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{i.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Sm();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class _T{constructor(){this.so=new ip,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ip,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){G("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){G("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mc=null;function Mh(){return Mc===null?Mc=function(){return 268435456+Math.round(2147483648*Math.random())}():Mc++,"0x"+Mc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut="WebChannelConnection";class L2 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Mh(),u=this.xo(t,r.toUriEncodedString());G("RestConnection",`Sending RPC '${t}' ${a}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(t,u,d,s).then(f=>(G("RestConnection",`Received RPC '${t}' ${a}: `,f),f),f=>{throw yl("RestConnection",`RPC '${t}' ${a} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=M2[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Mh();return new Promise((o,a)=>{const u=new Kw;u.setWithCredentials(!0),u.listenOnce(Ww.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case eu.NO_ERROR:const f=u.getResponseJson();G(Ut,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),o(f);break;case eu.TIMEOUT:G(Ut,`RPC '${e}' ${i} timed out`),a(new te(B.DEADLINE_EXCEEDED,"Request time out"));break;case eu.HTTP_ERROR:const m=u.getStatus();if(G(Ut,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const _=y==null?void 0:y.error;if(_&&_.status&&_.message){const R=function(k){const E=k.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(E)>=0?E:B.UNKNOWN}(_.status);a(new te(R,_.message))}else a(new te(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new te(B.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{G(Ut,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);G(Ut,`RPC '${e}' ${i} sending request:`,s),u.send(t,"POST",d,r,15)})}Bo(e,t,r){const s=Mh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jw(),a=Yw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const f=i.join("");G(Ut,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=o.createWebChannel(f,u);let y=!1,_=!1;const R=new O2({Io:k=>{_?G(Ut,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(y||(G(Ut,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),G(Ut,`RPC '${e}' stream ${s} sending:`,k),m.send(k))},To:()=>m.close()}),A=(k,E,v)=>{k.listen(E,b=>{try{v(b)}catch(I){setTimeout(()=>{throw I},0)}})};return A(m,Ca.EventType.OPEN,()=>{_||(G(Ut,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),A(m,Ca.EventType.CLOSE,()=>{_||(_=!0,G(Ut,`RPC '${e}' stream ${s} transport closed`),R.So())}),A(m,Ca.EventType.ERROR,k=>{_||(_=!0,yl(Ut,`RPC '${e}' stream ${s} transport errored:`,k),R.So(new te(B.UNAVAILABLE,"The operation could not be completed")))}),A(m,Ca.EventType.MESSAGE,k=>{var E;if(!_){const v=k.data[0];de(!!v);const b=v,I=b.error||((E=b[0])===null||E===void 0?void 0:E.error);if(I){G(Ut,`RPC '${e}' stream ${s} received error:`,I);const D=I.status;let P=function(x){const S=yt[x];if(S!==void 0)return FI(S)}(D),w=I.message;P===void 0&&(P=B.INTERNAL,w="Unknown error status: "+D+" with message "+I.message),_=!0,R.So(new te(P,w)),m.close()}else G(Ut,`RPC '${e}' stream ${s} received:`,v),R.bo(v)}}),A(a,Qw.STAT_EVENT,k=>{k.stat===Bf.PROXY?G(Ut,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===Bf.NOPROXY&&G(Ut,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(){return typeof window<"u"?window:null}function au(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(n){return new GA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&G("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,t,r,s,i,o,a,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new wT(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(ft(t.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new te(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return G("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(G("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class F2 extends IT{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=WA(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?Qt(o.readTime):pe.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Zf(this.serializer),t.addTarget=function(i,o){let a;const u=o.target;if(a=Uu(u)?{documents:KI(i,u)}:{query:WI(i,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=BI(i,o.resumeToken);const d=Jf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=Vo(i,o.snapshotVersion.toTimestamp());const d=Jf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=YA(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Zf(this.serializer),t.removeTarget=e,this.a_(t)}}class z2 extends IT{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return de(!!e.streamToken),this.lastStreamToken=e.streamToken,de(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){de(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=QA(e.writeResults,e.commitTime),r=Qt(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Zf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>qu(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2 extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(B.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Xf(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(B.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Xf(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(B.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class B2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ft(t),this.D_=!1):G("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ei(this)&&(G("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ce(u);d.L_.add(4),await $l(d),d.q_.set("Unknown"),d.L_.delete(4),await Vd(d)}(this))})}),this.q_=new B2(r,s)}}async function Vd(n){if(Ei(n))for(const e of n.B_)await e(!0)}async function $l(n){for(const e of n.B_)await e(!1)}function Md(n,e){const t=ce(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Um(t)?zm(t):Jo(t).r_()&&Fm(t,e))}function Oo(n,e){const t=ce(n),r=Jo(t);t.N_.delete(e),r.r_()&&TT(t,e),t.N_.size===0&&(r.r_()?r.o_():Ei(t)&&t.q_.set("Unknown"))}function Fm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Jo(n).A_(e)}function TT(n,e){n.Q_.xe(e),Jo(n).R_(e)}function zm(n){n.Q_=new UA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Jo(n).start(),n.q_.v_()}function Um(n){return Ei(n)&&!Jo(n).n_()&&n.N_.size>0}function Ei(n){return ce(n).L_.size===0}function ET(n){n.Q_=void 0}async function q2(n){n.q_.set("Online")}async function G2(n){n.N_.forEach((e,t)=>{Fm(n,e)})}async function H2(n,e){ET(n),Um(n)?(n.q_.M_(e),zm(n)):n.q_.set("Unknown")}async function K2(n,e,t){if(n.q_.set("Online"),e instanceof UI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){G("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ju(n,r)}else if(e instanceof ou?n.Q_.Ke(e):e instanceof zI?n.Q_.He(e):n.Q_.We(e),!t.isEqual(pe.min()))try{const r=await mT(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(mt.EMPTY_BYTE_STRING,f.snapshotVersion)),TT(i,u);const m=new _r(f.target,u,d,f.sequenceNumber);Fm(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){G("RemoteStore","Failed to raise snapshot:",r),await Ju(n,r)}}async function Ju(n,e,t){if(!Rs(e))throw e;n.L_.add(1),await $l(n),n.q_.set("Offline"),t||(t=()=>mT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{G("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Vd(n)})}function bT(n,e){return e().catch(t=>Ju(n,t,e))}async function Yo(n){const e=ce(n),t=Ss(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;W2(e);)try{const s=await j2(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,Q2(e,s)}catch(s){await Ju(e,s)}ST(e)&&NT(e)}function W2(n){return Ei(n)&&n.O_.length<10}function Q2(n,e){n.O_.push(e);const t=Ss(n);t.r_()&&t.V_&&t.m_(e.mutations)}function ST(n){return Ei(n)&&!Ss(n).n_()&&n.O_.length>0}function NT(n){Ss(n).start()}async function Y2(n){Ss(n).p_()}async function J2(n){const e=Ss(n);for(const t of n.O_)e.m_(t.mutations)}async function X2(n,e,t){const r=n.O_.shift(),s=Cm.from(r,e,t);await bT(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Yo(n)}async function Z2(n,e){e&&Ss(n).V_&&await async function(r,s){if(function(o){return LA(o)&&o!==B.ABORTED}(s.code)){const i=r.O_.shift();Ss(r).s_(),await bT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Yo(r)}}(n,e),ST(n)&&NT(n)}async function y0(n,e){const t=ce(n);t.asyncQueue.verifyOperationInProgress(),G("RemoteStore","RemoteStore received new credentials");const r=Ei(t);t.L_.add(3),await $l(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Vd(t)}async function op(n,e){const t=ce(n);e?(t.L_.delete(2),await Vd(t)):e||(t.L_.add(2),await $l(t),t.q_.set("Unknown"))}function Jo(n){return n.K_||(n.K_=function(t,r,s){const i=ce(t);return i.w_(),new F2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:q2.bind(null,n),Ro:G2.bind(null,n),mo:H2.bind(null,n),d_:K2.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Um(n)?zm(n):n.q_.set("Unknown")):(await n.K_.stop(),ET(n))})),n.K_}function Ss(n){return n.U_||(n.U_=function(t,r,s){const i=ce(t);return i.w_(),new z2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Y2.bind(null,n),mo:Z2.bind(null,n),f_:J2.bind(null,n),g_:X2.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Yo(n)):(await n.U_.stop(),n.O_.length>0&&(G("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Bm(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $m(n,e){if(ft("AsyncQueue",`${e}: ${n}`),Rs(n))return new te(B.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ee.comparator(t.key,r.key):(t,r)=>ee.comparator(t.key,r.key),this.keyedMap=Aa(),this.sortedSet=new $e(this.comparator)}static emptySet(e){return new _o(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _o)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new _o;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(){this.W_=new $e(ee.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):oe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Lo{constructor(e,t,r,s,i,o,a,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Lo(e,t,_o.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class tR{constructor(){this.queries=_0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=ce(t),i=s.queries;s.queries=_0(),i.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new te(B.ABORTED,"Firestore shutting down"))}}function _0(){return new Ps(n=>TI(n),kd)}async function nR(n,e){const t=ce(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new eR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=$m(o,`Initialization of query '${Gi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&qm(t)}async function rR(n,e){const t=ce(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function sR(n,e){const t=ce(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&qm(t)}function iR(n,e,t){const r=ce(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function qm(n){n.Y_.forEach(e=>{e.next()})}var ap,x0;(x0=ap||(ap={})).ea="default",x0.Cache="cache";class oR{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ap.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e){this.key=e}}class CT{constructor(e){this.key=e}}class aR{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Te(),this.mutatedKeys=Te(),this.Aa=bI(e),this.Ra=new _o(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new v0,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const y=s.get(f),_=Fl(this.query,m)?m:null,R=!!y&&this.mutatedKeys.has(y.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let k=!1;y&&_?y.data.isEqual(_.data)?R!==A&&(r.track({type:3,doc:_}),k=!0):this.ga(y,_)||(r.track({type:2,doc:_}),k=!0,(u&&this.Aa(_,u)>0||d&&this.Aa(_,d)<0)&&(a=!0)):!y&&_?(r.track({type:0,doc:_}),k=!0):y&&!_&&(r.track({type:1,doc:y}),k=!0,(u||d)&&(a=!0)),k&&(_?(o=o.add(_),i=A?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,m)=>function(_,R){const A=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return A(_)-A(R)}(f.type,m.type)||this.Aa(f.doc,m.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Lo(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new v0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Te(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new CT(r))}),this.da.forEach(r=>{e.has(r)||t.push(new kT(r))}),t}ba(e){this.Ta=e.Ts,this.da=Te();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Lo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class lR{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class cR{constructor(e){this.key=e,this.va=!1}}class uR{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ps(a=>TI(a),kd),this.Ma=new Map,this.xa=new Set,this.Oa=new $e(ee.comparator),this.Na=new Map,this.La=new Vm,this.Ba={},this.ka=new Map,this.qa=_i.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function dR(n,e,t=!0){const r=Od(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await AT(r,e,t,!0),s}async function hR(n,e){const t=Od(n);await AT(t,e,!0,!1)}async function AT(n,e,t,r){const s=await Wu(n.localStore,pn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Gm(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Md(n.remoteStore,s),a}async function Gm(n,e,t,r,s){n.Ka=(m,y,_)=>async function(A,k,E,v){let b=k.view.ma(E);b.ns&&(b=await sp(A.localStore,k.query,!1).then(({documents:w})=>k.view.ma(w,b)));const I=v&&v.targetChanges.get(k.targetId),D=v&&v.targetMismatches.get(k.targetId)!=null,P=k.view.applyChanges(b,A.isPrimaryClient,I,D);return lp(A,k.targetId,P.wa),P.snapshot}(n,m,y,_);const i=await sp(n.localStore,e,!0),o=new aR(e,i.Ts),a=o.ma(i.documents),u=Bl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),d=o.applyChanges(a,n.isPrimaryClient,u);lp(n,t,d.wa);const f=new lR(e,t,o);return n.Fa.set(e,f),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot}async function fR(n,e,t){const r=ce(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!kd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Mo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Oo(r.remoteStore,s.targetId),Fo(r,s.targetId)}).catch(As)):(Fo(r,s.targetId),await Mo(r.localStore,s.targetId,!0))}async function pR(n,e){const t=ce(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Oo(t.remoteStore,r.targetId))}async function mR(n,e,t){const r=Qm(n);try{const s=await function(o,a){const u=ce(o),d=it.now(),f=a.reduce((_,R)=>_.add(R.key),Te());let m,y;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let R=hn(),A=Te();return u.cs.getEntries(_,f).next(k=>{R=k,R.forEach((E,v)=>{v.isValidDocument()||(A=A.add(E))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,R)).next(k=>{m=k;const E=[];for(const v of a){const b=MA(v,m.get(v.key).overlayedDocument);b!=null&&E.push(new Pr(v.key,b,pI(b.value.mapValue),kt.exists(!0)))}return u.mutationQueue.addMutationBatch(_,d,E,a)}).next(k=>{y=k;const E=k.applyToLocalDocumentSet(m,A);return u.documentOverlayCache.saveOverlays(_,k.batchId,E)})}).then(()=>({batchId:y.batchId,changes:NI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new $e(_e)),d=d.insert(a,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,t),await Ds(r,s.changes),await Yo(r.remoteStore)}catch(s){const i=$m(s,"Failed to persist write");t.reject(i)}}async function RT(n,e){const t=ce(n);try{const r=await P2(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(de(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?de(o.va):s.removedDocuments.size>0&&(de(o.va),o.va=!1))}),await Ds(t,r,e)}catch(r){await As(r)}}function w0(n,e,t){const r=ce(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=ce(o);u.onlineState=a;let d=!1;u.queries.forEach((f,m)=>{for(const y of m.j_)y.Z_(a)&&(d=!0)}),d&&qm(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gR(n,e,t){const r=ce(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new $e(ee.comparator);o=o.insert(i,dt.newNoDocument(i,pe.min()));const a=Te().add(i),u=new Ul(pe.min(),new Map,new $e(_e),o,a);await RT(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Wm(r)}else await Mo(r.localStore,e,!1).then(()=>Fo(r,e,t)).catch(As)}async function yR(n,e){const t=ce(n),r=e.batch.batchId;try{const s=await R2(t.localStore,e);Km(t,r,null),Hm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ds(t,s)}catch(s){await As(s)}}async function vR(n,e,t){const r=ce(n);try{const s=await function(o,a){const u=ce(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,a).next(m=>(de(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);Km(r,e,t),Hm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ds(r,s)}catch(s){await As(s)}}function Hm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Km(n,e,t){const r=ce(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Fo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||PT(n,r)})}function PT(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Oo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Wm(n))}function lp(n,e,t){for(const r of t)r instanceof kT?(n.La.addReference(r.key,e),_R(n,r)):r instanceof CT?(G("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||PT(n,r.key)):oe()}function _R(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(G("SyncEngine","New document in limbo: "+t),n.xa.add(r),Wm(n))}function Wm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new ee(Ve.fromString(e)),r=n.qa.next();n.Na.set(r,new cR(t)),n.Oa=n.Oa.insert(t,r),Md(n.remoteStore,new _r(pn(Nd(t.path)),r,"TargetPurposeLimboResolution",tn.oe))}}async function Ds(n,e,t){const r=ce(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(d=>{var f;if((d||t)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=t==null?void 0:t.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Om.Wi(u.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const f=ce(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(d,y=>O.forEach(y.$i,_=>f.persistence.referenceDelegate.addReference(m,y.targetId,_)).next(()=>O.forEach(y.Ui,_=>f.persistence.referenceDelegate.removeReference(m,y.targetId,_)))))}catch(m){if(!Rs(m))throw m;G("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const y=m.targetId;if(!m.fromCache){const _=f.os.get(y),R=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(R);f.os=f.os.insert(y,A)}}}(r.localStore,i))}async function xR(n,e){const t=ce(n);if(!t.currentUser.isEqual(e)){G("SyncEngine","User change. New user:",e.toKey());const r=await pT(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(u=>{u.reject(new te(B.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ds(t,r.hs)}}function wR(n,e){const t=ce(n),r=t.Na.get(e);if(r&&r.va)return Te().add(r.key);{let s=Te();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function IR(n,e){const t=ce(n),r=await sp(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&lp(t,e.targetId,s.wa),s}async function TR(n,e){const t=ce(n);return yT(t.localStore,e).then(r=>Ds(t,r))}async function ER(n,e,t,r){const s=ce(n),i=await function(a,u){const d=ce(a),f=ce(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>f.Mn(m,u).next(y=>y?d.localDocuments.getDocuments(m,y):O.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Yo(s.remoteStore):t==="acknowledged"||t==="rejected"?(Km(s,e,r||null),Hm(s,e),function(a,u){ce(ce(a).mutationQueue).On(u)}(s.localStore,e)):oe(),await Ds(s,i)):G("SyncEngine","Cannot apply mutation batch with id: "+e)}async function bR(n,e){const t=ce(n);if(Od(t),Qm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await I0(t,r.toArray());t.Qa=!0,await op(t.remoteStore,!0);for(const i of s)Md(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Fo(t,o),Mo(t.localStore,o,!0))),Oo(t.remoteStore,o)}),await s,await I0(t,r),function(o){const a=ce(o);a.Na.forEach((u,d)=>{Oo(a.remoteStore,d)}),a.La.pr(),a.Na=new Map,a.Oa=new $e(ee.comparator)}(t),t.Qa=!1,await op(t.remoteStore,!1)}}async function I0(n,e,t){const r=ce(n),s=[],i=[];for(const o of e){let a;const u=r.Ma.get(o);if(u&&u.length!==0){a=await Wu(r.localStore,pn(u[0]));for(const d of u){const f=r.Fa.get(d),m=await IR(r,f);m.snapshot&&i.push(m.snapshot)}}else{const d=await gT(r.localStore,o);a=await Wu(r.localStore,d),await Gm(r,DT(d),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function DT(n){return II(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function SR(n){return function(t){return ce(ce(t).persistence).Qi()}(ce(n).localStore)}async function NR(n,e,t,r){const s=ce(n);if(s.Qa)return void G("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await yT(s.localStore,EI(i[0])),a=Ul.createSynthesizedRemoteEventForCurrentChange(e,t==="current",mt.EMPTY_BYTE_STRING);await Ds(s,o,a);break}case"rejected":await Mo(s.localStore,e,!0),Fo(s,e,r);break;default:oe()}}async function kR(n,e,t){const r=Od(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){G("SyncEngine","Adding an already active target "+s);continue}const i=await gT(r.localStore,s),o=await Wu(r.localStore,i);await Gm(r,DT(i),o.targetId,!1,o.resumeToken),Md(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await Mo(r.localStore,s,!1).then(()=>{Oo(r.remoteStore,s),Fo(r,s)}).catch(As)}}function Od(n){const e=ce(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=RT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gR.bind(null,e),e.Ca.d_=sR.bind(null,e.eventManager),e.Ca.$a=iR.bind(null,e.eventManager),e}function Qm(n){const e=ce(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vR.bind(null,e),e}class bl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=jd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return fT(this.persistence,new hT,e.initialUser,this.serializer)}Ga(e){return new uT(Dd.Zr,this.serializer)}Wa(e){return new _T}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bl.provider={build:()=>new bl};class jT extends bl{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Qm(this.Ja.syncEngine),await Yo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return fT(this.persistence,new hT,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new f2(r,e.asyncQueue,t)}Ha(e,t){const r=new HC(t,this.persistence);return new GC(e.asyncQueue,r)}Ga(e){const t=dT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new Mm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,xT(),au(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new _T}}class CR extends jT{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Vh&&(this.sharedClientState.syncEngine={no:ER.bind(null,t),ro:NR.bind(null,t),io:kR.bind(null,t),Qi:SR.bind(null,t),eo:TR.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await bR(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=xT();if(!Vh.D(t))throw new te(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=dT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Vh(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Sl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>w0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xR.bind(null,this.syncEngine),await op(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new tR}()}createDatastore(e){const t=jd(e.databaseInfo.databaseId),r=function(i){return new L2(i)}(e.databaseInfo);return function(i,o,a,u){return new U2(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new $2(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>w0(this.syncEngine,t,0),function(){return g0.D()?new g0:new V2}())}createSyncEngine(e,t){return function(s,i,o,a,u,d,f){const m=new uR(s,i,o,a,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=ce(s);G("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await $l(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Sl.provider={build:()=>new Sl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ft("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Bt.UNAUTHENTICATED,this.clientId=Xw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{G("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(G("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=$m(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Oh(n,e){n.asyncQueue.verifyOperationInProgress(),G("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await pT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function T0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await PR(n);G("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>y0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>y0(e.remoteStore,s)),n._onlineComponents=e}async function PR(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){G("FirestoreClient","Using user provided OfflineComponentProvider");try{await Oh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;yl("Error using user provided cache. Falling back to memory cache: "+t),await Oh(n,new bl)}}else G("FirestoreClient","Using default OfflineComponentProvider"),await Oh(n,new bl);return n._offlineComponents}async function VT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(G("FirestoreClient","Using user provided OnlineComponentProvider"),await T0(n,n._uninitializedComponentsProvider._online)):(G("FirestoreClient","Using default OnlineComponentProvider"),await T0(n,new Sl))),n._onlineComponents}function DR(n){return VT(n).then(e=>e.syncEngine)}async function E0(n){const e=await VT(n),t=e.eventManager;return t.onListen=dR.bind(null,e.syncEngine),t.onUnlisten=fR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pR.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(n,e,t){if(!t)throw new te(B.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jR(n,e,t,r){if(e===!0&&r===!0)throw new te(B.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function S0(n){if(!ee.isDocumentKey(n))throw new te(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N0(n){if(ee.isDocumentKey(n))throw new te(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ym(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":oe()}function vs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ym(n);throw new te(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=MT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new k0({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new k0(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new VC;switch(r.type){case"firstParty":return new LC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=b0.get(t);r&&(G("ComponentProvider","Removing Datastore"),b0.delete(t),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ld(this.firestore,e,this._query)}}class mn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}}class _s extends Ld{constructor(e,t,r){super(e,t,Nd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new ee(e))}withConverter(e){return new _s(this.firestore,e,this._path)}}function lt(n,e,...t){if(n=pt(n),OT("collection","path",e),n instanceof Jm){const r=Ve.fromString(e,...t);return N0(r),new _s(n,null,r)}{if(!(n instanceof mn||n instanceof _s))throw new te(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ve.fromString(e,...t));return N0(r),new _s(n.firestore,null,r)}}function Ee(n,e,...t){if(n=pt(n),arguments.length===1&&(e=Xw.newId()),OT("doc","path",e),n instanceof Jm){const r=Ve.fromString(e,...t);return S0(r),new mn(n,null,new ee(r))}{if(!(n instanceof mn||n instanceof _s))throw new te(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ve.fromString(e,...t));return S0(r),new mn(n.firestore,n instanceof _s?n.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new wT(this,"async_queue_retry"),this.Vu=()=>{const r=au();r&&G("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=au();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=au();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new gs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Rs(e))throw e;G("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ft("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Bm.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&oe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function A0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class xi extends Jm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new C0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new C0(e),this._firestoreClient=void 0,await e}}}function VR(n,e,t){const r=vd(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(pl(i,e))return s;throw new te(B.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new te(B.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function Xm(n){if(n._terminated)throw new te(B.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||MR(n),n._firestoreClient}function MR(n){var e,t,r;const s=n._freezeSettings(),i=function(a,u,d,f){return new fA(a,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,MT(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new RR(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zo(mt.fromBase64String(e))}catch(t){throw new te(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new zo(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new te(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR=/^__.*__$/;class LR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qo(e,this.data,t,this.fieldTransforms)}}class LT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Pr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class tg{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new tg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Xu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(FT(this.Cu)&&OR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class FR{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||jd(e)}Qu(e,t,r,s=!1){return new tg({Cu:e,methodName:t,qu:r,path:rt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ng(n){const e=n._freezeSettings(),t=jd(n._databaseId);return new FR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function zT(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);sg("Data must be an object, but it was:",o,r);const a=$T(r,o);let u,d;if(i.merge)u=new nn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const y=cp(e,m,t);if(!o.contains(y))throw new te(B.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);GT(f,y)||f.push(y)}u=new nn(f),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new LR(new qt(a),u,d)}class zd extends Fd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zd}}class rg extends Fd{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new jo(e.serializer,AI(e.serializer,this.$u));return new VI(e.path,t)}isEqual(e){return e instanceof rg&&this.$u===e.$u}}function UT(n,e,t,r){const s=n.Qu(1,e,t);sg("Data must be an object, but it was:",s,r);const i=[],o=qt.empty();Ti(r,(u,d)=>{const f=ig(e,u,t);d=pt(d);const m=s.Nu(f);if(d instanceof zd)i.push(f);else{const y=Ud(d,m);y!=null&&(i.push(f),o.set(f,y))}});const a=new nn(i);return new LT(o,a,s.fieldTransforms)}function BT(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[cp(e,r,t)],u=[s];if(i.length%2!=0)throw new te(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)a.push(cp(e,i[y])),u.push(i[y+1]);const d=[],f=qt.empty();for(let y=a.length-1;y>=0;--y)if(!GT(d,a[y])){const _=a[y];let R=u[y];R=pt(R);const A=o.Nu(_);if(R instanceof zd)d.push(_);else{const k=Ud(R,A);k!=null&&(d.push(_),f.set(_,k))}}const m=new nn(d);return new LT(f,m,o.fieldTransforms)}function Ud(n,e){if(qT(n=pt(n)))return sg("Unsupported field value:",e,n),$T(n,e);if(n instanceof Fd)return function(r,s){if(!FT(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=Ud(a,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=it.fromDate(r);return{timestampValue:Vo(s.serializer,i)}}if(r instanceof it){const i=new it(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vo(s.serializer,i)}}if(r instanceof Zm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zo)return{bytesValue:BI(s.serializer,r._byteString)};if(r instanceof mn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Pm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof eg)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Nm(a.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ym(r)}`)}(n,e)}function $T(n,e){const t={};return uI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ti(n,(r,s)=>{const i=Ud(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function qT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof it||n instanceof Zm||n instanceof zo||n instanceof mn||n instanceof Fd||n instanceof eg)}function sg(n,e,t){if(!qT(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Ym(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function cp(n,e,t){if((e=pt(e))instanceof ql)return e._internalPath;if(typeof e=="string")return ig(n,e);throw Xu("Field path arguments must be of type string or ",n,!1,void 0,t)}const zR=new RegExp("[~\\*/\\[\\]]");function ig(n,e,t){if(e.search(zR)>=0)throw Xu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ql(...e.split("."))._internalPath}catch{throw Xu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xu(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new te(B.INVALID_ARGUMENT,a+n+u)}function GT(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(KT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class UR extends HT{data(){return super.data()}}function KT(n,e){return typeof e=="string"?ig(n,e):e instanceof ql?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new te(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $R{convertValue(e,t="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw oe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ti(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ye(o.doubleValue));return new eg(i)}convertGeoPoint(e){return new Zm(Ye(e.latitude),Ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Tm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(wl(e));default:return null}}convertTimestamp(e){const t=Ar(e);return new it(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ve.fromString(e);de(XI(r));const s=new pi(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(t)||ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class QT extends HT{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(KT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class lu extends QT{data(e={}){return super.data(e)}}class qR{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Da(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new lu(this._firestore,this._userDataWriter,r.key,r,new Da(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new lu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Da(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new lu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Da(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:GR(a.type),doc:u,oldIndex:d,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function GR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}class YT extends $R{constructor(e){super(),this.firestore=e}convertBytes(e){return new zo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,t)}}function ct(n,e,t,...r){n=vs(n,mn);const s=vs(n.firestore,xi),i=ng(s);let o;return o=typeof(e=pt(e))=="string"||e instanceof ql?BT(i,"updateDoc",n._key,e,t,r):UT(i,"updateDoc",n._key,e),Bd(s,[o.toMutation(n._key,kt.exists(!0))])}function Oc(n){return Bd(vs(n.firestore,xi),[new zl(n._key,kt.none())])}function Dn(n,e){const t=vs(n.firestore,xi),r=Ee(n),s=WT(n.converter,e);return Bd(t,[zT(ng(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,kt.exists(!1))]).then(()=>r)}function Gr(n,...e){var t,r,s;n=pt(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||A0(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(A0(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,d,f;if(n instanceof mn)d=vs(n.firestore,xi),f=Nd(n._key.path),u={next:m=>{e[o]&&e[o](HR(d,n,m))},error:e[o+1],complete:e[o+2]};else{const m=vs(n,Ld);d=vs(m.firestore,xi),f=m._query;const y=new YT(d);u={next:_=>{e[o]&&e[o](new qR(d,y,m,_))},error:e[o+1],complete:e[o+2]},BR(n._query)}return function(y,_,R,A){const k=new AR(A),E=new oR(_,k,R);return y.asyncQueue.enqueueAndForget(async()=>nR(await E0(y),E)),()=>{k.Za(),y.asyncQueue.enqueueAndForget(async()=>rR(await E0(y),E))}}(Xm(d),f,a,u)}function Bd(n,e){return function(r,s){const i=new gs;return r.asyncQueue.enqueueAndForget(async()=>mR(await DR(r),s,i)),i.promise}(Xm(n),e)}function HR(n,e,t){const r=t.docs.get(e._key),s=new YT(n);return new QT(n,s,e._key,r,new Da(t.hasPendingWrites,t.fromCache),e.converter)}class KR{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=JR(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function WR(n){return new KR(n)}class QR{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Sl.provider,this._offlineComponentProvider={build:t=>new jT(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class YR{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Sl.provider,this._offlineComponentProvider={build:t=>new CR(t,e==null?void 0:e.cacheSizeBytes)}}}function JR(n){return new QR(void 0)}function XR(){return new YR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ng(e)}set(e,t,r){this._verifyNotCommitted();const s=Lh(e,this._firestore),i=WT(s.converter,t,r),o=zT(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,kt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=Lh(e,this._firestore);let o;return o=typeof(t=pt(t))=="string"||t instanceof ql?BT(this._dataReader,"WriteBatch.update",i._key,t,r,s):UT(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Lh(e,this._firestore);return this._mutations=this._mutations.concat(new zl(t._key,kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Lh(n,e){if((n=pt(n)).firestore!==e)throw new te(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function ur(n){return new rg("increment",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(n){return Xm(n=vs(n,xi)),new ZR(n,e=>Bd(n,e))}(function(e,t=!0){(function(s){Wo=s})(Ho),di(new Is("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new xi(new MC(r.getProvider("auth-internal")),new zC(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new te(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pi(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),er(Tv,"4.7.3",e),er(Tv,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP="type.googleapis.com/google.protobuf.Int64Value",tP="type.googleapis.com/google.protobuf.UInt64Value";function JT(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function up(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>up(e));if(typeof n=="function"||typeof n=="object")return JT(n,e=>up(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Zu(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case eP:case tP:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Zu(e)):typeof n=="function"||typeof n=="object"?JT(n,e=>Zu(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xo extends sr{constructor(e,t,r){super(`${og}/${e}`,t||""),this.details=r}}function nP(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function rP(n,e){let t=nP(n),r=t,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!R0[o])return new xo("internal","internal");t=R0[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Zu(s))}}catch{}return t==="ok"?null:new xo(t,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||t.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="us-central1";function iP(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new xo("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class oP{constructor(e,t,r,s,i=dp,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new sP(t,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=dp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function aP(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}function lP(n,e,t){return r=>uP(n,e,r,{})}async function cP(n,e,t,r){t["Content-Type"]="application/json";let s;try{s=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function uP(n,e,t,r){const s=n._url(e);return dP(n,s,t,r)}async function dP(n,e,t,r){t=up(t);const s={data:t},i={},o=await n.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,u=iP(a),d=await Promise.race([cP(e,s,i,n.fetchImpl),u.promise,n.cancelAllRequests]);if(u.cancel(),!d)throw new xo("cancelled","Firebase Functions instance was deleted.");const f=rP(d.status,d.json);if(f)throw f;if(!d.json)throw new xo("internal","Response is not valid JSON object.");let m=d.json.data;if(typeof m>"u"&&(m=d.json.result),typeof m>"u")throw new xo("internal","Response is missing data field.");return{data:Zu(m)}}const P0="@firebase/functions",D0="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP="auth-internal",fP="app-check-internal",pP="messaging-internal";function mP(n,e){const t=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(hP),a=r.getProvider(pP),u=r.getProvider(fP);return new oP(i,o,a,u,s,n)};di(new Is(og,t,"PUBLIC").setMultipleInstances(!0)),er(P0,D0,e),er(P0,D0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(n=uw(),e=dp){const r=vd(pt(n),og).getImmediate({identifier:e}),s=uS("functions");return s&&yP(r,...s),r}function yP(n,e,t){aP(pt(n),e,t)}function vP(n,e,t){return lP(pt(n),e)}mP(fetch.bind(self));/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _P={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ge=(n,e)=>{const t=U.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:u,...d},f)=>U.createElement("svg",{ref:f,..._P,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${xP(n)}`,a].join(" "),...d},[...e.map(([m,y])=>U.createElement(m,y)),...Array.isArray(u)?u:[u]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=ge("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=ge("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=ge("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=ge("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=ge("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=ge("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=ge("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=ge("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=ge("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=ge("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=ge("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=ge("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=ge("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=ge("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=ge("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=ge("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=ge("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=ge("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=ge("Magnet",[["path",{d:"m6 15-4-4 6.75-6.77a7.79 7.79 0 0 1 11 11L13 22l-4-4 6.39-6.36a2.14 2.14 0 0 0-3-3L6 15",key:"1i3lhw"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}],["path",{d:"m12 15 4 4",key:"lnac28"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=ge("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=ge("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=ge("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=ge("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uE=ge("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=ge("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=ge("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=ge("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=ge("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=ge("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=ge("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=ge("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=ge("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=ge("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=ge("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=ge("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=ge("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=ge("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=ge("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ie="w-full px-4 py-3 bg-white border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all text-sm shadow-sm font-medium text-slate-700 no-spinner",me="block text-xs font-bold text-slate-500 mb-2 uppercase tracking-wide ml-1",Xe={ru:{dashboard:"",rooms:"",calendar:"",reports:"",debts:"",tasks:"",expenses:"",clients:"",staff:"",shifts:"",logout:"",login:"",pass:"",enter:"  ",guests:"",occupancy:"",revenue:"",today:"",cash:"",card:"",qr:"QR",checkin:"",booking:"",debt:"",paid:"",save:"",cancel:"",delete:"",edit:"",guestName:" ",passport:"",birthDate:" ",country:"",room:"",bed:"",days:"",price:"",total:"",comment:"",category:"",amount:"",success:"",error:"",splitTitle:" ()",splitAfter:"  (.)",splitGap:" (.)",splitInfo:"  {x} .,    {y} .,     {z} .",confirmSplit:" ",checkoutWarn:"",timeOut:" ",shiftClose:" ",cashInHand:" ",shift:"",payment:"",extend:"",move:"",checkout:"",confirmDelete:" ?",search:"...",allHostels:" ",welcome:" ",initDb:" ",addTask:" ",priority:"",description:"",low:"",medium:"",high:"",printCheck:"",printForm:"",printRef:"",income:"",expense:"",balance:"",done:"",role:"",action:"",admin:"",cashier:"",noData:" ",createdBy:"",date:"",moveDate:" ",newDate:" ",manualRefund:" ",payDebt:" ",addDebt:" ",history:"",reduceNoRefund:" ( )",debtRemaining:" .  .",allCashiers:" ",selectCashier:" ",assignTo:"",householdGoods:"",groceries:"",repair:"",salary:"",utilities:"",other:"",freeFor:"",future:"",import:" (CSV)",preview:"",new:"",update:"",importSuccess:" ",deduplicate:" ",deleteSelected:" ",normalizeCountries:" ",createDebt:" ",print:"",printReport:" ",checkinNew:" ",startShift:" ",endShift:" ",transferShift:" ",working:" ",workedHours:"",salaryCalc:" "},uz:{dashboard:"Boshqaruv",rooms:"Xonalar",calendar:"Kalendar",reports:"Hisobotlar",debts:"Qarzlar",tasks:"Vazifalar",expenses:"Xarajatlar",clients:"Mijozlar",staff:"Xodimlar",shifts:"Smenalar",logout:"Chiqish",login:"Login",pass:"Parol",enter:"Tizimga kirish",guests:"Mehmonlar",occupancy:"Bandlik",revenue:"Tushum",today:"Bugun",cash:"Naqd",card:"Terminal",qr:"QR",checkin:"Joylashtirish",booking:"Band qilish",debt:"Qarz",paid:"To'langan",save:"Saqlash",cancel:"Bekor qilish",delete:"O'chirish",edit:"Tahrirlash",guestName:"F.I.SH",passport:"Pasport",birthDate:"Tug'ilgan sana",country:"Davlat",room:"Xona",bed:"Joy",days:"Kun",price:"Narx",total:"Jami",comment:"Izoh",category:"Toifa",amount:"Summa",success:"Muvaffaqiyatli",error:"Xato",splitTitle:"Bo'lish (Pauza)",splitAfter:"Chiqish (kun)",splitGap:"Tanaffus (kun)",splitInfo:"Mehmon {x} kun yashaydi, keyin joy {y} kun bo'sh turadi, so'ng yana {z} kunga joylashadi.",confirmSplit:"Bo'lishni tasdiqlash",checkoutWarn:"Qoldi",timeOut:"Vaqt tugadi",shiftClose:"Smenani yopish",cashInHand:"Kassada",shift:"Smena",payment:"To'lov",extend:"Uzaytirish",move:"Ko'chirish",checkout:"Chiqarish",confirmDelete:"Ishonchingiz komilmi?",search:"Qidirish...",allHostels:"Barcha filiallar",welcome:"Xush kelibsiz",initDb:"MB ishga tushirish",addTask:"Vazifa qo'shish",priority:"Muhimlik",description:"Tavsif",low:"Past",medium:"O'rta",high:"Yuqori",printCheck:"Chek",printForm:"Anketa",printRef:"Ma'lumotnoma",income:"Kirim",expense:"Chiqim",balance:"Balans",done:"Bajarildi",role:"Rol",action:"Amal",admin:"Admin",cashier:"Kassir",noData:"Ma'lumot yo'q",createdBy:"Yaratdi",date:"Sana",moveDate:"Sanani ko'chirish",newDate:"Yangi sana",manualRefund:"Qaytarish summasi",payDebt:"Qarzni to'lash",addDebt:"Qarzni o'zgartirish",history:"Tarix",reduceNoRefund:"Qisqartirish (Qaytim yo'q)",debtRemaining:"Qarz qoldi. Admin kerak.",allCashiers:"Barcha kassirlar",selectCashier:"Kassirni tanlash",assignTo:"Tayinlash",householdGoods:" ",groceries:"-",repair:"",salary:" ",utilities:"",other:"",freeFor:"Bo'sh",future:"Bo'ladi",import:"Import (CSV)",preview:"Ko'rib chiqish",new:"Yangi",update:"Yangilash",importSuccess:"Import bajarildi",deduplicate:"Dublikatlarni topish",deleteSelected:"Tanlanganlarni o'chirish",normalizeCountries:"Davlatlarni to'g'irlash",createDebt:"Qarz yaratish",print:"Chop etish",printReport:"Hisobotni chop etish",checkinNew:"Yangi mehmon",startShift:"Smenani boshlash",endShift:"Smenani tugatish",transferShift:"Smenani topshirish",working:"Ishlamoqda",workedHours:"Soat",salaryCalc:"Maosh hisobi"}},V0="8483864240:AAGotoLWbAVH4iA6gh3GF-eNL5fAASHW468",OP=["7029598539","6953132612"],hp=async n=>{if(!V0.includes("YOUR_TELEGRAM"))try{await Promise.all(OP.map(e=>fetch(`https://api.telegram.org/bot${V0}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:e,text:n,parse_mode:"HTML"})})))}catch(e){console.error("Telegram Error:",e)}},LP={apiKey:"AIzaSyAoVj92dmnl5gBB7zYul0iG2Ekp5cbmkp0",authDomain:"hostella-app-a1e07.firebaseapp.com",projectId:"hostella-app-a1e07",storageBucket:"hostella-app-a1e07.firebasestorage.app",messagingSenderId:"826787873496",appId:"1:826787873496:web:51a0c6e42631a28919cdad"},hg=cw(LP),M0=PC(hg),FP=gP(hg),ue=VR(hg,{localCache:WR({tabManager:XR()})},"hostella"),zP="hostella-multi-v4",fe=["artifacts",zP,"public","data"],UP=266666,Fh=[{login:"admin",pass:"admin",name:"Aziz Yuldashev",role:"admin",hostelId:"all"},{login:"dilafruz",pass:"123",name:"Dilafruz",role:"cashier",hostelId:"hostel1"},{login:"nargiza",pass:"123",name:"Nargiza",role:"cashier",hostelId:"hostel1"},{login:"fazliddin",pass:"123",name:"Fazliddin",role:"viewer",hostelId:"hostel2",viewHostels:["hostel1","hostel2"]},{login:"olimjon",pass:"123",name:"Olimjon",role:"cashier",hostelId:"hostel2"}],O0={turkmenistan:"",turkmenia:"",uzbekistan:"",russia:"","russian federation":"",kazakhstan:"",tajikistan:"",kyrgyzstan:"",kirgizstan:"",usa:"","united states":"","united states of america":"",china:"",turkey:"",korea:" ()","south korea":" ()",india:"",pakistan:"",afghanistan:"",germany:"",uk:"","united kingdom":"",england:"",france:"",italy:"",spain:"",japan:"",uae:"","united arab emirates":""},Kl=["","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ()","","","","","","","","","","","",""," ","","","","","",""," ","","","","","","","","","","","","","","","","","","","-","",""],On={hostel1:{name:" 1",address:",   , 43",currency:"UZS"},hostel2:{name:" 2",address:", 6- .  , 39",currency:"UZS"}},zn=n=>typeof n.amountPaid=="number"?n.amountPaid:(n.paidCash||0)+(n.paidCard||0)+(n.paidQR||0),fp=n=>{if(!n)return"";const e=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-e).toISOString().slice(0,10)},lo=n=>{if(!n)return"";const e=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-e).toISOString().slice(0,16)},xr=(n,e,t=new Date)=>{const r=new Date(n);r.setHours(12,0,0,0);const s=new Date(r),i=new Date(r);return i.setDate(i.getDate()+parseInt(e)),i.setHours(12,0,0,0),{start:r,end:i,startDateNormalized:s}},pE=(n,e,t,r)=>{const s=xr(n,e),i=xr(t,r),o=s.start.getTime(),a=s.end.getTime(),u=i.start.getTime(),d=i.end.getTime();return o<d&&a>u},zh=(n,e)=>{const t=new Date(n),i=((e?new Date(e):new Date)-t)/(1e3*60*60),o=UP/24;return Math.round(i*o)},BP=(n,e,t=0,r=0)=>{const s=t-r;let i=`
        <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <style>
                body { font-family: Arial, sans-serif; }
                table { border-collapse: collapse; width: 100%; }
                th, td { border: 1px solid #000000; padding: 8px; text-align: left; vertical-align: top; }
                th { background-color: #4f46e5; color: #ffffff; font-weight: bold; }
                .income { color: #166534; font-weight: bold; }
                .expense { color: #9f1239; font-weight: bold; }
                .amount { text-align: right; }
            </style>
        </head>
        <body>
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
    `;n.forEach(u=>{const d=u.type==="income"?"income":"expense",f=u.type==="income"?"":"";i+=`
            <tr>
                <td>${u.date}</td>
                <td class="${d}">${f}</td>
                <td>${u.hostel||"-"}</td>
                <td>${u.staff}</td>
                <td class="amount">${parseInt(u.amount).toLocaleString()}</td>
                <td>${u.method}</td>
                <td>${u.comment}</td>
            </tr>
        `}),(t>0||r>0)&&(i+=`
            <tr style="background-color: #f3f4f6; font-weight: bold; border-top: 3px solid #000;">
                <td colspan="4" style="text-align: right;"> :</td>
                <td class="income" style="text-align: right;">${t.toLocaleString()}</td>
                <td colspan="2"></td>
            </tr>
            <tr style="background-color: #f3f4f6; font-weight: bold;">
                <td colspan="4" style="text-align: right;"> :</td>
                <td class="expense" style="text-align: right;">${r.toLocaleString()}</td>
                <td colspan="2"></td>
            </tr>
            <tr style="background-color: #e0e7ff; font-weight: bold;">
                <td colspan="4" style="text-align: right; font-size: 16px;">:</td>
                <td style="text-align: right; font-size: 16px; color: ${s>=0?"#166534":"#9f1239"};">${s.toLocaleString()}</td>
                <td colspan="2"></td>
            </tr>
        `),i+="</tbody></table></body></html>";const o=new Blob(["\uFEFF",i],{type:"application/vnd.ms-excel; charset=UTF-8"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)},$P=(n,e,t)=>{const r=window.open("","","width=800,height=600");let s='<html><head><meta charset="UTF-8"><title>';n==="check"||n===""?(s+="Receipt</title>",s+=`
        <style>
            body { font-family: 'Courier New', monospace; padding: 30px; max-width: 400px; margin: 0 auto; background: #f9fafb; }
            .receipt { background: white; border: 2px solid #000; padding: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
            .header { text-align: center; border-bottom: 2px dashed #000; padding-bottom: 15px; margin-bottom: 20px; }
            .header h2 { margin: 0 0 8px 0; font-size: 20px; }
            .header p { margin: 3px 0; font-size: 11px; color: #666; }
            .row { display: flex; justify-content: space-between; margin: 10px 0; font-size: 13px; }
            .row.bold { font-weight: bold; font-size: 14px; }
            .divider { border-top: 1px dashed #ccc; margin: 15px 0; }
            .total { border-top: 2px solid #000; margin-top: 20px; padding-top: 15px; }
            .total .row { font-size: 16px; font-weight: bold; }
            .balance { font-size: 18px; margin-top: 10px; }
            .balance.paid { color: #10b981; }
            .balance.debt { color: #ef4444; }
            .footer { text-align: center; margin-top: 25px; padding-top: 15px; border-top: 2px dashed #000; font-size: 11px; color: #666; }
        </style>
        </head><body>
        <div class="receipt">
            <div class="header">
                <h2>${t.name}</h2>
                <p>${t.address}</p>
                <p> ${(e.id||"").toString().slice(0,8).toUpperCase()}</p>
                <p>${new Date().toLocaleString("ru-RU")}</p>
            </div>
            
            <div class="row bold"><span>:</span><span>${e.fullName}</span></div>
            <div class="row"><span>:</span><span>${e.passport}</span></div>
            <div class="row"><span>:</span><span>${e.roomNumber},  ${e.bedId}</span></div>
            
            <div class="divider"></div>
            
            <div class="row"><span> :</span><span>${new Date(e.checkInDate).toLocaleDateString("ru-RU")}</span></div>
            <div class="row"><span> :</span><span>${e.days}</span></div>
            <div class="row"><span>  :</span><span>${(e.pricePerNight||0).toLocaleString()} </span></div>
            
            <div class="divider"></div>
            
            <div class="row bold"><span>:</span><span>${(e.totalPrice||0).toLocaleString()} </span></div>
            <div class="row" style="color: #10b981;"><span>:</span><span>${zn(e).toLocaleString()} </span></div>
            
            <div class="total">
                <div class="row balance ${(e.totalPrice||0)-zn(e)>0?"debt":"paid"}">
                    <span> :</span>
                    <span>${Math.max(0,(e.totalPrice||0)-zn(e)).toLocaleString()} </span>
                </div>
            </div>
            
            <div class="footer">
                <p>    !</p>
                <p> !</p>
            </div>
        </div>
        </body></html>`):n==="regcard"||n===""?(s+="Registration Card</title>",s+=`
        <style>
            body { font-family: Arial, sans-serif; padding: 40px; background: #f9fafb; }
            .form { background: white; max-width: 600px; margin: 0 auto; padding: 40px; border: 1px solid #ddd; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
            .form-header { text-align: center; border-bottom: 3px solid #4f46e5; padding-bottom: 20px; margin-bottom: 30px; }
            .form-header h1 { margin: 0 0 10px 0; color: #4f46e5; font-size: 24px; }
            .field { margin: 20px 0; padding: 15px; background: #f9fafb; border-left: 4px solid #4f46e5; }
            .field-label { font-size: 11px; color: #666; text-transform: uppercase; font-weight: bold; margin-bottom: 5px; }
            .field-value { font-size: 16px; color: #1f2937; font-weight: 600; }
            .signature { margin-top: 50px; border-top: 1px solid #000; padding-top: 10px; text-align: center; }
        </style>
        </head><body>
        <div class="form">
            <div class="form-header">
                <h1>  </h1>
                <p style="margin: 5px 0; color: #666;">${t.name}</p>
                <p style="margin: 0; font-size: 12px; color: #999;">${t.address}</p>
            </div>
            
            <div class="field">
                <div class="field-label"> :</div>
                <div class="field-value">${e.fullName}</div>
            </div>
            
            <div class="field">
                <div class="field-label"> :</div>
                <div class="field-value">${e.passport}</div>
            </div>
            
            <div class="field">
                <div class="field-label">:</div>
                <div class="field-value">${e.country}</div>
            </div>
            
            <div class="field">
                <div class="field-label"> :</div>
                <div class="field-value">${e.birthDate||" "}</div>
            </div>
            
            <div class="field">
                <div class="field-label"> / :</div>
                <div class="field-value">${e.roomNumber},  ${e.bedId}</div>
            </div>
            
            <div class="field">
                <div class="field-label"> :</div>
                <div class="field-value">${new Date(e.checkInDate).toLocaleString("ru-RU")}</div>
            </div>
            
            <div class="field">
                <div class="field-label"> :</div>
                <div class="field-value">${e.days} </div>
            </div>
            
            <div class="signature">
                <p style="margin: 30px 0 10px 0; font-size: 12px;"> : _______________________</p>
                <p style="margin: 0; font-size: 11px; color: #999;">: ${new Date().toLocaleDateString("ru-RU")}</p>
            </div>
        </div>
        </body></html>`):(n==="ref"||n==="")&&(s+="Reference Letter</title>",s+=`
        <style>
            body { font-family: 'Times New Roman', serif; padding: 50px; background: #f9fafb; }
            .certificate { background: white; max-width: 700px; margin: 0 auto; padding: 50px; border: 2px solid #4f46e5; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
            .cert-header { text-align: center; margin-bottom: 40px; }
            .cert-header h1 { margin: 0 0 20px 0; color: #4f46e5; font-size: 28px; text-transform: uppercase; letter-spacing: 2px; }
            .cert-number { text-align: right; font-size: 12px; color: #666; margin-bottom: 30px; }
            .cert-body { line-height: 1.8; font-size: 15px; text-align: justify; }
            .cert-body p { margin: 20px 0; }
            .cert-highlight { font-weight: bold; color: #1f2937; }
            .cert-footer { margin-top: 50px; }
            .cert-footer p { margin: 30px 0 5px 0; font-size: 13px; }
            .signature-line { border-bottom: 1px solid #000; display: inline-block; min-width: 250px; margin-left: 10px; }
            .stamp { margin-top: 30px; padding: 20px; border: 2px dashed #4f46e5; text-align: center; color: #4f46e5; font-weight: bold; }
        </style>
        </head><body>
        <div class="certificate">
            <div class="cert-header">
                <h1></h1>
                <p style="margin: 0; font-size: 14px; color: #666;">${t.name}</p>
                <p style="margin: 5px 0 0 0; font-size: 12px; color: #999;">${t.address}</p>
            </div>
            
            <div class="cert-number"> ${Date.now().toString().slice(-6)}  ${new Date().toLocaleDateString("ru-RU")}</div>
            
            <div class="cert-body">
                <p>    ,  () <span class="cert-highlight">${e.fullName}</span>,  <span class="cert-highlight">${e.passport}</span>,  <span class="cert-highlight">${e.country}</span>,  ()  ${t.name}.</p>
                
                <p><strong> :</strong>  <span class="cert-highlight">${new Date(e.checkInDate).toLocaleDateString("ru-RU")}</span>  <span class="cert-highlight">${e.days} </span>.</p>
                
                <p><strong> :</strong>  <span class="cert-highlight">${e.roomNumber}</span>,  <span class="cert-highlight">${e.bedId}</span>.</p>
                
                <p>      .</p>
            </div>
            
            <div class="cert-footer">
                <p>: <span class="signature-line"></span></p>
                <p style="margin-left: 160px; font-size: 11px; color: #666;">()</p>
                
                <div class="stamp">
                      
                </div>
            </div>
        </div>
        </body></html>`),s+="</body></html>",r.document.write(s),r.document.close(),r.print()},qP=(n,e)=>{const t=window.open("","","width=800,height=600");let s=`
    <html>
    <head>
        <title> </title>
        <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #000; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; }
            .header { text-align: center; margin-bottom: 30px; }
            .total { text-align: right; font-size: 18px; font-weight: bold; margin-top: 20px; }
            .debt { color: #d63031; font-weight: bold; }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>  </h1>
            <p>: ${new Date().toLocaleDateString()}</p>
        </div>
        <table>
            <thead>
                <tr>
                    <th> </th>
                    <th></th>
                    <th>/</th>
                    <th> </th>
                </tr>
            </thead>
            <tbody>
    `;n.forEach(i=>{s+=`
            <tr>
                <td>${i.fullName}</td>
                <td>${i.passport||"-"}</td>
                <td>${i.roomNumber?` ${i.roomNumber}`:"-"}</td>
                <td class="debt">${i.totalDebt.toLocaleString()}</td>
            </tr>
        `}),s+=`
            </tbody>
        </table>
        <div class="total"> : ${e.toLocaleString()}</div>
    </body>
    </html>
    `,t.document.write(s),t.document.close(),t.print()},GP=(n,e,t,r,s)=>{const i=window.open("","","width=800,height=600"),o=new Date(r.start).toLocaleString(),a=new Date(r.end).toLocaleString();let u=`
    <html>
    <head>
        <title> </title>
        <style>
            body { font-family: Arial, sans-serif; padding: 20px; font-size: 12px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
            th { background-color: #f2f2f2; }
            .header { text-align: center; margin-bottom: 20px; }
            .summary { display: flex; justify-content: space-between; margin: 20px 0; border: 1px solid #000; padding: 10px; }
            .income { color: green; }
            .expense { color: red; }
            .balance { font-weight: bold; font-size: 14px; }
        </style>
    </head>
    <body>
        <div class="header">
            <h2> </h2>
            <p>${o}  ${a}</p>
        </div>
        
        <div class="summary">
            <div>: <span class="income">+${e.toLocaleString()}</span></div>
            <div>: <span class="expense">-${t.toLocaleString()}</span></div>
            <div class="balance">: ${(e-t).toLocaleString()}</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
    `;n.forEach(d=>{var _;const f=((_=s.find(R=>R.id===d.staffId||R.login===d.staffId))==null?void 0:_.name)||d.staffId,m=d.type==="income"?"":"",y=d.type==="income"?"income":"expense";u+=`
            <tr>
                <td>${new Date(d.date).toLocaleString()}</td>
                <td class="${y}">${m}</td>
                <td>${parseInt(d.amount).toLocaleString()}</td>
                <td>${d.method}</td>
                <td>${f}</td>
                <td>${d.comment||"-"}</td>
            </tr>
        `}),u+=`
            </tbody>
        </table>
    </body>
    </html>
    `,i.document.write(u),i.document.close(),i.print()},mE=n=>{if(!n)return"";const e=n.trim().replace(/['"]/g,""),t=e.toLowerCase();if(O0[t])return O0[t];const r=Kl.find(s=>s.toLowerCase()===t);return r||e},ss=({children:n,className:e=""})=>c.jsx("div",{className:`bg-white rounded-2xl shadow-sm border border-slate-300 p-5 ${e}`,children:n}),Z=({children:n,onClick:e,variant:t="primary",className:r="",icon:s,disabled:i,type:o="button",title:a,size:u="md"})=>{const d=`rounded-xl font-medium transition-all duration-200 flex items-center justify-center gap-2 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 shadow-sm border ${u==="sm"?"px-3 py-1.5 text-sm":"px-4 py-2.5"}`,f={primary:"bg-indigo-600 text-white border-transparent hover:bg-indigo-700 shadow-indigo-200",secondary:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50",danger:"bg-rose-500 text-white border-transparent hover:bg-rose-600 shadow-rose-200",success:"bg-emerald-600 text-white border-transparent hover:bg-emerald-700 shadow-emerald-200",ghost:"text-slate-500 border-transparent hover:bg-slate-100 shadow-none",warning:"bg-amber-500 text-white border-transparent hover:bg-amber-600 shadow-amber-200"};return c.jsxs("button",{type:o,onClick:e,disabled:i,className:`${d} ${f[t]} ${r}`,title:a,children:[s&&c.jsx(s,{size:u==="sm"?16:18}),n]})},HP=({icon:n,label:e,active:t,onClick:r,badge:s})=>c.jsxs("button",{onClick:r,className:`whitespace-nowrap w-full flex flex-col md:flex-row items-center gap-1 md:gap-3 px-3 py-2.5 rounded-lg text-[10px] md:text-sm font-medium transition-all relative ${t?"bg-indigo-50 text-indigo-700 font-bold":"text-slate-600 hover:bg-slate-50"}`,children:[c.jsx(n,{size:20,className:t?"text-indigo-600":"text-slate-400"}),c.jsx("span",{children:e}),s>0&&c.jsx("span",{className:"absolute right-2 top-0 md:top-1/2 md:-translate-y-1/2 bg-rose-500 text-white text-[10px] font-bold rounded-full w-4 h-4 md:w-5 md:h-5 flex items-center justify-center",children:s>9?"9+":s})]}),KP=({message:n,type:e,onClose:t})=>(U.useEffect(()=>{const r=setTimeout(t,3e3);return()=>clearTimeout(r)},[t]),c.jsxs("div",{className:`fixed top-12 right-4 z-[60] px-6 py-4 rounded-xl shadow-2xl flex items-center gap-3 animate-in slide-in-from-right-10 fade-in duration-300 ${e==="error"?"bg-rose-500 text-white":"bg-slate-900 text-white"}`,children:[e==="error"?c.jsx(XT,{size:24}):c.jsx(Uo,{size:24,className:"text-emerald-400"}),c.jsx("span",{className:"font-bold",children:n})]})),WP=({currentUser:n,activeTab:e,setActiveTab:t,pendingTasksCount:r,lang:s})=>{const i=d=>Xe[s][d],o=[{id:"dashboard",label:i("dashboard"),icon:aE,role:"admin"},{id:"rooms",label:i("rooms"),icon:$d,role:"all"},{id:"calendar",label:i("calendar"),icon:ZT,role:"all"},{id:"tasks",label:i("tasks"),icon:fE,role:"all",badge:r},{id:"shifts",label:i("shifts"),icon:ug,role:"all"}],a=d=>n.role==="super"||d==="all"?!0:d===n.role,u=o.filter(d=>a(d.role)).slice(0,5);return c.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 pb-safe pt-2 px-2 flex justify-between items-center z-50 md:hidden h-16 shadow-[0_-5px_15px_rgba(0,0,0,0.05)]",children:[u.map(d=>c.jsxs("button",{onClick:()=>t(d.id),className:`flex-1 flex flex-col items-center justify-center py-1 relative ${e===d.id?"text-indigo-600":"text-slate-400"}`,children:[c.jsx(d.icon,{size:20,strokeWidth:e===d.id?2.5:2}),c.jsx("span",{className:"text-[9px] font-bold mt-1 truncate max-w-[60px]",children:d.label}),d.badge>0&&c.jsx("span",{className:"absolute top-0 right-1/4 w-2 h-2 bg-rose-500 rounded-full"})]},d.id)),c.jsxs("button",{onClick:()=>t(n.role==="admin"?"staff":"debts"),className:`flex-1 flex flex-col items-center justify-center py-1 ${e==="more"?"text-indigo-600":"text-slate-400"}`,children:[c.jsx(dE,{size:20}),c.jsx("span",{className:"text-[9px] font-bold mt-1",children:"Menu"})]})]})},QP=({currentUser:n,activeTab:e,setActiveTab:t,onLogout:r,lang:s,setLang:i,pendingTasksCount:o,selectedHostelView:a,setSelectedHostelView:u})=>{const d=_=>Xe[s][_],f=n.role==="viewer",m=[{id:"dashboard",label:d("dashboard"),icon:aE,role:"admin"},{id:"rooms",label:d("rooms"),icon:$d,role:"all"},{id:"calendar",label:d("calendar"),icon:ZT,role:"all"},{id:"reports",label:d("reports"),icon:EP,role:"admin"},{id:"debts",label:d("debts"),icon:TP,role:"all"},{id:"shifts",label:d("shifts"),icon:ug,role:"all"},{id:"tasks",label:d("tasks"),icon:fE,role:"all",badge:o},{id:"expenses",label:d("expenses"),icon:Hl,role:"admin"},{id:"clients",label:d("clients"),icon:hE,role:"admin"},{id:"staff",label:d("staff"),icon:dE,role:"admin"}],y=_=>n.role==="super"||_==="all"||n.role==="viewer"&&(_==="admin"||_==="viewer")?!0:_===n.role;return c.jsxs("div",{className:"w-56 bg-white h-screen border-r border-slate-200 flex flex-col p-4 fixed md:relative z-20 hidden md:flex",children:[c.jsxs("div",{className:"text-2xl font-bold text-indigo-600 mb-8 flex items-center gap-2 pl-2",children:[c.jsx(lg,{})," Hostella"]}),c.jsxs("div",{className:"mb-4 flex bg-slate-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>i("ru"),className:`flex-1 py-1 text-xs font-bold rounded ${s==="ru"?"bg-white shadow text-indigo-600":"text-slate-500"}`,children:"RU"}),c.jsx("button",{onClick:()=>i("uz"),className:`flex-1 py-1 text-xs font-bold rounded ${s==="uz"?"bg-white shadow text-indigo-600":"text-slate-500"}`,children:"UZ"})]}),f&&u&&c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 mb-2 block uppercase tracking-wide",children:""}),c.jsxs("select",{className:"w-full px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium",value:a,onChange:_=>u(_.target.value),children:[c.jsx("option",{value:"hostel1",children:" 1 ()"}),c.jsx("option",{value:"hostel2",children:" 2 ()"})]})]}),c.jsx("div",{className:"space-y-1 flex-1 overflow-y-auto",children:m.filter(_=>y(_.role)).map(_=>c.jsx(HP,{icon:_.icon,label:_.label,active:e===_.id,onClick:()=>t(_.id),badge:_.badge},_.id))}),c.jsxs("div",{className:"border-t border-slate-100 pt-4 mt-auto",children:[c.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 mb-2 bg-slate-50 rounded-xl",children:[c.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-700 font-bold uppercase shrink-0",children:n.name[0]}),c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("div",{className:"font-bold text-sm truncate text-slate-700",children:n.name}),c.jsx("div",{className:"text-[10px] text-slate-500 capitalize uppercase tracking-wider",children:n.role==="super"?"Super Admin":n.role==="admin"?d("admin"):n.role==="viewer"?"Viewer":d("cashier")})]})]}),c.jsx(Z,{variant:"ghost",className:"w-full justify-start text-orange-600 hover:bg-orange-50 hover:text-orange-700",icon:cg,onClick:r,children:d("logout")})]})]})},YP=({users:n,onLogin:e,onSeed:t,lang:r,setLang:s})=>{const i=m=>Xe[r][m],[o,a]=U.useState(""),[u,d]=U.useState(""),f=m=>{if(m.preventDefault(),o==="Super"&&u==="super"){e({name:"Super Admin",login:"Super",role:"super",hostelId:"all"});return}const y=n.find(_=>_.login.toLowerCase()===o.toLowerCase()&&_.pass===u);y?e(y):alert(i("error"))};return c.jsxs("div",{className:"fixed inset-0 w-screen h-screen bg-slate-50 flex items-center justify-center z-[100] p-4",children:[c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[c.jsx("button",{onClick:()=>s("ru"),className:`px-3 py-1 rounded ${r==="ru"?"bg-indigo-600 text-white":"bg-white"}`,children:"RU"}),c.jsx("button",{onClick:()=>s("uz"),className:`px-3 py-1 rounded ${r==="uz"?"bg-indigo-600 text-white":"bg-white"}`,children:"UZ"})]}),c.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md border border-slate-100 flex flex-col items-center",children:[c.jsx("div",{className:"bg-indigo-600 p-4 rounded-2xl mb-6 shadow-lg shadow-indigo-200",children:c.jsx(lg,{className:"text-white",size:40})}),c.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Hostella"}),c.jsx("p",{className:"text-slate-500 mb-8 text-center",children:"  "}),c.jsxs("form",{onSubmit:f,className:"space-y-5 w-full",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("login")}),c.jsx("input",{className:ie,value:o,onChange:m=>a(m.target.value),placeholder:"admin",autoFocus:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("pass")}),c.jsx("input",{type:"password",className:ie,value:u,onChange:m=>d(m.target.value),placeholder:""})]}),c.jsx(Z,{type:"submit",className:"w-full py-4 text-lg shadow-xl shadow-indigo-100 mt-4",children:i("enter")})]}),c.jsx("div",{className:"mt-8 text-center pt-6 border-t border-slate-100 w-full",children:c.jsx("button",{onClick:t,className:"text-xs text-slate-400 hover:text-indigo-500 transition-colors",children:i("initDb")})})]})]})},JP=({rooms:n,guests:e,payments:t,lang:r,currentHostelId:s})=>{const i=E=>Xe[r][E],o=On[s],a=s==="all"?n:n.filter(E=>E.hostelId===s),u=a.reduce((E,v)=>E+parseInt(v.capacity),0),d=new Date,f=e.filter(E=>{if(s!=="all"&&E.hostelId!==s||E.status!=="active")return!1;const v=E.checkInDate||E.checkInDateTime||E.checkIn,b=E.checkOutDate;if(!v||!b)return!1;const I=new Date(v),D=new Date(b);return typeof v=="string"&&!v.includes("T")&&I.setHours(12,0,0,0),typeof b=="string"&&!b.includes("T")&&D.setHours(12,0,0,0),d>=I&&d<D}).length,m=E=>{if(!E)return"";const v=new Date(E),b=v.getTimezoneOffset()*6e4;return new Date(v.getTime()-b).toISOString().slice(0,10)},y=m(new Date),_=t?t.filter(E=>s!=="all"&&E.hostelId!==s?!1:m(E.date)===y).reduce((E,v)=>E+(parseInt(v.amount)||0),0):0,R=e.filter(E=>s!=="all"&&E.hostelId!==s?!1:m(E.checkInDate||E.checkIn)===y&&E.status==="active").length,A=u?Math.round(f/u*100):0,k=Math.max(0,u-f);return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[c.jsxs(ss,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(hE,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("guests")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800 mt-1",children:f})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:[i("today"),": +",R]})]}),c.jsxs(ss,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx($d,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("occupancy")}),c.jsxs("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:[A,"%"]})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:[": ",f," / : ",k]})]}),c.jsxs(ss,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(Hl,{size:64})}),c.jsxs("div",{children:[c.jsxs("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:[i("revenue")," (",i("today"),")"]}),c.jsx("div",{className:"text-2xl font-bold text-emerald-600 mt-1",children:_.toLocaleString()})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:["Hostel: ",(o==null?void 0:o.name)||s]})]}),c.jsxs(ss,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(lg,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("rooms")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800 mt-1",children:a.length})]}),c.jsx("div",{className:"text-xs text-slate-400 mt-auto",children:i("total")})]})]})},XP=({guests:n,rooms:e,payments:t=[],lang:r})=>{const s=I=>Xe[r][I],[i,o]=U.useState(7),a=e.reduce((I,D)=>I+parseInt(D.capacity),0),u=new Date,d=n.filter(I=>{if(I.status!=="active")return!1;const D=I.checkInDate||I.checkInDateTime||I.checkIn;if(!D)return!1;const P=new Date(D);typeof D=="string"&&!D.includes("T")&&P.setHours(12,0,0,0);const w=I.checkOutDate;if(!w)return!1;const g=new Date(w);return typeof w=="string"&&!w.includes("T")&&g.setHours(12,0,0,0),u>=P&&u<g}).length,f=a>0?d/a*100:0,m=Array.from({length:i},(I,D)=>{const P=new Date;return P.setDate(P.getDate()-(i-1-D)),{iso:P.toISOString().split("T")[0],label:P.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"})}}),y=m.map(I=>{const D=t.filter(P=>P.date&&P.date.startsWith(I.iso)).reduce((P,w)=>P+(parseInt(w.amount)||0),0);return{date:I.label,value:D}}),_=Math.max(...y.map(I=>I.value),1e5),R=t.filter(I=>I.date>=m[0].iso),A={cash:0,card:0,qr:0};R.forEach(I=>{I.method==="cash"&&(A.cash+=parseInt(I.amount)||0),I.method==="card"&&(A.card+=parseInt(I.amount)||0),I.method==="qr"&&(A.qr+=parseInt(I.amount)||0)});const k=A.cash+A.card+A.qr||1,E={};n.filter(I=>I.status==="active").forEach(I=>{const D=I.country||"Unknown";E[D]=(E[D]||0)+1});const v=Object.entries(E).sort((I,D)=>D[1]-I[1]).slice(0,4),b=v.length>0?v[0][1]:1;return c.jsxs(c.Fragment,{children:[c.jsxs(ss,{className:"flex flex-col items-center justify-center relative",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:s("occupancy")}),c.jsxs("div",{className:"relative w-40 h-40",children:[c.jsxs("svg",{viewBox:"0 0 36 36",className:"w-full h-full transform -rotate-90",children:[c.jsx("path",{className:"text-slate-100",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3"}),c.jsx("path",{className:"text-indigo-600",strokeDasharray:`${isNaN(f)?0:f}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-indigo-900",children:[c.jsxs("span",{className:"text-3xl font-bold",children:[Math.round(f),"%"]}),c.jsxs("span",{className:"text-xs text-slate-400",children:[d,"/",a]})]})]})]}),c.jsxs(ss,{className:"flex flex-col justify-end",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase",children:s("revenue")}),c.jsxs("div",{className:"flex bg-slate-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>o(7),className:`px-2 py-0.5 text-xs rounded-md transition-all ${i===7?"bg-white shadow-sm font-bold":"text-slate-500"}`,children:"7"}),c.jsx("button",{onClick:()=>o(14),className:`px-2 py-0.5 text-xs rounded-md transition-all ${i===14?"bg-white shadow-sm font-bold":"text-slate-500"}`,children:"14"})]})]}),c.jsx("div",{className:"flex justify-between items-end h-40 gap-1",children:y.map((I,D)=>c.jsxs("div",{className:"flex flex-col items-center flex-1 group relative h-full justify-end",children:[c.jsx("div",{className:"w-full bg-emerald-100 rounded-t-sm hover:bg-emerald-200 transition-all relative",style:{height:`${I.value/_*100}%`,minHeight:I.value>0?"4px":"0"},children:c.jsx("div",{className:"hidden group-hover:block absolute bottom-full mb-1 left-1/2 -translate-x-1/2 text-xs bg-slate-800 text-white p-1 rounded z-10 whitespace-nowrap",children:I.value.toLocaleString()})}),c.jsx("span",{className:"text-[10px] text-slate-400 mt-2 whitespace-nowrap",children:I.date})]},D))})]}),c.jsxs(ss,{className:"flex flex-col",children:[c.jsxs("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:[s("payment")," (",i," d)"]}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("cash")}),c.jsxs("span",{children:[Math.round(A.cash/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${A.cash/k*100}%`}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("card")}),c.jsxs("span",{children:[Math.round(A.card/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-500",style:{width:`${A.card/k*100}%`}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("qr")}),c.jsxs("span",{children:[Math.round(A.qr/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-amber-500",style:{width:`${A.qr/k*100}%`}})})]})]})]}),c.jsxs(ss,{className:"flex flex-col",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:"Top Country"}),c.jsxs("div",{className:"space-y-3",children:[v.map(([I,D])=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 text-xs text-slate-600 truncate",children:I}),c.jsx("div",{className:"flex-[2] h-2 bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-indigo-500",style:{width:`${D/b*100}%`}})}),c.jsx("div",{className:"text-xs font-bold text-slate-700",children:D})]},I)),v.length===0&&c.jsx("div",{className:"text-xs text-slate-400 text-center mt-10",children:s("noData")})]})]})]})},ZP=({targetDate:n,lang:e})=>{const[t,r]=U.useState(""),s=i=>Xe[e][i];return U.useEffect(()=>{const i=()=>{const a=new Date,d=new Date(n)-a;if(d<=0)r(s("timeOut"));else{const f=Math.floor(d/36e5),m=Math.floor(d%(1e3*60*60)/(1e3*60));r(`${f}h ${m}m`)}};i();const o=setInterval(i,6e4);return()=>clearInterval(o)},[n,e]),c.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[c.jsx(Nl,{size:12,className:"text-rose-500 animate-pulse"}),c.jsxs("span",{className:"text-[10px] font-bold text-rose-600",children:[s("checkoutWarn"),": ",t]})]})},eD=({room:n,guests:e,isAdmin:t,onEdit:r,onClone:s,onDelete:i,onBedClick:o,lang:a})=>{const u=y=>Xe[a][y],d=Array.from({length:n.capacity},(y,_)=>_+1),f=new Date,m=new Date;return m.setDate(m.getDate()-2),c.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col hover:shadow-md transition-all",children:[c.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[c.jsxs("h3",{className:"font-bold text-lg text-slate-700 flex items-center gap-2",children:[c.jsxs("span",{className:"bg-slate-200 px-3 py-1 rounded-md text-sm text-slate-700 font-bold border border-slate-200",children:[u("room")," ",n.number]}),c.jsxs("span",{className:"text-xs font-normal text-slate-400",children:["(",n.capacity,")"]})]}),t&&c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:r,className:"p-2 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded transition-all",children:c.jsx(Gl,{size:16})}),c.jsx("button",{onClick:s,className:"p-2 bg-emerald-100 text-emerald-700 hover:bg-emerald-200 rounded transition-all",children:c.jsx(rE,{size:16})}),c.jsx("button",{onClick:i,className:"p-2 bg-rose-100 text-rose-700 hover:bg-rose-200 rounded transition-all",children:c.jsx(Xo,{size:16})})]})]}),c.jsx("div",{className:"p-4 grid grid-cols-2 gap-3 flex-1",children:d.map(y=>{const _=e.find(x=>{const S=String(x.bedId)===String(y),C=x.status==="active"||x.status==="booking";if(!S||!C)return!1;const j=new Date(x.checkInDate||x.checkInDateTime||x.checkIn);x.checkInDate.includes("T")||j.setHours(12,0,0,0);const N=parseInt(x.days),Y=new Date(j.getTime()+N*24*60*60*1e3);return f>=j&&f<Y});let R=null;if(!_){const x=e.filter(S=>String(S.roomId)===String(n.id)&&String(S.bedId)===String(y)&&S.status==="checked_out"&&new Date(S.checkOutDate)>m).sort((S,C)=>new Date(C.checkOutDate)-new Date(S.checkOutDate));x.length>0&&(R=x[0])}let A=null;if(!_){const x=e.filter(S=>{if(String(S.roomId)!==String(n.id)||String(S.bedId)!==String(y)||S.status!=="active"&&S.status!=="booking")return!1;const C=new Date(S.checkInDate||S.checkInDateTime||S.checkIn);return S.checkInDate.includes("T")||C.setHours(12,0,0,0),C>f}).sort((S,C)=>new Date(S.checkInDate)-new Date(C.checkInDate));x.length>0&&(A=x[0])}const k=(_==null?void 0:_.status)==="booking",E=_?zn(_):0,v=_?_.totalPrice-E:0;let b=null;if(_){const x=new Date(_.checkInDate||_.checkInDateTime||_.checkIn);x.setHours(12,0,0,0),b=new Date(x.getTime()+parseInt(_.days)*24*60*60*1e3),b.setHours(12,0,0,0)}const I=b&&b<new Date;let D="bg-white border-slate-100 hover:border-indigo-300 hover:shadow-sm",P="bg-slate-100 text-slate-400",w="text-slate-700",g=!1;if(_&&!k){I?v<=0?(D="bg-slate-200 border-slate-300",P="bg-slate-300 text-slate-500",w="text-slate-500"):(D="bg-rose-50 border-rose-200",P="bg-white/50 text-rose-700",w="text-rose-900"):v>0?(D="bg-rose-50 border-rose-200",P="bg-white/50 text-rose-700",w="text-rose-900"):(D="bg-emerald-50 border-emerald-200",P="bg-white/50 text-emerald-700",w="text-emerald-900");const x=b-f,S=12*60*60*1e3;x>0&&x<S&&(g=!0)}else k?(D="bg-amber-50 border-amber-200",P="bg-white/50 text-amber-600",w="text-amber-900"):R&&(D="bg-slate-50 border-slate-200 opacity-70",P="bg-slate-200 text-slate-400",w="text-slate-400 italic");return c.jsxs("div",{onClick:()=>o(y,_||R,!!R),className:`cursor-pointer rounded-xl p-3 border transition-all relative min-h-[90px] flex flex-col justify-between group overflow-hidden ${D}`,children:[(_&&I&&v<=0||R)&&c.jsxs("div",{className:"absolute inset-0 bg-slate-800/90 z-10 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity p-2 gap-2",children:[c.jsx("span",{className:"text-white text-[10px] font-bold text-center mb-1",children:R?"Checked Out":"Time Out"}),c.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[_&&c.jsx("button",{className:"bg-emerald-500 text-white text-[10px] py-1.5 rounded font-bold hover:bg-emerald-600 w-full",children:u("extend")}),c.jsxs("button",{onClick:x=>{x.stopPropagation(),o(y,null,!1)},className:"bg-indigo-500 text-white text-[10px] py-1.5 rounded font-bold hover:bg-indigo-600 w-full flex items-center justify-center gap-1",children:[c.jsx(Bo,{size:12})," ",u("checkinNew")]})]})]}),c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded uppercase tracking-wide ${P}`,children:[y," ",y%2===0?"Up":"Dn"]}),_&&(k?c.jsx(Nl,{size:14,className:"text-amber-500"}):c.jsx(ed,{size:14,className:I&&v<=0?"text-slate-400":v>0?"text-rose-400":"text-emerald-400"})),R&&c.jsx(oE,{size:14,className:"text-slate-300"})]}),_||R?c.jsxs("div",{className:"mt-2 overflow-hidden",children:[c.jsx("div",{className:`font-bold text-sm leading-tight truncate ${w}`,children:(_||R).fullName}),c.jsxs("div",{className:"flex justify-between items-end mt-1",children:[c.jsx("div",{className:"text-[10px] opacity-70",children:k?u("booking"):`${(_||R).days} ${u("days")}`}),!k&&v>0&&c.jsxs("div",{className:"text-[10px] font-bold text-rose-600 bg-rose-100 px-1 rounded",children:["-",v.toLocaleString()]})]}),g&&b&&c.jsx(ZP,{targetDate:b,lang:a}),I&&v<=0&&c.jsx("div",{className:"text-[9px] font-bold text-slate-500 mt-1 uppercase tracking-wide",children:"Time Out"})]}):c.jsx("div",{className:"mt-auto text-center",children:A?c.jsxs("div",{className:"text-left",children:[c.jsxs("div",{className:"text-[10px] text-slate-400 font-medium uppercase",children:[u("freeFor")," ",Math.max(0,Math.ceil((new Date(A.checkInDate)-f)/(1e3*60*60*24)))," ",u("days")]}),c.jsxs("div",{className:"text-xs font-bold text-slate-500 truncate flex items-center gap-1",children:[c.jsx(Nl,{size:10})," ",A.fullName]})]}):c.jsx(Bo,{className:"mx-auto text-slate-200 group-hover:text-indigo-400 transition-colors",size:20})})]},y)})})]})},tD=({rooms:n,guests:e,onSlotClick:t,lang:r,currentUser:s,onDeleteGuest:i})=>{const o=P=>Xe[r][P],[a,u]=U.useState({}),[d,f]=U.useState(new Date),m=P=>{const w=new Date(d);w.setDate(w.getDate()+P),f(w)},y=14,_=Array.from({length:y},(P,w)=>{const g=new Date(d);return g.setDate(g.getDate()+w),{date:g,str:fp(g),day:g.getDate(),month:g.getMonth()+1,week:g.toLocaleDateString("ru-RU",{weekday:"short"})}}),R=P=>{u(w=>({...w,[P]:!w[P]}))},A=new Date;A.setDate(A.getDate()-7);const k=e.filter(P=>P.status==="checked_out"?new Date(P.checkOutDate)>A:!0),E=s.role==="admin"||s.role==="super",v=P=>{if(P.status==="booking")return"bg-amber-400 border-amber-500";if(P.status==="checked_out")return"bg-slate-400 border-slate-500";const w=new Date,g=new Date(P.checkOutDate);if(typeof P.checkOutDate=="string"&&!P.checkOutDate.includes("T")&&g.setHours(12,0,0,0),w>g)return"bg-slate-400 border-slate-500 opacity-90";const x=P.totalPrice||0,S=zn(P);return x-S<=0?"bg-emerald-500 border-emerald-600":"bg-rose-500 border-rose-600"},b=P=>{let w=new Date(P.checkInDate||P.checkInDateTime||P.checkIn);w.setHours(12,0,0,0);const g=new Date(_[0].str);g.setHours(0,0,0,0);let x;if(P.status==="checked_out"&&P.checkOutDate)x=new Date(P.checkOutDate),x.setHours(12,0,0,0);else{const W=parseInt(P.days)*24*60*60*1e3;x=new Date(w.getTime()+W),x.setHours(12,0,0,0)}const S=new Date(_[_.length-1].str);if(S.setHours(23,59,59,999),x<g||w>S)return null;const j=1e3*60*60*24*y;let N=w.getTime()-g.getTime(),Y=x.getTime()-w.getTime();N<0&&(Y+=N,N=0);const L=N/j*100,xe=Y/j*100,we=100-L,q=Math.min(xe,we);return{leftPercent:L,widthPercent:q}},I=(P,w,g,x)=>{const S=new Date(g);x||S.setDate(S.getDate()-1),S.setHours(12,0,0,0),t(P,w,null,S.toISOString())},D=(P,w)=>{P.stopPropagation(),confirm(o("confirmDelete"))&&i(w)};return c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-slate-200 shadow-sm",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>m(-1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:c.jsx(tE,{size:20})}),c.jsx("button",{onClick:()=>{const P=new Date;P.setHours(0,0,0,0),f(P)},className:"px-4 py-1.5 bg-indigo-50 text-indigo-700 rounded-lg text-sm font-bold hover:bg-indigo-100",children:o("today")}),c.jsx("button",{onClick:()=>m(7),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:c.jsx(nE,{size:20})})]}),c.jsxs("div",{className:"text-sm font-bold text-slate-700 bg-slate-50 px-3 py-1 rounded-md border border-slate-200",children:[_[0].date.toLocaleDateString(),"  ",_[_.length-1].date.toLocaleDateString()]})]}),c.jsx("div",{className:"flex-1 overflow-auto relative",children:c.jsxs("div",{className:"min-w-[1600px]",children:[c.jsxs("div",{className:"flex sticky top-0 bg-white z-40 border-b border-slate-200 shadow-sm h-12",children:[c.jsxs("div",{className:"w-40 p-3 font-bold text-xs text-slate-500 bg-slate-50 border-r border-slate-200 sticky left-0 z-50",children:[o("room")," / ",o("bed")]}),_.map(P=>c.jsxs("div",{className:`flex-1 min-w-[80px] flex flex-col items-start justify-center px-2 border-r border-slate-100 ${["",""].includes(P.week)?"bg-rose-50":""}`,children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:P.week}),c.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[P.day,".",P.month]})]},P.str))]}),n.map(P=>{const w=a[P.id],g=r==="uz"?`Xona ${P.number}`:` ${P.number}`;return c.jsxs("div",{className:"border-b border-slate-200",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-100 hover:bg-slate-200 cursor-pointer font-bold text-slate-700 text-sm sticky left-0 z-30 border-r border-slate-200 w-40 border-b border-slate-200",onClick:()=>R(P.id),children:[c.jsx("span",{children:g}),w?c.jsx(wP,{size:16}):c.jsx(IP,{size:16})]}),!w&&Array.from({length:P.capacity},(x,S)=>S+1).map(x=>{const S=k.filter(C=>C.roomId===P.id&&String(C.bedId)===String(x));return c.jsxs("div",{className:"flex h-16 border-b border-slate-50 last:border-b-0 relative",children:[c.jsxs("div",{className:"w-40 px-4 flex items-center justify-between border-r border-slate-200 bg-white sticky left-0 z-30 text-xs font-bold text-slate-500",children:[c.jsxs("span",{children:[o("bed")," ",x]}),c.jsx("span",{className:"text-[9px] px-1.5 py-0.5 bg-slate-100 rounded text-slate-400",children:x%2===0?"Up":"Dn"})]}),c.jsxs("div",{className:"flex-1 relative",children:[c.jsx("div",{className:"absolute inset-0 flex",children:_.map(C=>c.jsxs("div",{className:`flex-1 min-w-[80px] border-r border-slate-100 h-full flex ${["",""].includes(C.week)?"bg-rose-50":""}`,children:[c.jsx("div",{className:"w-1/2 h-full cursor-pointer hover:bg-indigo-50 border-r border-slate-200/30",onClick:()=>I(P,x,C.str,!1)}),c.jsx("div",{className:"w-1/2 h-full cursor-pointer hover:bg-indigo-50",onClick:()=>I(P,x,C.str,!0)})]},C.str))}),S.map(C=>{const j=b(C);if(!j)return null;v(C);const N=(C.totalPrice||0)-zn(C),Y=N>0,L=C.status==="checked_out",xe=C.status==="booking",we=zn(C),q=C.totalPrice||1,W=Math.min(100,we/q*100);return c.jsxs("div",{className:"absolute top-1 bottom-1 z-20 rounded-md shadow-sm cursor-pointer hover:z-50 hover:shadow-lg border group/block overflow-hidden flex items-center",style:{left:`${j.leftPercent}%`,width:`${j.widthPercent}%`,background:L?"#94a3b8":xe?"#fbbf24":`linear-gradient(to right, #10b981 0%, #10b981 ${W}%, #ef4444 ${W}%, #ef4444 100%)`},onClick:ne=>{ne.stopPropagation(),t(P,x,C,null)},title:C.fullName,children:[c.jsxs("div",{className:"sticky left-0 pl-1 pr-1 flex flex-col justify-center h-full w-full max-w-full z-50",children:[c.jsxs("span",{className:"font-bold text-[10px] text-white whitespace-nowrap overflow-hidden text-ellipsis px-1.5 py-0.5 rounded-sm bg-black/40 w-fit block relative",children:[C.status==="booking"&&" ",C.fullName]}),!L&&Y&&c.jsxs("span",{className:"text-[9px] font-bold mt-0.5 px-1.5 py-px rounded w-fit bg-white text-rose-600 shadow-sm border border-rose-200 relative",children:["-",N.toLocaleString()]}),!L&&!Y&&c.jsx("span",{className:"text-[9px] font-bold mt-0.5 px-1 py-px rounded w-fit bg-white/90 text-emerald-700 shadow-sm relative",children:" OK"}),L&&c.jsx("span",{className:"text-[9px] text-white/90 italic ml-1",children:"OUT"})]}),L&&E&&c.jsx("button",{onClick:ne=>D(ne,C.id),className:"absolute right-1 top-1 p-1 bg-white hover:bg-rose-500 hover:text-white rounded-full text-slate-700 shadow-md hidden group-hover/block:block z-50",title:o("delete"),children:c.jsx(MP,{size:10,strokeWidth:3})})]},C.id)})]})]},x)})]},P.id)})]})})]})},nD=({users:n,onAdd:e,onDelete:t,lang:r})=>{const s=u=>Xe[r][u],[i,o]=U.useState({name:"",login:"",pass:"",role:"cashier",hostelId:"hostel1"}),a=n.filter(u=>u.login!=="Super");return c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[c.jsx("h3",{className:"font-bold text-lg",children:s("staff")}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:s("guestName")}),c.jsx("th",{className:"p-4",children:s("login")}),c.jsx("th",{className:"p-4",children:s("role")}),c.jsx("th",{className:"p-4",children:"Hostel"}),c.jsx("th",{className:"p-4",children:s("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:a.map(u=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-4 font-medium",children:u.name}),c.jsx("td",{className:"p-4 text-slate-500 font-mono",children:u.login}),c.jsx("td",{className:"p-4",children:c.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs",children:u.role==="admin"?s("admin"):s("cashier")})}),c.jsx("td",{className:"p-4 text-slate-500",children:u.hostelId}),c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>t(u.id),className:"text-rose-500 hover:bg-rose-50 p-2 rounded",children:c.jsx(Xo,{size:16})})})]},u.id||u.login))})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 h-min",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:"Add"}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:ie,placeholder:"Name",value:i.name,onChange:u=>o({...i,name:u.target.value})}),c.jsx("input",{className:ie,placeholder:"Login",value:i.login,onChange:u=>o({...i,login:u.target.value})}),c.jsx("input",{className:ie,placeholder:"Pass",value:i.pass,onChange:u=>o({...i,pass:u.target.value})}),c.jsxs("select",{className:ie,value:i.role,onChange:u=>o({...i,role:u.target.value}),children:[c.jsx("option",{value:"cashier",children:s("cashier")}),c.jsx("option",{value:"admin",children:s("admin")})]}),c.jsx(Z,{onClick:()=>e(i),className:"w-full",children:s("save")})]})]})]})},rD=({onClose:n,onImport:e,lang:t})=>{const r=f=>Xe[t][f],[s,i]=U.useState([]),[o,a]=U.useState(""),u=f=>{const m=f.target.files[0];if(!m)return;const y=new FileReader;y.onload=_=>{const R=_.target.result;a(R);const k=R.split(`
`).map(E=>E.split(",")).filter(E=>E.length>=2).map(E=>{var b,I,D,P,w,g;const v=((b=E[3])==null?void 0:b.replace(/['"]/g,"").trim())||"";return{fullName:(D=(I=E[0])==null?void 0:I.replace(/['"]/g,"").trim())==null?void 0:D.toUpperCase(),passport:(w=(P=E[1])==null?void 0:P.replace(/['"]/g,"").trim())==null?void 0:w.toUpperCase(),birthDate:(g=E[2])==null?void 0:g.replace(/['"]/g,"").trim(),country:mE(v)}}).filter(E=>E.fullName&&E.passport);i(k)},y.readAsText(m)},d=()=>{e(s),n()};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl p-6 shadow-xl flex flex-col max-h-[90vh]",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[c.jsx(DP,{size:20})," ",r("import")]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-slate-500 mb-2",children:"CSV Format: Name,Passport,BirthDate,Country"}),c.jsx("input",{type:"file",accept:".csv",onChange:u,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]}),s.length>0&&c.jsx("div",{className:"flex-1 overflow-auto border border-slate-200 rounded-lg mb-4",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2",children:"Name"}),c.jsx("th",{className:"p-2",children:"Passport"}),c.jsx("th",{className:"p-2",children:"Country"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:s.map((f,m)=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-2",children:f.fullName}),c.jsx("td",{className:"p-2",children:f.passport}),c.jsx("td",{className:"p-2",children:f.country})]},m))})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Z,{onClick:d,disabled:s.length===0,className:"flex-1",children:[r("save")," (",s.length,")"]}),c.jsx(Z,{variant:"secondary",onClick:n,className:"flex-1",children:r("cancel")})]})]})})},sD=({clients:n,onUpdateClient:e,onImportClients:t,onDeduplicate:r,onBulkDelete:s,onNormalizeCountries:i,lang:o,currentUser:a})=>{const u=Y=>Xe[o][Y],[d,f]=U.useState(""),[m,y]=U.useState(null),[_,R]=U.useState(!1),[A,k]=U.useState(new Set),[E,v]=U.useState({page:1,perPage:25}),[b,I]=U.useState(""),D=a&&(a.role==="admin"||a.role==="super"),P=U.useMemo(()=>{let Y=n;return d.length>1&&(Y=Y.filter(L=>(L.fullName||"").toLowerCase().includes(d.toLowerCase())||(L.passport||"").toLowerCase().includes(d.toLowerCase()))),b&&(Y=Y.filter(L=>L.country===b)),Y},[n,d,b]),w=U.useMemo(()=>{const Y=(E.page-1)*E.perPage,L=Y+E.perPage;return P.slice(Y,L)},[P,E]),g=Math.ceil(P.length/E.perPage),x=Y=>{Y.target.checked?k(new Set(w.map(L=>L.id))):k(new Set)},S=Y=>{const L=new Set(A);L.has(Y)?L.delete(Y):L.add(Y),k(L)},C=()=>{confirm(`${u("deleteSelected")} (${A.size})?`)&&(s(Array.from(A)),k(new Set))},j=()=>{confirm("Normalize all countries?")&&i()},N=Y=>{Y>=1&&Y<=g&&v(L=>({...L,page:Y}))};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(RP,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),c.jsx("input",{className:`${ie} pl-10`,placeholder:u("search"),value:d,onChange:Y=>f(Y.target.value)})]}),c.jsxs("select",{className:ie,value:b,onChange:Y=>{I(Y.target.value),v(L=>({...L,page:1}))},style:{minWidth:"200px"},children:[c.jsx("option",{value:"",children:" "}),Kl.map(Y=>c.jsx("option",{value:Y,children:Y},Y))]}),c.jsxs("select",{className:ie,value:E.perPage,onChange:Y=>v({page:1,perPage:parseInt(Y.target.value)}),style:{minWidth:"120px"},children:[c.jsx("option",{value:"25",children:"25 "}),c.jsx("option",{value:"50",children:"50 "}),c.jsx("option",{value:"100",children:"100 "})]}),c.jsx("div",{className:"flex gap-2 flex-wrap",children:D&&c.jsxs(c.Fragment,{children:[c.jsx(Z,{icon:NP,variant:"secondary",onClick:r,title:"Merge duplicates",children:u("deduplicate")}),c.jsx(Z,{icon:bP,variant:"secondary",onClick:j,title:"Fix country names",children:u("normalizeCountries")}),c.jsx(Z,{icon:iE,variant:"secondary",onClick:()=>R(!0),children:"Import CSV"}),A.size>0&&c.jsx(Z,{icon:Xo,variant:"danger",onClick:C,children:u("deleteSelected")})]})})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left min-w-[600px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[D&&c.jsx("th",{className:"p-4 w-10",children:c.jsx("input",{type:"checkbox",onChange:x,checked:A.size>0&&A.size===w.length,className:"rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"})}),c.jsx("th",{className:"p-4",children:u("guestName")}),c.jsx("th",{className:"p-4",children:u("passport")}),c.jsx("th",{className:"p-4",children:u("birthDate")}),c.jsx("th",{className:"p-4",children:u("country")}),c.jsx("th",{className:"p-4",children:"Visits"}),c.jsx("th",{className:"p-4",children:"Last Visit"}),c.jsx("th",{className:"p-4",children:u("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:w.map(Y=>c.jsxs("tr",{className:A.has(Y.id)?"bg-indigo-50":"",children:[D&&c.jsx("td",{className:"p-4",children:c.jsx("input",{type:"checkbox",checked:A.has(Y.id),onChange:()=>S(Y.id),className:"rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"})}),c.jsx("td",{className:"p-4 font-bold",children:Y.fullName}),c.jsx("td",{className:"p-4 font-mono text-indigo-600",children:Y.passport}),c.jsx("td",{className:"p-4",children:Y.birthDate||"-"}),c.jsx("td",{className:"p-4",children:Y.country}),c.jsx("td",{className:"p-4",children:Y.visits}),c.jsx("td",{className:"p-4 text-slate-500",children:new Date(Y.lastVisit).toLocaleDateString()}),c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>y(Y),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded",children:c.jsx(Gl,{size:16})})})]},Y.id))})]})}),c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"text-sm text-slate-600",children:[" ",(E.page-1)*E.perPage+1," - ",Math.min(E.page*E.perPage,P.length),"  ",P.length]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"secondary",onClick:()=>N(E.page-1),disabled:E.page===1,icon:tE,size:"sm"}),c.jsxs("span",{className:"px-4 py-2 text-sm font-bold text-slate-700",children:[E.page," / ",g||1]}),c.jsx(Z,{variant:"secondary",onClick:()=>N(E.page+1),disabled:E.page>=g,icon:nE,size:"sm"})]})]}),m&&c.jsx(iD,{client:m,onClose:()=>y(null),onSave:Y=>{e(m.id,Y),y(null)},lang:o}),_&&c.jsx(rD,{onClose:()=>R(!1),onImport:Y=>{t(Y),R(!1)},lang:o})]})},iD=({client:n,onClose:e,onSave:t,lang:r})=>{const s=a=>Xe[r][a],[i,o]=U.useState({...n});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:s("edit")}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("guestName")}),c.jsx("input",{className:ie,value:i.fullName,onChange:a=>o({...i,fullName:a.target.value.toUpperCase()})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("passport")}),c.jsx("input",{className:ie,value:i.passport,onChange:a=>o({...i,passport:a.target.value.toUpperCase()})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("birthDate")}),c.jsx("input",{type:"date",className:ie,value:i.birthDate,onChange:a=>o({...i,birthDate:a.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("country")}),c.jsx("select",{className:ie,value:i.country,onChange:a=>o({...i,country:a.target.value}),children:Kl.map(a=>c.jsx("option",{children:a},a))})]}),c.jsx(Z,{onClick:()=>t(i),children:s("save")}),c.jsx(Z,{variant:"secondary",onClick:e,children:s("cancel")})]})]})})},oD=({tasks:n,users:e,currentUser:t,onAddTask:r,onCompleteTask:s,onUpdateTask:i,onDeleteTask:o,lang:a,selectedHostelFilter:u})=>{const d=I=>Xe[a][I],f=U.useMemo(()=>{const I=t.role==="admin"||t.role==="super"?u:t.hostelId;return e.filter(D=>D.role==="cashier"&&(D.hostelId===I||D.hostelId==="all"))},[e,u,t]),[m,y]=U.useState({description:"",roomNumber:"",priority:"medium",hostelId:t.role==="admin"||t.role==="super"?"hostel1":t.hostelId,assignedTo:""}),[_,R]=U.useState(null),A=n.sort((I,D)=>D.createdAt.localeCompare(I.createdAt)),k=t.role==="admin"||t.role==="super",E=I=>I==="low"||I===""?d("low"):I==="medium"||I===""?d("medium"):I==="high"||I===""?d("high"):I,v=()=>{m.description&&(r({...m,status:"pending",createdBy:t.name,createdAt:new Date().toISOString(),hostelId:k?m.hostelId:t.hostelId}),y({description:"",roomNumber:"",priority:"medium",hostelId:k?"hostel1":t.hostelId,assignedTo:""}))},b=()=>{_&&(i(_.id,{description:_.description,roomNumber:_.roomNumber,priority:_.priority,assignedTo:_.assignedTo}),R(null))};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:d("addTask")}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{className:me,children:d("description")}),c.jsx("input",{className:ie,value:m.description,onChange:I=>y({...m,description:I.target.value}),placeholder:"..."})]}),c.jsxs("div",{className:"w-full md:w-32",children:[c.jsx("label",{className:me,children:d("room")}),c.jsx("input",{className:ie,value:m.roomNumber,onChange:I=>y({...m,roomNumber:I.target.value}),placeholder:""})]}),c.jsxs("div",{className:"w-full md:w-40",children:[c.jsx("label",{className:me,children:d("priority")}),c.jsxs("select",{className:ie,value:m.priority,onChange:I=>y({...m,priority:I.target.value}),children:[c.jsx("option",{value:"low",children:d("low")}),c.jsx("option",{value:"medium",children:d("medium")}),c.jsx("option",{value:"high",children:d("high")})]})]}),k&&c.jsxs("div",{className:"w-full md:w-48",children:[c.jsx("label",{className:me,children:d("assignTo")}),c.jsxs("select",{className:ie,value:m.assignedTo,onChange:I=>y({...m,assignedTo:I.target.value}),children:[c.jsx("option",{value:"",children:d("allCashiers")}),f.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsx(Z,{onClick:v,icon:Bo,children:d("save")})]})]}),_&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-md shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:d("edit")}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:ie,value:_.description,onChange:I=>R({..._,description:I.target.value})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{className:ie,value:_.roomNumber,onChange:I=>R({..._,roomNumber:I.target.value}),placeholder:"Room"}),c.jsxs("select",{className:ie,value:_.priority,onChange:I=>R({..._,priority:I.target.value}),children:[c.jsx("option",{value:"low",children:d("low")}),c.jsx("option",{value:"medium",children:d("medium")}),c.jsx("option",{value:"high",children:d("high")})]})]}),k&&c.jsxs("div",{children:[c.jsx("label",{className:me,children:d("assignTo")}),c.jsxs("select",{className:ie,value:_.assignedTo||"",onChange:I=>R({..._,assignedTo:I.target.value}),children:[c.jsx("option",{value:"",children:d("allCashiers")}),f.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsx(Z,{onClick:b,className:"w-full",children:d("save")}),c.jsx(Z,{variant:"secondary",onClick:()=>R(null),className:"w-full",children:d("cancel")})]})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(I=>{const D=I.assignedTo?e.find(P=>P.id===I.assignedTo):null;return c.jsxs("div",{className:`p-4 rounded-xl border flex flex-col justify-between ${I.status==="done"?"bg-slate-50 border-slate-200 opacity-70":"bg-white border-indigo-100 shadow-sm"}`,children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${I.priority==="high"?"bg-rose-100 text-rose-600":"bg-slate-100 text-slate-500"}`,children:E(I.priority)}),I.roomNumber&&c.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[d("room")," ",I.roomNumber]})]}),c.jsx("p",{className:`font-medium ${I.status==="done"?"line-through text-slate-400":"text-slate-800"}`,children:I.description}),c.jsxs("div",{className:"text-[10px] text-slate-400 mt-2",children:[d("createdBy"),": ",I.createdBy,"  ",new Date(I.createdAt).toLocaleDateString(),D&&c.jsxs("div",{className:"mt-1 text-indigo-600",children:[" ",D.name]})]})]}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[I.status!=="done"?c.jsx(Z,{size:"sm",variant:"success",onClick:()=>s(I.id),icon:eE,children:d("done")}):c.jsx("span",{}),k&&c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>R(I),className:"p-1.5 text-blue-500 hover:bg-blue-50 rounded",children:c.jsx(Gl,{size:16})}),c.jsx("button",{onClick:()=>o(I.id),className:"p-1.5 text-rose-500 hover:bg-rose-50 rounded",children:c.jsx(Xo,{size:16})})]})]})]},I.id)})})]})},aD=({clients:n,onClose:e,onCreate:t,lang:r})=>{const s=_=>Xe[r][_],[i,o]=U.useState(""),[a,u]=U.useState(null),[d,f]=U.useState(""),m=n.filter(_=>_.fullName.toLowerCase().includes(i.toLowerCase())||_.passport.toLowerCase().includes(i.toLowerCase())).slice(0,5),y=()=>{!a||!d||(t(a,parseInt(d)),e())};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:s("createDebt")}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("label",{className:me,children:"Search Client"}),c.jsx("input",{className:ie,value:i,onChange:_=>{o(_.target.value),u(null)},placeholder:"Name or Passport"}),i.length>1&&!a&&c.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-slate-200 rounded-xl shadow-xl mt-1 z-50 max-h-40 overflow-y-auto",children:m.map(_=>c.jsxs("div",{onClick:()=>{u(_),o(_.fullName)},className:"p-3 hover:bg-indigo-50 cursor-pointer border-b border-slate-50 last:border-0",children:[c.jsx("div",{className:"font-bold text-sm",children:_.fullName}),c.jsx("div",{className:"text-xs text-slate-500",children:_.passport})]},_.id))})]}),a&&c.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200 text-sm",children:["Selected: ",c.jsx("b",{children:a.fullName})," (",a.passport,")"]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Debt Amount"}),c.jsx("input",{type:"number",className:ie,value:d,onChange:_=>f(_.target.value),placeholder:"0"})]}),c.jsx(Z,{onClick:y,disabled:!a||!d,className:"w-full",children:s("save")}),c.jsx(Z,{variant:"secondary",onClick:e,className:"w-full",children:s("cancel")})]})]})})},lD=({guests:n,users:e,lang:t,onPayDebt:r,currentUser:s,onAdminAdjustDebt:i,clients:o,onCreateDebt:a})=>{const u=H=>Xe[t][H],[d,f]=U.useState(""),[m,y]=U.useState(""),_=U.useMemo(()=>{const H={};return n.forEach(ae=>{var Ze;if(ae.status==="booking")return;const Ie=zn(ae),Ne=ae.totalPrice-Ie;if(Ne>0){const et=m?ae.checkInDate>=m:!0,Qe=d?ae.staffId===d||((Ze=e.find(je=>je.id===d))==null?void 0:Ze.login)===ae.staffId:!0;if(et&&Qe){const je=ae.passport||ae.fullName;H[je]||(H[je]={...ae,totalDebt:0,records:[]}),H[je].totalDebt+=Ne,H[je].records.push(ae)}}}),Object.values(H)},[n,m,d,e]),R=_.reduce((H,ae)=>H+ae.totalDebt,0),A=s.role==="admin"||s.role==="super",[k,E]=U.useState(null),[v,b]=U.useState(""),[I,D]=U.useState(""),[P,w]=U.useState(""),[g,x]=U.useState(""),[S,C]=U.useState(!1),[j,N]=U.useState(!1),[Y,L]=U.useState(null),[xe,we]=U.useState(!1),q=H=>{E(H),C(!0),b(""),D(""),w(""),L(null)},W=H=>{E(H),N(!0),x("")},ne=()=>{if(!k)return;const H=parseInt(v)||0,ae=parseInt(I)||0,Ie=parseInt(P)||0,Ne=H+ae+Ie;if(Ne<=0)return;const Ze=k.records.map(et=>({id:et.id,currentDebt:et.totalPrice-zn(et)}));r(Ze,Ne,{cash:H,card:ae,qr:Ie}),C(!1)},ye=()=>{if(!k||!g)return;const H=k.records[0];i(H.id,parseInt(g)),N(!1)},he=H=>{const ae=H==="payCash"?0:parseInt(v)||0,Ie=H==="payCard"?0:parseInt(I)||0,Ne=H==="payQR"?0:parseInt(P)||0,Ze=ae+Ie+Ne,et=Math.max(0,k.totalDebt-Ze);H==="payCash"&&b(String(et)),H==="payCard"&&D(String(et)),H==="payQR"&&w(String(et)),L(H)},$=H=>{H.currentTarget.blur()};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-slate-200 flex flex-col md:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{className:me,children:u("staff")}),c.jsxs("select",{className:ie,value:d,onChange:H=>f(H.target.value),children:[c.jsx("option",{value:"",children:"All"}),e.map(H=>c.jsx("option",{value:H.id,children:H.name},H.id))]})]}),c.jsxs("div",{className:"w-full md:w-auto",children:[c.jsx("label",{className:me,children:u("date")}),c.jsx("input",{type:"date",className:ie,value:m,onChange:H=>y(H.target.value)})]}),c.jsxs("div",{className:"px-6 py-2 bg-rose-50 border border-rose-200 rounded-xl text-center w-full md:w-auto min-w-[200px]",children:[c.jsxs("div",{className:"text-xs font-bold text-rose-500 uppercase",children:[u("total")," ",u("debt")]}),c.jsx("div",{className:"text-2xl font-bold text-rose-700",children:R.toLocaleString()})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{icon:Bo,onClick:()=>we(!0),children:u("createDebt")}),c.jsx(Z,{variant:"secondary",icon:Ya,onClick:()=>qP(_,R),children:u("print")})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:[c.jsxs("table",{className:"w-full text-sm text-left min-w-[600px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:u("guestName")}),c.jsx("th",{className:"p-4",children:u("passport")}),c.jsx("th",{className:"p-4",children:u("staff")}),c.jsx("th",{className:"p-4 text-right",children:u("debt")}),c.jsx("th",{className:"p-4 text-right",children:u("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:_.map(H=>{var ae;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"p-4 font-bold",children:H.fullName}),c.jsx("td",{className:"p-4 font-mono",children:H.passport}),c.jsx("td",{className:"p-4",children:((ae=e.find(Ie=>Ie.id===H.staffId||Ie.login===H.staffId))==null?void 0:ae.name)||H.staffId}),c.jsx("td",{className:"p-4 text-right font-bold text-rose-600",children:H.totalDebt.toLocaleString()}),c.jsxs("td",{className:"p-4 text-right flex justify-end gap-2",children:[c.jsx(Z,{size:"sm",onClick:()=>q(H),children:u("payDebt")}),A&&c.jsx(Z,{size:"sm",variant:"secondary",onClick:()=>W(H),children:u("addDebt")})]})]},H.id)})})]}),_.length===0&&c.jsx("div",{className:"p-8 text-center text-slate-400",children:u("noData")})]}),S&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-sm shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:u("payDebt")}),c.jsxs("p",{className:"mb-4 text-sm",children:[k==null?void 0:k.fullName," (Total: ",k==null?void 0:k.totalDebt.toLocaleString(),")"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("cash")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:v,onChange:H=>{b(H.target.value),L(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payCash"),disabled:Y&&Y!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("card")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:I,onChange:H=>{D(H.target.value),L(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payCard"),disabled:Y&&Y!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("qr")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:P,onChange:H=>{w(H.target.value),L(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payQR"),disabled:Y&&Y!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx(Z,{className:"flex-1",onClick:ne,children:u("save")}),c.jsx(Z,{variant:"secondary",className:"flex-1",onClick:()=>C(!1),children:u("cancel")})]})]})}),j&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-sm shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4",children:[u("addDebt")," (Admin)"]}),c.jsx("p",{className:"mb-4 text-sm text-slate-500",children:"Enter +/- amount to adjust total price."}),c.jsx("input",{className:ie,type:"number",value:g,onChange:H=>x(H.target.value),placeholder:"+/- Amount"}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx(Z,{className:"flex-1",onClick:ye,children:u("save")}),c.jsx(Z,{variant:"secondary",className:"flex-1",onClick:()=>N(!1),children:u("cancel")})]})]})}),xe&&c.jsx(aD,{clients:o,onClose:()=>we(!1),onCreate:a,lang:t}),c.jsx("style",{children:`
                .no-spinner::-webkit-outer-spin-button, .no-spinner::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
                .no-spinner { -moz-appearance: textfield; }
            `})]})},cD=({payments:n,expenses:e,users:t,guests:r,currentUser:s,onDeletePayment:i,lang:o})=>{const a=I=>Xe[o][I],u=[{id:"hostel1",name:" 1"},{id:"hostel2",name:" 2"}],[d,f]=U.useState({start:lo(new Date(new Date().setHours(0,0,0,0))),end:lo(new Date(new Date().setHours(23,59,59,999))),staffId:"",method:"",hostelId:s.role==="admin"&&s.hostelId!=="all"?s.hostelId:""}),[m,y]=U.useState({start:lo(new Date(new Date().setHours(0,0,0,0))),end:lo(new Date(new Date().setHours(23,59,59,999))),staffId:"",method:"",hostelId:s.role==="admin"&&s.hostelId!=="all"?s.hostelId:""}),_=()=>{y(d)},A=U.useMemo(()=>{const I=n.map(P=>{let w=P.hostelId;if(!w&&P.staffId){const g=t.find(x=>x.id===P.staffId||x.login===P.staffId);g&&(w=g.hostelId)}return{...P,type:"income",id:P.id,hostelId:w}}),D=e.map(P=>{let w=P.hostelId;if(!w&&P.staffId){const g=t.find(x=>x.id===P.staffId||x.login===P.staffId);g&&(w=g.hostelId)}return{...P,type:"expense",method:"cash",id:P.id,hostelId:w}});return[...I,...D].sort((P,w)=>new Date(w.date)-new Date(P.date))},[n,e,t]).filter(I=>{var j;const D=new Date(I.date).getTime(),P=m.start?new Date(m.start).getTime():0,w=m.end?new Date(m.end).getTime():1/0,g=D>=P&&D<=w,x=m.staffId?I.staffId===m.staffId||((j=t.find(N=>N.id===m.staffId))==null?void 0:j.login)===I.staffId:!0,S=m.method?I.method===m.method:!0,C=m.hostelId?I.hostelId===m.hostelId:!0;return parseInt(I.amount)===0?!1:g&&x&&S&&C}),k=U.useMemo(()=>d.hostelId?t.filter(I=>I.hostelId===d.hostelId||I.hostelId==="all"):t,[t,d.hostelId]),E=A.filter(I=>I.type==="income").reduce((I,D)=>I+(parseInt(D.amount)||0),0),v=A.filter(I=>I.type==="expense").reduce((I,D)=>I+(parseInt(D.amount)||0),0),b=()=>{const I=A.map(D=>{var P,w,g;return{date:new Date(D.date).toLocaleString(),type:D.type,staff:((P=t.find(x=>x.id===D.staffId||x.login===D.staffId))==null?void 0:P.name)||D.staffId,hostel:((w=u.find(x=>x.id===D.hostelId))==null?void 0:w.name)||D.hostelId||"-",amount:D.amount,method:D.method||"-",comment:D.comment||(D.guestId?(g=r.find(x=>x.id===D.guestId))==null?void 0:g.fullName:"-")}});BP(I,`Otchet_${m.hostelId||"All"}.xls`,E,v)};return c.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[c.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end mb-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:"From"}),c.jsx("input",{type:"datetime-local",className:ie,value:d.start,onChange:I=>f({...d,start:I.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"To"}),c.jsx("input",{type:"datetime-local",className:ie,value:d.end,onChange:I=>f({...d,end:I.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:a("staff")}),c.jsxs("select",{className:ie,value:d.staffId,onChange:I=>f({...d,staffId:I.target.value}),children:[c.jsx("option",{value:"",children:"All"}),k.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Payment Method"}),c.jsxs("select",{className:ie,value:d.method,onChange:I=>f({...d,method:I.target.value}),children:[c.jsx("option",{value:"",children:"All"}),c.jsx("option",{value:"cash",children:a("cash")}),c.jsx("option",{value:"card",children:a("card")}),c.jsx("option",{value:"qr",children:a("qr")})]})]})]}),c.jsxs("div",{className:"flex gap-2 justify-end border-t border-slate-100 pt-4",children:[c.jsx(Z,{onClick:_,icon:eE,className:"flex-1 md:flex-none",children:a("save")}),c.jsx(Z,{icon:Ya,variant:"secondary",onClick:()=>GP(A,E,v,m,t),className:"flex-1 md:flex-none",children:a("printReport")}),c.jsx(Z,{icon:sE,variant:"secondary",onClick:b,className:"flex-1 md:flex-none",children:"Export (XLS)"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-emerald-600 font-bold uppercase",children:a("income")}),c.jsxs("div",{className:"text-2xl font-bold text-emerald-800",children:["+",E.toLocaleString()]})]}),c.jsxs("div",{className:"bg-rose-50 border border-rose-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-rose-600 font-bold uppercase",children:a("expense")}),c.jsxs("div",{className:"text-2xl font-bold text-rose-800",children:["-",v.toLocaleString()]})]}),c.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-slate-600 font-bold uppercase",children:a("balance")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800",children:(E-v).toLocaleString()})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:[c.jsxs("table",{className:"w-full text-sm text-left min-w-[700px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:a("date")}),c.jsx("th",{className:"p-4",children:"Hostel"}),c.jsx("th",{className:"p-4",children:"Type"}),c.jsx("th",{className:"p-4",children:a("amount")}),c.jsx("th",{className:"p-4",children:"Method"}),c.jsx("th",{className:"p-4",children:a("staff")}),c.jsx("th",{className:"p-4",children:"Details"}),s.role==="super"&&c.jsx("th",{className:"p-4",children:a("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:A.map((I,D)=>{var P,w,g;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"p-4 text-slate-500",children:new Date(I.date).toLocaleString()}),c.jsx("td",{className:"p-4 font-bold text-slate-600",children:((P=u.find(x=>x.id===I.hostelId))==null?void 0:P.name)||"N/A"}),c.jsx("td",{className:"p-4",children:I.type==="income"?c.jsx("span",{className:"bg-emerald-100 text-emerald-700 px-2 py-1 rounded text-xs font-bold",children:"IN"}):c.jsx("span",{className:"bg-rose-100 text-rose-700 px-2 py-1 rounded text-xs font-bold",children:"OUT"})}),c.jsx("td",{className:`p-4 font-bold ${I.type==="income"?"text-emerald-700":"text-rose-700"}`,children:parseInt(I.amount).toLocaleString()}),c.jsx("td",{className:"p-4 uppercase text-xs font-bold text-slate-500",children:I.method}),c.jsx("td",{className:"p-4",children:((w=t.find(x=>x.id===I.staffId||x.login===I.staffId))==null?void 0:w.name)||"N/A"}),c.jsx("td",{className:"p-4 text-slate-600 truncate max-w-[200px]",children:I.comment||(I.guestId?(g=r.find(x=>x.id===I.guestId))==null?void 0:g.fullName:"-")}),s.role==="super"&&c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>i(I.id,I.type),className:"text-rose-500 hover:bg-rose-50 p-2 rounded",title:"Delete",children:c.jsx(Xo,{size:16})})})]},D)})})]}),A.length===0&&c.jsx("div",{className:"p-8 text-center text-slate-400",children:a("noData")})]})]})},uD=({shifts:n,users:e,currentUser:t,onStartShift:r,onEndShift:s,onTransferShift:i,lang:o,hostelId:a,onAdminAddShift:u,onAdminUpdateShift:d})=>{const f=L=>Xe[o][L],m=t.role==="admin"||t.role==="super",y=n.find(L=>L.staffId===t.id&&!L.endTime),_=e.filter(L=>L.role==="cashier"&&L.id!==t.id),[R,A]=U.useState(""),[k,E]=U.useState({start:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[v,b]=U.useState(""),[I,D]=U.useState(!1),[P,w]=U.useState(null),[g,x]=U.useState({staffId:"",startTime:"",endTime:"",hostelId:"hostel1"}),S=U.useMemo(()=>{let L=n;if(!m)L=L.filter(xe=>xe.staffId===t.id);else{const xe=new Date(k.start);xe.setHours(0,0,0,0);const we=new Date(k.end);we.setHours(23,59,59,999),L=L.filter(q=>{const W=new Date(q.startTime);return W>=xe&&W<=we}),v&&(L=L.filter(q=>q.staffId===v))}return L.sort((xe,we)=>new Date(we.startTime)-new Date(xe.startTime))},[n,m,t.id,k,v]),C=U.useMemo(()=>S.reduce((L,xe)=>xe.endTime?L+zh(xe.startTime,xe.endTime):L,0),[S]),j=()=>{const L=S.map(W=>{var ae,Ie;const ne=((ae=e.find(Ne=>Ne.id===W.staffId))==null?void 0:ae.name)||"Unknown",ye=new Date(W.startTime),he=W.endTime?new Date(W.endTime):null,$=he?((he-ye)/(1e3*60*60)).toFixed(1):"Active",H=he?zh(W.startTime,W.endTime):0;return{staff:ne,hostel:((Ie=On[W.hostelId])==null?void 0:Ie.name)||W.hostelId,date:ye.toLocaleDateString(),start:ye.toLocaleTimeString(),end:he?he.toLocaleTimeString():"Active",hours:$,salary:H}});let xe=`
            <html>
            <head><meta charset="UTF-8"></head>
            <body>
            <h2 style="text-align:center">  (${k.start} - ${k.end})</h2>
            <table border="1" style="border-collapse: collapse; width: 100%;">
                <thead style="background-color: #4f46e5; color: white;">
                    <tr>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                    </tr>
                </thead>
                <tbody>
        `;L.forEach(W=>{xe+=`
                <tr>
                    <td style="padding:5px">${W.staff}</td>
                    <td style="padding:5px">${W.hostel}</td>
                    <td style="padding:5px">${W.date}</td>
                    <td style="padding:5px">${W.start}</td>
                    <td style="padding:5px">${W.end}</td>
                    <td style="text-align:center">${W.hours}</td>
                    <td style="text-align:right;">${W.salary.toLocaleString()}</td>
                </tr>
            `}),xe+=`
            <tr style="background-color: #f3f4f6; font-weight: bold;">
                <td colspan="6" style="padding:10px; text-align:right;">:</td>
                <td style="padding:10px; text-align:right;">${C.toLocaleString()}</td>
            </tr>
        </tbody></table></body></html>`;const we=new Blob([xe],{type:"application/vnd.ms-excel"}),q=document.createElement("a");q.href=URL.createObjectURL(we),q.download="Shifts_Report.xls",q.click()},N=()=>{const L={...g,startTime:new Date(g.startTime).toISOString(),endTime:g.endTime?new Date(g.endTime).toISOString():null};P?d(P.id,L):u(L),D(!1),w(null)},Y=L=>{w(L),x({staffId:L.staffId,hostelId:L.hostelId||"hostel1",startTime:lo(new Date(L.startTime)),endTime:L.endTime?lo(new Date(L.endTime)):""}),D(!0)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[c.jsx("div",{children:c.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[c.jsx(ug,{className:"text-indigo-600"})," ",f("shifts")]})}),!m&&c.jsxs("div",{className:"flex gap-2",children:[!y&&c.jsx(Z,{icon:uE,onClick:r,children:f("startShift")}),y&&c.jsxs("div",{className:"flex gap-2 items-center bg-slate-100 p-1 rounded-xl",children:[c.jsxs("select",{className:"bg-white border-0 rounded-lg text-sm py-2 px-3 focus:ring-0",value:R,onChange:L=>A(L.target.value),children:[c.jsx("option",{value:"",children:" ..."}),_.map(L=>{var xe;return c.jsxs("option",{value:L.id,children:[L.name," (",(xe=On[L.hostelId])==null?void 0:xe.name,")"]},L.id)})]}),c.jsx(Z,{size:"sm",variant:"secondary",onClick:()=>i(y.id,R),disabled:!R,children:f("transferShift")}),c.jsx("div",{className:"w-px h-6 bg-slate-300 mx-1"}),c.jsx(Z,{size:"sm",variant:"danger",onClick:s,children:f("endShift")})]})]}),m&&c.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[c.jsx("input",{type:"date",className:"border rounded-lg px-2 py-2 text-sm",value:k.start,onChange:L=>E({...k,start:L.target.value})}),c.jsx("span",{children:"-"}),c.jsx("input",{type:"date",className:"border rounded-lg px-2 py-2 text-sm",value:k.end,onChange:L=>E({...k,end:L.target.value})}),c.jsxs("select",{className:"border rounded-lg px-2 py-2 text-sm max-w-[150px]",value:v,onChange:L=>b(L.target.value),children:[c.jsx("option",{value:"",children:" "}),e.filter(L=>L.role!=="super").map(L=>c.jsx("option",{value:L.id,children:L.name},L.id))]}),c.jsx(Z,{icon:Bo,onClick:()=>{var L;w(null),x({staffId:(L=e[0])==null?void 0:L.id,startTime:"",endTime:"",hostelId:"hostel1"}),D(!0)},children:""}),c.jsx(Z,{icon:iE,variant:"secondary",onClick:j,children:"Excel"})]})]}),c.jsx("div",{className:"overflow-hidden border rounded-xl",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:f("staff")}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:f("workedHours")}),c.jsx("th",{className:"p-4 text-right",children:f("salaryCalc")}),m&&c.jsx("th",{className:"p-4 text-right",children:"Edit"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-100",children:[S.map(L=>{var W,ne;const xe=((W=e.find(ye=>ye.id===L.staffId))==null?void 0:W.name)||"Unknown",we=L.endTime?((new Date(L.endTime)-new Date(L.startTime))/(1e3*60*60)).toFixed(1):"-",q=L.endTime?zh(L.startTime,L.endTime).toLocaleString():"...";return c.jsxs("tr",{className:L.endTime?"hover:bg-slate-50":"bg-emerald-50",children:[c.jsx("td",{className:"p-4 font-bold",children:xe}),c.jsx("td",{className:"p-4 text-xs text-slate-500",children:(ne=On[L.hostelId])==null?void 0:ne.name}),c.jsx("td",{className:"p-4",children:new Date(L.startTime).toLocaleString()}),c.jsx("td",{className:"p-4",children:L.endTime?new Date(L.endTime).toLocaleString():c.jsx("span",{className:"text-emerald-600 font-bold",children:" ..."})}),c.jsx("td",{className:"p-4 font-mono",children:we}),c.jsx("td",{className:"p-4 text-right font-bold text-indigo-600",children:q}),m&&c.jsx("td",{className:"p-4 text-right",children:c.jsx("button",{onClick:()=>Y(L),className:"text-blue-500 hover:bg-blue-50 p-1 rounded",children:c.jsx(Gl,{size:16})})})]},L.id)}),m&&c.jsxs("tr",{className:"bg-slate-100 border-t-2 border-slate-300 font-bold",children:[c.jsx("td",{colSpan:"5",className:"p-4 text-right uppercase text-slate-600",children:"  :"}),c.jsx("td",{className:"p-4 text-right text-emerald-700 text-lg",children:C.toLocaleString()}),c.jsx("td",{className:"p-4"})]})]})]})})]}),I&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:P?" ":" "}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("select",{className:ie,value:g.staffId,onChange:L=>x({...g,staffId:L.target.value}),children:e.filter(L=>L.role!=="super").map(L=>c.jsx("option",{value:L.id,children:L.name},L.id))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("select",{className:ie,value:g.hostelId,onChange:L=>x({...g,hostelId:L.target.value}),children:Object.keys(On).map(L=>c.jsx("option",{value:L,children:On[L].name},L))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("input",{type:"datetime-local",className:ie,value:g.startTime,onChange:L=>x({...g,startTime:L.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("input",{type:"datetime-local",className:ie,value:g.endTime,onChange:L=>x({...g,endTime:L.target.value})})]}),c.jsx(Z,{onClick:N,className:"w-full mt-4",children:""}),c.jsx(Z,{variant:"secondary",onClick:()=>D(!1),className:"w-full",children:""})]})]})})]})},dD=({initialRoom:n,preSelectedBedId:e,initialDate:t,allRooms:r,guests:s,clients:i,onClose:o,onSubmit:a,notify:u,lang:d})=>{var he;const f=$=>Xe[d][$],[m,y]=U.useState((n==null?void 0:n.id)||((he=r[0])==null?void 0:he.id)||""),_=r.find($=>$.id===m),[R,A]=U.useState(""),[k,E]=U.useState(!1),[v,b]=U.useState(!1),I=new Date,D=fp(I),P=fp(new Date(I.getTime()-24*60*60*1e3)),w=I.getHours()<12?P:D,[g,x]=U.useState({fullName:"",birthDate:"",passport:"",country:"",bedId:String(e||"1"),checkInDate:t||w,days:1,pricePerNight:0,payCash:"",payCard:"",payQR:""}),[S,C]=U.useState(null);U.useEffect(()=>{var $,H;if(_){const Ie=parseInt(g.bedId)%2===0?(($=_.prices)==null?void 0:$.upper)||0:((H=_.prices)==null?void 0:H.lower)||0;x(Ne=>({...Ne,pricePerNight:Ie}))}},[_,g.bedId]);const j=$=>{const H=$.target.value.toUpperCase();x(ae=>({...ae,fullName:H})),A(H),E(!0)},N=$=>{x(H=>({...H,fullName:$.fullName,passport:$.passport,birthDate:$.birthDate,country:$.country})),E(!1)},Y=async $=>{const H=$.target.files[0];if(H){b(!0);try{const ae=new FileReader;ae.readAsDataURL(H),ae.onload=async()=>{const Ne=ae.result.toString().split(",")[1];if(!Ne){u("Error processing image file","error"),b(!1);return}try{const et=await vP(FP,"scanPassport")({image:Ne}),{success:Qe,data:je,error:qe}=et.data;if(Qe)x(At=>({...At,fullName:je.fullName||At.fullName,passport:je.passport||At.passport,birthDate:je.birthDate||At.birthDate,country:je.country||At.country})),u("Passport Scanned Successfully!","success");else throw new Error(qe||"Unknown server error")}catch(Ze){console.error("Cloud Function Error:",Ze),u("Scan failed: "+(Ze.message||"Server Error"),"error")}finally{b(!1)}},ae.onerror=()=>{u("File Read Error","error"),b(!1)}}catch(ae){console.error(ae),u("System Error","error"),b(!1)}}},L=R.length>1?i.filter($=>$.fullName.includes(R)||$.passport.includes(R)).slice(0,5):[],xe=(parseInt(g.pricePerNight)||0)*(parseInt(g.days)||1),we=(parseInt(g.payCash)||0)+(parseInt(g.payCard)||0)+(parseInt(g.payQR)||0),q=xe-we,W=$=>{const H=$==="payCash"?0:parseInt(g.payCash)||0,ae=$==="payCard"?0:parseInt(g.payCard)||0,Ie=$==="payQR"?0:parseInt(g.payQR)||0,Ne=H+ae+Ie,Ze=Math.max(0,xe-Ne);x(et=>({...et,[$]:String(Ze)})),C($)},ne=($,H=!1)=>{$&&$.preventDefault();try{if(!_)return u(f("error"),"error");if(!g.fullName.trim())return u("Fill Name!","error");const ae=new Date(g.checkInDate);ae.setHours(12,0,0,0);const Ie=xr(ae.toISOString(),g.days),Ne=s.filter(qe=>qe.roomId!==_.id||String(qe.bedId)!==String(g.bedId)||qe.status!=="active"&&qe.status!=="booking"?!1:pE(qe.checkInDate||qe.checkInDateTime||qe.checkIn,qe.days,ae.toISOString(),g.days));if(Ne.length>0)return u(`Occupied! (${Ne[0].fullName})`,"error");const Ze=H?0:parseInt(g.payCash)||0,et=H?0:parseInt(g.payCard)||0,Qe=H?0:parseInt(g.payQR)||0,je=H?0:we;a({...g,checkInDate:Ie.start.toISOString(),checkOutDate:Ie.end.toISOString(),roomId:_.id,roomNumber:_.number,hostelId:_.hostelId,bedId:String(g.bedId),paidCash:Ze,paidCard:et,paidQR:Qe,amountPaid:je,totalPrice:xe,status:H?"booking":"active"})}catch(ae){console.error(ae)}},ye=$=>{$.currentTarget.blur()};return c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in fade-in zoom-in-95",children:[c.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-5xl overflow-hidden flex flex-col max-h-[95vh]",children:[c.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-20",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-2xl font-bold text-slate-900 flex items-center gap-3",children:[f("checkin")," ",_&&c.jsxs("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 text-sm rounded-full font-bold",children:["Room ",_.number]})]}),c.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"New Guest"})]}),c.jsx("button",{onClick:o,type:"button",className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:c.jsx(dg,{className:"text-slate-400 hover:text-slate-600",size:32})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-50/50 p-8",children:c.jsxs("form",{onSubmit:$=>ne($,!1),className:"flex flex-col gap-6",children:[c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm h-full relative flex flex-col",children:[v&&c.jsxs("div",{className:"absolute inset-0 z-50 bg-white/90 backdrop-blur-sm flex flex-col items-center justify-center rounded-2xl animate-in fade-in",children:[c.jsx(lE,{className:"animate-spin text-indigo-600 mb-4",size:50}),c.jsx("span",{className:"font-bold text-slate-800 text-lg",children:"AI ..."}),c.jsx("span",{className:"text-slate-500 text-sm mt-1",children:", "})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(ed,{className:"text-indigo-600",size:24}),c.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:f("guestName")})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("label",{className:"relative flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-indigo-300 rounded-xl cursor-pointer bg-indigo-50 hover:bg-indigo-100 transition-all group overflow-hidden",children:[c.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[c.jsx("div",{className:"bg-white p-3 rounded-full mb-2 shadow-sm group-hover:scale-110 transition-transform",children:c.jsx(CP,{className:"text-indigo-600",size:24})}),c.jsx("p",{className:"mb-1 text-sm font-bold text-indigo-700",children:"  / "}),c.jsx("p",{className:"text-xs text-indigo-400",children:"  ID "})]}),c.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:Y,className:"hidden",disabled:v})]})}),c.jsxs("div",{className:"space-y-5 flex-1",children:[c.jsxs("div",{className:"relative",children:[c.jsxs("label",{className:me,children:[f("guestName")," (Search DB)"]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{className:`${ie} pl-10 py-3 text-lg font-bold text-slate-700`,value:g.fullName,onChange:j,placeholder:"IVANOV IVAN",onBlur:()=>setTimeout(()=>E(!1),200)}),c.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:c.jsx(ed,{size:18})})]}),k&&L.length>0&&c.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-slate-200 rounded-xl shadow-xl mt-2 z-50 overflow-hidden",children:L.map($=>c.jsxs("div",{onClick:()=>N($),className:"p-3 hover:bg-indigo-50 cursor-pointer border-b border-slate-50 last:border-0 flex justify-between items-center group",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-slate-800",children:$.fullName}),c.jsx("div",{className:"text-xs text-slate-400",children:$.country})]}),c.jsx("div",{className:"bg-slate-100 px-2 py-1 rounded text-xs font-mono text-slate-500 group-hover:bg-white",children:$.passport})]},$.id))})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("passport")}),c.jsx("input",{className:`${ie} uppercase font-mono text-lg`,value:g.passport,onChange:$=>x({...g,passport:$.target.value.toUpperCase()}),placeholder:"AA1234567"})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("birthDate")}),c.jsx("input",{type:"date",className:ie,value:g.birthDate,onChange:$=>x({...g,birthDate:$.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("country")}),c.jsx("select",{className:ie,value:g.country,onChange:$=>x({...g,country:$.target.value}),children:Kl.map($=>c.jsx("option",{value:$,children:$},$))})]})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm h-full",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[c.jsx($d,{className:"text-indigo-600",size:20}),c.jsx("h4",{className:"font-bold text-slate-800",children:"Placement"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("room")}),c.jsx("select",{className:`${ie} font-bold`,value:m,onChange:$=>y($.target.value),children:r.map($=>c.jsxs("option",{value:$.id,children:[" ",$.number]},$.id))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("bed")}),c.jsx("select",{className:ie,value:g.bedId,onChange:$=>x({...g,bedId:$.target.value}),children:_&&Array.from({length:_.capacity}).map(($,H)=>{const ae=H+1;return c.jsxs("option",{value:ae,children:[" ",ae," ",ae%2===0?"(Up)":"(Down)"]},ae)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Date In"}),c.jsx("input",{type:"date",className:ie,value:g.checkInDate.split("T")[0],onChange:$=>x({...g,checkInDate:$.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("days")}),c.jsx("input",{type:"number",min:"1",className:`${ie} font-bold text-lg`,value:g.days,onChange:$=>x({...g,days:$.target.value}),onWheel:ye})]}),c.jsxs("div",{className:"col-span-2",children:[c.jsx("label",{className:me,children:f("price")}),c.jsx("input",{type:"number",className:ie,value:g.pricePerNight,onChange:$=>x({...g,pricePerNight:$.target.value}),onWheel:ye})]})]})]})]}),c.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-6 rounded-3xl w-full",children:[c.jsxs("h4",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2 text-lg",children:[c.jsx(Hl,{className:"text-indigo-600"})," ",f("payment")]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("cash")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payCash,onChange:$=>{x({...g,payCash:$.target.value}),C(null)},placeholder:"0",onWheel:ye}),c.jsx("button",{type:"button",onClick:()=>W("payCash"),disabled:S&&S!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:18})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("card")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payCard,onChange:$=>{x({...g,payCard:$.target.value}),C(null)},placeholder:"0",onWheel:ye}),c.jsx("button",{type:"button",onClick:()=>W("payCard"),disabled:S&&S!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:18})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("qr")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payQR,onChange:$=>{x({...g,payQR:$.target.value}),C(null)},placeholder:"0",onWheel:ye}),c.jsx("button",{type:"button",onClick:()=>W("qr"),disabled:S&&S!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:18})})]})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:[c.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-xl p-4 flex justify-around items-center shadow-sm",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("total")}),c.jsx("div",{className:"font-extrabold text-slate-800 text-xl",children:xe.toLocaleString()})]}),c.jsx("div",{className:"w-px h-8 bg-slate-100 mx-2"}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("paid")}),c.jsx("div",{className:"font-extrabold text-emerald-600 text-xl",children:we.toLocaleString()})]}),c.jsx("div",{className:"w-px h-8 bg-slate-100 mx-2"}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("debt")}),c.jsx("div",{className:`font-extrabold text-xl ${q>0?"text-rose-500":"text-slate-300"}`,children:q>0?q.toLocaleString():"0"})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 min-w-[300px]",children:[c.jsxs(Z,{type:"button",onClick:$=>ne($,!0),variant:"warning",className:"flex-1 py-4 text-lg shadow-sm",title:"Book",children:[c.jsx(Nl,{size:20})," ",f("booking")]}),c.jsx(Z,{type:"button",onClick:$=>ne($,!1),variant:"primary",className:"flex-[2] py-4 text-lg shadow-lg shadow-indigo-200",icon:Uo,children:f("checkin")})]})]})]})]})})]}),c.jsx("style",{children:`
            .no-spinner::-webkit-outer-spin-button, .no-spinner::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
            .no-spinner { -moz-appearance: textfield; }
          `})]})},hD=({guest:n,room:e,currentUser:t,onClose:r,onUpdate:s,onPayment:i,onCheckOut:o,onSplit:a,onOpenMove:u,onDelete:d,notify:f,onReduceDays:m,onActivateBooking:y,onReduceDaysNoRefund:_,hostelInfo:R,lang:A})=>{var $n;const k=X=>Xe[A][X],E=zn(n),v=(n.totalPrice||0)-E,b=t.role==="viewer"?n.hostelId===t.hostelId:!0,[I,D]=U.useState(null),[P,w]=U.useState(""),[g,x]=U.useState(""),[S,C]=U.useState(""),[j,N]=U.useState(1),[Y,L]=U.useState(""),[xe,we]=U.useState(!1),[q,W]=U.useState({fullName:n.fullName,birthDate:n.birthDate,passport:n.passport,country:n.country,pricePerNight:n.pricePerNight}),[ne,ye]=U.useState(1),[he,$]=U.useState(1),[H,ae]=U.useState(1),[Ie,Ne]=U.useState(1),[Ze,et]=U.useState(n.checkInDate.split("T")[0]),Qe=n.status==="booking",je=n.status==="checked_out",[qe,At]=U.useState(null),kn=new Date,js=new Date(n.checkInDate);let bi=Math.max(1,Math.ceil((kn-js)/(1e3*60*60*24)));const ir=Math.min(bi,parseInt(n.days)),Dr=ir*parseInt(n.pricePerNight),Cn=E-Dr,Vs=()=>{const X=parseInt(P)||0,_t=parseInt(g)||0,xt=parseInt(S)||0;if(X+_t+xt<=0)return f("Enter Amount","error");i(n.id,{cash:X,card:_t,qr:xt})},Si=()=>{const X=parseInt(j);if(!X)return;const _t=(n.totalPrice||0)+X*parseInt(n.pricePerNight),xt={days:parseInt(n.days)+X,totalPrice:_t,status:"active"},qn=xr(n.checkInDate,xt.days);xt.checkOutDate=qn.end.toISOString(),s(n.id,xt)},Zo=()=>{const X=(n.totalPrice||0)-zn(n),_t=t.role==="admin"||t.role==="super";if(X>0&&!_t)return f(k("debtRemaining"),"error");const xt=Y?parseInt(Y):Math.max(0,Cn),qn={totalPrice:Dr,paidCash:(n.paidCash||0)-xt,amountPaid:(n.amountPaid||0)-xt};o(n,qn)},Bn=()=>{const X=parseInt(ne),_t=parseInt(he),xt=parseInt(n.days);if(X>=xt)return f("Split day must be less than total days","error");a(n,X,_t),r()},Ms=()=>{const _t=parseInt(q.pricePerNight)*parseInt(n.days);s(n.id,{...q,totalPrice:_t}),we(!1)},jr=()=>{confirm(k("confirmDelete"))&&d(n)},Ue=async()=>{const X=parseInt(H);if(!X||X<=0)return f("Error days","error");if(X>=n.days)return f("Can't remove all days","error");m(n,X),r()},Ge=async()=>{const X=parseInt(Ie);if(!X||X<=0)return f("Error days","error");if(X>=n.days)return f("Can't remove all days","error");_(n,X),r()},an=X=>{$P(X,n,R)},Ni=()=>{const X=new Date(Ze);X.setHours(12,0,0,0);const _t=xr(X.toISOString(),n.days);s(n.id,{checkInDate:X.toISOString(),checkOutDate:_t.end.toISOString()}),f("Date Changed!"),D(null)},Vr=X=>{const _t=X==="payCash"?0:parseInt(P)||0,xt=X==="payCard"?0:parseInt(g)||0,qn=X==="payQR"?0:parseInt(S)||0,ea=_t+xt+qn,or=Math.max(0,v-ea);X==="payCash"&&w(String(or)),X==="payCard"&&x(String(or)),X==="payQR"&&C(String(or)),At(X)},Os=X=>{X.currentTarget.blur()};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in fade-in zoom-in-95",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:`${Qe?"bg-amber-500":je?"bg-slate-500":"bg-slate-900"} text-white p-6 flex justify-between items-start relative`,children:[c.jsxs("div",{className:"flex-1",children:[Qe&&c.jsxs("div",{className:"text-xs uppercase font-bold text-white/80 mb-1 flex items-center gap-1",children:[c.jsx(Nl,{size:12})," ",k("booking")]}),je&&c.jsxs("div",{className:"text-xs uppercase font-bold text-white/80 mb-1 flex items-center gap-1",children:[c.jsx(oE,{size:12})," Checked Out"]}),xe?c.jsxs("div",{className:"space-y-2 text-slate-900",children:[c.jsx("input",{className:ie,value:q.fullName,onChange:X=>W({...q,fullName:X.target.value.toUpperCase()})}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("input",{className:ie,value:q.passport,onChange:X=>W({...q,passport:X.target.value.toUpperCase()})}),c.jsx("input",{type:"date",className:ie,value:q.birthDate,onChange:X=>W({...q,birthDate:X.target.value})})]}),c.jsx("select",{className:ie,value:q.country,onChange:X=>W({...q,country:X.target.value}),children:Kl.map(X=>c.jsx("option",{children:X},X))}),(t.role==="admin"||t.role==="super")&&c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("price")}),c.jsx("input",{type:"number",className:ie,value:q.pricePerNight,onChange:X=>W({...q,pricePerNight:X.target.value})})]}),c.jsx(Z,{size:"sm",onClick:Ms,children:k("save")})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h2",{className:"text-xl font-bold",children:n.fullName}),c.jsx("button",{onClick:()=>we(!0),className:"bg-transparent border-none p-1 text-white/60 hover:text-white transition-colors cursor-pointer",title:"",children:c.jsx(Gl,{size:18})})]}),c.jsxs("div",{className:"flex gap-4 text-sm text-white/70 mt-1 flex-wrap",children:[c.jsxs("span",{children:["Room ",n.roomNumber]}),c.jsxs("span",{children:["Bed ",n.bedId]}),c.jsx("span",{children:new Date(n.checkInDate).toLocaleDateString()}),c.jsx("span",{children:n.passport})]})]})]}),c.jsx("button",{onClick:r,className:"bg-transparent border-none p-2 text-white/60 hover:text-white transition-colors cursor-pointer hover:bg-white/10 rounded-full",children:c.jsx(dg,{size:32})})]}),!Qe&&c.jsxs("div",{className:`p-4 flex justify-between items-center ${v>0?"bg-rose-50 border-b border-rose-200":"bg-emerald-50 border-b border-emerald-200"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[v>0?c.jsx(XT,{className:"text-rose-600"}):c.jsx(Uo,{className:"text-emerald-600"}),c.jsx("span",{className:`font-bold ${v>0?"text-rose-700":"text-emerald-700"}`,children:v>0?`${k("debt")}: ${v.toLocaleString()}`:k("paid")})]}),c.jsxs("div",{className:"text-xs text-slate-500 text-right",children:[c.jsxs("div",{children:[k("total"),": ",($n=n.totalPrice)==null?void 0:$n.toLocaleString()]}),c.jsxs("div",{children:[k("paid"),": ",E.toLocaleString()]})]})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[Qe&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs(Z,{className:"w-full py-3 text-lg",onClick:()=>y(n),children:[c.jsx(Uo,{})," ",k("checkin")]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx(Z,{variant:"secondary",onClick:()=>D(I==="moveDate"?null:"moveDate"),icon:j0,children:k("moveDate")}),c.jsx(Z,{variant:"danger",onClick:jr,icon:Xo,children:k("cancel")})]})]}),!Qe&&c.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[c.jsx(Z,{variant:I==="pay"?"primary":"secondary",onClick:()=>D(I==="pay"?null:"pay"),disabled:v<=0||!b,children:k("payment")}),c.jsx(Z,{variant:I==="extend"?"primary":"secondary",onClick:()=>D(I==="extend"?null:"extend"),disabled:!b,children:k("extend")}),!je&&c.jsx(Z,{variant:I==="split"?"primary":"secondary",onClick:()=>D(I==="split"?null:"split"),title:"Split",disabled:!b,children:c.jsx(PP,{size:18})}),!je&&c.jsx(Z,{variant:I==="checkout"?"primary":"secondary",onClick:()=>D(I==="checkout"?null:"checkout"),className:"text-rose-600 border-rose-300 hover:bg-rose-50",disabled:!b,children:k("checkout")})]}),!Qe&&c.jsxs("div",{className:"flex gap-2 justify-center",children:[c.jsx(Z,{size:"sm",variant:"ghost",onClick:()=>an("check"),icon:Ya,children:k("printCheck")}),c.jsx(Z,{size:"sm",variant:"ghost",onClick:()=>an("regcard"),icon:Ya,children:k("printForm")}),c.jsx(Z,{size:"sm",variant:"ghost",onClick:()=>an("ref"),icon:Ya,children:k("printRef")})]}),c.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-300",children:[!I&&!Qe&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-center gap-2",children:[!je&&c.jsx(Z,{variant:"ghost",icon:ag,onClick:u,children:k("move")}),!je&&(t.role==="admin"||t.role==="super")&&c.jsx(Z,{variant:"ghost",icon:j0,onClick:()=>D("moveDate"),children:k("moveDate")})]}),(t.role==="admin"||t.role==="super")&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"border-t border-slate-200 pt-4 flex justify-center gap-4",children:[!je&&c.jsxs("button",{onClick:()=>D("reduceNoRefund"),className:"text-xs text-amber-600 hover:text-amber-700 font-bold flex items-center gap-1",children:[c.jsx(AP,{size:14})," ",k("reduceNoRefund")]}),c.jsx("button",{onClick:jr,className:"text-xs text-rose-400 hover:text-rose-600 underline",children:k("delete")})]})})]}),I==="split"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-slate-700",children:k("splitTitle")}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("splitAfter")}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:ie,value:ne,onChange:X=>ye(X.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("splitGap")}),c.jsx("input",{type:"number",min:"1",className:ie,value:he,onChange:X=>$(X.target.value)})]})]}),c.jsx("div",{className:"text-xs text-slate-500 bg-white p-2 rounded border border-slate-200",children:k("splitInfo").replace("{x}",ne).replace("{y}",he).replace("{z}",n.days-ne)}),c.jsx(Z,{className:"w-full",onClick:Bn,children:k("confirmSplit")})]}),I==="moveDate"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-slate-700",children:k("moveDate")}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("newDate")}),c.jsx("input",{type:"date",className:ie,value:Ze,onChange:X=>et(X.target.value)})]}),c.jsx(Z,{className:"w-full",onClick:Ni,children:k("save")})]}),I==="pay"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:me,children:[k("amount")," (",k("debt"),": ",v,")"]}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("cash")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:P,onChange:X=>{w(X.target.value),At(null)},placeholder:"0",onWheel:Os}),c.jsx("button",{onClick:()=>Vr("payCash"),disabled:qe&&qe!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("card")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:g,onChange:X=>{x(X.target.value),At(null)},placeholder:"0",onWheel:Os}),c.jsx("button",{onClick:()=>Vr("payCard"),disabled:qe&&qe!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("qr")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:S,onChange:X=>{C(X.target.value),At(null)},placeholder:"0",onWheel:Os}),c.jsx("button",{onClick:()=>Vr("payQR"),disabled:qe&&qe!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(Ir,{size:16})})]})]}),c.jsx(Z,{className:"w-full",onClick:Vs,children:k("payment")})]}),I==="extend"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:me,children:[k("extend")," (",k("days"),")"]}),c.jsx("input",{type:"number",min:"1",className:ie,value:j,onChange:X=>N(X.target.value)}),c.jsxs("div",{className:"text-right text-sm text-slate-500",children:["+ ",(j*parseInt(n.pricePerNight)).toLocaleString()]}),c.jsx(Z,{className:"w-full",onClick:Si,children:"OK"})]}),I==="checkout"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-sm space-y-1 pb-3 border-b border-slate-300",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" ():"})," ",c.jsxs("b",{children:[ir," ."]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" :"})," ",c.jsx("b",{children:E.toLocaleString()})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" :"})," ",c.jsx("b",{children:Dr.toLocaleString()})]})]}),Cn<0?c.jsxs("div",{className:"bg-rose-100 text-rose-800 p-3 rounded-lg text-center font-bold border border-rose-200",children:[": ",Math.abs(Cn).toLocaleString()," ",c.jsx("br",{}),c.jsx("span",{className:"text-xs font-normal",children:"   ."})]}):c.jsxs("div",{className:"bg-emerald-100 text-emerald-800 p-3 rounded-lg border border-emerald-200",children:[c.jsxs("div",{className:"text-center font-bold mb-2",children:[" : ",Cn.toLocaleString()]}),Cn>0&&c.jsxs("div",{children:[c.jsx("label",{className:`${me} mb-1`,children:k("manualRefund")}),c.jsx("input",{type:"number",className:ie,value:Y,placeholder:Cn,onChange:X=>L(X.target.value)})]})]}),c.jsx(Z,{variant:"danger",className:"w-full",onClick:Zo,children:k("checkout")})]}),(t.role==="admin"||t.role==="super")&&!Qe&&!I&&c.jsxs("div",{className:"mt-6 p-4 border-t border-slate-100",children:[c.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:"Reduce Days (Refund)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 items-end",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Reduce by (days)"}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:ie,value:H,onChange:X=>ae(X.target.value)})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Refund:"}),c.jsx("div",{className:"font-bold",children:((parseInt(n.pricePerNight)||0)*(parseInt(H)||0)).toLocaleString()})]}),c.jsx("div",{className:"col-span-2",children:c.jsx(Z,{className:"w-full",variant:"secondary",onClick:Ue,children:"Apply & Refund"})})]})]}),I==="reduceNoRefund"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-amber-700",children:k("reduceNoRefund")}),c.jsx("p",{className:"text-xs text-slate-500",children:"Money stays in register. Guest stay is shortened."}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Reduce by (days)"}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:ie,value:Ie,onChange:X=>Ne(X.target.value)})]}),c.jsx(Z,{className:"w-full",variant:"warning",onClick:Ge,children:"Apply (No Refund)"})]})]})]})]})})},fD=({user:n,payments:e=[],expenses:t,onClose:r,onLogout:s,notify:i,onEndShift:o,lang:a})=>{const u=v=>Xe[a][v],d=n.lastShiftEnd||"1970-01-01T00:00:00.000Z",f=e.filter(v=>(v.staffId===n.id||v.staffId===n.login)&&v.date>d),m=t.filter(v=>(v.staffId===n.id||v.staffId===n.login)&&v.date>d),y={cash:f.reduce((v,b)=>v+(b.method==="cash"&&parseInt(b.amount)||0),0),card:f.reduce((v,b)=>v+(b.method==="card"&&parseInt(b.amount)||0),0),qr:f.reduce((v,b)=>v+(b.method==="qr"&&parseInt(b.amount)||0),0)},_=m.reduce((v,b)=>v+(parseInt(b.amount)||0),0),R=y.cash+y.card+y.qr,A=y.cash-_,k=()=>{const v=`<b>  </b>
: ${n.name}
---
 : ${y.cash.toLocaleString()}
 : ${y.card.toLocaleString()}
 QR: ${y.qr.toLocaleString()}
---
<b> : ${R.toLocaleString()}</b>
 : ${_.toLocaleString()}
<b>  : ${A.toLocaleString()}</b>`;hp(v),o()},E=()=>{const b=[`User: ${n.name}`,`Cash: ${y.cash.toLocaleString()}`,`Card: ${y.card.toLocaleString()}`,`QR: ${y.qr.toLocaleString()}`,`TOTAL: ${R.toLocaleString()}`,`Exp: ${_.toLocaleString()}`,`HAND: ${A.toLocaleString()}`].join(`
`),I=document.createElement("textarea");I.value=b,document.body.appendChild(I),I.select();try{document.execCommand("copy"),i("Copied!","success")}catch{}document.body.removeChild(I)};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/80 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-lg shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"bg-slate-900 p-6 text-white flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[c.jsx(cE,{size:20,className:"text-rose-400"})," ",u("shiftClose")]}),c.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[u("staff"),": ",n.name]})]}),c.jsx("button",{onClick:r,className:"p-2 bg-white/10 rounded-full hover:bg-white/20",children:c.jsx(dg,{size:20})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto bg-slate-50 space-y-6",children:[c.jsxs("div",{className:"bg-indigo-50 p-5 rounded-2xl border border-indigo-200 shadow-sm text-center",children:[c.jsx("h3",{className:"text-xs font-bold text-indigo-500 uppercase tracking-wider mb-1",children:u("total")}),c.jsx("div",{className:"text-3xl font-extrabold text-indigo-700",children:R.toLocaleString()}),c.jsxs("div",{className:"text-xs text-indigo-400 mt-1",children:[u("cash")," + ",u("card")," + ",u("qr")]})]}),c.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm",children:[c.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4",children:["Kassa (",u("cash"),")"]}),c.jsxs("div",{className:"flex justify-between items-center mb-2 text-sm",children:[c.jsxs("span",{className:"text-slate-600",children:[u("income"),":"]}),c.jsxs("span",{className:"font-bold text-slate-900",children:["+",y.cash.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between items-center mb-4 text-sm",children:[c.jsxs("span",{className:"text-rose-600",children:[u("expense"),":"]}),c.jsxs("span",{className:"font-bold text-rose-600",children:["-",_.toLocaleString()]})]}),c.jsxs("div",{className:"pt-3 border-t border-dashed border-slate-300 flex justify-between items-center",children:[c.jsxs("span",{className:"font-bold text-lg text-slate-800",children:[u("cashInHand"),":"]}),c.jsx("span",{className:"font-bold text-2xl text-emerald-600",children:A.toLocaleString()})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[c.jsx("div",{className:"text-slate-400 text-xs font-bold uppercase mb-1",children:u("card")}),c.jsx("div",{className:"text-lg font-bold text-slate-800",children:y.card.toLocaleString()})]}),c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[c.jsx("div",{className:"text-slate-400 text-xs font-bold uppercase mb-1",children:u("qr")}),c.jsx("div",{className:"text-lg font-bold text-slate-800",children:y.qr.toLocaleString()})]})]})]}),c.jsxs("div",{className:"p-4 bg-white border-t border-slate-200 flex flex-col gap-3",children:[c.jsx(Z,{variant:"secondary",onClick:E,icon:rE,className:"w-full",children:"Copy"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(Z,{variant:"ghost",className:"flex-1",onClick:r,children:u("cancel")}),c.jsx(Z,{variant:"danger",className:"flex-1",icon:cg,onClick:k,children:u("shiftClose")})]})]})]})})},pD=({onClose:n,onSubmit:e,lang:t})=>{const r=a=>Xe[t][a],s=t==="uz"?[" ","-",""," ","",""]:["","","","","",""],[i,o]=U.useState({amount:"",category:s[0],comment:""});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2",children:[c.jsx(Hl,{size:20,className:"text-rose-500"})," ",r("expense")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("amount")}),c.jsx("input",{type:"number",className:ie,value:i.amount,onChange:a=>o({...i,amount:a.target.value}),placeholder:"0"})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("category")}),c.jsx("select",{className:ie,value:i.category,onChange:a=>o({...i,category:a.target.value}),children:s.map(a=>c.jsx("option",{value:a,children:a},a))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("comment")}),c.jsx("input",{className:ie,value:i.comment,onChange:a=>o({...i,comment:a.target.value}),placeholder:"..."})]}),c.jsx(Z,{onClick:()=>e(i),className:"w-full mt-4",disabled:!i.amount,children:r("save")}),c.jsx(Z,{variant:"secondary",onClick:n,className:"w-full",children:r("cancel")})]})]})})},L0=({title:n,initialData:e={},onClose:t,onSubmit:r,lang:s})=>{const i=u=>Xe[s][u],[o,a]=U.useState({number:e.number||"",capacity:e.capacity||"4",prices:e.prices||{lower:0,upper:0}});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-6",children:n}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("room")}),c.jsx("input",{className:ie,value:o.number,onChange:u=>a({...o,number:u.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("bed")}),c.jsx("input",{type:"number",className:ie,value:o.capacity,onChange:u=>a({...o,capacity:u.target.value})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:me,children:[i("price")," (Down)"]}),c.jsx("input",{type:"number",className:ie,value:o.prices.lower,onChange:u=>a({...o,prices:{...o.prices,lower:u.target.value}})})]}),c.jsxs("div",{children:[c.jsxs("label",{className:me,children:[i("price")," (Up)"]}),c.jsx("input",{type:"number",className:ie,value:o.prices.upper,onChange:u=>a({...o,prices:{...o.prices,upper:u.target.value}})})]})]}),c.jsx(Z,{onClick:()=>r(o),className:"w-full mt-4",children:i("save")}),c.jsx(Z,{variant:"secondary",onClick:t,className:"w-full",children:i("cancel")})]})]})})},mD=({guest:n,allRooms:e,guests:t,onClose:r,onMove:s,notify:i,lang:o})=>{const a=A=>Xe[o][A],[u,d]=U.useState(n.roomId),[f,m]=U.useState(""),y=e.find(A=>A.id===u),_=y?Array.from({length:y.capacity},(A,k)=>k+1):[],R=()=>{if(!u||!f)return i("Select Destination","error");const A=t.filter(k=>k.roomId===u&&String(k.bedId)===String(f)&&(k.status==="active"||k.status==="booking")&&k.id!==n.id&&pE(k.checkInDate,k.days,n.checkInDate,n.days));if(A.length>0)return i(`Occupied! (${A[0].fullName})`,"error");s(n,u,y.number,String(f))};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2",children:[c.jsx(ag,{size:20})," ",a("move")]}),c.jsxs("p",{className:"text-sm text-slate-500 mb-4",children:[a("guestName"),": ",c.jsx("b",{children:n.fullName})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:me,children:["New ",a("room")]}),c.jsx("select",{className:ie,value:u,onChange:A=>{d(A.target.value),m("")},children:e.map(A=>c.jsxs("option",{value:A.id,children:["Room ",A.number]},A.id))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:me,children:["New ",a("bed")]}),c.jsxs("select",{className:ie,value:f,onChange:A=>m(A.target.value),children:[c.jsx("option",{value:"",children:"Select Bed"}),_.map(A=>c.jsxs("option",{value:A,children:["Bed ",A," ",A%2===0?"(Up)":"(Down)"]},A))]})]}),c.jsx(Z,{onClick:R,className:"w-full mt-4",children:a("move")}),c.jsx(Z,{variant:"secondary",onClick:r,className:"w-full",children:a("cancel")})]})]})})},gD=({activeShift:n,activeUser:e,currentUser:t,onLogout:r,onTransferToMe:s})=>c.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-900 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-3xl max-w-md w-full p-8 text-center shadow-2xl relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-rose-500"}),c.jsx("div",{className:"mb-6 flex justify-center",children:c.jsx("div",{className:"w-20 h-20 bg-rose-100 rounded-full flex items-center justify-center text-rose-600 animate-pulse",children:c.jsx(cE,{size:40})})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:" "}),c.jsxs("p",{className:"text-slate-500 mb-6",children:["       ",c.jsx("b",{children:(e==null?void 0:e.name)||" "}),".",c.jsx("br",{}),"   ,       ."]}),c.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 text-left",children:[c.jsx("div",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:" :"}),c.jsxs("div",{className:"font-bold text-slate-700",children:[": ",new Date(n.startTime).toLocaleString()]}),c.jsx("div",{className:"text-sm text-emerald-600 font-bold mt-1",children:" "})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(Z,{onClick:()=>s(n.id,t.id),className:"w-full py-3",variant:"primary",icon:ag,children:"  ( )"}),c.jsx(Z,{onClick:r,className:"w-full py-3",variant:"secondary",icon:cg,children:""})]})]})});function yD(){var Pi,sa;const[n,e]=U.useState(null),[t,r]=U.useState(null),[s,i]=U.useState("dashboard"),[o,a]=U.useState("hostel1"),[u,d]=U.useState(navigator.onLine),[f,m]=U.useState(!1),[y,_]=U.useState(!0),[R,A]=U.useState(null),[k,E]=U.useState("ru"),v=(V,z="success")=>{A({message:V,type:z})},[b,I]=U.useState([]),[D,P]=U.useState([]),[w,g]=U.useState([]),[x,S]=U.useState([]),[C,j]=U.useState([]),[N,Y]=U.useState([]),[L,xe]=U.useState([]),[we,q]=U.useState([]),[W,ne]=U.useState({open:!1,room:null,bedId:null,date:null}),[ye,he]=U.useState({open:!1,guest:null}),[$,H]=U.useState({open:!1,guest:null}),[ae,Ie]=U.useState(!1),[Ne,Ze]=U.useState(!1),[et,Qe]=U.useState(!1),[je,qe]=U.useState({open:!1,room:null}),At=U.useMemo(()=>L.filter(V=>V.status!=="done").length,[L]),kn=U.useMemo(()=>!t||t.role==="admin"||t.role==="super"?null:we.find(V=>V.hostelId===t.hostelId&&!V.endTime&&V.staffId!==t.id),[we,t]),js=U.useMemo(()=>kn?N.find(V=>V.id===kn.staffId):null,[kn,N]);U.useEffect(()=>{const V=z=>{z.key==="Escape"&&(W.open&&ne({open:!1,room:null,bedId:null,date:null}),ye.open&&he({open:!1,guest:null}),$.open&&H({open:!1,guest:null}),ae&&Ie(!1),Ne&&Ze(!1),et&&Qe(!1),je.open&&qe({open:!1,room:null}))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[W,ye,$,ae,Ne,et,je]),U.useEffect(()=>{mk(M0).catch(le=>console.error(le));const V=wk(M0,le=>{e(le),_(!1)}),z=localStorage.getItem("hostella_user_v4");z&&r(JSON.parse(z));const Q=()=>d(!0),re=()=>d(!1);return window.addEventListener("online",Q),window.addEventListener("offline",re),()=>{V(),window.removeEventListener("online",Q),window.removeEventListener("offline",re)}},[]);const bi=V=>{r(V),localStorage.setItem("hostella_user_v4",JSON.stringify(V)),V.role==="cashier"?i("calendar"):i("dashboard")},ir=()=>{r(null),localStorage.removeItem("hostella_user_v4")},Dr=async()=>{t&&t.id&&await ct(Ee(ue,...fe,"users",t.id),{lastShiftEnd:new Date().toISOString()});const V=we.find(z=>z.staffId===t.id&&!z.endTime);V&&await ct(Ee(ue,...fe,"shifts",V.id),{endTime:new Date().toISOString()}),ir()},Cn=async V=>{if(t)try{const z=$i(ue);z.update(Ee(ue,...fe,"shifts",V),{endTime:new Date().toISOString()});const Q=Ee(lt(ue,...fe,"shifts"));z.set(Q,{staffId:t.id,hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),await z.commit(),v("  !","success")}catch(z){v("  : "+z.message,"error")}};U.useEffect(()=>{if(!n)return;const V=lt(ue,...fe,"users"),z=Gr(V,tt=>{const Ae=tt.docs.map(ln=>({id:ln.id,...ln.data()}));Y(Ae.length?Ae:Fh)});if(!t)return z;const Q=lt(ue,...fe,"rooms"),re=lt(ue,...fe,"guests"),le=lt(ue,...fe,"expenses"),Pe=lt(ue,...fe,"clients"),Oe=lt(ue,...fe,"payments"),gt=lt(ue,...fe,"tasks"),An=lt(ue,...fe,"shifts"),xn=Gr(Q,{includeMetadataChanges:!0},tt=>{m(!1),I(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>parseInt(Ae.number)-parseInt(ln.number))),d(!tt.metadata.fromCache)},tt=>{tt.code==="permission-denied"&&m(!0),d(!1)}),wn=Gr(re,tt=>P(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>new Date(ln.checkInDate)-new Date(Ae.checkInDate)))),Di=Gr(le,tt=>g(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>new Date(ln.date)-new Date(Ae.date)))),Lr=Gr(Pe,tt=>S(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>Ae.fullName.localeCompare(ln.fullName)))),Us=Gr(Oe,tt=>j(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})))),Hn=Gr(gt,tt=>xe(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()})))),ji=Gr(An,tt=>q(tt.docs.map(Ae=>({id:Ae.id,...Ae.data()}))));return()=>{z(),xn(),wn(),Di(),Lr(),Us(),Hn(),ji()}},[n,t]);const Vs=async()=>{if(N.length===Fh.length&&N[0].id===void 0)try{for(const V of Fh)await Dn(lt(ue,...fe,"users"),V);alert("Init done")}catch{}},Si=async V=>{await Dn(lt(ue,...fe,"users"),V)},Zo=async V=>{confirm("Del?")&&await Oc(Ee(ue,...fe,"users",V))},Bn=V=>{if(!t)return[];if(t.role==="super")return V;if(t.role==="viewer")return V.filter(Q=>Q.hostelId===o);const z=t.role==="admin"?o:t.hostelId;return V.filter(Q=>Q.hostelId===z)},Ms=U.useMemo(()=>{if(!t)return[];const V=t.role==="admin"?o:t.hostelId;return t.role==="super"?N:N.filter(z=>z.hostelId===V||z.role==="super"||z.hostelId==="all")},[N,t,o]),jr=U.useMemo(()=>{if(!t)return[];const V=t.role==="admin"?o:t.hostelId;return t.role==="super"?C:C.filter(z=>{const Q=N.find(re=>re.id===z.staffId||re.login===z.staffId);return Q&&(Q.hostelId===V||Q.hostelId==="all")})},[C,N,t,o]),Ue=U.useMemo(()=>Bn(b),[b,t,o]),Ge=U.useMemo(()=>Bn(D),[D,t,o]),an=U.useMemo(()=>Bn(w),[w,t,o]),Ni=U.useMemo(()=>Bn(L),[L,t,o]),Vr=async(V,z)=>{await ct(Ee(ue,...fe,"clients",V),z),v("Updated")},Os=async V=>{if(V.length!==0)try{const z=$i(ue);let Q=0,re=0;V.forEach(le=>{const Pe=x.find(Oe=>Oe.passport&&le.passport&&Oe.passport===le.passport||Oe.fullName===le.fullName&&Oe.passport===le.passport);Pe?(z.update(Ee(ue,...fe,"clients",Pe.id),{fullName:Pe.fullName||le.fullName,passport:Pe.passport||le.passport,birthDate:Pe.birthDate||le.birthDate,country:Pe.country||le.country}),Q++):(z.set(Ee(lt(ue,...fe,"clients")),{...le,visits:0,lastVisit:new Date().toISOString()}),re++)}),await z.commit(),v(`Success! New: ${re}, Merged: ${Q}`,"success")}catch(z){console.error(z),v("Import failed","error")}},$n=async()=>{if(confirm("Start auto deduplication?"))try{const V={},z=[];if(x.forEach(re=>{const le=re.passport?`P:${re.passport}`:`N:${re.fullName}`;V[le]?z.push({original:V[le],duplicate:re}):V[le]=re}),z.length===0)return v("No duplicates found!");const Q=$i(ue);z.forEach(({original:re,duplicate:le})=>{Q.update(Ee(ue,...fe,"clients",re.id),{visits:(re.visits||0)+(le.visits||0),lastVisit:new Date(re.lastVisit)>new Date(le.lastVisit)?re.lastVisit:le.lastVisit}),Q.delete(Ee(ue,...fe,"clients",le.id))}),await Q.commit(),v(`Merged ${z.length} duplicates!`,"success")}catch(V){console.error(V),v("Deduplication failed","error")}},X=async V=>{try{const z=$i(ue);V.forEach(Q=>z.delete(Ee(ue,...fe,"clients",Q))),await z.commit(),v(`Deleted ${V.length} clients`,"success")}catch{v("Bulk delete failed","error")}},_t=async()=>{try{const V=$i(ue);let z=0;x.forEach(Q=>{const re=mE(Q.country);re!==Q.country&&(V.update(Ee(ue,...fe,"clients",Q.id),{country:re}),z++)}),z>0?(await V.commit(),v(`Normalized ${z} countries`,"success")):v("All normalized")}catch{v("Normalization failed","error")}},xt=async V=>{Qe(!1),await Dn(lt(ue,...fe,"rooms"),{...V,hostelId:t.role==="admin"?o:t.hostelId,occupied:0})},qn=async V=>{},ea=async V=>{},or=async V=>{},ki=async(V,z,Q)=>{const{cash:re,card:le,qr:Pe}=z,Oe=new Date().toISOString(),gt=[];re>0&&gt.push({guestId:V,staffId:Q,amount:re,method:"cash",date:Oe,hostelId:t.hostelId}),le>0&&gt.push({guestId:V,staffId:Q,amount:le,method:"card",date:Oe,hostelId:t.hostelId}),Pe>0&&gt.push({guestId:V,staffId:Q,amount:Pe,method:"qr",date:Oe,hostelId:t.hostelId});for(const An of gt)await Dn(lt(ue,...fe,"payments"),An)},Wl=async V=>{ne({open:!1,room:null,bedId:null,date:null});try{const z=t.id||t.login||"unknown",Q=await Dn(lt(ue,...fe,"guests"),{...V,staffId:z});if((V.paidCash||0)+(V.paidCard||0)+(V.paidQR||0)>0&&await ki(Q.id,{cash:V.paidCash,card:V.paidCard,qr:V.paidQR},z),V.status==="active"){const le=b.find(Pe=>Pe.id===V.roomId);le&&await ct(Ee(ue,...fe,"rooms",le.id),{occupied:(le.occupied||0)+1})}v(V.status==="booking"?"Booking created":"Checked In!")}catch(z){v(z.message,"error")}},Ls=async(V,z)=>{try{const Q=t.id||t.login||"unknown",re={fullName:V.fullName,passport:V.passport,country:V.country,birthDate:V.birthDate,staffId:Q,checkInDate:new Date().toISOString(),days:0,roomId:"DEBT_ONLY",roomNumber:"-",bedId:"-",pricePerNight:0,totalPrice:z,paidCash:0,paidCard:0,paidQR:0,amountPaid:0,status:"active",hostelId:t.role==="admin"?o:t.hostelId};await Dn(lt(ue,...fe,"guests"),re),v("Debt created successfully")}catch{v("Error creating debt","error")}},ta=async V=>{await ct(Ee(ue,...fe,"guests",V.id),{status:"active"});const z=b.find(Q=>Q.id===V.roomId);z&&await ct(Ee(ue,...fe,"rooms",z.id),{occupied:(z.occupied||0)+1}),he({open:!1,guest:null}),v("Activated")},na=async(V,z)=>{ye.open&&he({open:!1,guest:null}),await ct(Ee(ue,...fe,"guests",V),z)},ar=async(V,z)=>{try{const Q=t.id||t.login,{cash:re,card:le,qr:Pe}=z;await ct(Ee(ue,...fe,"guests",V),{paidCash:ur(re),paidCard:ur(le),paidQR:ur(Pe),amountPaid:ur(re+le+Pe)}),await ki(V,z,Q),he({open:!1,guest:null}),v("Payment success")}catch(Q){v(Q.message,"error")}},Ql=async(V,z)=>{he({open:!1,guest:null}),await ct(Ee(ue,...fe,"guests",V.id),{...z,status:"checked_out",checkOutDate:new Date().toISOString()});const Q=b.find(le=>le.id===V.roomId);Q&&await ct(Ee(ue,...fe,"rooms",Q.id),{occupied:Math.max(0,(Q.occupied||1)-1)});const re=(V.amountPaid||0)-z.totalPrice;re>0&&hp(` <b>Refund</b>
Guest: ${V.fullName}
Amount: ~${re}`)},Ci=async(V,z,Q)=>{try{const re=parseInt(V.pricePerNight),le=parseInt(z),Pe=parseInt(Q),Oe=parseInt(V.days),gt=Oe-le;if(gt<=0)return;const An=V.amountPaid||0,xn=le/Oe,wn=gt/Oe,Di=le*re,Lr=xr(V.checkInDate,le);await ct(Ee(ue,...fe,"guests",V.id),{days:le,totalPrice:Di,amountPaid:Math.floor(An*xn),paidCash:Math.floor((V.paidCash||0)*xn),paidCard:Math.floor((V.paidCard||0)*xn),paidQR:Math.floor((V.paidQR||0)*xn),checkOutDate:Lr.end.toISOString()});const Us=new Date(Lr.end),Hn=new Date(Us);Hn.setDate(Hn.getDate()+Pe),Hn.setHours(12,0,0,0);const ji=xr(Hn.toISOString(),gt),tt={...V,checkInDate:Hn.toISOString(),checkOutDate:ji.end.toISOString(),days:gt,pricePerNight:re,totalPrice:gt*re,amountPaid:Math.floor(An*wn),paidCash:Math.floor((V.paidCash||0)*wn),paidCard:Math.floor((V.paidCard||0)*wn),paidQR:Math.floor((V.paidQR||0)*wn),status:"active",checkInDateTime:null,checkIn:null};delete tt.id,await Dn(lt(ue,...fe,"guests"),tt),v("Split successful!")}catch(re){console.error(re),v("Split Error","error")}},Yl=async(V,z,Q,re)=>{try{await ct(Ee(ue,...fe,"guests",V.id),{roomId:z,roomNumber:Q,bedId:re}),H({open:!1,guest:null}),he({open:!1,guest:null}),v("Moved!")}catch(le){v("Error: "+le.message,"error")}},Mr=async V=>{let z=typeof V=="string"?V:V.id,Q=typeof V=="object"?V:D.find(re=>re.id===z);if(await Oc(Ee(ue,...fe,"guests",z)),Q&&Q.status==="active"&&Q.roomId!=="DEBT_ONLY"){const re=b.find(le=>le.id===Q.roomId);re&&await ct(Ee(ue,...fe,"rooms",re.id),{occupied:Math.max(0,(re.occupied||1)-1)})}he({open:!1,guest:null}),v("Deleted")},Jl=async(V,z)=>{confirm("Delete?")&&(await Oc(Ee(ue,...fe,z==="income"?"payments":"expenses",V)),hp(` <b>Delete Record</b>
ID: ${V}
Type: ${z}`),v("Deleted"))},Rt=async V=>{Ie(!1),await Dn(lt(ue,...fe,"expenses"),{...V,hostelId:t.role==="admin"?o:t.hostelId,staffId:t.id||t.login,date:new Date().toISOString()})},Xl=async V=>{await Dn(lt(ue,...fe,"tasks"),V),v("Task Added")},Fs=async V=>{await ct(Ee(ue,...fe,"tasks",V),{status:"done"})},zs=async(V,z)=>{await ct(Ee(ue,...fe,"tasks",V),z),v("Task Updated")},qd=async V=>{await Oc(Ee(ue,...fe,"tasks",V)),v("Task Deleted")},Gd=async()=>{if(we.find(z=>z.staffId===t.id&&!z.endTime))return v("Shift already started","error");await Dn(lt(ue,...fe,"shifts"),{staffId:t.id,hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),v("Shift Started")},Or=async(V,z)=>{if(!z)return;const Q=$i(ue),re=Ee(ue,...fe,"shifts",V);Q.update(re,{endTime:new Date().toISOString()});const le=N.find(Oe=>Oe.id===z),Pe=Ee(lt(ue,...fe,"shifts"));Q.set(Pe,{staffId:z,hostelId:le?le.hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),await Q.commit(),v("Shift Transferred")},Hd=async V=>{await Dn(lt(ue,...fe,"shifts"),V),v("  ")},Kd=async(V,z)=>{await ct(Ee(ue,...fe,"shifts",V),z),v(" ")},Ai=async(V,z)=>{const Q=parseInt(V.days)-parseInt(z),re=Q*parseInt(V.pricePerNight),le=parseInt(z)*parseInt(V.pricePerNight);await ct(Ee(ue,...fe,"guests",V.id),{days:Q,totalPrice:re,amountPaid:(V.amountPaid||0)-le,paidCash:(V.paidCash||0)-le});const Pe=xr(V.checkInDate,Q);await ct(Ee(ue,...fe,"guests",V.id),{checkOutDate:Pe.end.toISOString()}),v("Days reduced")},Zl=async(V,z)=>{const Q=parseInt(V.days)-parseInt(z),re=Q*parseInt(V.pricePerNight);await ct(Ee(ue,...fe,"guests",V.id),{days:Q,totalPrice:re});const le=xr(V.checkInDate,Q);await ct(Ee(ue,...fe,"guests",V.id),{checkOutDate:le.end.toISOString()}),v("Reduced (No Refund)")},ra=async(V,z,Q={cash:z,card:0,qr:0})=>{try{const re=t.id||t.login;let le=z;for(const Pe of V){if(le<=0)break;const Oe=Math.min(le,Pe.currentDebt),gt=Oe/z,An=Math.floor(Q.cash*gt),xn=Math.floor(Q.card*gt),wn=Math.floor(Q.qr*gt);await ct(Ee(ue,...fe,"guests",Pe.id),{paidCash:ur(An),paidCard:ur(xn),paidQR:ur(wn),amountPaid:ur(Oe)}),await ki(Pe.id,{cash:An,card:xn,qr:wn},re),le-=Oe}v("Debt Paid!")}catch{v("Error paying debt","error")}},Ri=async(V,z)=>{try{await ct(Ee(ue,...fe,"guests",V),{totalPrice:ur(z)}),v("Debt Adjusted")}catch{v("Error adjusting","error")}},Gn=()=>{alert("Export feature pending")};if(y)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:c.jsx(lE,{className:"animate-spin text-indigo-600",size:40})});if(!t)return c.jsx(YP,{users:N,onLogin:bi,onSeed:Vs,lang:k,setLang:E});if(kn)return c.jsx(gD,{activeShift:kn,activeUser:js,currentUser:t,onLogout:ir,onTransferToMe:Cn});const ec=N.find(V=>V.id===(t==null?void 0:t.id))||t,tc=On[t.role==="admin"?o:t.hostelId]||On.hostel1,wt=V=>Xe[k][V];return c.jsxs("div",{className:"h-screen w-screen bg-slate-50 text-slate-800 font-sans flex flex-col md:flex-row overflow-hidden",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(QP,{currentUser:t,activeTab:s,setActiveTab:i,onLogout:ir,lang:k,setLang:E,pendingTasksCount:At,selectedHostelView:o,setSelectedHostelView:a})}),c.jsx(WP,{currentUser:t,activeTab:s,setActiveTab:i,pendingTasksCount:At,lang:k}),R&&c.jsx(KP,{message:R.message,type:R.type,onClose:()=>A(null)}),c.jsxs("main",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[c.jsx("div",{className:"flex-shrink-0 p-4 md:p-6 pb-0 bg-slate-50 z-10",children:c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:s==="dashboard"?wt("dashboard").toUpperCase():s==="rooms"?wt("rooms").toUpperCase():s==="calendar"?wt("calendar").toUpperCase():s==="reports"?wt("reports").toUpperCase():s==="debts"?wt("debts").toUpperCase():s==="tasks"?wt("tasks").toUpperCase():s==="expenses"?wt("expenses").toUpperCase():s==="clients"?wt("clients").toUpperCase():s==="staff"?wt("staff").toUpperCase():s==="shifts"?wt("shifts").toUpperCase():""}),c.jsxs("div",{className:"flex items-center gap-4 text-slate-500 text-sm mt-1",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(SP,{size:14})," ",((Pi=On[t.role==="admin"?o:t.hostelId])==null?void 0:Pi.name)||"All"]}),c.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold flex items-center gap-1.5 border ${u?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-rose-50 text-rose-700 border-rose-200"}`,children:[u?c.jsx(VP,{size:12}):c.jsx(jP,{size:12}),u?"ONLINE":"OFFLINE"]}),t.role==="cashier"&&c.jsxs("div",{className:"bg-white px-2 py-0.5 rounded border border-slate-200 text-[10px] font-bold text-slate-600 flex items-center gap-1",children:[c.jsx(ed,{size:10}),"Current: ",((sa=N.find(V=>we.find(z=>z.staffId===V.id&&!z.endTime)))==null?void 0:sa.name)||"Nobody"]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.role==="cashier"&&c.jsxs(c.Fragment,{children:[c.jsx(Z,{variant:"danger",icon:Hl,onClick:()=>Ie(!0),children:wt("expense")}),c.jsx(Z,{variant:"primary",icon:Uo,onClick:()=>ne({open:!0,room:null,bedId:null,date:null}),children:wt("checkin")}),c.jsx(Z,{variant:"secondary",icon:uE,onClick:()=>Ze(!0),children:wt("shift")})]}),(t.role==="admin"||t.role==="super"||t.role==="viewer")&&c.jsx("div",{className:"flex bg-white p-1 rounded-xl border border-slate-300 shadow-sm",children:(t.role==="viewer"?t.viewHostels||[t.hostelId]:Object.keys(On)).map(z=>c.jsx("button",{onClick:()=>a(z),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${o===z?"bg-slate-800 text-white shadow-md":"text-slate-500 hover:bg-slate-50"}`,children:On[z].name},z))})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 md:p-6 pt-2 pb-20",children:[s==="dashboard"&&(t.role==="admin"||t.role==="viewer")&&c.jsxs("div",{className:"space-y-8 animate-in fade-in",children:[c.jsx(JP,{rooms:Ue,guests:D,payments:C,lang:k,currentHostelId:o}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:c.jsx(XP,{guests:Ge,rooms:Ue,payments:jr,lang:k})})]}),s==="rooms"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[c.jsx(Uo,{size:18})," ",c.jsx("span",{children:"Click bed for actions"})]}),(t.role==="admin"||t.role==="super")&&c.jsx(Z,{icon:kP,onClick:()=>Qe(!0),children:"Add Room"})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:Ue.map(V=>c.jsx(eD,{room:V,guests:Ge.filter(z=>z.roomId===V.id),isAdmin:t.role==="admin"||t.role==="super",onEdit:()=>qe({open:!0,room:V}),onClone:()=>qn(),onDelete:()=>or(),lang:k,onBedClick:(z,Q,re)=>{Q?he(re?{open:!0,guest:Q}:{open:!0,guest:Q}):t.role==="admin"||t.role==="super"?alert("Admin cannot check-in"):ne({open:!0,room:V,bedId:z,date:null})}},V.id))})]}),s==="calendar"&&c.jsx("div",{className:"h-full flex flex-col bg-white rounded-2xl border border-slate-300 shadow-sm overflow-hidden",children:c.jsx(tD,{rooms:Ue,guests:Ge,onSlotClick:(V,z,Q,re)=>{Q?he({open:!0,guest:Q}):t.role==="admin"||t.role==="super"?alert("Admin cannot check-in"):ne({open:!0,room:V,bedId:z,date:re})},lang:k,currentUser:t,onDeleteGuest:Mr})}),s==="reports"&&(t.role==="admin"||t.role==="super")&&c.jsx(cD,{payments:jr,expenses:an,users:Ms,guests:Ge,currentUser:t,onDeletePayment:Jl,lang:k}),s==="debts"&&c.jsx(lD,{guests:Ge,users:N,lang:k,onPayDebt:ra,currentUser:t,onAdminAdjustDebt:Ri,clients:x,onCreateDebt:Ls}),s==="tasks"&&c.jsx(oD,{tasks:Ni,users:N,currentUser:t,onAddTask:Xl,onCompleteTask:Fs,onUpdateTask:zs,onDeleteTask:qd,lang:k,selectedHostelFilter:o}),s==="shifts"&&c.jsx(uD,{shifts:we,users:N,currentUser:t,onStartShift:Gd,onEndShift:Dr,onTransferShift:Or,lang:k,hostelId:t.hostelId,onAdminAddShift:Hd,onAdminUpdateShift:Kd}),s==="clients"&&(t.role==="admin"||t.role==="super")&&c.jsx(sD,{clients:x,onUpdateClient:Vr,onImportClients:Os,onDeduplicate:$n,onBulkDelete:X,onNormalizeCountries:_t,lang:k,currentUser:t}),s==="staff"&&t.role==="admin"&&c.jsx(nD,{users:N,onAdd:Si,onDelete:Zo,lang:k}),s==="expenses"&&(t.role==="admin"||t.role==="super")&&c.jsxs("div",{className:"animate-in slide-in-from-bottom-2 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-bold",children:wt("expenses")}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{icon:sE,variant:"secondary",onClick:Gn,children:"Export"}),c.jsx(Z,{icon:Bo,onClick:()=>Ie(!0),children:wt("expense")})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:an.length>0?an.map(V=>{var z;return c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-300 shadow-sm flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("span",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-bold text-slate-600",children:V.category}),c.jsx("span",{className:"text-xs text-slate-400",children:new Date(V.date).toLocaleDateString()})]}),c.jsx("p",{className:"font-medium text-slate-800",children:V.comment})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex justify-between items-center",children:[c.jsxs("span",{className:"font-bold text-rose-600",children:["-",parseInt(V.amount).toLocaleString()]}),c.jsx("span",{className:"text-xs text-slate-400",children:((z=N.find(Q=>Q.id===V.staffId))==null?void 0:z.name)||"N/A"})]})]},V.id)}):c.jsx("div",{className:"text-slate-400 col-span-3 text-center py-10",children:"No Expenses"})})]})]})]}),W.open&&c.jsx(dD,{initialRoom:W.room,preSelectedBedId:W.bedId,initialDate:W.date,allRooms:Ue,guests:Ge,clients:x,onClose:()=>ne({open:!1,room:null,bedId:null,date:null}),onSubmit:Wl,notify:v,lang:k}),ye.open&&c.jsx(hD,{guest:ye.guest,room:Ue.find(V=>V.id===ye.guest.roomId),currentUser:t,onClose:()=>he({open:!1,guest:null}),onUpdate:na,onPayment:ar,onCheckOut:Ql,onSplit:Ci,onOpenMove:()=>H({open:!0,guest:ye.guest}),onDelete:Mr,notify:v,onReduceDays:Ai,onActivateBooking:ta,onReduceDaysNoRefund:Zl,hostelInfo:tc,lang:k}),$.open&&c.jsx(mD,{guest:$.guest,allRooms:Ue,guests:Ge,onClose:()=>H({open:!1,guest:null}),onMove:Yl,notify:v,lang:k}),ae&&c.jsx(pD,{onClose:()=>Ie(!1),onSubmit:Rt,lang:k}),et&&c.jsx(L0,{title:"Add Room",onClose:()=>Qe(!1),onSubmit:xt,lang:k}),je.open&&c.jsx(L0,{title:"Edit Room",initialData:je.room,onClose:()=>qe({open:!1,room:null}),onSubmit:ea,lang:k}),Ne&&c.jsx(fD,{user:ec,payments:C,expenses:an,onClose:()=>Ze(!1),onEndShift:Dr,onLogout:ir,notify:v,lang:k})]})}Jx(document.getElementById("root")).render(c.jsx(U.StrictMode,{children:c.jsx(yD,{})}));
