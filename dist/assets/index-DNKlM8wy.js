(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var F0={exports:{}},ed={},U0={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kl=Symbol.for("react.element"),CT=Symbol.for("react.portal"),AT=Symbol.for("react.fragment"),RT=Symbol.for("react.strict_mode"),PT=Symbol.for("react.profiler"),DT=Symbol.for("react.provider"),jT=Symbol.for("react.context"),VT=Symbol.for("react.forward_ref"),MT=Symbol.for("react.suspense"),OT=Symbol.for("react.memo"),LT=Symbol.for("react.lazy"),Ug=Symbol.iterator;function FT(n){return n===null||typeof n!="object"?null:(n=Ug&&n[Ug]||n["@@iterator"],typeof n=="function"?n:null)}var z0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B0=Object.assign,$0={};function Bo(n,e,t){this.props=n,this.context=e,this.refs=$0,this.updater=t||z0}Bo.prototype.isReactComponent={};Bo.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Bo.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function q0(){}q0.prototype=Bo.prototype;function pp(n,e,t){this.props=n,this.context=e,this.refs=$0,this.updater=t||z0}var mp=pp.prototype=new q0;mp.constructor=pp;B0(mp,Bo.prototype);mp.isPureReactComponent=!0;var zg=Array.isArray,G0=Object.prototype.hasOwnProperty,gp={current:null},K0={key:!0,ref:!0,__self:!0,__source:!0};function H0(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)G0.call(e,r)&&!K0.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];s.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:kl,type:n,key:i,ref:o,props:s,_owner:gp.current}}function UT(n,e){return{$$typeof:kl,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function yp(n){return typeof n=="object"&&n!==null&&n.$$typeof===kl}function zT(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Bg=/\/+/g;function Zd(n,e){return typeof n=="object"&&n!==null&&n.key!=null?zT(""+n.key):e.toString(36)}function Oc(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case kl:case CT:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Zd(o,0):r,zg(s)?(t="",n!=null&&(t=n.replace(Bg,"$&/")+"/"),Oc(s,e,t,"",function(d){return d})):s!=null&&(yp(s)&&(s=UT(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Bg,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",zg(n))for(var a=0;a<n.length;a++){i=n[a];var u=r+Zd(i,a);o+=Oc(i,e,t,u,s)}else if(u=FT(n),typeof u=="function")for(n=u.call(n),a=0;!(i=n.next()).done;)i=i.value,u=r+Zd(i,a++),o+=Oc(i,e,t,u,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function hc(n,e,t){if(n==null)return n;var r=[],s=0;return Oc(n,r,"","",function(i){return e.call(t,i,s++)}),r}function BT(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Qt={current:null},Lc={transition:null},$T={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:Lc,ReactCurrentOwner:gp};function W0(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:hc,forEach:function(n,e,t){hc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return hc(n,function(){e++}),e},toArray:function(n){return hc(n,function(e){return e})||[]},only:function(n){if(!yp(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Se.Component=Bo;Se.Fragment=AT;Se.Profiler=PT;Se.PureComponent=pp;Se.StrictMode=RT;Se.Suspense=MT;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$T;Se.act=W0;Se.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=B0({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=gp.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)G0.call(e,u)&&!K0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:kl,type:n.type,key:s,ref:i,props:r,_owner:o}};Se.createContext=function(n){return n={$$typeof:jT,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:DT,_context:n},n.Consumer=n};Se.createElement=H0;Se.createFactory=function(n){var e=H0.bind(null,n);return e.type=n,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(n){return{$$typeof:VT,render:n}};Se.isValidElement=yp;Se.lazy=function(n){return{$$typeof:LT,_payload:{_status:-1,_result:n},_init:BT}};Se.memo=function(n,e){return{$$typeof:OT,type:n,compare:e===void 0?null:e}};Se.startTransition=function(n){var e=Lc.transition;Lc.transition={};try{n()}finally{Lc.transition=e}};Se.unstable_act=W0;Se.useCallback=function(n,e){return Qt.current.useCallback(n,e)};Se.useContext=function(n){return Qt.current.useContext(n)};Se.useDebugValue=function(){};Se.useDeferredValue=function(n){return Qt.current.useDeferredValue(n)};Se.useEffect=function(n,e){return Qt.current.useEffect(n,e)};Se.useId=function(){return Qt.current.useId()};Se.useImperativeHandle=function(n,e,t){return Qt.current.useImperativeHandle(n,e,t)};Se.useInsertionEffect=function(n,e){return Qt.current.useInsertionEffect(n,e)};Se.useLayoutEffect=function(n,e){return Qt.current.useLayoutEffect(n,e)};Se.useMemo=function(n,e){return Qt.current.useMemo(n,e)};Se.useReducer=function(n,e,t){return Qt.current.useReducer(n,e,t)};Se.useRef=function(n){return Qt.current.useRef(n)};Se.useState=function(n){return Qt.current.useState(n)};Se.useSyncExternalStore=function(n,e,t){return Qt.current.useSyncExternalStore(n,e,t)};Se.useTransition=function(){return Qt.current.useTransition()};Se.version="18.3.1";U0.exports=Se;var z=U0.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qT=z,GT=Symbol.for("react.element"),KT=Symbol.for("react.fragment"),HT=Object.prototype.hasOwnProperty,WT=qT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QT={key:!0,ref:!0,__self:!0,__source:!0};function Q0(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)HT.call(e,r)&&!QT.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:GT,type:n,key:i,ref:o,props:s,_owner:WT.current}}ed.Fragment=KT;ed.jsx=Q0;ed.jsxs=Q0;F0.exports=ed;var c=F0.exports,Y0={exports:{}},vn={},J0={exports:{}},X0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(G,W){var le=G.length;G.push(W);e:for(;0<le;){var ge=le-1>>>1,he=G[ge];if(0<s(he,W))G[ge]=W,G[le]=he,le=ge;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var W=G[0],le=G.pop();if(le!==W){G[0]=le;e:for(var ge=0,he=G.length,$=he>>>1;ge<$;){var K=2*(ge+1)-1,re=G[K],Ie=K+1,be=G[Ie];if(0>s(re,le))Ie<he&&0>s(be,re)?(G[ge]=be,G[Ie]=le,ge=Ie):(G[ge]=re,G[K]=le,ge=K);else if(Ie<he&&0>s(be,le))G[ge]=be,G[Ie]=le,ge=Ie;else break e}}return W}function s(G,W){var le=G.sortIndex-W.sortIndex;return le!==0?le:G.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],d=[],f=1,m=null,y=3,x=!1,A=!1,R=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(G){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=G)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function I(G){if(R=!1,T(G),!A)if(t(u)!==null)A=!0,_e(D);else{var W=t(d);W!==null&&pe(I,W.startTime-G)}}function D(G,W){A=!1,R&&(R=!1,S(g),g=-1),x=!0;var le=y;try{for(T(W),m=t(u);m!==null&&(!(m.expirationTime>W)||G&&!C());){var ge=m.callback;if(typeof ge=="function"){m.callback=null,y=m.priorityLevel;var he=ge(m.expirationTime<=W);W=n.unstable_now(),typeof he=="function"?m.callback=he:m===t(u)&&r(u),T(W)}else r(u);m=t(u)}if(m!==null)var $=!0;else{var K=t(d);K!==null&&pe(I,K.startTime-W),$=!1}return $}finally{m=null,y=le,x=!1}}var P=!1,w=null,g=-1,_=5,b=-1;function C(){return!(n.unstable_now()-b<_)}function V(){if(w!==null){var G=n.unstable_now();b=G;var W=!0;try{W=w(!0,G)}finally{W?N():(P=!1,w=null)}}else P=!1}var N;if(typeof v=="function")N=function(){v(V)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,F=Ee.port2;Ee.port1.onmessage=V,N=function(){F.postMessage(null)}}else N=function(){k(V,0)};function _e(G){w=G,P||(P=!0,N())}function pe(G,W){g=k(function(){G(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){A||x||(A=!0,_e(D))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(G){switch(y){case 1:case 2:case 3:var W=3;break;default:W=y}var le=y;y=W;try{return G()}finally{y=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,W){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var le=y;y=G;try{return W()}finally{y=le}},n.unstable_scheduleCallback=function(G,W,le){var ge=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?ge+le:ge):le=ge,G){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=le+he,G={id:f++,callback:W,priorityLevel:G,startTime:le,expirationTime:he,sortIndex:-1},le>ge?(G.sortIndex=le,e(d,G),t(u)===null&&G===t(d)&&(R?(S(g),g=-1):R=!0,pe(I,le-ge))):(G.sortIndex=he,e(u,G),A||x||(A=!0,_e(D))),G},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(G){var W=y;return function(){var le=y;y=W;try{return G.apply(this,arguments)}finally{y=le}}}})(X0);J0.exports=X0;var YT=J0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JT=z,gn=YT;function H(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z0=new Set,Ja={};function _i(n,e){_o(n,e),_o(n+"Capture",e)}function _o(n,e){for(Ja[n]=e,n=0;n<e.length;n++)Z0.add(e[n])}var xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zh=Object.prototype.hasOwnProperty,XT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$g={},qg={};function ZT(n){return zh.call(qg,n)?!0:zh.call($g,n)?!1:XT.test(n)?qg[n]=!0:($g[n]=!0,!1)}function e1(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function t1(n,e,t,r){if(e===null||typeof e>"u"||e1(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yt(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){jt[n]=new Yt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];jt[e]=new Yt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){jt[n]=new Yt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){jt[n]=new Yt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){jt[n]=new Yt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){jt[n]=new Yt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){jt[n]=new Yt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){jt[n]=new Yt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){jt[n]=new Yt(n,5,!1,n.toLowerCase(),null,!1,!1)});var vp=/[\-:]([a-z])/g;function _p(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(vp,_p);jt[e]=new Yt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(vp,_p);jt[e]=new Yt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(vp,_p);jt[e]=new Yt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){jt[n]=new Yt(n,1,!1,n.toLowerCase(),null,!1,!1)});jt.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){jt[n]=new Yt(n,1,!1,n.toLowerCase(),null,!0,!0)});function xp(n,e,t,r){var s=jt.hasOwnProperty(e)?jt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(t1(e,t,s,r)&&(t=null),r||s===null?ZT(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var kr=JT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fc=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Wi=Symbol.for("react.fragment"),wp=Symbol.for("react.strict_mode"),Bh=Symbol.for("react.profiler"),e_=Symbol.for("react.provider"),t_=Symbol.for("react.context"),Ip=Symbol.for("react.forward_ref"),$h=Symbol.for("react.suspense"),qh=Symbol.for("react.suspense_list"),Ep=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),n_=Symbol.for("react.offscreen"),Gg=Symbol.iterator;function ha(n){return n===null||typeof n!="object"?null:(n=Gg&&n[Gg]||n["@@iterator"],typeof n=="function"?n:null)}var it=Object.assign,eh;function Sa(n){if(eh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);eh=e&&e[1]||""}return`
`+eh+n}var th=!1;function nh(n,e){if(!n||th)return"";th=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{th=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Sa(n):""}function n1(n){switch(n.tag){case 5:return Sa(n.type);case 16:return Sa("Lazy");case 13:return Sa("Suspense");case 19:return Sa("SuspenseList");case 0:case 2:case 15:return n=nh(n.type,!1),n;case 11:return n=nh(n.type.render,!1),n;case 1:return n=nh(n.type,!0),n;default:return""}}function Gh(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Wi:return"Fragment";case Hi:return"Portal";case Bh:return"Profiler";case wp:return"StrictMode";case $h:return"Suspense";case qh:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case t_:return(n.displayName||"Context")+".Consumer";case e_:return(n._context.displayName||"Context")+".Provider";case Ip:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ep:return e=n.displayName||null,e!==null?e:Gh(n.type)||"Memo";case $r:e=n._payload,n=n._init;try{return Gh(n(e))}catch{}}return null}function r1(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gh(e);case 8:return e===wp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ys(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function r_(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function s1(n){var e=r_(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function pc(n){n._valueTracker||(n._valueTracker=s1(n))}function s_(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=r_(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function lu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Kh(n,e){var t=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Kg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=ys(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function i_(n,e){e=e.checked,e!=null&&xp(n,"checked",e,!1)}function Hh(n,e){i_(n,e);var t=ys(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Wh(n,e.type,t):e.hasOwnProperty("defaultValue")&&Wh(n,e.type,ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Hg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Wh(n,e,t){(e!=="number"||lu(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ba=Array.isArray;function ao(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+ys(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Qh(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Wg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(H(92));if(ba(t)){if(1<t.length)throw Error(H(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ys(t)}}function o_(n,e){var t=ys(e.value),r=ys(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Qg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function a_(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?a_(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var mc,l_=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(mc=mc||document.createElement("div"),mc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Xa(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i1=["Webkit","ms","Moz","O"];Object.keys(ja).forEach(function(n){i1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ja[e]=ja[n]})});function c_(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ja.hasOwnProperty(n)&&ja[n]?(""+e).trim():e+"px"}function u_(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=c_(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var o1=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jh(n,e){if(e){if(o1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Xh(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zh=null;function Tp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ef=null,lo=null,co=null;function Yg(n){if(n=Rl(n)){if(typeof ef!="function")throw Error(H(280));var e=n.stateNode;e&&(e=id(e),ef(n.stateNode,n.type,e))}}function d_(n){lo?co?co.push(n):co=[n]:lo=n}function h_(){if(lo){var n=lo,e=co;if(co=lo=null,Yg(n),e)for(n=0;n<e.length;n++)Yg(e[n])}}function f_(n,e){return n(e)}function p_(){}var rh=!1;function m_(n,e,t){if(rh)return n(e,t);rh=!0;try{return f_(n,e,t)}finally{rh=!1,(lo!==null||co!==null)&&(p_(),h_())}}function Za(n,e){var t=n.stateNode;if(t===null)return null;var r=id(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(H(231,e,typeof t));return t}var tf=!1;if(xr)try{var fa={};Object.defineProperty(fa,"passive",{get:function(){tf=!0}}),window.addEventListener("test",fa,fa),window.removeEventListener("test",fa,fa)}catch{tf=!1}function a1(n,e,t,r,s,i,o,a,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(f){this.onError(f)}}var Va=!1,cu=null,uu=!1,nf=null,l1={onError:function(n){Va=!0,cu=n}};function c1(n,e,t,r,s,i,o,a,u){Va=!1,cu=null,a1.apply(l1,arguments)}function u1(n,e,t,r,s,i,o,a,u){if(c1.apply(this,arguments),Va){if(Va){var d=cu;Va=!1,cu=null}else throw Error(H(198));uu||(uu=!0,nf=d)}}function xi(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function g_(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Jg(n){if(xi(n)!==n)throw Error(H(188))}function d1(n){var e=n.alternate;if(!e){if(e=xi(n),e===null)throw Error(H(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return Jg(s),n;if(i===r)return Jg(s),e;i=i.sibling}throw Error(H(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(H(189))}}if(t.alternate!==r)throw Error(H(190))}if(t.tag!==3)throw Error(H(188));return t.stateNode.current===t?n:e}function y_(n){return n=d1(n),n!==null?v_(n):null}function v_(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=v_(n);if(e!==null)return e;n=n.sibling}return null}var __=gn.unstable_scheduleCallback,Xg=gn.unstable_cancelCallback,h1=gn.unstable_shouldYield,f1=gn.unstable_requestPaint,ht=gn.unstable_now,p1=gn.unstable_getCurrentPriorityLevel,Sp=gn.unstable_ImmediatePriority,x_=gn.unstable_UserBlockingPriority,du=gn.unstable_NormalPriority,m1=gn.unstable_LowPriority,w_=gn.unstable_IdlePriority,td=null,Jn=null;function g1(n){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(td,n,void 0,(n.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:_1,y1=Math.log,v1=Math.LN2;function _1(n){return n>>>=0,n===0?32:31-(y1(n)/v1|0)|0}var gc=64,yc=4194304;function Na(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function hu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Na(a):(i&=o,i!==0&&(r=Na(i)))}else o=t&~s,o!==0?r=Na(o):i!==0&&(r=Na(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ln(e),s=1<<t,r|=n[t],e&=~s;return r}function x1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function w1(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Ln(i),a=1<<o,u=s[o];u===-1?(!(a&t)||a&r)&&(s[o]=x1(a,e)):u<=e&&(n.expiredLanes|=a),i&=~a}}function rf(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function I_(){var n=gc;return gc<<=1,!(gc&4194240)&&(gc=64),n}function sh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Cl(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ln(e),n[e]=t}function I1(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Ln(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function bp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ln(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Oe=0;function E_(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var T_,Np,S_,b_,N_,sf=!1,vc=[],ns=null,rs=null,ss=null,el=new Map,tl=new Map,Gr=[],E1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zg(n,e){switch(n){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":el.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(e.pointerId)}}function pa(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Rl(e),e!==null&&Np(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function T1(n,e,t,r,s){switch(e){case"focusin":return ns=pa(ns,n,e,t,r,s),!0;case"dragenter":return rs=pa(rs,n,e,t,r,s),!0;case"mouseover":return ss=pa(ss,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return el.set(i,pa(el.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,tl.set(i,pa(tl.get(i)||null,n,e,t,r,s)),!0}return!1}function k_(n){var e=Js(n.target);if(e!==null){var t=xi(e);if(t!==null){if(e=t.tag,e===13){if(e=g_(t),e!==null){n.blockedOn=e,N_(n.priority,function(){S_(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fc(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=of(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Zh=r,t.target.dispatchEvent(r),Zh=null}else return e=Rl(t),e!==null&&Np(e),n.blockedOn=t,!1;e.shift()}return!0}function ey(n,e,t){Fc(n)&&t.delete(e)}function S1(){sf=!1,ns!==null&&Fc(ns)&&(ns=null),rs!==null&&Fc(rs)&&(rs=null),ss!==null&&Fc(ss)&&(ss=null),el.forEach(ey),tl.forEach(ey)}function ma(n,e){n.blockedOn===e&&(n.blockedOn=null,sf||(sf=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,S1)))}function nl(n){function e(s){return ma(s,n)}if(0<vc.length){ma(vc[0],n);for(var t=1;t<vc.length;t++){var r=vc[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ns!==null&&ma(ns,n),rs!==null&&ma(rs,n),ss!==null&&ma(ss,n),el.forEach(e),tl.forEach(e),t=0;t<Gr.length;t++)r=Gr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Gr.length&&(t=Gr[0],t.blockedOn===null);)k_(t),t.blockedOn===null&&Gr.shift()}var uo=kr.ReactCurrentBatchConfig,fu=!0;function b1(n,e,t,r){var s=Oe,i=uo.transition;uo.transition=null;try{Oe=1,kp(n,e,t,r)}finally{Oe=s,uo.transition=i}}function N1(n,e,t,r){var s=Oe,i=uo.transition;uo.transition=null;try{Oe=4,kp(n,e,t,r)}finally{Oe=s,uo.transition=i}}function kp(n,e,t,r){if(fu){var s=of(n,e,t,r);if(s===null)ph(n,e,r,pu,t),Zg(n,r);else if(T1(s,n,e,t,r))r.stopPropagation();else if(Zg(n,r),e&4&&-1<E1.indexOf(n)){for(;s!==null;){var i=Rl(s);if(i!==null&&T_(i),i=of(n,e,t,r),i===null&&ph(n,e,r,pu,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else ph(n,e,r,null,t)}}var pu=null;function of(n,e,t,r){if(pu=null,n=Tp(r),n=Js(n),n!==null)if(e=xi(n),e===null)n=null;else if(t=e.tag,t===13){if(n=g_(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return pu=n,null}function C_(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p1()){case Sp:return 1;case x_:return 4;case du:case m1:return 16;case w_:return 536870912;default:return 16}default:return 16}}var Xr=null,Cp=null,Uc=null;function A_(){if(Uc)return Uc;var n,e=Cp,t=e.length,r,s="value"in Xr?Xr.value:Xr.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Uc=s.slice(n,1<r?1-r:void 0)}function zc(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function _c(){return!0}function ty(){return!1}function _n(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_c:ty,this.isPropagationStopped=ty,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=_c)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=_c)},persist:function(){},isPersistent:_c}),e}var $o={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ap=_n($o),Al=it({},$o,{view:0,detail:0}),k1=_n(Al),ih,oh,ga,nd=it({},Al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ga&&(ga&&n.type==="mousemove"?(ih=n.screenX-ga.screenX,oh=n.screenY-ga.screenY):oh=ih=0,ga=n),ih)},movementY:function(n){return"movementY"in n?n.movementY:oh}}),ny=_n(nd),C1=it({},nd,{dataTransfer:0}),A1=_n(C1),R1=it({},Al,{relatedTarget:0}),ah=_n(R1),P1=it({},$o,{animationName:0,elapsedTime:0,pseudoElement:0}),D1=_n(P1),j1=it({},$o,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),V1=_n(j1),M1=it({},$o,{data:0}),ry=_n(M1),O1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U1(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=F1[n])?!!e[n]:!1}function Rp(){return U1}var z1=it({},Al,{key:function(n){if(n.key){var e=O1[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=zc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?L1[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rp,charCode:function(n){return n.type==="keypress"?zc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?zc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),B1=_n(z1),$1=it({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sy=_n($1),q1=it({},Al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rp}),G1=_n(q1),K1=it({},$o,{propertyName:0,elapsedTime:0,pseudoElement:0}),H1=_n(K1),W1=it({},nd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Q1=_n(W1),Y1=[9,13,27,32],Pp=xr&&"CompositionEvent"in window,Ma=null;xr&&"documentMode"in document&&(Ma=document.documentMode);var J1=xr&&"TextEvent"in window&&!Ma,R_=xr&&(!Pp||Ma&&8<Ma&&11>=Ma),iy=" ",oy=!1;function P_(n,e){switch(n){case"keyup":return Y1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function D_(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qi=!1;function X1(n,e){switch(n){case"compositionend":return D_(e);case"keypress":return e.which!==32?null:(oy=!0,iy);case"textInput":return n=e.data,n===iy&&oy?null:n;default:return null}}function Z1(n,e){if(Qi)return n==="compositionend"||!Pp&&P_(n,e)?(n=A_(),Uc=Cp=Xr=null,Qi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return R_&&e.locale!=="ko"?null:e.data;default:return null}}var eS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ay(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!eS[n.type]:e==="textarea"}function j_(n,e,t,r){d_(r),e=mu(e,"onChange"),0<e.length&&(t=new Ap("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Oa=null,rl=null;function tS(n){G_(n,0)}function rd(n){var e=Xi(n);if(s_(e))return n}function nS(n,e){if(n==="change")return e}var V_=!1;if(xr){var lh;if(xr){var ch="oninput"in document;if(!ch){var ly=document.createElement("div");ly.setAttribute("oninput","return;"),ch=typeof ly.oninput=="function"}lh=ch}else lh=!1;V_=lh&&(!document.documentMode||9<document.documentMode)}function cy(){Oa&&(Oa.detachEvent("onpropertychange",M_),rl=Oa=null)}function M_(n){if(n.propertyName==="value"&&rd(rl)){var e=[];j_(e,rl,n,Tp(n)),m_(tS,e)}}function rS(n,e,t){n==="focusin"?(cy(),Oa=e,rl=t,Oa.attachEvent("onpropertychange",M_)):n==="focusout"&&cy()}function sS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rd(rl)}function iS(n,e){if(n==="click")return rd(e)}function oS(n,e){if(n==="input"||n==="change")return rd(e)}function aS(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Un=typeof Object.is=="function"?Object.is:aS;function sl(n,e){if(Un(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!zh.call(e,s)||!Un(n[s],e[s]))return!1}return!0}function uy(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function dy(n,e){var t=uy(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=uy(t)}}function O_(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?O_(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function L_(){for(var n=window,e=lu();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=lu(n.document)}return e}function Dp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function lS(n){var e=L_(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&O_(t.ownerDocument.documentElement,t)){if(r!==null&&Dp(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=dy(t,i);var o=dy(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var cS=xr&&"documentMode"in document&&11>=document.documentMode,Yi=null,af=null,La=null,lf=!1;function hy(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;lf||Yi==null||Yi!==lu(r)||(r=Yi,"selectionStart"in r&&Dp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),La&&sl(La,r)||(La=r,r=mu(af,"onSelect"),0<r.length&&(e=new Ap("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Yi)))}function xc(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ji={animationend:xc("Animation","AnimationEnd"),animationiteration:xc("Animation","AnimationIteration"),animationstart:xc("Animation","AnimationStart"),transitionend:xc("Transition","TransitionEnd")},uh={},F_={};xr&&(F_=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function sd(n){if(uh[n])return uh[n];if(!Ji[n])return n;var e=Ji[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in F_)return uh[n]=e[t];return n}var U_=sd("animationend"),z_=sd("animationiteration"),B_=sd("animationstart"),$_=sd("transitionend"),q_=new Map,fy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ts(n,e){q_.set(n,e),_i(e,[n])}for(var dh=0;dh<fy.length;dh++){var hh=fy[dh],uS=hh.toLowerCase(),dS=hh[0].toUpperCase()+hh.slice(1);Ts(uS,"on"+dS)}Ts(U_,"onAnimationEnd");Ts(z_,"onAnimationIteration");Ts(B_,"onAnimationStart");Ts("dblclick","onDoubleClick");Ts("focusin","onFocus");Ts("focusout","onBlur");Ts($_,"onTransitionEnd");_o("onMouseEnter",["mouseout","mouseover"]);_o("onMouseLeave",["mouseout","mouseover"]);_o("onPointerEnter",["pointerout","pointerover"]);_o("onPointerLeave",["pointerout","pointerover"]);_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_i("onBeforeInput",["compositionend","keypress","textInput","paste"]);_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ka="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ka));function py(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,u1(r,e,void 0,n),n.currentTarget=null}function G_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;py(s,a,d),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,d=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;py(s,a,d),i=u}}}if(uu)throw n=nf,uu=!1,nf=null,n}function He(n,e){var t=e[ff];t===void 0&&(t=e[ff]=new Set);var r=n+"__bubble";t.has(r)||(K_(e,n,2,!1),t.add(r))}function fh(n,e,t){var r=0;e&&(r|=4),K_(t,n,r,e)}var wc="_reactListening"+Math.random().toString(36).slice(2);function il(n){if(!n[wc]){n[wc]=!0,Z0.forEach(function(t){t!=="selectionchange"&&(hS.has(t)||fh(t,!1,n),fh(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[wc]||(e[wc]=!0,fh("selectionchange",!1,e))}}function K_(n,e,t,r){switch(C_(e)){case 1:var s=b1;break;case 4:s=N1;break;default:s=kp}t=s.bind(null,e,t,n),s=void 0,!tf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function ph(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Js(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}m_(function(){var d=i,f=Tp(t),m=[];e:{var y=q_.get(n);if(y!==void 0){var x=Ap,A=n;switch(n){case"keypress":if(zc(t)===0)break e;case"keydown":case"keyup":x=B1;break;case"focusin":A="focus",x=ah;break;case"focusout":A="blur",x=ah;break;case"beforeblur":case"afterblur":x=ah;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=ny;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=A1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=G1;break;case U_:case z_:case B_:x=D1;break;case $_:x=H1;break;case"scroll":x=k1;break;case"wheel":x=Q1;break;case"copy":case"cut":case"paste":x=V1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=sy}var R=(e&4)!==0,k=!R&&n==="scroll",S=R?y!==null?y+"Capture":null:y;R=[];for(var v=d,T;v!==null;){T=v;var I=T.stateNode;if(T.tag===5&&I!==null&&(T=I,S!==null&&(I=Za(v,S),I!=null&&R.push(ol(v,I,T)))),k)break;v=v.return}0<R.length&&(y=new x(y,A,null,t,f),m.push({event:y,listeners:R}))}}if(!(e&7)){e:{if(y=n==="mouseover"||n==="pointerover",x=n==="mouseout"||n==="pointerout",y&&t!==Zh&&(A=t.relatedTarget||t.fromElement)&&(Js(A)||A[wr]))break e;if((x||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,x?(A=t.relatedTarget||t.toElement,x=d,A=A?Js(A):null,A!==null&&(k=xi(A),A!==k||A.tag!==5&&A.tag!==6)&&(A=null)):(x=null,A=d),x!==A)){if(R=ny,I="onMouseLeave",S="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(R=sy,I="onPointerLeave",S="onPointerEnter",v="pointer"),k=x==null?y:Xi(x),T=A==null?y:Xi(A),y=new R(I,v+"leave",x,t,f),y.target=k,y.relatedTarget=T,I=null,Js(f)===d&&(R=new R(S,v+"enter",A,t,f),R.target=T,R.relatedTarget=k,I=R),k=I,x&&A)t:{for(R=x,S=A,v=0,T=R;T;T=Mi(T))v++;for(T=0,I=S;I;I=Mi(I))T++;for(;0<v-T;)R=Mi(R),v--;for(;0<T-v;)S=Mi(S),T--;for(;v--;){if(R===S||S!==null&&R===S.alternate)break t;R=Mi(R),S=Mi(S)}R=null}else R=null;x!==null&&my(m,y,x,R,!1),A!==null&&k!==null&&my(m,k,A,R,!0)}}e:{if(y=d?Xi(d):window,x=y.nodeName&&y.nodeName.toLowerCase(),x==="select"||x==="input"&&y.type==="file")var D=nS;else if(ay(y))if(V_)D=oS;else{D=sS;var P=rS}else(x=y.nodeName)&&x.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(D=iS);if(D&&(D=D(n,d))){j_(m,D,t,f);break e}P&&P(n,y,d),n==="focusout"&&(P=y._wrapperState)&&P.controlled&&y.type==="number"&&Wh(y,"number",y.value)}switch(P=d?Xi(d):window,n){case"focusin":(ay(P)||P.contentEditable==="true")&&(Yi=P,af=d,La=null);break;case"focusout":La=af=Yi=null;break;case"mousedown":lf=!0;break;case"contextmenu":case"mouseup":case"dragend":lf=!1,hy(m,t,f);break;case"selectionchange":if(cS)break;case"keydown":case"keyup":hy(m,t,f)}var w;if(Pp)e:{switch(n){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Qi?P_(n,t)&&(g="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(g="onCompositionStart");g&&(R_&&t.locale!=="ko"&&(Qi||g!=="onCompositionStart"?g==="onCompositionEnd"&&Qi&&(w=A_()):(Xr=f,Cp="value"in Xr?Xr.value:Xr.textContent,Qi=!0)),P=mu(d,g),0<P.length&&(g=new ry(g,n,null,t,f),m.push({event:g,listeners:P}),w?g.data=w:(w=D_(t),w!==null&&(g.data=w)))),(w=J1?X1(n,t):Z1(n,t))&&(d=mu(d,"onBeforeInput"),0<d.length&&(f=new ry("onBeforeInput","beforeinput",null,t,f),m.push({event:f,listeners:d}),f.data=w))}G_(m,e)})}function ol(n,e,t){return{instance:n,listener:e,currentTarget:t}}function mu(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Za(n,t),i!=null&&r.unshift(ol(n,i,s)),i=Za(n,e),i!=null&&r.push(ol(n,i,s))),n=n.return}return r}function Mi(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function my(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,d=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&d!==null&&(a=d,s?(u=Za(t,i),u!=null&&o.unshift(ol(t,u,a))):s||(u=Za(t,i),u!=null&&o.push(ol(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var fS=/\r\n?/g,pS=/\u0000|\uFFFD/g;function gy(n){return(typeof n=="string"?n:""+n).replace(fS,`
`).replace(pS,"")}function Ic(n,e,t){if(e=gy(e),gy(n)!==e&&t)throw Error(H(425))}function gu(){}var cf=null,uf=null;function df(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hf=typeof setTimeout=="function"?setTimeout:void 0,mS=typeof clearTimeout=="function"?clearTimeout:void 0,yy=typeof Promise=="function"?Promise:void 0,gS=typeof queueMicrotask=="function"?queueMicrotask:typeof yy<"u"?function(n){return yy.resolve(null).then(n).catch(yS)}:hf;function yS(n){setTimeout(function(){throw n})}function mh(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),nl(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);nl(e)}function is(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function vy(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var qo=Math.random().toString(36).slice(2),Wn="__reactFiber$"+qo,al="__reactProps$"+qo,wr="__reactContainer$"+qo,ff="__reactEvents$"+qo,vS="__reactListeners$"+qo,_S="__reactHandles$"+qo;function Js(n){var e=n[Wn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[wr]||t[Wn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=vy(n);n!==null;){if(t=n[Wn])return t;n=vy(n)}return e}n=t,t=n.parentNode}return null}function Rl(n){return n=n[Wn]||n[wr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Xi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(H(33))}function id(n){return n[al]||null}var pf=[],Zi=-1;function Ss(n){return{current:n}}function We(n){0>Zi||(n.current=pf[Zi],pf[Zi]=null,Zi--)}function qe(n,e){Zi++,pf[Zi]=n.current,n.current=e}var vs={},$t=Ss(vs),sn=Ss(!1),si=vs;function xo(n,e){var t=n.type.contextTypes;if(!t)return vs;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function on(n){return n=n.childContextTypes,n!=null}function yu(){We(sn),We($t)}function _y(n,e,t){if($t.current!==vs)throw Error(H(168));qe($t,e),qe(sn,t)}function H_(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,r1(n)||"Unknown",s));return it({},t,r)}function vu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||vs,si=$t.current,qe($t,n),qe(sn,sn.current),!0}function xy(n,e,t){var r=n.stateNode;if(!r)throw Error(H(169));t?(n=H_(n,e,si),r.__reactInternalMemoizedMergedChildContext=n,We(sn),We($t),qe($t,n)):We(sn),qe(sn,t)}var cr=null,od=!1,gh=!1;function W_(n){cr===null?cr=[n]:cr.push(n)}function xS(n){od=!0,W_(n)}function bs(){if(!gh&&cr!==null){gh=!0;var n=0,e=Oe;try{var t=cr;for(Oe=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}cr=null,od=!1}catch(s){throw cr!==null&&(cr=cr.slice(n+1)),__(Sp,bs),s}finally{Oe=e,gh=!1}}return null}var eo=[],to=0,_u=null,xu=0,In=[],En=0,ii=null,ur=1,dr="";function $s(n,e){eo[to++]=xu,eo[to++]=_u,_u=n,xu=e}function Q_(n,e,t){In[En++]=ur,In[En++]=dr,In[En++]=ii,ii=n;var r=ur;n=dr;var s=32-Ln(r)-1;r&=~(1<<s),t+=1;var i=32-Ln(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ur=1<<32-Ln(e)+s|t<<s|r,dr=i+n}else ur=1<<i|t<<s|r,dr=n}function jp(n){n.return!==null&&($s(n,1),Q_(n,1,0))}function Vp(n){for(;n===_u;)_u=eo[--to],eo[to]=null,xu=eo[--to],eo[to]=null;for(;n===ii;)ii=In[--En],In[En]=null,dr=In[--En],In[En]=null,ur=In[--En],In[En]=null}var fn=null,dn=null,Ye=!1,Mn=null;function Y_(n,e){var t=Tn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function wy(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,fn=n,dn=is(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,fn=n,dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ii!==null?{id:ur,overflow:dr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Tn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,fn=n,dn=null,!0):!1;default:return!1}}function mf(n){return(n.mode&1)!==0&&(n.flags&128)===0}function gf(n){if(Ye){var e=dn;if(e){var t=e;if(!wy(n,e)){if(mf(n))throw Error(H(418));e=is(t.nextSibling);var r=fn;e&&wy(n,e)?Y_(r,t):(n.flags=n.flags&-4097|2,Ye=!1,fn=n)}}else{if(mf(n))throw Error(H(418));n.flags=n.flags&-4097|2,Ye=!1,fn=n}}}function Iy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;fn=n}function Ec(n){if(n!==fn)return!1;if(!Ye)return Iy(n),Ye=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!df(n.type,n.memoizedProps)),e&&(e=dn)){if(mf(n))throw J_(),Error(H(418));for(;e;)Y_(n,e),e=is(e.nextSibling)}if(Iy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(H(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){dn=is(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}dn=null}}else dn=fn?is(n.stateNode.nextSibling):null;return!0}function J_(){for(var n=dn;n;)n=is(n.nextSibling)}function wo(){dn=fn=null,Ye=!1}function Mp(n){Mn===null?Mn=[n]:Mn.push(n)}var wS=kr.ReactCurrentBatchConfig;function ya(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(H(309));var r=t.stateNode}if(!r)throw Error(H(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(H(284));if(!t._owner)throw Error(H(290,n))}return n}function Tc(n,e){throw n=Object.prototype.toString.call(e),Error(H(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Ey(n){var e=n._init;return e(n._payload)}function X_(n){function e(S,v){if(n){var T=S.deletions;T===null?(S.deletions=[v],S.flags|=16):T.push(v)}}function t(S,v){if(!n)return null;for(;v!==null;)e(S,v),v=v.sibling;return null}function r(S,v){for(S=new Map;v!==null;)v.key!==null?S.set(v.key,v):S.set(v.index,v),v=v.sibling;return S}function s(S,v){return S=cs(S,v),S.index=0,S.sibling=null,S}function i(S,v,T){return S.index=T,n?(T=S.alternate,T!==null?(T=T.index,T<v?(S.flags|=2,v):T):(S.flags|=2,v)):(S.flags|=1048576,v)}function o(S){return n&&S.alternate===null&&(S.flags|=2),S}function a(S,v,T,I){return v===null||v.tag!==6?(v=Eh(T,S.mode,I),v.return=S,v):(v=s(v,T),v.return=S,v)}function u(S,v,T,I){var D=T.type;return D===Wi?f(S,v,T.props.children,I,T.key):v!==null&&(v.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===$r&&Ey(D)===v.type)?(I=s(v,T.props),I.ref=ya(S,v,T),I.return=S,I):(I=Wc(T.type,T.key,T.props,null,S.mode,I),I.ref=ya(S,v,T),I.return=S,I)}function d(S,v,T,I){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=Th(T,S.mode,I),v.return=S,v):(v=s(v,T.children||[]),v.return=S,v)}function f(S,v,T,I,D){return v===null||v.tag!==7?(v=ti(T,S.mode,I,D),v.return=S,v):(v=s(v,T),v.return=S,v)}function m(S,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Eh(""+v,S.mode,T),v.return=S,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case fc:return T=Wc(v.type,v.key,v.props,null,S.mode,T),T.ref=ya(S,null,v),T.return=S,T;case Hi:return v=Th(v,S.mode,T),v.return=S,v;case $r:var I=v._init;return m(S,I(v._payload),T)}if(ba(v)||ha(v))return v=ti(v,S.mode,T,null),v.return=S,v;Tc(S,v)}return null}function y(S,v,T,I){var D=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return D!==null?null:a(S,v,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case fc:return T.key===D?u(S,v,T,I):null;case Hi:return T.key===D?d(S,v,T,I):null;case $r:return D=T._init,y(S,v,D(T._payload),I)}if(ba(T)||ha(T))return D!==null?null:f(S,v,T,I,null);Tc(S,T)}return null}function x(S,v,T,I,D){if(typeof I=="string"&&I!==""||typeof I=="number")return S=S.get(T)||null,a(v,S,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case fc:return S=S.get(I.key===null?T:I.key)||null,u(v,S,I,D);case Hi:return S=S.get(I.key===null?T:I.key)||null,d(v,S,I,D);case $r:var P=I._init;return x(S,v,T,P(I._payload),D)}if(ba(I)||ha(I))return S=S.get(T)||null,f(v,S,I,D,null);Tc(v,I)}return null}function A(S,v,T,I){for(var D=null,P=null,w=v,g=v=0,_=null;w!==null&&g<T.length;g++){w.index>g?(_=w,w=null):_=w.sibling;var b=y(S,w,T[g],I);if(b===null){w===null&&(w=_);break}n&&w&&b.alternate===null&&e(S,w),v=i(b,v,g),P===null?D=b:P.sibling=b,P=b,w=_}if(g===T.length)return t(S,w),Ye&&$s(S,g),D;if(w===null){for(;g<T.length;g++)w=m(S,T[g],I),w!==null&&(v=i(w,v,g),P===null?D=w:P.sibling=w,P=w);return Ye&&$s(S,g),D}for(w=r(S,w);g<T.length;g++)_=x(w,S,g,T[g],I),_!==null&&(n&&_.alternate!==null&&w.delete(_.key===null?g:_.key),v=i(_,v,g),P===null?D=_:P.sibling=_,P=_);return n&&w.forEach(function(C){return e(S,C)}),Ye&&$s(S,g),D}function R(S,v,T,I){var D=ha(T);if(typeof D!="function")throw Error(H(150));if(T=D.call(T),T==null)throw Error(H(151));for(var P=D=null,w=v,g=v=0,_=null,b=T.next();w!==null&&!b.done;g++,b=T.next()){w.index>g?(_=w,w=null):_=w.sibling;var C=y(S,w,b.value,I);if(C===null){w===null&&(w=_);break}n&&w&&C.alternate===null&&e(S,w),v=i(C,v,g),P===null?D=C:P.sibling=C,P=C,w=_}if(b.done)return t(S,w),Ye&&$s(S,g),D;if(w===null){for(;!b.done;g++,b=T.next())b=m(S,b.value,I),b!==null&&(v=i(b,v,g),P===null?D=b:P.sibling=b,P=b);return Ye&&$s(S,g),D}for(w=r(S,w);!b.done;g++,b=T.next())b=x(w,S,g,b.value,I),b!==null&&(n&&b.alternate!==null&&w.delete(b.key===null?g:b.key),v=i(b,v,g),P===null?D=b:P.sibling=b,P=b);return n&&w.forEach(function(V){return e(S,V)}),Ye&&$s(S,g),D}function k(S,v,T,I){if(typeof T=="object"&&T!==null&&T.type===Wi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case fc:e:{for(var D=T.key,P=v;P!==null;){if(P.key===D){if(D=T.type,D===Wi){if(P.tag===7){t(S,P.sibling),v=s(P,T.props.children),v.return=S,S=v;break e}}else if(P.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===$r&&Ey(D)===P.type){t(S,P.sibling),v=s(P,T.props),v.ref=ya(S,P,T),v.return=S,S=v;break e}t(S,P);break}else e(S,P);P=P.sibling}T.type===Wi?(v=ti(T.props.children,S.mode,I,T.key),v.return=S,S=v):(I=Wc(T.type,T.key,T.props,null,S.mode,I),I.ref=ya(S,v,T),I.return=S,S=I)}return o(S);case Hi:e:{for(P=T.key;v!==null;){if(v.key===P)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){t(S,v.sibling),v=s(v,T.children||[]),v.return=S,S=v;break e}else{t(S,v);break}else e(S,v);v=v.sibling}v=Th(T,S.mode,I),v.return=S,S=v}return o(S);case $r:return P=T._init,k(S,v,P(T._payload),I)}if(ba(T))return A(S,v,T,I);if(ha(T))return R(S,v,T,I);Tc(S,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(t(S,v.sibling),v=s(v,T),v.return=S,S=v):(t(S,v),v=Eh(T,S.mode,I),v.return=S,S=v),o(S)):t(S,v)}return k}var Io=X_(!0),Z_=X_(!1),wu=Ss(null),Iu=null,no=null,Op=null;function Lp(){Op=no=Iu=null}function Fp(n){var e=wu.current;We(wu),n._currentValue=e}function yf(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function ho(n,e){Iu=n,Op=no=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(tn=!0),n.firstContext=null)}function bn(n){var e=n._currentValue;if(Op!==n)if(n={context:n,memoizedValue:e,next:null},no===null){if(Iu===null)throw Error(H(308));no=n,Iu.dependencies={lanes:0,firstContext:n}}else no=no.next=n;return e}var Xs=null;function Up(n){Xs===null?Xs=[n]:Xs.push(n)}function ex(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Up(e)):(t.next=s.next,s.next=t),e.interleaved=t,Ir(n,r)}function Ir(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var qr=!1;function zp(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tx(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function vr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function os(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ir(n,t)}return s=r.interleaved,s===null?(e.next=e,Up(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ir(n,t)}function Bc(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,bp(n,t)}}function Ty(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Eu(n,e,t,r){var s=n.updateQueue;qr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=n.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=d:a.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,f=d=u=null,a=i;do{var y=a.lane,x=a.eventTime;if((r&y)===y){f!==null&&(f=f.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=n,R=a;switch(y=e,x=t,R.tag){case 1:if(A=R.payload,typeof A=="function"){m=A.call(x,m,y);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=R.payload,y=typeof A=="function"?A.call(x,m,y):A,y==null)break e;m=it({},m,y);break e;case 2:qr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,y=s.effects,y===null?s.effects=[a]:y.push(a))}else x={eventTime:x,lane:y,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(d=f=x,u=m):f=f.next=x,o|=y;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;y=a,a=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ai|=o,n.lanes=o,n.memoizedState=m}}function Sy(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Pl={},Xn=Ss(Pl),ll=Ss(Pl),cl=Ss(Pl);function Zs(n){if(n===Pl)throw Error(H(174));return n}function Bp(n,e){switch(qe(cl,e),qe(ll,n),qe(Xn,Pl),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yh(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Yh(e,n)}We(Xn),qe(Xn,e)}function Eo(){We(Xn),We(ll),We(cl)}function nx(n){Zs(cl.current);var e=Zs(Xn.current),t=Yh(e,n.type);e!==t&&(qe(ll,n),qe(Xn,t))}function $p(n){ll.current===n&&(We(Xn),We(ll))}var tt=Ss(0);function Tu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yh=[];function qp(){for(var n=0;n<yh.length;n++)yh[n]._workInProgressVersionPrimary=null;yh.length=0}var $c=kr.ReactCurrentDispatcher,vh=kr.ReactCurrentBatchConfig,oi=0,rt=null,wt=null,bt=null,Su=!1,Fa=!1,ul=0,IS=0;function Ot(){throw Error(H(321))}function Gp(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Un(n[t],e[t]))return!1;return!0}function Kp(n,e,t,r,s,i){if(oi=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$c.current=n===null||n.memoizedState===null?bS:NS,n=t(r,s),Fa){i=0;do{if(Fa=!1,ul=0,25<=i)throw Error(H(301));i+=1,bt=wt=null,e.updateQueue=null,$c.current=kS,n=t(r,s)}while(Fa)}if($c.current=bu,e=wt!==null&&wt.next!==null,oi=0,bt=wt=rt=null,Su=!1,e)throw Error(H(300));return n}function Hp(){var n=ul!==0;return ul=0,n}function Hn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?rt.memoizedState=bt=n:bt=bt.next=n,bt}function Nn(){if(wt===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=wt.next;var e=bt===null?rt.memoizedState:bt.next;if(e!==null)bt=e,wt=n;else{if(n===null)throw Error(H(310));wt=n,n={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},bt===null?rt.memoizedState=bt=n:bt=bt.next=n}return bt}function dl(n,e){return typeof e=="function"?e(n):e}function _h(n){var e=Nn(),t=e.queue;if(t===null)throw Error(H(311));t.lastRenderedReducer=n;var r=wt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,d=i;do{var f=d.lane;if((oi&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=m,o=r):u=u.next=m,rt.lanes|=f,ai|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=a,Un(r,e.memoizedState)||(tn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,rt.lanes|=i,ai|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function xh(n){var e=Nn(),t=e.queue;if(t===null)throw Error(H(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Un(i,e.memoizedState)||(tn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function rx(){}function sx(n,e){var t=rt,r=Nn(),s=e(),i=!Un(r.memoizedState,s);if(i&&(r.memoizedState=s,tn=!0),r=r.queue,Wp(ax.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||bt!==null&&bt.memoizedState.tag&1){if(t.flags|=2048,hl(9,ox.bind(null,t,r,s,e),void 0,null),kt===null)throw Error(H(349));oi&30||ix(t,e,s)}return s}function ix(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function ox(n,e,t,r){e.value=t,e.getSnapshot=r,lx(e)&&cx(n)}function ax(n,e,t){return t(function(){lx(e)&&cx(n)})}function lx(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Un(n,t)}catch{return!0}}function cx(n){var e=Ir(n,1);e!==null&&Fn(e,n,1,-1)}function by(n){var e=Hn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dl,lastRenderedState:n},e.queue=n,n=n.dispatch=SS.bind(null,rt,n),[e.memoizedState,n]}function hl(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function ux(){return Nn().memoizedState}function qc(n,e,t,r){var s=Hn();rt.flags|=n,s.memoizedState=hl(1|e,t,void 0,r===void 0?null:r)}function ad(n,e,t,r){var s=Nn();r=r===void 0?null:r;var i=void 0;if(wt!==null){var o=wt.memoizedState;if(i=o.destroy,r!==null&&Gp(r,o.deps)){s.memoizedState=hl(e,t,i,r);return}}rt.flags|=n,s.memoizedState=hl(1|e,t,i,r)}function Ny(n,e){return qc(8390656,8,n,e)}function Wp(n,e){return ad(2048,8,n,e)}function dx(n,e){return ad(4,2,n,e)}function hx(n,e){return ad(4,4,n,e)}function fx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function px(n,e,t){return t=t!=null?t.concat([n]):null,ad(4,4,fx.bind(null,e,n),t)}function Qp(){}function mx(n,e){var t=Nn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function gx(n,e){var t=Nn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function yx(n,e,t){return oi&21?(Un(t,e)||(t=I_(),rt.lanes|=t,ai|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,tn=!0),n.memoizedState=t)}function ES(n,e){var t=Oe;Oe=t!==0&&4>t?t:4,n(!0);var r=vh.transition;vh.transition={};try{n(!1),e()}finally{Oe=t,vh.transition=r}}function vx(){return Nn().memoizedState}function TS(n,e,t){var r=ls(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},_x(n))xx(e,t);else if(t=ex(n,e,t,r),t!==null){var s=Kt();Fn(t,n,r,s),wx(t,e,r)}}function SS(n,e,t){var r=ls(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(_x(n))xx(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Un(a,o)){var u=e.interleaved;u===null?(s.next=s,Up(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}t=ex(n,e,s,r),t!==null&&(s=Kt(),Fn(t,n,r,s),wx(t,e,r))}}function _x(n){var e=n.alternate;return n===rt||e!==null&&e===rt}function xx(n,e){Fa=Su=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function wx(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,bp(n,t)}}var bu={readContext:bn,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useInsertionEffect:Ot,useLayoutEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useMutableSource:Ot,useSyncExternalStore:Ot,useId:Ot,unstable_isNewReconciler:!1},bS={readContext:bn,useCallback:function(n,e){return Hn().memoizedState=[n,e===void 0?null:e],n},useContext:bn,useEffect:Ny,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,qc(4194308,4,fx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return qc(4194308,4,n,e)},useInsertionEffect:function(n,e){return qc(4,2,n,e)},useMemo:function(n,e){var t=Hn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Hn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=TS.bind(null,rt,n),[r.memoizedState,n]},useRef:function(n){var e=Hn();return n={current:n},e.memoizedState=n},useState:by,useDebugValue:Qp,useDeferredValue:function(n){return Hn().memoizedState=n},useTransition:function(){var n=by(!1),e=n[0];return n=ES.bind(null,n[1]),Hn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=rt,s=Hn();if(Ye){if(t===void 0)throw Error(H(407));t=t()}else{if(t=e(),kt===null)throw Error(H(349));oi&30||ix(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Ny(ax.bind(null,r,i,n),[n]),r.flags|=2048,hl(9,ox.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=Hn(),e=kt.identifierPrefix;if(Ye){var t=dr,r=ur;t=(r&~(1<<32-Ln(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=ul++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=IS++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},NS={readContext:bn,useCallback:mx,useContext:bn,useEffect:Wp,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:hx,useMemo:gx,useReducer:_h,useRef:ux,useState:function(){return _h(dl)},useDebugValue:Qp,useDeferredValue:function(n){var e=Nn();return yx(e,wt.memoizedState,n)},useTransition:function(){var n=_h(dl)[0],e=Nn().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:sx,useId:vx,unstable_isNewReconciler:!1},kS={readContext:bn,useCallback:mx,useContext:bn,useEffect:Wp,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:hx,useMemo:gx,useReducer:xh,useRef:ux,useState:function(){return xh(dl)},useDebugValue:Qp,useDeferredValue:function(n){var e=Nn();return wt===null?e.memoizedState=n:yx(e,wt.memoizedState,n)},useTransition:function(){var n=xh(dl)[0],e=Nn().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:sx,useId:vx,unstable_isNewReconciler:!1};function jn(n,e){if(n&&n.defaultProps){e=it({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function vf(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:it({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var ld={isMounted:function(n){return(n=n._reactInternals)?xi(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=ls(n),i=vr(r,s);i.payload=e,t!=null&&(i.callback=t),e=os(n,i,s),e!==null&&(Fn(e,n,s,r),Bc(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=ls(n),i=vr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=os(n,i,s),e!==null&&(Fn(e,n,s,r),Bc(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Kt(),r=ls(n),s=vr(t,r);s.tag=2,e!=null&&(s.callback=e),e=os(n,s,r),e!==null&&(Fn(e,n,r,t),Bc(e,n,r))}};function ky(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!sl(t,r)||!sl(s,i):!0}function Ix(n,e,t){var r=!1,s=vs,i=e.contextType;return typeof i=="object"&&i!==null?i=bn(i):(s=on(e)?si:$t.current,r=e.contextTypes,i=(r=r!=null)?xo(n,s):vs),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ld,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function Cy(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&ld.enqueueReplaceState(e,e.state,null)}function _f(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},zp(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=bn(i):(i=on(e)?si:$t.current,s.context=xo(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vf(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ld.enqueueReplaceState(s,s.state,null),Eu(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function To(n,e){try{var t="",r=e;do t+=n1(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function wh(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function xf(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var CS=typeof WeakMap=="function"?WeakMap:Map;function Ex(n,e,t){t=vr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){ku||(ku=!0,Af=r),xf(n,e)},t}function Tx(n,e,t){t=vr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){xf(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){xf(n,e),typeof r!="function"&&(as===null?as=new Set([this]):as.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function Ay(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new CS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=$S.bind(null,n,e,t),e.then(n,n))}function Ry(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Py(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=vr(-1,1),e.tag=2,os(t,e,1))),t.lanes|=1),n)}var AS=kr.ReactCurrentOwner,tn=!1;function Gt(n,e,t,r){e.child=n===null?Z_(e,null,t,r):Io(e,n.child,t,r)}function Dy(n,e,t,r,s){t=t.render;var i=e.ref;return ho(e,s),r=Kp(n,e,t,r,i,s),t=Hp(),n!==null&&!tn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Er(n,e,s)):(Ye&&t&&jp(e),e.flags|=1,Gt(n,e,r,s),e.child)}function jy(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!rm(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Sx(n,e,i,r,s)):(n=Wc(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:sl,t(o,r)&&n.ref===e.ref)return Er(n,e,s)}return e.flags|=1,n=cs(i,r),n.ref=e.ref,n.return=e,e.child=n}function Sx(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(sl(i,r)&&n.ref===e.ref)if(tn=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(tn=!0);else return e.lanes=n.lanes,Er(n,e,s)}return wf(n,e,t,r,s)}function bx(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(so,un),un|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,qe(so,un),un|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,qe(so,un),un|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,qe(so,un),un|=r;return Gt(n,e,s,t),e.child}function Nx(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function wf(n,e,t,r,s){var i=on(t)?si:$t.current;return i=xo(e,i),ho(e,s),t=Kp(n,e,t,r,i,s),r=Hp(),n!==null&&!tn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Er(n,e,s)):(Ye&&r&&jp(e),e.flags|=1,Gt(n,e,t,s),e.child)}function Vy(n,e,t,r,s){if(on(t)){var i=!0;vu(e)}else i=!1;if(ho(e,s),e.stateNode===null)Gc(n,e),Ix(e,t,r),_f(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=on(t)?si:$t.current,d=xo(e,d));var f=t.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==d)&&Cy(e,o,r,d),qr=!1;var y=e.memoizedState;o.state=y,Eu(e,r,o,s),u=e.memoizedState,a!==r||y!==u||sn.current||qr?(typeof f=="function"&&(vf(e,t,f,r),u=e.memoizedState),(a=qr||ky(e,t,a,r,y,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tx(n,e),a=e.memoizedProps,d=e.type===e.elementType?a:jn(e.type,a),o.props=d,m=e.pendingProps,y=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=bn(u):(u=on(t)?si:$t.current,u=xo(e,u));var x=t.getDerivedStateFromProps;(f=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||y!==u)&&Cy(e,o,r,u),qr=!1,y=e.memoizedState,o.state=y,Eu(e,r,o,s);var A=e.memoizedState;a!==m||y!==A||sn.current||qr?(typeof x=="function"&&(vf(e,t,x,r),A=e.memoizedState),(d=qr||ky(e,t,d,r,y,A,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),r=!1)}return If(n,e,t,r,i,s)}function If(n,e,t,r,s,i){Nx(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&xy(e,t,!1),Er(n,e,i);r=e.stateNode,AS.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Io(e,n.child,null,i),e.child=Io(e,null,a,i)):Gt(n,e,a,i),e.memoizedState=r.state,s&&xy(e,t,!0),e.child}function kx(n){var e=n.stateNode;e.pendingContext?_y(n,e.pendingContext,e.pendingContext!==e.context):e.context&&_y(n,e.context,!1),Bp(n,e.containerInfo)}function My(n,e,t,r,s){return wo(),Mp(s),e.flags|=256,Gt(n,e,t,r),e.child}var Ef={dehydrated:null,treeContext:null,retryLane:0};function Tf(n){return{baseLanes:n,cachePool:null,transitions:null}}function Cx(n,e,t){var r=e.pendingProps,s=tt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),qe(tt,s&1),n===null)return gf(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=dd(o,r,0,null),n=ti(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Tf(t),e.memoizedState=Ef,n):Yp(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return RS(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=cs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=cs(a,i):(i=ti(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Tf(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Ef,r}return i=n.child,n=i.sibling,r=cs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Yp(n,e){return e=dd({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Sc(n,e,t,r){return r!==null&&Mp(r),Io(e,n.child,null,t),n=Yp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function RS(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=wh(Error(H(422))),Sc(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=dd({mode:"visible",children:r.children},s,0,null),i=ti(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Io(e,n.child,null,o),e.child.memoizedState=Tf(o),e.memoizedState=Ef,i);if(!(e.mode&1))return Sc(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(H(419)),r=wh(i,r,void 0),Sc(n,e,o,r)}if(a=(o&n.childLanes)!==0,tn||a){if(r=kt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ir(n,s),Fn(r,n,s,-1))}return nm(),r=wh(Error(H(421))),Sc(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=qS.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,dn=is(s.nextSibling),fn=e,Ye=!0,Mn=null,n!==null&&(In[En++]=ur,In[En++]=dr,In[En++]=ii,ur=n.id,dr=n.overflow,ii=e),e=Yp(e,r.children),e.flags|=4096,e)}function Oy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),yf(n.return,e,t)}function Ih(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function Ax(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Gt(n,e,r.children,t),r=tt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Oy(n,t,e);else if(n.tag===19)Oy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(qe(tt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Tu(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Ih(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Tu(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Ih(e,!0,t,null,i);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Er(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ai|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(H(153));if(e.child!==null){for(n=e.child,t=cs(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=cs(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function PS(n,e,t){switch(e.tag){case 3:kx(e),wo();break;case 5:nx(e);break;case 1:on(e.type)&&vu(e);break;case 4:Bp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;qe(wu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qe(tt,tt.current&1),e.flags|=128,null):t&e.child.childLanes?Cx(n,e,t):(qe(tt,tt.current&1),n=Er(n,e,t),n!==null?n.sibling:null);qe(tt,tt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Ax(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),qe(tt,tt.current),r)break;return null;case 22:case 23:return e.lanes=0,bx(n,e,t)}return Er(n,e,t)}var Rx,Sf,Px,Dx;Rx=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Sf=function(){};Px=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Zs(Xn.current);var i=null;switch(t){case"input":s=Kh(n,s),r=Kh(n,r),i=[];break;case"select":s=it({},s,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":s=Qh(n,s),r=Qh(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=gu)}Jh(t,r);var o;t=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ja.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(i||(i=[]),i.push(d,t)),t=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ja.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&He("scroll",n),i||a===u||(i=[])):(i=i||[]).push(d,u))}t&&(i=i||[]).push("style",t);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Dx=function(n,e,t,r){t!==r&&(e.flags|=4)};function va(n,e){if(!Ye)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Lt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function DS(n,e,t){var r=e.pendingProps;switch(Vp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(e),null;case 1:return on(e.type)&&yu(),Lt(e),null;case 3:return r=e.stateNode,Eo(),We(sn),We($t),qp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Ec(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(Df(Mn),Mn=null))),Sf(n,e),Lt(e),null;case 5:$p(e);var s=Zs(cl.current);if(t=e.type,n!==null&&e.stateNode!=null)Px(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Lt(e),null}if(n=Zs(Xn.current),Ec(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Wn]=e,r[al]=i,n=(e.mode&1)!==0,t){case"dialog":He("cancel",r),He("close",r);break;case"iframe":case"object":case"embed":He("load",r);break;case"video":case"audio":for(s=0;s<ka.length;s++)He(ka[s],r);break;case"source":He("error",r);break;case"img":case"image":case"link":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"input":Kg(r,i),He("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},He("invalid",r);break;case"textarea":Wg(r,i),He("invalid",r)}Jh(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Ic(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Ic(r.textContent,a,n),s=["children",""+a]):Ja.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&He("scroll",r)}switch(t){case"input":pc(r),Hg(r,i,!0);break;case"textarea":pc(r),Qg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=gu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=a_(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Wn]=e,n[al]=r,Rx(n,e,!1,!1),e.stateNode=n;e:{switch(o=Xh(t,r),t){case"dialog":He("cancel",n),He("close",n),s=r;break;case"iframe":case"object":case"embed":He("load",n),s=r;break;case"video":case"audio":for(s=0;s<ka.length;s++)He(ka[s],n);s=r;break;case"source":He("error",n),s=r;break;case"img":case"image":case"link":He("error",n),He("load",n),s=r;break;case"details":He("toggle",n),s=r;break;case"input":Kg(n,r),s=Kh(n,r),He("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=it({},r,{value:void 0}),He("invalid",n);break;case"textarea":Wg(n,r),s=Qh(n,r),He("invalid",n);break;default:s=r}Jh(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?u_(n,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&l_(n,u)):i==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&Xa(n,u):typeof u=="number"&&Xa(n,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ja.hasOwnProperty(i)?u!=null&&i==="onScroll"&&He("scroll",n):u!=null&&xp(n,i,u,o))}switch(t){case"input":pc(n),Hg(n,r,!1);break;case"textarea":pc(n),Qg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+ys(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?ao(n,!!r.multiple,i,!1):r.defaultValue!=null&&ao(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=gu)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Lt(e),null;case 6:if(n&&e.stateNode!=null)Dx(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(t=Zs(cl.current),Zs(Xn.current),Ec(e)){if(r=e.stateNode,t=e.memoizedProps,r[Wn]=e,(i=r.nodeValue!==t)&&(n=fn,n!==null))switch(n.tag){case 3:Ic(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ic(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Wn]=e,e.stateNode=r}return Lt(e),null;case 13:if(We(tt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ye&&dn!==null&&e.mode&1&&!(e.flags&128))J_(),wo(),e.flags|=98560,i=!1;else if(i=Ec(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Wn]=e}else wo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Lt(e),i=!1}else Mn!==null&&(Df(Mn),Mn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||tt.current&1?It===0&&(It=3):nm())),e.updateQueue!==null&&(e.flags|=4),Lt(e),null);case 4:return Eo(),Sf(n,e),n===null&&il(e.stateNode.containerInfo),Lt(e),null;case 10:return Fp(e.type._context),Lt(e),null;case 17:return on(e.type)&&yu(),Lt(e),null;case 19:if(We(tt),i=e.memoizedState,i===null)return Lt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)va(i,!1);else{if(It!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Tu(n),o!==null){for(e.flags|=128,va(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return qe(tt,tt.current&1|2),e.child}n=n.sibling}i.tail!==null&&ht()>So&&(e.flags|=128,r=!0,va(i,!1),e.lanes=4194304)}else{if(!r)if(n=Tu(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),va(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ye)return Lt(e),null}else 2*ht()-i.renderingStartTime>So&&t!==1073741824&&(e.flags|=128,r=!0,va(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ht(),e.sibling=null,t=tt.current,qe(tt,r?t&1|2:t&1),e):(Lt(e),null);case 22:case 23:return tm(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(Lt(e),e.subtreeFlags&6&&(e.flags|=8192)):Lt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function jS(n,e){switch(Vp(e),e.tag){case 1:return on(e.type)&&yu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Eo(),We(sn),We($t),qp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return $p(e),null;case 13:if(We(tt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(H(340));wo()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return We(tt),null;case 4:return Eo(),null;case 10:return Fp(e.type._context),null;case 22:case 23:return tm(),null;case 24:return null;default:return null}}var bc=!1,zt=!1,VS=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ro(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ut(n,e,r)}else t.current=null}function bf(n,e,t){try{t()}catch(r){ut(n,e,r)}}var Ly=!1;function MS(n,e){if(cf=fu,n=L_(),Dp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,d=0,f=0,m=n,y=null;t:for(;;){for(var x;m!==t||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)y=m,m=x;for(;;){if(m===n)break t;if(y===t&&++d===s&&(a=o),y===i&&++f===r&&(u=o),(x=m.nextSibling)!==null)break;m=y,y=m.parentNode}m=x}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(uf={focusedElem:n,selectionRange:t},fu=!1,ne=e;ne!==null;)if(e=ne,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ne=n;else for(;ne!==null;){e=ne;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var R=A.memoizedProps,k=A.memoizedState,S=e.stateNode,v=S.getSnapshotBeforeUpdate(e.elementType===e.type?R:jn(e.type,R),k);S.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(I){ut(e,e.return,I)}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}return A=Ly,Ly=!1,A}function Ua(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&bf(e,t,i)}s=s.next}while(s!==r)}}function cd(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Nf(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function jx(n){var e=n.alternate;e!==null&&(n.alternate=null,jx(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Wn],delete e[al],delete e[ff],delete e[vS],delete e[_S])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Vx(n){return n.tag===5||n.tag===3||n.tag===4}function Fy(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Vx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function kf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=gu));else if(r!==4&&(n=n.child,n!==null))for(kf(n,e,t),n=n.sibling;n!==null;)kf(n,e,t),n=n.sibling}function Cf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Cf(n,e,t),n=n.sibling;n!==null;)Cf(n,e,t),n=n.sibling}var Rt=null,Vn=!1;function Lr(n,e,t){for(t=t.child;t!==null;)Mx(n,e,t),t=t.sibling}function Mx(n,e,t){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(td,t)}catch{}switch(t.tag){case 5:zt||ro(t,e);case 6:var r=Rt,s=Vn;Rt=null,Lr(n,e,t),Rt=r,Vn=s,Rt!==null&&(Vn?(n=Rt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Rt.removeChild(t.stateNode));break;case 18:Rt!==null&&(Vn?(n=Rt,t=t.stateNode,n.nodeType===8?mh(n.parentNode,t):n.nodeType===1&&mh(n,t),nl(n)):mh(Rt,t.stateNode));break;case 4:r=Rt,s=Vn,Rt=t.stateNode.containerInfo,Vn=!0,Lr(n,e,t),Rt=r,Vn=s;break;case 0:case 11:case 14:case 15:if(!zt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&bf(t,e,o),s=s.next}while(s!==r)}Lr(n,e,t);break;case 1:if(!zt&&(ro(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){ut(t,e,a)}Lr(n,e,t);break;case 21:Lr(n,e,t);break;case 22:t.mode&1?(zt=(r=zt)||t.memoizedState!==null,Lr(n,e,t),zt=r):Lr(n,e,t);break;default:Lr(n,e,t)}}function Uy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new VS),e.forEach(function(r){var s=GS.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Pn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Rt=a.stateNode,Vn=!1;break e;case 3:Rt=a.stateNode.containerInfo,Vn=!0;break e;case 4:Rt=a.stateNode.containerInfo,Vn=!0;break e}a=a.return}if(Rt===null)throw Error(H(160));Mx(i,o,s),Rt=null,Vn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){ut(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ox(e,n),e=e.sibling}function Ox(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Pn(e,n),Kn(n),r&4){try{Ua(3,n,n.return),cd(3,n)}catch(R){ut(n,n.return,R)}try{Ua(5,n,n.return)}catch(R){ut(n,n.return,R)}}break;case 1:Pn(e,n),Kn(n),r&512&&t!==null&&ro(t,t.return);break;case 5:if(Pn(e,n),Kn(n),r&512&&t!==null&&ro(t,t.return),n.flags&32){var s=n.stateNode;try{Xa(s,"")}catch(R){ut(n,n.return,R)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&i_(s,i),Xh(a,o);var d=Xh(a,i);for(o=0;o<u.length;o+=2){var f=u[o],m=u[o+1];f==="style"?u_(s,m):f==="dangerouslySetInnerHTML"?l_(s,m):f==="children"?Xa(s,m):xp(s,f,m,d)}switch(a){case"input":Hh(s,i);break;case"textarea":o_(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?ao(s,!!i.multiple,x,!1):y!==!!i.multiple&&(i.defaultValue!=null?ao(s,!!i.multiple,i.defaultValue,!0):ao(s,!!i.multiple,i.multiple?[]:"",!1))}s[al]=i}catch(R){ut(n,n.return,R)}}break;case 6:if(Pn(e,n),Kn(n),r&4){if(n.stateNode===null)throw Error(H(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(R){ut(n,n.return,R)}}break;case 3:if(Pn(e,n),Kn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{nl(e.containerInfo)}catch(R){ut(n,n.return,R)}break;case 4:Pn(e,n),Kn(n);break;case 13:Pn(e,n),Kn(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zp=ht())),r&4&&Uy(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(zt=(d=zt)||f,Pn(e,n),zt=d):Pn(e,n),Kn(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!f&&n.mode&1)for(ne=n,f=n.child;f!==null;){for(m=ne=f;ne!==null;){switch(y=ne,x=y.child,y.tag){case 0:case 11:case 14:case 15:Ua(4,y,y.return);break;case 1:ro(y,y.return);var A=y.stateNode;if(typeof A.componentWillUnmount=="function"){r=y,t=y.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(R){ut(r,t,R)}}break;case 5:ro(y,y.return);break;case 22:if(y.memoizedState!==null){By(m);continue}}x!==null?(x.return=y,ne=x):By(m)}f=f.sibling}e:for(f=null,m=n;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=c_("display",o))}catch(R){ut(n,n.return,R)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(R){ut(n,n.return,R)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Pn(e,n),Kn(n),r&4&&Uy(n);break;case 21:break;default:Pn(e,n),Kn(n)}}function Kn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Vx(t)){var r=t;break e}t=t.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xa(s,""),r.flags&=-33);var i=Fy(n);Cf(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Fy(n);kf(n,a,o);break;default:throw Error(H(161))}}catch(u){ut(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function OS(n,e,t){ne=n,Lx(n)}function Lx(n,e,t){for(var r=(n.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||bc;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||zt;a=bc;var d=zt;if(bc=o,(zt=u)&&!d)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?$y(s):u!==null?(u.return=o,ne=u):$y(s);for(;i!==null;)ne=i,Lx(i),i=i.sibling;ne=s,bc=a,zt=d}zy(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):zy(n)}}function zy(n){for(;ne!==null;){var e=ne;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:zt||cd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!zt)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:jn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Sy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Sy(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&nl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}zt||e.flags&512&&Nf(e)}catch(y){ut(e,e.return,y)}}if(e===n){ne=null;break}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}}function By(n){for(;ne!==null;){var e=ne;if(e===n){ne=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ne=t;break}ne=e.return}}function $y(n){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{cd(4,e)}catch(u){ut(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){ut(e,s,u)}}var i=e.return;try{Nf(e)}catch(u){ut(e,i,u)}break;case 5:var o=e.return;try{Nf(e)}catch(u){ut(e,o,u)}}}catch(u){ut(e,e.return,u)}if(e===n){ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ne=a;break}ne=e.return}}var LS=Math.ceil,Nu=kr.ReactCurrentDispatcher,Jp=kr.ReactCurrentOwner,Sn=kr.ReactCurrentBatchConfig,Re=0,kt=null,vt=null,Dt=0,un=0,so=Ss(0),It=0,fl=null,ai=0,ud=0,Xp=0,za=null,en=null,Zp=0,So=1/0,lr=null,ku=!1,Af=null,as=null,Nc=!1,Zr=null,Cu=0,Ba=0,Rf=null,Kc=-1,Hc=0;function Kt(){return Re&6?ht():Kc!==-1?Kc:Kc=ht()}function ls(n){return n.mode&1?Re&2&&Dt!==0?Dt&-Dt:wS.transition!==null?(Hc===0&&(Hc=I_()),Hc):(n=Oe,n!==0||(n=window.event,n=n===void 0?16:C_(n.type)),n):1}function Fn(n,e,t,r){if(50<Ba)throw Ba=0,Rf=null,Error(H(185));Cl(n,t,r),(!(Re&2)||n!==kt)&&(n===kt&&(!(Re&2)&&(ud|=t),It===4&&Kr(n,Dt)),an(n,r),t===1&&Re===0&&!(e.mode&1)&&(So=ht()+500,od&&bs()))}function an(n,e){var t=n.callbackNode;w1(n,e);var r=hu(n,n===kt?Dt:0);if(r===0)t!==null&&Xg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Xg(t),e===1)n.tag===0?xS(qy.bind(null,n)):W_(qy.bind(null,n)),gS(function(){!(Re&6)&&bs()}),t=null;else{switch(E_(r)){case 1:t=Sp;break;case 4:t=x_;break;case 16:t=du;break;case 536870912:t=w_;break;default:t=du}t=Kx(t,Fx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Fx(n,e){if(Kc=-1,Hc=0,Re&6)throw Error(H(327));var t=n.callbackNode;if(fo()&&n.callbackNode!==t)return null;var r=hu(n,n===kt?Dt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Au(n,r);else{e=r;var s=Re;Re|=2;var i=zx();(kt!==n||Dt!==e)&&(lr=null,So=ht()+500,ei(n,e));do try{zS();break}catch(a){Ux(n,a)}while(!0);Lp(),Nu.current=i,Re=s,vt!==null?e=0:(kt=null,Dt=0,e=It)}if(e!==0){if(e===2&&(s=rf(n),s!==0&&(r=s,e=Pf(n,s))),e===1)throw t=fl,ei(n,0),Kr(n,r),an(n,ht()),t;if(e===6)Kr(n,r);else{if(s=n.current.alternate,!(r&30)&&!FS(s)&&(e=Au(n,r),e===2&&(i=rf(n),i!==0&&(r=i,e=Pf(n,i))),e===1))throw t=fl,ei(n,0),Kr(n,r),an(n,ht()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:qs(n,en,lr);break;case 3:if(Kr(n,r),(r&130023424)===r&&(e=Zp+500-ht(),10<e)){if(hu(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Kt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=hf(qs.bind(null,n,en,lr),e);break}qs(n,en,lr);break;case 4:if(Kr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Ln(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*LS(r/1960))-r,10<r){n.timeoutHandle=hf(qs.bind(null,n,en,lr),r);break}qs(n,en,lr);break;case 5:qs(n,en,lr);break;default:throw Error(H(329))}}}return an(n,ht()),n.callbackNode===t?Fx.bind(null,n):null}function Pf(n,e){var t=za;return n.current.memoizedState.isDehydrated&&(ei(n,e).flags|=256),n=Au(n,e),n!==2&&(e=en,en=t,e!==null&&Df(e)),n}function Df(n){en===null?en=n:en.push.apply(en,n)}function FS(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Un(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Kr(n,e){for(e&=~Xp,e&=~ud,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ln(e),r=1<<t;n[t]=-1,e&=~r}}function qy(n){if(Re&6)throw Error(H(327));fo();var e=hu(n,0);if(!(e&1))return an(n,ht()),null;var t=Au(n,e);if(n.tag!==0&&t===2){var r=rf(n);r!==0&&(e=r,t=Pf(n,r))}if(t===1)throw t=fl,ei(n,0),Kr(n,e),an(n,ht()),t;if(t===6)throw Error(H(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,qs(n,en,lr),an(n,ht()),null}function em(n,e){var t=Re;Re|=1;try{return n(e)}finally{Re=t,Re===0&&(So=ht()+500,od&&bs())}}function li(n){Zr!==null&&Zr.tag===0&&!(Re&6)&&fo();var e=Re;Re|=1;var t=Sn.transition,r=Oe;try{if(Sn.transition=null,Oe=1,n)return n()}finally{Oe=r,Sn.transition=t,Re=e,!(Re&6)&&bs()}}function tm(){un=so.current,We(so)}function ei(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,mS(t)),vt!==null)for(t=vt.return;t!==null;){var r=t;switch(Vp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&yu();break;case 3:Eo(),We(sn),We($t),qp();break;case 5:$p(r);break;case 4:Eo();break;case 13:We(tt);break;case 19:We(tt);break;case 10:Fp(r.type._context);break;case 22:case 23:tm()}t=t.return}if(kt=n,vt=n=cs(n.current,null),Dt=un=e,It=0,fl=null,Xp=ud=ai=0,en=za=null,Xs!==null){for(e=0;e<Xs.length;e++)if(t=Xs[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}Xs=null}return n}function Ux(n,e){do{var t=vt;try{if(Lp(),$c.current=bu,Su){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Su=!1}if(oi=0,bt=wt=rt=null,Fa=!1,ul=0,Jp.current=null,t===null||t.return===null){It=1,fl=e,vt=null;break}e:{var i=n,o=t.return,a=t,u=e;if(e=Dt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=Ry(o);if(x!==null){x.flags&=-257,Py(x,o,a,i,e),x.mode&1&&Ay(i,d,e),e=x,u=d;var A=e.updateQueue;if(A===null){var R=new Set;R.add(u),e.updateQueue=R}else A.add(u);break e}else{if(!(e&1)){Ay(i,d,e),nm();break e}u=Error(H(426))}}else if(Ye&&a.mode&1){var k=Ry(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Py(k,o,a,i,e),Mp(To(u,a));break e}}i=u=To(u,a),It!==4&&(It=2),za===null?za=[i]:za.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=Ex(i,u,e);Ty(i,S);break e;case 1:a=u;var v=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(as===null||!as.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=Tx(i,a,e);Ty(i,I);break e}}i=i.return}while(i!==null)}$x(t)}catch(D){e=D,vt===t&&t!==null&&(vt=t=t.return);continue}break}while(!0)}function zx(){var n=Nu.current;return Nu.current=bu,n===null?bu:n}function nm(){(It===0||It===3||It===2)&&(It=4),kt===null||!(ai&268435455)&&!(ud&268435455)||Kr(kt,Dt)}function Au(n,e){var t=Re;Re|=2;var r=zx();(kt!==n||Dt!==e)&&(lr=null,ei(n,e));do try{US();break}catch(s){Ux(n,s)}while(!0);if(Lp(),Re=t,Nu.current=r,vt!==null)throw Error(H(261));return kt=null,Dt=0,It}function US(){for(;vt!==null;)Bx(vt)}function zS(){for(;vt!==null&&!h1();)Bx(vt)}function Bx(n){var e=Gx(n.alternate,n,un);n.memoizedProps=n.pendingProps,e===null?$x(n):vt=e,Jp.current=null}function $x(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=jS(t,e),t!==null){t.flags&=32767,vt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{It=6,vt=null;return}}else if(t=DS(t,e,un),t!==null){vt=t;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=n}while(e!==null);It===0&&(It=5)}function qs(n,e,t){var r=Oe,s=Sn.transition;try{Sn.transition=null,Oe=1,BS(n,e,t,r)}finally{Sn.transition=s,Oe=r}return null}function BS(n,e,t,r){do fo();while(Zr!==null);if(Re&6)throw Error(H(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(H(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(I1(n,i),n===kt&&(vt=kt=null,Dt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Nc||(Nc=!0,Kx(du,function(){return fo(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Sn.transition,Sn.transition=null;var o=Oe;Oe=1;var a=Re;Re|=4,Jp.current=null,MS(n,t),Ox(t,n),lS(uf),fu=!!cf,uf=cf=null,n.current=t,OS(t),f1(),Re=a,Oe=o,Sn.transition=i}else n.current=t;if(Nc&&(Nc=!1,Zr=n,Cu=s),i=n.pendingLanes,i===0&&(as=null),g1(t.stateNode),an(n,ht()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(ku)throw ku=!1,n=Af,Af=null,n;return Cu&1&&n.tag!==0&&fo(),i=n.pendingLanes,i&1?n===Rf?Ba++:(Ba=0,Rf=n):Ba=0,bs(),null}function fo(){if(Zr!==null){var n=E_(Cu),e=Sn.transition,t=Oe;try{if(Sn.transition=null,Oe=16>n?16:n,Zr===null)var r=!1;else{if(n=Zr,Zr=null,Cu=0,Re&6)throw Error(H(331));var s=Re;for(Re|=4,ne=n.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(ne=d;ne!==null;){var f=ne;switch(f.tag){case 0:case 11:case 15:Ua(8,f,i)}var m=f.child;if(m!==null)m.return=f,ne=m;else for(;ne!==null;){f=ne;var y=f.sibling,x=f.return;if(jx(f),f===d){ne=null;break}if(y!==null){y.return=x,ne=y;break}ne=x}}}var A=i.alternate;if(A!==null){var R=A.child;if(R!==null){A.child=null;do{var k=R.sibling;R.sibling=null,R=k}while(R!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ua(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,ne=S;break e}ne=i.return}}var v=n.current;for(ne=v;ne!==null;){o=ne;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ne=T;else e:for(o=v;ne!==null;){if(a=ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:cd(9,a)}}catch(D){ut(a,a.return,D)}if(a===o){ne=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,ne=I;break e}ne=a.return}}if(Re=s,bs(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(td,n)}catch{}r=!0}return r}finally{Oe=t,Sn.transition=e}}return!1}function Gy(n,e,t){e=To(t,e),e=Ex(n,e,1),n=os(n,e,1),e=Kt(),n!==null&&(Cl(n,1,e),an(n,e))}function ut(n,e,t){if(n.tag===3)Gy(n,n,t);else for(;e!==null;){if(e.tag===3){Gy(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(as===null||!as.has(r))){n=To(t,n),n=Tx(e,n,1),e=os(e,n,1),n=Kt(),e!==null&&(Cl(e,1,n),an(e,n));break}}e=e.return}}function $S(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Kt(),n.pingedLanes|=n.suspendedLanes&t,kt===n&&(Dt&t)===t&&(It===4||It===3&&(Dt&130023424)===Dt&&500>ht()-Zp?ei(n,0):Xp|=t),an(n,e)}function qx(n,e){e===0&&(n.mode&1?(e=yc,yc<<=1,!(yc&130023424)&&(yc=4194304)):e=1);var t=Kt();n=Ir(n,e),n!==null&&(Cl(n,e,t),an(n,t))}function qS(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),qx(n,t)}function GS(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),qx(n,t)}var Gx;Gx=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||sn.current)tn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return tn=!1,PS(n,e,t);tn=!!(n.flags&131072)}else tn=!1,Ye&&e.flags&1048576&&Q_(e,xu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gc(n,e),n=e.pendingProps;var s=xo(e,$t.current);ho(e,t),s=Kp(null,e,r,n,s,t);var i=Hp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(r)?(i=!0,vu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zp(e),s.updater=ld,e.stateNode=s,s._reactInternals=e,_f(e,r,n,t),e=If(null,e,r,!0,i,t)):(e.tag=0,Ye&&i&&jp(e),Gt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Gc(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=HS(r),n=jn(r,n),s){case 0:e=wf(null,e,r,n,t);break e;case 1:e=Vy(null,e,r,n,t);break e;case 11:e=Dy(null,e,r,n,t);break e;case 14:e=jy(null,e,r,jn(r.type,n),t);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),wf(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Vy(n,e,r,s,t);case 3:e:{if(kx(e),n===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,tx(n,e),Eu(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=To(Error(H(423)),e),e=My(n,e,r,t,s);break e}else if(r!==s){s=To(Error(H(424)),e),e=My(n,e,r,t,s);break e}else for(dn=is(e.stateNode.containerInfo.firstChild),fn=e,Ye=!0,Mn=null,t=Z_(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(wo(),r===s){e=Er(n,e,t);break e}Gt(n,e,r,t)}e=e.child}return e;case 5:return nx(e),n===null&&gf(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,df(r,s)?o=null:i!==null&&df(r,i)&&(e.flags|=32),Nx(n,e),Gt(n,e,o,t),e.child;case 6:return n===null&&gf(e),null;case 13:return Cx(n,e,t);case 4:return Bp(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Io(e,null,r,t):Gt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Dy(n,e,r,s,t);case 7:return Gt(n,e,e.pendingProps,t),e.child;case 8:return Gt(n,e,e.pendingProps.children,t),e.child;case 12:return Gt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,qe(wu,r._currentValue),r._currentValue=o,i!==null)if(Un(i.value,o)){if(i.children===s.children&&!sn.current){e=Er(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=vr(-1,t&-t),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=t,u=i.alternate,u!==null&&(u.lanes|=t),yf(i.return,t,e),a.lanes|=t;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),yf(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Gt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ho(e,t),s=bn(s),r=r(s),e.flags|=1,Gt(n,e,r,t),e.child;case 14:return r=e.type,s=jn(r,e.pendingProps),s=jn(r.type,s),jy(n,e,r,s,t);case 15:return Sx(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jn(r,s),Gc(n,e),e.tag=1,on(r)?(n=!0,vu(e)):n=!1,ho(e,t),Ix(e,r,s),_f(e,r,s,t),If(null,e,r,!0,n,t);case 19:return Ax(n,e,t);case 22:return bx(n,e,t)}throw Error(H(156,e.tag))};function Kx(n,e){return __(n,e)}function KS(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(n,e,t,r){return new KS(n,e,t,r)}function rm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function HS(n){if(typeof n=="function")return rm(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ip)return 11;if(n===Ep)return 14}return 2}function cs(n,e){var t=n.alternate;return t===null?(t=Tn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Wc(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")rm(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Wi:return ti(t.children,s,i,e);case wp:o=8,s|=8;break;case Bh:return n=Tn(12,t,e,s|2),n.elementType=Bh,n.lanes=i,n;case $h:return n=Tn(13,t,e,s),n.elementType=$h,n.lanes=i,n;case qh:return n=Tn(19,t,e,s),n.elementType=qh,n.lanes=i,n;case n_:return dd(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case e_:o=10;break e;case t_:o=9;break e;case Ip:o=11;break e;case Ep:o=14;break e;case $r:o=16,r=null;break e}throw Error(H(130,n==null?n:typeof n,""))}return e=Tn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ti(n,e,t,r){return n=Tn(7,n,r,e),n.lanes=t,n}function dd(n,e,t,r){return n=Tn(22,n,r,e),n.elementType=n_,n.lanes=t,n.stateNode={isHidden:!1},n}function Eh(n,e,t){return n=Tn(6,n,null,e),n.lanes=t,n}function Th(n,e,t){return e=Tn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function WS(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sh(0),this.expirationTimes=sh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sm(n,e,t,r,s,i,o,a,u){return n=new WS(n,e,t,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Tn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},zp(i),n}function QS(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Hx(n){if(!n)return vs;n=n._reactInternals;e:{if(xi(n)!==n||n.tag!==1)throw Error(H(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(n.tag===1){var t=n.type;if(on(t))return H_(n,t,e)}return e}function Wx(n,e,t,r,s,i,o,a,u){return n=sm(t,r,!0,n,s,i,o,a,u),n.context=Hx(null),t=n.current,r=Kt(),s=ls(t),i=vr(r,s),i.callback=e??null,os(t,i,s),n.current.lanes=s,Cl(n,s,r),an(n,r),n}function hd(n,e,t,r){var s=e.current,i=Kt(),o=ls(s);return t=Hx(t),e.context===null?e.context=t:e.pendingContext=t,e=vr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=os(s,e,o),n!==null&&(Fn(n,s,o,i),Bc(n,s,o)),o}function Ru(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Ky(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function im(n,e){Ky(n,e),(n=n.alternate)&&Ky(n,e)}function YS(){return null}var Qx=typeof reportError=="function"?reportError:function(n){console.error(n)};function om(n){this._internalRoot=n}fd.prototype.render=om.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(H(409));hd(n,e,null,null)};fd.prototype.unmount=om.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;li(function(){hd(null,n,null,null)}),e[wr]=null}};function fd(n){this._internalRoot=n}fd.prototype.unstable_scheduleHydration=function(n){if(n){var e=b_();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Gr.length&&e!==0&&e<Gr[t].priority;t++);Gr.splice(t,0,n),t===0&&k_(n)}};function am(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function pd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Hy(){}function JS(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Ru(o);i.call(d)}}var o=Wx(e,r,n,0,null,!1,!1,"",Hy);return n._reactRootContainer=o,n[wr]=o.current,il(n.nodeType===8?n.parentNode:n),li(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Ru(u);a.call(d)}}var u=sm(n,0,!1,null,null,!1,!1,"",Hy);return n._reactRootContainer=u,n[wr]=u.current,il(n.nodeType===8?n.parentNode:n),li(function(){hd(e,u,t,r)}),u}function md(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=Ru(o);a.call(u)}}hd(e,o,n,s)}else o=JS(t,e,n,s,r);return Ru(o)}T_=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Na(e.pendingLanes);t!==0&&(bp(e,t|1),an(e,ht()),!(Re&6)&&(So=ht()+500,bs()))}break;case 13:li(function(){var r=Ir(n,1);if(r!==null){var s=Kt();Fn(r,n,1,s)}}),im(n,1)}};Np=function(n){if(n.tag===13){var e=Ir(n,134217728);if(e!==null){var t=Kt();Fn(e,n,134217728,t)}im(n,134217728)}};S_=function(n){if(n.tag===13){var e=ls(n),t=Ir(n,e);if(t!==null){var r=Kt();Fn(t,n,e,r)}im(n,e)}};b_=function(){return Oe};N_=function(n,e){var t=Oe;try{return Oe=n,e()}finally{Oe=t}};ef=function(n,e,t){switch(e){case"input":if(Hh(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=id(r);if(!s)throw Error(H(90));s_(r),Hh(r,s)}}}break;case"textarea":o_(n,t);break;case"select":e=t.value,e!=null&&ao(n,!!t.multiple,e,!1)}};f_=em;p_=li;var XS={usingClientEntryPoint:!1,Events:[Rl,Xi,id,d_,h_,em]},_a={findFiberByHostInstance:Js,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZS={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=y_(n),n===null?null:n.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||YS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{td=kc.inject(ZS),Jn=kc}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XS;vn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!am(e))throw Error(H(200));return QS(n,e,null,t)};vn.createRoot=function(n,e){if(!am(n))throw Error(H(299));var t=!1,r="",s=Qx;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=sm(n,1,!1,null,null,t,!1,r,s),n[wr]=e.current,il(n.nodeType===8?n.parentNode:n),new om(e)};vn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(H(188)):(n=Object.keys(n).join(","),Error(H(268,n)));return n=y_(e),n=n===null?null:n.stateNode,n};vn.flushSync=function(n){return li(n)};vn.hydrate=function(n,e,t){if(!pd(e))throw Error(H(200));return md(null,n,e,!0,t)};vn.hydrateRoot=function(n,e,t){if(!am(n))throw Error(H(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=Qx;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Wx(e,null,n,1,t??null,s,!1,i,o),n[wr]=e.current,il(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new fd(e)};vn.render=function(n,e,t){if(!pd(e))throw Error(H(200));return md(null,n,e,!1,t)};vn.unmountComponentAtNode=function(n){if(!pd(n))throw Error(H(40));return n._reactRootContainer?(li(function(){md(null,null,n,!1,function(){n._reactRootContainer=null,n[wr]=null})}),!0):!1};vn.unstable_batchedUpdates=em;vn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!pd(t))throw Error(H(200));if(n==null||n._reactInternals===void 0)throw Error(H(38));return md(n,e,t,!1,r)};vn.version="18.3.1-next-f1338f8080-20240426";function Yx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yx)}catch(n){console.error(n)}}Yx(),Y0.exports=vn;var eb=Y0.exports,Jx,Wy=eb;Jx=Wy.createRoot,Wy.hydrateRoot;var Qy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},tb=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Zx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,d=u?n[s+2]:0,f=i>>2,m=(i&3)<<4|a>>4;let y=(a&15)<<2|d>>6,x=d&63;u||(x=64,o||(y=64)),r.push(t[f],t[m],t[y],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tb(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const d=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new nb;const y=i<<2|a>>4;if(r.push(y),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const A=d<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class nb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rb=function(n){const e=Xx(n);return Zx.encodeByteArray(e,!0)},ew=function(n){return rb(n).replace(/\./g,"")},tw=function(n){try{return Zx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=()=>sb().__FIREBASE_DEFAULTS__,ob=()=>{if(typeof process>"u"||typeof Qy>"u")return;const n=Qy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ab=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tw(n[1]);return e&&JSON.parse(e)},gd=()=>{try{return ib()||ob()||ab()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nw=n=>{var e,t;return(t=(e=gd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},lb=n=>{const e=nw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},rw=()=>{var n;return(n=gd())===null||n===void 0?void 0:n.config},sw=n=>{var e;return(e=gd())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ub(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Et())}function db(){var n;const e=(n=gd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fb(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mb(){const n=Et();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function iw(){return!db()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ow(){try{return typeof indexedDB=="object"}catch{return!1}}function gb(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="FirebaseError";class rr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=yb,Object.setPrototypeOf(this,rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dl.prototype.create)}}class Dl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?vb(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new rr(s,a,r)}}function vb(n,e){return n.replace(_b,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const _b=/\{\$([^}]+)}/g;function xb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function pl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Yy(i)&&Yy(o)){if(!pl(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Yy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function wb(n,e){const t=new Ib(n,e);return t.subscribe.bind(t)}class Ib{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Eb(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Sh),s.error===void 0&&(s.error=Sh),s.complete===void 0&&(s.complete=Sh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Eb(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Sh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(n){return n&&n._delegate?n._delegate:n}class _s{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new cb;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bb(e))try{this.getOrInitializeService({instanceIdentifier:Gs})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Gs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gs){return this.instances.has(e)}getOptions(e=Gs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Sb(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gs){return this.component?this.component.multipleInstances?e:Gs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Sb(n){return n===Gs?void 0:n}function bb(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Tb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ne||(Ne={}));const kb={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},Cb=Ne.INFO,Ab={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},Rb=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=Ab[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lm{constructor(e){this.name=e,this._logLevel=Cb,this._logHandler=Rb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const Pb=(n,e)=>e.some(t=>n instanceof t);let Jy,Xy;function Db(){return Jy||(Jy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jb(){return Xy||(Xy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aw=new WeakMap,jf=new WeakMap,lw=new WeakMap,bh=new WeakMap,cm=new WeakMap;function Vb(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(us(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&aw.set(t,n)}).catch(()=>{}),cm.set(e,n),e}function Mb(n){if(jf.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});jf.set(n,e)}let Vf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return us(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ob(n){Vf=n(Vf)}function Lb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Nh(this),e,...t);return lw.set(r,e.sort?e.sort():[e]),us(r)}:jb().includes(n)?function(...e){return n.apply(Nh(this),e),us(aw.get(this))}:function(...e){return us(n.apply(Nh(this),e))}}function Fb(n){return typeof n=="function"?Lb(n):(n instanceof IDBTransaction&&Mb(n),Pb(n,Db())?new Proxy(n,Vf):n)}function us(n){if(n instanceof IDBRequest)return Vb(n);if(bh.has(n))return bh.get(n);const e=Fb(n);return e!==n&&(bh.set(n,e),cm.set(e,n)),e}const Nh=n=>cm.get(n);function Ub(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=us(o);return r&&o.addEventListener("upgradeneeded",u=>{r(us(o.result),u.oldVersion,u.newVersion,us(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const zb=["get","getKey","getAll","getAllKeys","count"],Bb=["put","add","delete","clear"],kh=new Map;function Zy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(kh.get(e))return kh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Bb.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||zb.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[t](...a),s&&u.done]))[0]};return kh.set(e,i),i}Ob(n=>({...n,get:(e,t,r)=>Zy(e,t)||n.get(e,t,r),has:(e,t)=>!!Zy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qb(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function qb(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mf="@firebase/app",ev="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=new lm("@firebase/app"),Gb="@firebase/app-compat",Kb="@firebase/analytics-compat",Hb="@firebase/analytics",Wb="@firebase/app-check-compat",Qb="@firebase/app-check",Yb="@firebase/auth",Jb="@firebase/auth-compat",Xb="@firebase/database",Zb="@firebase/data-connect",eN="@firebase/database-compat",tN="@firebase/functions",nN="@firebase/functions-compat",rN="@firebase/installations",sN="@firebase/installations-compat",iN="@firebase/messaging",oN="@firebase/messaging-compat",aN="@firebase/performance",lN="@firebase/performance-compat",cN="@firebase/remote-config",uN="@firebase/remote-config-compat",dN="@firebase/storage",hN="@firebase/storage-compat",fN="@firebase/firestore",pN="@firebase/vertexai-preview",mN="@firebase/firestore-compat",gN="firebase",yN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Of="[DEFAULT]",vN={[Mf]:"fire-core",[Gb]:"fire-core-compat",[Hb]:"fire-analytics",[Kb]:"fire-analytics-compat",[Qb]:"fire-app-check",[Wb]:"fire-app-check-compat",[Yb]:"fire-auth",[Jb]:"fire-auth-compat",[Xb]:"fire-rtdb",[Zb]:"fire-data-connect",[eN]:"fire-rtdb-compat",[tN]:"fire-fn",[nN]:"fire-fn-compat",[rN]:"fire-iid",[sN]:"fire-iid-compat",[iN]:"fire-fcm",[oN]:"fire-fcm-compat",[aN]:"fire-perf",[lN]:"fire-perf-compat",[cN]:"fire-rc",[uN]:"fire-rc-compat",[dN]:"fire-gcs",[hN]:"fire-gcs-compat",[fN]:"fire-fst",[mN]:"fire-fst-compat",[pN]:"fire-vertex","fire-js":"fire-js",[gN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=new Map,_N=new Map,Lf=new Map;function tv(n,e){try{n.container.addComponent(e)}catch(t){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ci(n){const e=n.name;if(Lf.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;Lf.set(e,n);for(const t of Pu.values())tv(t,n);for(const t of _N.values())tv(t,n);return!0}function yd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function hr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ds=new Dl("app","Firebase",xN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _s("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=yN;function cw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Of,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ds.create("bad-app-name",{appName:String(s)});if(t||(t=rw()),!t)throw ds.create("no-options");const i=Pu.get(s);if(i){if(pl(t,i.options)&&pl(r,i.config))return i;throw ds.create("duplicate-app",{appName:s})}const o=new Nb(s);for(const u of Lf.values())o.addComponent(u);const a=new wN(t,r,o);return Pu.set(s,a),a}function uw(n=Of){const e=Pu.get(n);if(!e&&n===Of&&rw())return cw();if(!e)throw ds.create("no-app",{appName:n});return e}function Zn(n,e,t){var r;let s=(r=vN[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(a.join(" "));return}ci(new _s(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="firebase-heartbeat-database",EN=1,ml="firebase-heartbeat-store";let Ch=null;function dw(){return Ch||(Ch=Ub(IN,EN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ml)}catch(t){console.warn(t)}}}}).catch(n=>{throw ds.create("idb-open",{originalErrorMessage:n.message})})),Ch}async function TN(n){try{const t=(await dw()).transaction(ml),r=await t.objectStore(ml).get(hw(n));return await t.done,r}catch(e){if(e instanceof rr)Tr.warn(e.message);else{const t=ds.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Tr.warn(t.message)}}}async function nv(n,e){try{const r=(await dw()).transaction(ml,"readwrite");await r.objectStore(ml).put(e,hw(n)),await r.done}catch(t){if(t instanceof rr)Tr.warn(t.message);else{const r=ds.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Tr.warn(r.message)}}}function hw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=1024,bN=30*24*60*60*1e3;class NN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=bN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Tr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rv(),{heartbeatsToSend:r,unsentEntries:s}=kN(this._heartbeatsCache.heartbeats),i=ew(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Tr.warn(t),""}}}function rv(){return new Date().toISOString().substring(0,10)}function kN(n,e=SN){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),sv(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),sv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class CN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ow()?gb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await TN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function sv(n){return ew(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(n){ci(new _s("platform-logger",e=>new $b(e),"PRIVATE")),ci(new _s("heartbeat",e=>new NN(e),"PRIVATE")),Zn(Mf,ev,n),Zn(Mf,ev,"esm2017"),Zn("fire-js","")}AN("");var RN="firebase",PN="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn(RN,PN,"app");function um(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function fw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DN=fw,pw=new Dl("auth","Firebase",fw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=new lm("@firebase/auth");function jN(n,...e){Du.logLevel<=Ne.WARN&&Du.warn(`Auth (${Go}): ${n}`,...e)}function Qc(n,...e){Du.logLevel<=Ne.ERROR&&Du.error(`Auth (${Go}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(n,...e){throw dm(n,...e)}function er(n,...e){return dm(n,...e)}function mw(n,e,t){const r=Object.assign(Object.assign({},DN()),{[e]:t});return new Dl("auth","Firebase",r).create(e,{appName:n.name})}function hs(n){return mw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dm(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return pw.create(n,...e)}function ve(n,e,...t){if(!n)throw dm(e,...t)}function fr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Qc(e),new Error(e)}function br(n,e){n||fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function VN(){return iv()==="http:"||iv()==="https:"}function iv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VN()||fb()||"connection"in navigator)?navigator.onLine:!0}function ON(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t){this.shortDelay=e,this.longDelay=t,br(t>e,"Short delay should be less than long delay!"),this.isMobile=ub()||pb()}get(){return MN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(n,e){br(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=new Vl(3e4,6e4);function vd(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ko(n,e,t,r,s={}){return yw(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=jl(Object.assign({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d=Object.assign({method:e,headers:u},i);return hb()||(d.referrerPolicy="no-referrer"),gw.fetch()(_w(n,n.config.apiHost,t,a),d)})}async function yw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},LN),e);try{const s=new UN(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Cc(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,d]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cc(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Cc(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Cc(n,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw mw(n,f,d);Sr(n,f)}}catch(s){if(s instanceof rr)throw s;Sr(n,"network-request-failed",{message:String(s)})}}async function vw(n,e,t,r,s={}){const i=await Ko(n,e,t,r,s);return"mfaPendingCredential"in i&&Sr(n,"multi-factor-auth-required",{_serverResponse:i}),i}function _w(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?hm(n.config,s):`${n.config.apiScheme}://${s}`}class UN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(er(this.auth,"network-request-failed")),FN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cc(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=er(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(n,e){return Ko(n,"POST","/v1/accounts:delete",e)}async function xw(n,e){return Ko(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function BN(n,e=!1){const t=pt(n),r=await t.getIdToken(e),s=fm(r);ve(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:$a(Ah(s.auth_time)),issuedAtTime:$a(Ah(s.iat)),expirationTime:$a(Ah(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ah(n){return Number(n)*1e3}function fm(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Qc("JWT malformed, contained fewer than 3 sections"),null;try{const s=tw(t);return s?JSON.parse(s):(Qc("Failed to decode base64 JWT payload"),null)}catch(s){return Qc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ov(n){const e=fm(n);return ve(e,"internal-error"),ve(typeof e.exp<"u","internal-error"),ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof rr&&$N(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function $N({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$a(this.lastLoginAt),this.creationTime=$a(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ju(n){var e;const t=n.auth,r=await n.getIdToken(),s=await gl(n,xw(t,{idToken:r}));ve(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?ww(i.providerUserInfo):[],a=KN(n.providerData,o),u=n.isAnonymous,d=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),f=u?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Uf(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(n,m)}async function GN(n){const e=pt(n);await ju(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ww(n){return n.map(e=>{var{providerId:t}=e,r=um(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(n,e){const t=await yw(n,{},async()=>{const r=jl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=_w(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",gw.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function WN(n,e){return Ko(n,"POST","/v2/accounts:revokeToken",vd(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(typeof e.idToken<"u","internal-error"),ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ov(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ve(e.length!==0,"internal-error");const t=ov(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await HN(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new po;return r&&(ve(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ve(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new po,this.toJSON())}_performRefresh(){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(n,e){ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class pr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=um(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new qN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Uf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await gl(this,this.stsTokenManager.getToken(this.auth,e));return ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return BN(this,e)}reload(){return GN(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new pr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ju(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(hr(this.auth.app))return Promise.reject(hs(this.auth));const e=await this.getIdToken();return await gl(this,zN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,u,d,f;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(s=t.email)!==null&&s!==void 0?s:void 0,x=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,A=(o=t.photoURL)!==null&&o!==void 0?o:void 0,R=(a=t.tenantId)!==null&&a!==void 0?a:void 0,k=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,S=(d=t.createdAt)!==null&&d!==void 0?d:void 0,v=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:T,emailVerified:I,isAnonymous:D,providerData:P,stsTokenManager:w}=t;ve(T&&w,e,"internal-error");const g=po.fromJSON(this.name,w);ve(typeof T=="string",e,"internal-error"),Fr(m,e.name),Fr(y,e.name),ve(typeof I=="boolean",e,"internal-error"),ve(typeof D=="boolean",e,"internal-error"),Fr(x,e.name),Fr(A,e.name),Fr(R,e.name),Fr(k,e.name),Fr(S,e.name),Fr(v,e.name);const _=new pr({uid:T,auth:e,email:y,emailVerified:I,displayName:m,isAnonymous:D,photoURL:A,phoneNumber:x,tenantId:R,stsTokenManager:g,createdAt:S,lastLoginAt:v});return P&&Array.isArray(P)&&(_.providerData=P.map(b=>Object.assign({},b))),k&&(_._redirectEventId=k),_}static async _fromIdTokenResponse(e,t,r=!1){const s=new po;s.updateFromServerResponse(t);const i=new pr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ju(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ww(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new po;a.updateFromIdToken(r);const u=new pr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Uf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=new Map;function mr(n){br(n instanceof Function,"Expected a class definition");let e=av.get(n);return e?(br(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,av.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Iw.type="NONE";const lv=Iw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(n,e,t){return`firebase:${n}:${e}:${t}`}class mo{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Yc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Yc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new mo(mr(lv),e,r);const s=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||mr(lv);const o=Yc(r,e.config.apiKey,e.name);let a=null;for(const d of t)try{const f=await d._get(o);if(f){const m=pr._fromJSON(e,f);d!==i&&(a=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new mo(i,e,r):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new mo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ew(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kw(e))return"Blackberry";if(Cw(e))return"Webos";if(Tw(e))return"Safari";if((e.includes("chrome/")||Sw(e))&&!e.includes("edge/"))return"Chrome";if(Nw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Ew(n=Et()){return/firefox\//i.test(n)}function Tw(n=Et()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Sw(n=Et()){return/crios\//i.test(n)}function bw(n=Et()){return/iemobile/i.test(n)}function Nw(n=Et()){return/android/i.test(n)}function kw(n=Et()){return/blackberry/i.test(n)}function Cw(n=Et()){return/webos/i.test(n)}function pm(n=Et()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function QN(n=Et()){var e;return pm(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function YN(){return mb()&&document.documentMode===10}function Aw(n=Et()){return pm(n)||Nw(n)||Cw(n)||kw(n)||/windows phone/i.test(n)||bw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(n,e=[]){let t;switch(n){case"Browser":t=cv(Et());break;case"Worker":t=`${cv(Et())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Go}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XN(n,e={}){return Ko(n,"GET","/v2/passwordPolicy",vd(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=6;class ek{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:ZN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uv(this),this.idTokenSubscription=new uv(this),this.beforeStateQueue=new JN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mr(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await mo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xw(this,{idToken:e}),r=await pr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(hr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ju(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ON()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(hr(this.app))return Promise.reject(hs(this));const t=e?pt(e):null;return t&&ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return hr(this.app)?Promise.reject(hs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return hr(this.app)?Promise.reject(hs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await XN(this),t=new ek(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Dl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await WN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&mr(e)||this._popupRedirectResolver;ve(t,this,"argument-error"),this.redirectPersistenceManager=await mo.create(this,[mr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&jN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function _d(n){return pt(n)}class uv{constructor(e){this.auth=e,this.observer=null,this.addObserver=wb(t=>this.observer=t)}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nk(n){mm=n}function rk(n){return mm.loadJS(n)}function sk(){return mm.gapiScript}function ik(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(n,e){const t=yd(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(pl(i,e??{}))return s;Sr(s,"already-initialized")}return t.initialize({options:e})}function ak(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(mr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function lk(n,e,t){const r=_d(n);ve(r._canInitEmulator,r,"emulator-config-failed"),ve(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Pw(e),{host:o,port:a}=ck(e),u=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),uk()}function Pw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ck(n){const e=Pw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:dv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:dv(o)}}}function dv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function uk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,t){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function go(n,e){return vw(n,"POST","/v1/accounts:signInWithIdp",vd(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="http://localhost";class ui extends Dw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=um(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ui(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return go(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,go(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,go(e,t)}buildRequest(){const e={requestUri:dk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=jl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends jw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends Ml{constructor(){super("facebook.com")}static credential(e){return ui._fromParams({providerId:Hr.PROVIDER_ID,signInMethod:Hr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hr.credentialFromTaggedObject(e)}static credentialFromError(e){return Hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hr.credential(e.oauthAccessToken)}catch{return null}}}Hr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Ml{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ui._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Wr.credential(t,r)}catch{return null}}}Wr.GOOGLE_SIGN_IN_METHOD="google.com";Wr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends Ml{constructor(){super("github.com")}static credential(e){return ui._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qr.credential(e.oauthAccessToken)}catch{return null}}}Qr.GITHUB_SIGN_IN_METHOD="github.com";Qr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends Ml{constructor(){super("twitter.com")}static credential(e,t){return ui._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Yr.credential(t,r)}catch{return null}}}Yr.TWITTER_SIGN_IN_METHOD="twitter.com";Yr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hk(n,e){return vw(n,"POST","/v1/accounts:signUp",vd(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await pr._fromIdTokenResponse(e,r,s),o=hv(r);return new xs({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=hv(r);return new xs({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function hv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fk(n){var e;if(hr(n.app))return Promise.reject(hs(n));const t=_d(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new xs({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await hk(t,{returnSecureToken:!0}),s=await xs._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends rr{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Vu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Vu(e,t,r,s)}}function Vw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Vu._fromErrorAndOperation(n,i,e,r):i})}async function pk(n,e,t=!1){const r=await gl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xs._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mk(n,e,t=!1){const{auth:r}=n;if(hr(r.app))return Promise.reject(hs(r));const s="reauthenticate";try{const i=await gl(n,Vw(r,s,e,n),t);ve(i.idToken,r,"internal-error");const o=fm(i.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(n.uid===a,r,"user-mismatch"),xs._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Sr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gk(n,e,t=!1){if(hr(n.app))return Promise.reject(hs(n));const r="signIn",s=await Vw(n,r,e),i=await xs._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function yk(n,e,t,r){return pt(n).onIdTokenChanged(e,t,r)}function vk(n,e,t){return pt(n).beforeAuthStateChanged(e,t)}function _k(n,e,t,r){return pt(n).onAuthStateChanged(e,t,r)}const Mu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mu,"1"),this.storage.removeItem(Mu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=1e3,wk=10;class Ow extends Mw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Aw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);YN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,wk):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},xk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ow.type="LOCAL";const Ik=Ow;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw extends Mw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lw.type="SESSION";const Fw=Lw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new xd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(t.origin,i)),u=await Ek(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const d=gm("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const y=m;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(y.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return window}function Sk(n){tr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(){return typeof tr().WorkerGlobalScope<"u"&&typeof tr().importScripts=="function"}async function bk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Nk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kk(){return Uw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="firebaseLocalStorageDb",Ck=1,Ou="firebaseLocalStorage",Bw="fbase_key";class Ol{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function wd(n,e){return n.transaction([Ou],e?"readwrite":"readonly").objectStore(Ou)}function Ak(){const n=indexedDB.deleteDatabase(zw);return new Ol(n).toPromise()}function zf(){const n=indexedDB.open(zw,Ck);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ou,{keyPath:Bw})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ou)?e(r):(r.close(),await Ak(),e(await zf()))})})}async function fv(n,e,t){const r=wd(n,!0).put({[Bw]:e,value:t});return new Ol(r).toPromise()}async function Rk(n,e){const t=wd(n,!1).get(e),r=await new Ol(t).toPromise();return r===void 0?null:r.value}function pv(n,e){const t=wd(n,!0).delete(e);return new Ol(t).toPromise()}const Pk=800,Dk=3;class $w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Dk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xd._getInstance(kk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await bk(),!this.activeServiceWorker)return;this.sender=new Tk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Nk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zf();return await fv(e,Mu,"1"),await pv(e,Mu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>fv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Rk(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>pv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=wd(s,!1).getAll();return new Ol(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$w.type="LOCAL";const jk=$w;new Vl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vk(n,e){return e?mr(e):(ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym extends Dw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return go(e,this._buildIdpRequest())}_linkToIdToken(e,t){return go(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return go(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Mk(n){return gk(n.auth,new ym(n),n.bypassAuthState)}function Ok(n){const{auth:e,user:t}=n;return ve(t,e,"internal-error"),mk(t,new ym(n),n.bypassAuthState)}async function Lk(n){const{auth:e,user:t}=n;return ve(t,e,"internal-error"),pk(t,new ym(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mk;case"linkViaPopup":case"linkViaRedirect":return Lk;case"reauthViaPopup":case"reauthViaRedirect":return Ok;default:Sr(this.auth,"internal-error")}}resolve(e){br(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){br(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=new Vl(2e3,1e4);class io extends qw{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,io.currentPopupAction&&io.currentPopupAction.cancel(),io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){br(this.filter.length===1,"Popup operations only handle one event");const e=gm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Fk.get())};e()}}io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk="pendingRedirect",Jc=new Map;class zk extends qw{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Jc.get(this.auth._key());if(!e){try{const r=await Bk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Jc.set(this.auth._key(),e)}return this.bypassAuthState||Jc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Bk(n,e){const t=Gk(e),r=qk(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function $k(n,e){Jc.set(n._key(),e)}function qk(n){return mr(n._redirectPersistence)}function Gk(n){return Yc(Uk,n.config.apiKey,n.name)}async function Kk(n,e,t=!1){if(hr(n.app))return Promise.reject(hs(n));const r=_d(n),s=Vk(r,e),o=await new zk(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk=10*60*1e3;class Wk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Qk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Gw(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(er(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Hk&&this.cachedEventUids.clear(),this.cachedEventUids.has(mv(e))}saveEventToCache(e){this.cachedEventUids.add(mv(e)),this.lastProcessedEventTime=Date.now()}}function mv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Gw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Qk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yk(n,e={}){return Ko(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xk=/^https?/;async function Zk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Yk(n);for(const t of e)try{if(eC(t))return}catch{}Sr(n,"unauthorized-domain")}function eC(n){const e=Ff(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Xk.test(t))return!1;if(Jk.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=new Vl(3e4,6e4);function gv(){const n=tr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nC(n){return new Promise((e,t)=>{var r,s,i;function o(){gv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gv(),t(er(n,"network-request-failed"))},timeout:tC.get()})}if(!((s=(r=tr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=tr().gapi)===null||i===void 0)&&i.load)o();else{const a=ik("iframefcb");return tr()[a]=()=>{gapi.load?o():t(er(n,"network-request-failed"))},rk(`${sk()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Xc=null,e})}let Xc=null;function rC(n){return Xc=Xc||nC(n),Xc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC=new Vl(5e3,15e3),iC="__/auth/iframe",oC="emulator/auth/iframe",aC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cC(n){const e=n.config;ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hm(e,oC):`https://${n.config.authDomain}/${iC}`,r={apiKey:e.apiKey,appName:n.name,v:Go},s=lC.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${jl(r).slice(1)}`}async function uC(n){const e=await rC(n),t=tr().gapi;return ve(t,n,"internal-error"),e.open({where:document.body,url:cC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=er(n,"network-request-failed"),a=tr().setTimeout(()=>{i(o)},sC.get());function u(){tr().clearTimeout(a),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hC=500,fC=600,pC="_blank",mC="http://localhost";class yv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gC(n,e,t,r=hC,s=fC){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},dC),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Et().toLowerCase();t&&(a=Sw(d)?pC:t),Ew(d)&&(e=e||mC,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,A])=>`${y}${x}=${A},`,"");if(QN(d)&&a!=="_self")return yC(e||"",a),new yv(null);const m=window.open(e||"",a,f);ve(m,n,"popup-blocked");try{m.focus()}catch{}return new yv(m)}function yC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="__/auth/handler",_C="emulator/auth/handler",xC=encodeURIComponent("fac");async function vv(n,e,t,r,s,i){ve(n.config.authDomain,n,"auth-domain-config-required"),ve(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Go,eventId:s};if(e instanceof jw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",xb(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Ml){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const u=await n._getAppCheckToken(),d=u?`#${xC}=${encodeURIComponent(u)}`:"";return`${wC(n)}?${jl(a).slice(1)}${d}`}function wC({config:n}){return n.emulator?hm(n,_C):`https://${n.authDomain}/${vC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh="webStorageSupport";class IC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Fw,this._completeRedirectFn=Kk,this._overrideRedirectResult=$k}async _openPopup(e,t,r,s){var i;br((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await vv(e,t,r,Ff(),s);return gC(e,o,gm())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await vv(e,t,r,Ff(),s);return Sk(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(br(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await uC(e),r=new Wk(e);return t.register("authEvent",s=>(ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rh,{type:Rh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Rh];o!==void 0&&t(!!o),Sr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Zk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Aw()||Tw()||pm()}}const EC=IC;var _v="@firebase/auth",xv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bC(n){ci(new _s("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ve(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rw(n)},d=new tk(r,s,i,u);return ak(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ci(new _s("auth-internal",e=>{const t=_d(e.getProvider("auth").getImmediate());return(r=>new TC(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zn(_v,xv,SC(n)),Zn(_v,xv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC=5*60,kC=sw("authIdTokenMaxAge")||NC;let wv=null;const CC=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>kC)return;const s=t==null?void 0:t.token;wv!==s&&(wv=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function AC(n=uw()){const e=yd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ok(n,{popupRedirectResolver:EC,persistence:[jk,Ik,Fw]}),r=sw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=CC(i.toString());vk(t,o,()=>o(t.currentUser)),yk(t,a=>o(a))}}const s=nw("auth");return s&&lk(t,`http://${s}`),t}function RC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}nk({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=er("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",RC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bC("Browser");var Iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ni,Kw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,g){function _(){}_.prototype=g.prototype,w.D=g.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(b,C,V){for(var N=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)N[Ee-2]=arguments[Ee];return g.prototype[C].apply(b,N)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,_){_||(_=0);var b=Array(16);if(typeof g=="string")for(var C=0;16>C;++C)b[C]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(C=0;16>C;++C)b[C]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=w.g[0],_=w.g[1],C=w.g[2];var V=w.g[3],N=g+(V^_&(C^V))+b[0]+3614090360&4294967295;g=_+(N<<7&4294967295|N>>>25),N=V+(C^g&(_^C))+b[1]+3905402710&4294967295,V=g+(N<<12&4294967295|N>>>20),N=C+(_^V&(g^_))+b[2]+606105819&4294967295,C=V+(N<<17&4294967295|N>>>15),N=_+(g^C&(V^g))+b[3]+3250441966&4294967295,_=C+(N<<22&4294967295|N>>>10),N=g+(V^_&(C^V))+b[4]+4118548399&4294967295,g=_+(N<<7&4294967295|N>>>25),N=V+(C^g&(_^C))+b[5]+1200080426&4294967295,V=g+(N<<12&4294967295|N>>>20),N=C+(_^V&(g^_))+b[6]+2821735955&4294967295,C=V+(N<<17&4294967295|N>>>15),N=_+(g^C&(V^g))+b[7]+4249261313&4294967295,_=C+(N<<22&4294967295|N>>>10),N=g+(V^_&(C^V))+b[8]+1770035416&4294967295,g=_+(N<<7&4294967295|N>>>25),N=V+(C^g&(_^C))+b[9]+2336552879&4294967295,V=g+(N<<12&4294967295|N>>>20),N=C+(_^V&(g^_))+b[10]+4294925233&4294967295,C=V+(N<<17&4294967295|N>>>15),N=_+(g^C&(V^g))+b[11]+2304563134&4294967295,_=C+(N<<22&4294967295|N>>>10),N=g+(V^_&(C^V))+b[12]+1804603682&4294967295,g=_+(N<<7&4294967295|N>>>25),N=V+(C^g&(_^C))+b[13]+4254626195&4294967295,V=g+(N<<12&4294967295|N>>>20),N=C+(_^V&(g^_))+b[14]+2792965006&4294967295,C=V+(N<<17&4294967295|N>>>15),N=_+(g^C&(V^g))+b[15]+1236535329&4294967295,_=C+(N<<22&4294967295|N>>>10),N=g+(C^V&(_^C))+b[1]+4129170786&4294967295,g=_+(N<<5&4294967295|N>>>27),N=V+(_^C&(g^_))+b[6]+3225465664&4294967295,V=g+(N<<9&4294967295|N>>>23),N=C+(g^_&(V^g))+b[11]+643717713&4294967295,C=V+(N<<14&4294967295|N>>>18),N=_+(V^g&(C^V))+b[0]+3921069994&4294967295,_=C+(N<<20&4294967295|N>>>12),N=g+(C^V&(_^C))+b[5]+3593408605&4294967295,g=_+(N<<5&4294967295|N>>>27),N=V+(_^C&(g^_))+b[10]+38016083&4294967295,V=g+(N<<9&4294967295|N>>>23),N=C+(g^_&(V^g))+b[15]+3634488961&4294967295,C=V+(N<<14&4294967295|N>>>18),N=_+(V^g&(C^V))+b[4]+3889429448&4294967295,_=C+(N<<20&4294967295|N>>>12),N=g+(C^V&(_^C))+b[9]+568446438&4294967295,g=_+(N<<5&4294967295|N>>>27),N=V+(_^C&(g^_))+b[14]+3275163606&4294967295,V=g+(N<<9&4294967295|N>>>23),N=C+(g^_&(V^g))+b[3]+4107603335&4294967295,C=V+(N<<14&4294967295|N>>>18),N=_+(V^g&(C^V))+b[8]+1163531501&4294967295,_=C+(N<<20&4294967295|N>>>12),N=g+(C^V&(_^C))+b[13]+2850285829&4294967295,g=_+(N<<5&4294967295|N>>>27),N=V+(_^C&(g^_))+b[2]+4243563512&4294967295,V=g+(N<<9&4294967295|N>>>23),N=C+(g^_&(V^g))+b[7]+1735328473&4294967295,C=V+(N<<14&4294967295|N>>>18),N=_+(V^g&(C^V))+b[12]+2368359562&4294967295,_=C+(N<<20&4294967295|N>>>12),N=g+(_^C^V)+b[5]+4294588738&4294967295,g=_+(N<<4&4294967295|N>>>28),N=V+(g^_^C)+b[8]+2272392833&4294967295,V=g+(N<<11&4294967295|N>>>21),N=C+(V^g^_)+b[11]+1839030562&4294967295,C=V+(N<<16&4294967295|N>>>16),N=_+(C^V^g)+b[14]+4259657740&4294967295,_=C+(N<<23&4294967295|N>>>9),N=g+(_^C^V)+b[1]+2763975236&4294967295,g=_+(N<<4&4294967295|N>>>28),N=V+(g^_^C)+b[4]+1272893353&4294967295,V=g+(N<<11&4294967295|N>>>21),N=C+(V^g^_)+b[7]+4139469664&4294967295,C=V+(N<<16&4294967295|N>>>16),N=_+(C^V^g)+b[10]+3200236656&4294967295,_=C+(N<<23&4294967295|N>>>9),N=g+(_^C^V)+b[13]+681279174&4294967295,g=_+(N<<4&4294967295|N>>>28),N=V+(g^_^C)+b[0]+3936430074&4294967295,V=g+(N<<11&4294967295|N>>>21),N=C+(V^g^_)+b[3]+3572445317&4294967295,C=V+(N<<16&4294967295|N>>>16),N=_+(C^V^g)+b[6]+76029189&4294967295,_=C+(N<<23&4294967295|N>>>9),N=g+(_^C^V)+b[9]+3654602809&4294967295,g=_+(N<<4&4294967295|N>>>28),N=V+(g^_^C)+b[12]+3873151461&4294967295,V=g+(N<<11&4294967295|N>>>21),N=C+(V^g^_)+b[15]+530742520&4294967295,C=V+(N<<16&4294967295|N>>>16),N=_+(C^V^g)+b[2]+3299628645&4294967295,_=C+(N<<23&4294967295|N>>>9),N=g+(C^(_|~V))+b[0]+4096336452&4294967295,g=_+(N<<6&4294967295|N>>>26),N=V+(_^(g|~C))+b[7]+1126891415&4294967295,V=g+(N<<10&4294967295|N>>>22),N=C+(g^(V|~_))+b[14]+2878612391&4294967295,C=V+(N<<15&4294967295|N>>>17),N=_+(V^(C|~g))+b[5]+4237533241&4294967295,_=C+(N<<21&4294967295|N>>>11),N=g+(C^(_|~V))+b[12]+1700485571&4294967295,g=_+(N<<6&4294967295|N>>>26),N=V+(_^(g|~C))+b[3]+2399980690&4294967295,V=g+(N<<10&4294967295|N>>>22),N=C+(g^(V|~_))+b[10]+4293915773&4294967295,C=V+(N<<15&4294967295|N>>>17),N=_+(V^(C|~g))+b[1]+2240044497&4294967295,_=C+(N<<21&4294967295|N>>>11),N=g+(C^(_|~V))+b[8]+1873313359&4294967295,g=_+(N<<6&4294967295|N>>>26),N=V+(_^(g|~C))+b[15]+4264355552&4294967295,V=g+(N<<10&4294967295|N>>>22),N=C+(g^(V|~_))+b[6]+2734768916&4294967295,C=V+(N<<15&4294967295|N>>>17),N=_+(V^(C|~g))+b[13]+1309151649&4294967295,_=C+(N<<21&4294967295|N>>>11),N=g+(C^(_|~V))+b[4]+4149444226&4294967295,g=_+(N<<6&4294967295|N>>>26),N=V+(_^(g|~C))+b[11]+3174756917&4294967295,V=g+(N<<10&4294967295|N>>>22),N=C+(g^(V|~_))+b[2]+718787259&4294967295,C=V+(N<<15&4294967295|N>>>17),N=_+(V^(C|~g))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(C+(N<<21&4294967295|N>>>11))&4294967295,w.g[2]=w.g[2]+C&4294967295,w.g[3]=w.g[3]+V&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var _=g-this.blockSize,b=this.B,C=this.h,V=0;V<g;){if(C==0)for(;V<=_;)s(this,w,V),V+=this.blockSize;if(typeof w=="string"){for(;V<g;)if(b[C++]=w.charCodeAt(V++),C==this.blockSize){s(this,b),C=0;break}}else for(;V<g;)if(b[C++]=w[V++],C==this.blockSize){s(this,b),C=0;break}}this.h=C,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var _=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=_&255,_/=256;for(this.u(w),w=Array(16),g=_=0;4>g;++g)for(var b=0;32>b;b+=8)w[_++]=this.g[g]>>>b&255;return w};function i(w,g){var _=a;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=g(w)}function o(w,g){this.h=g;for(var _=[],b=!0,C=w.length-1;0<=C;C--){var V=w[C]|0;b&&V==g||(_[C]=V,b=!1)}this.g=_}var a={};function u(w){return-128<=w&&128>w?i(w,function(g){return new o([g|0],0>g?-1:0)}):new o([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return m;if(0>w)return k(d(-w));for(var g=[],_=1,b=0;w>=_;b++)g[b]=w/_|0,_*=4294967296;return new o(g,0)}function f(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return k(f(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(g,8)),b=m,C=0;C<w.length;C+=8){var V=Math.min(8,w.length-C),N=parseInt(w.substring(C,C+V),g);8>V?(V=d(Math.pow(g,V)),b=b.j(V).add(d(N))):(b=b.j(_),b=b.add(d(N)))}return b}var m=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(R(this))return-k(this).m();for(var w=0,g=1,_=0;_<this.g.length;_++){var b=this.i(_);w+=(0<=b?b:4294967296+b)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(A(this))return"0";if(R(this))return"-"+k(this).toString(w);for(var g=d(Math.pow(w,6)),_=this,b="";;){var C=I(_,g).g;_=S(_,C.j(g));var V=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=C,A(_))return V+b;for(;6>V.length;)V="0"+V;b=V+b}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function A(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function R(w){return w.h==-1}n.l=function(w){return w=S(this,w),R(w)?-1:A(w)?0:1};function k(w){for(var g=w.g.length,_=[],b=0;b<g;b++)_[b]=~w.g[b];return new o(_,~w.h).add(y)}n.abs=function(){return R(this)?k(this):this},n.add=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],b=0,C=0;C<=g;C++){var V=b+(this.i(C)&65535)+(w.i(C)&65535),N=(V>>>16)+(this.i(C)>>>16)+(w.i(C)>>>16);b=N>>>16,V&=65535,N&=65535,_[C]=N<<16|V}return new o(_,_[_.length-1]&-2147483648?-1:0)};function S(w,g){return w.add(k(g))}n.j=function(w){if(A(this)||A(w))return m;if(R(this))return R(w)?k(this).j(k(w)):k(k(this).j(w));if(R(w))return k(this.j(k(w)));if(0>this.l(x)&&0>w.l(x))return d(this.m()*w.m());for(var g=this.g.length+w.g.length,_=[],b=0;b<2*g;b++)_[b]=0;for(b=0;b<this.g.length;b++)for(var C=0;C<w.g.length;C++){var V=this.i(b)>>>16,N=this.i(b)&65535,Ee=w.i(C)>>>16,F=w.i(C)&65535;_[2*b+2*C]+=N*F,v(_,2*b+2*C),_[2*b+2*C+1]+=V*F,v(_,2*b+2*C+1),_[2*b+2*C+1]+=N*Ee,v(_,2*b+2*C+1),_[2*b+2*C+2]+=V*Ee,v(_,2*b+2*C+2)}for(b=0;b<g;b++)_[b]=_[2*b+1]<<16|_[2*b];for(b=g;b<2*g;b++)_[b]=0;return new o(_,0)};function v(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function T(w,g){this.g=w,this.h=g}function I(w,g){if(A(g))throw Error("division by zero");if(A(w))return new T(m,m);if(R(w))return g=I(k(w),g),new T(k(g.g),k(g.h));if(R(g))return g=I(w,k(g)),new T(k(g.g),g.h);if(30<w.g.length){if(R(w)||R(g))throw Error("slowDivide_ only works with positive integers.");for(var _=y,b=g;0>=b.l(w);)_=D(_),b=D(b);var C=P(_,1),V=P(b,1);for(b=P(b,2),_=P(_,2);!A(b);){var N=V.add(b);0>=N.l(w)&&(C=C.add(_),V=N),b=P(b,1),_=P(_,1)}return g=S(w,C.j(g)),new T(C,g)}for(C=m;0<=w.l(g);){for(_=Math.max(1,Math.floor(w.m()/g.m())),b=Math.ceil(Math.log(_)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),V=d(_),N=V.j(g);R(N)||0<N.l(w);)_-=b,V=d(_),N=V.j(g);A(V)&&(V=y),C=C.add(V),w=S(w,N)}return new T(C,w)}n.A=function(w){return I(this,w).h},n.and=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],b=0;b<g;b++)_[b]=this.i(b)&w.i(b);return new o(_,this.h&w.h)},n.or=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],b=0;b<g;b++)_[b]=this.i(b)|w.i(b);return new o(_,this.h|w.h)},n.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],b=0;b<g;b++)_[b]=this.i(b)^w.i(b);return new o(_,this.h^w.h)};function D(w){for(var g=w.g.length+1,_=[],b=0;b<g;b++)_[b]=w.i(b)<<1|w.i(b-1)>>>31;return new o(_,w.h)}function P(w,g){var _=g>>5;g%=32;for(var b=w.g.length-_,C=[],V=0;V<b;V++)C[V]=0<g?w.i(V+_)>>>g|w.i(V+_+1)<<32-g:w.i(V+_);return new o(C,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,ni=o}).apply(typeof Iv<"u"?Iv:typeof self<"u"?self:typeof window<"u"?window:{});var Ac=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hw,Ca,Ww,Zc,Bf,Qw,Yw,Jw;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ac=="object"&&Ac];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var E=0;E<l.length-1;E++){var M=l[E];if(!(M in p))break e;p=p[M]}l=l[l.length-1],E=p[l],h=h(E),h!=E&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,E=!1,M={next:function(){if(!E&&p<l.length){var L=p++;return{value:h(L,l[L]),done:!1}}return E=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,p){return l.call.apply(l.bind,arguments)}function m(l,h,p){if(!l)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,E),l.apply(h,M)}}return function(){return l.apply(h,arguments)}}function y(l,h,p){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,y.apply(null,arguments)}function x(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var E=p.slice();return E.push.apply(E,arguments),l.apply(this,E)}}function A(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(E,M,L){for(var J=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)J[Be-2]=arguments[Be];return h.prototype[M].apply(E,J)}}function R(l){const h=l.length;if(0<h){const p=Array(h);for(let E=0;E<h;E++)p[E]=l[E];return p}return[]}function k(l,h){for(let p=1;p<arguments.length;p++){const E=arguments[p];if(u(E)){const M=l.length||0,L=E.length||0;l.length=M+L;for(let J=0;J<L;J++)l[M+J]=E[J]}else l.push(E)}}class S{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(l){return/^[\s\xa0]*$/.test(l)}function T(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function I(l){return I[" "](l),l}I[" "]=function(){};var D=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function P(l,h,p){for(const E in l)h.call(p,l[E],E,l)}function w(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function g(l){const h={};for(const p in l)h[p]=l[p];return h}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(l,h){let p,E;for(let M=1;M<arguments.length;M++){E=arguments[M];for(p in E)l[p]=E[p];for(let L=0;L<_.length;L++)p=_[L],Object.prototype.hasOwnProperty.call(E,p)&&(l[p]=E[p])}}function C(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function V(l){a.setTimeout(()=>{throw l},0)}function N(){var l=W;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Ee{constructor(){this.h=this.g=null}add(h,p){const E=F.get();E.set(h,p),this.h?this.h.next=E:this.g=E,this.h=E}}var F=new S(()=>new _e,l=>l.reset());class _e{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let pe,G=!1,W=new Ee,le=()=>{const l=a.Promise.resolve(void 0);pe=()=>{l.then(ge)}};var ge=()=>{for(var l;l=N();){try{l.h.call(l.g)}catch(p){V(p)}var h=F;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}G=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function re(l,h){if($.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,E=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(D){e:{try{I(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Ie[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&re.aa.h.call(this)}}A(re,$);var Ie={2:"touch",3:"pen",4:"mouse"};re.prototype.h=function(){re.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var be="closure_listenable_"+(1e6*Math.random()|0),ot=0;function je(l,h,p,E,M){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!E,this.ha=M,this.key=++ot,this.da=this.fa=!1}function Xe(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ve(l){this.src=l,this.g={},this.h=0}Ve.prototype.add=function(l,h,p,E,M){var L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);var J=Jt(l,h,E,M);return-1<J?(h=l[J],p||(h.fa=!1)):(h=new je(h,this.src,L,!!E,M),h.fa=p,l.push(h)),h};function Ze(l,h){var p=h.type;if(p in l.g){var E=l.g[p],M=Array.prototype.indexOf.call(E,h,void 0),L;(L=0<=M)&&Array.prototype.splice.call(E,M,1),L&&(Xe(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Jt(l,h,p,E){for(var M=0;M<l.length;++M){var L=l[M];if(!L.da&&L.listener==h&&L.capture==!!p&&L.ha==E)return M}return-1}var kn="closure_lm_"+(1e6*Math.random()|0),Rs={};function Ps(l,h,p,E,M){if(Array.isArray(h)){for(var L=0;L<h.length;L++)Ps(l,h[L],p,E,M);return null}return p=js(p),l&&l[be]?l.K(h,p,d(E)?!!E.capture:!1,M):zn(l,h,p,!1,E,M)}function zn(l,h,p,E,M,L){if(!h)throw Error("Invalid event type");var J=d(M)?!!M.capture:!!M,Be=Bn(l);if(Be||(l[kn]=Be=new Ve(l)),p=Be.add(h,p,E,J,L),p.proxy)return p;if(E=Xt(),p.proxy=E,E.src=l,E.listener=p,l.addEventListener)K||(M=J),M===void 0&&(M=!1),l.addEventListener(h.toString(),E,M);else if(l.attachEvent)l.attachEvent(Ti(h.toString()),E);else if(l.addListener&&l.removeListener)l.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Xt(){function l(p){return h.call(l.src,l.listener,p)}const h=Xo;return l}function Ei(l,h,p,E,M){if(Array.isArray(h))for(var L=0;L<h.length;L++)Ei(l,h[L],p,E,M);else E=d(E)?!!E.capture:!!E,p=js(p),l&&l[be]?(l=l.i,h=String(h).toString(),h in l.g&&(L=l.g[h],p=Jt(L,p,E,M),-1<p&&(Xe(L[p]),Array.prototype.splice.call(L,p,1),L.length==0&&(delete l.g[h],l.h--)))):l&&(l=Bn(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Jt(h,p,E,M)),(p=-1<l?h[l]:null)&&Ds(p))}function Ds(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[be])Ze(h.i,l);else{var p=l.type,E=l.proxy;h.removeEventListener?h.removeEventListener(p,E,l.capture):h.detachEvent?h.detachEvent(Ti(p),E):h.addListener&&h.removeListener&&h.removeListener(E),(p=Bn(h))?(Ze(p,l),p.h==0&&(p.src=null,h[kn]=null)):Xe(l)}}}function Ti(l){return l in Rs?Rs[l]:Rs[l]="on"+l}function Xo(l,h){if(l.da)l=!0;else{h=new re(h,this);var p=l.listener,E=l.ha||l.src;l.fa&&Ds(l),l=p.call(E,h)}return l}function Bn(l){return l=l[kn],l instanceof Ve?l:null}var Ar="__closure_events_fn_"+(1e9*Math.random()>>>0);function js(l){return typeof l=="function"?l:(l[Ar]||(l[Ar]=function(h){return l.handleEvent(h)}),l[Ar])}function $e(){he.call(this),this.i=new Ve(this),this.M=this,this.F=null}A($e,he),$e.prototype[be]=!0,$e.prototype.removeEventListener=function(l,h,p,E){Ei(this,l,h,p,E)};function ze(l,h){var p,E=l.F;if(E)for(p=[];E;E=E.F)p.push(E);if(l=l.M,E=h.type||h,typeof h=="string")h=new $(h,l);else if(h instanceof $)h.target=h.target||l;else{var M=h;h=new $(E,l),b(h,M)}if(M=!0,p)for(var L=p.length-1;0<=L;L--){var J=h.g=p[L];M=Cn(J,E,!0,h)&&M}if(J=h.g=l,M=Cn(J,E,!0,h)&&M,M=Cn(J,E,!1,h)&&M,p)for(L=0;L<p.length;L++)J=h.g=p[L],M=Cn(J,E,!1,h)&&M}$e.prototype.N=function(){if($e.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],E=0;E<p.length;E++)Xe(p[E]);delete l.g[h],l.h--}}this.F=null},$e.prototype.K=function(l,h,p,E){return this.i.add(String(l),h,!1,p,E)},$e.prototype.L=function(l,h,p,E){return this.i.add(String(l),h,!0,p,E)};function Cn(l,h,p,E){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,L=0;L<h.length;++L){var J=h[L];if(J&&!J.da&&J.capture==p){var Be=J.listener,At=J.ha||J.src;J.fa&&Ze(l.i,J),M=Be.call(At,E)!==!1&&M}}return M&&!E.defaultPrevented}function Rr(l,h,p){if(typeof l=="function")p&&(l=y(l,p));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Pr(l){l.g=Rr(()=>{l.g=null,l.i&&(l.i=!1,Pr(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Si extends he{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Pr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Y(l){he.call(this),this.h=l,this.g={}}A(Y,he);var _t=[];function qt(l){P(l.g,function(h,p){this.g.hasOwnProperty(p)&&Ds(h)},l),l.g={}}Y.prototype.N=function(){Y.aa.N.call(this),qt(this)},Y.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $n=a.JSON.stringify,Zo=a.JSON.parse,Vs=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function ea(){}ea.prototype.h=null;function bi(l){return l.h||(l.h=l.i())}function Hl(){}var Ms={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ta(){$.call(this,"d")}A(ta,$);function na(){$.call(this,"c")}A(na,$);var sr={},Wl=null;function Ni(){return Wl=Wl||new $e}sr.La="serverreachability";function Ql(l){$.call(this,sr.La,l)}A(Ql,$);function Dr(l){const h=Ni();ze(h,new Ql(h))}sr.STAT_EVENT="statevent";function Yl(l,h){$.call(this,sr.STAT_EVENT,l),this.stat=h}A(Yl,$);function Ct(l){const h=Ni();ze(h,new Yl(h,l))}sr.Ma="timingevent";function Jl(l,h){$.call(this,sr.Ma,l),this.size=h}A(Jl,$);function Os(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Ls(){this.g=!0}Ls.prototype.xa=function(){this.g=!1};function qd(l,h,p,E,M,L){l.info(function(){if(l.g)if(L)for(var J="",Be=L.split("&"),At=0;At<Be.length;At++){var De=Be[At].split("=");if(1<De.length){var Vt=De[0];De=De[1];var Mt=Vt.split("_");J=2<=Mt.length&&Mt[1]=="type"?J+(Vt+"="+De+"&"):J+(Vt+"=redacted&")}}else J=null;else J=L;return"XMLHTTP REQ ("+E+") [attempt "+M+"]: "+h+`
`+p+`
`+J})}function Gd(l,h,p,E,M,L,J){l.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+M+"]: "+h+`
`+p+`
`+L+" "+J})}function jr(l,h,p,E){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Hd(l,p)+(E?" "+E:"")})}function Kd(l,h){l.info(function(){return"TIMEOUT: "+h})}Ls.prototype.info=function(){};function Hd(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var E=p[l];if(!(2>E.length)){var M=E[1];if(Array.isArray(M)&&!(1>M.length)){var L=M[0];if(L!="noop"&&L!="stop"&&L!="close")for(var J=1;J<M.length;J++)M[J]=""}}}}return $n(p)}catch{return h}}var ki={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ra;function Ci(){}A(Ci,ea),Ci.prototype.g=function(){return new XMLHttpRequest},Ci.prototype.i=function(){return{}},ra=new Ci;function qn(l,h,p,E){this.j=l,this.i=h,this.l=p,this.R=E||1,this.U=new Y(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Zl}function Zl(){this.i=null,this.g="",this.h=!1}var ec={},xt={};function Ai(l,h,p){l.L=1,l.v=rc(ir(h)),l.m=p,l.P=!0,sa(l,null)}function sa(l,h){l.F=Date.now(),Q(l),l.A=ir(l.v);var p=l.A,E=l.R;Array.isArray(E)||(E=[String(E)]),vg(p.i,"t",E),l.C=0,p=l.j.J,l.h=new Zl,l.g=Mg(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Si(y(l.Y,l,l.g),l.O)),h=l.U,p=l.g,E=l.ca;var M="readystatechange";Array.isArray(M)||(M&&(_t[0]=M.toString()),M=_t);for(var L=0;L<M.length;L++){var J=Ps(p,M[L],E||h.handleEvent,!1,h.h||h);if(!J)break;h.g[J.key]=J}h=l.H?g(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Dr(),qd(l.i,l.u,l.A,l.l,l.R,l.m)}qn.prototype.ca=function(l){l=l.target;const h=this.M;h&&or(l)==3?h.j():this.Y(l)},qn.prototype.Y=function(l){try{if(l==this.g)e:{const Mt=or(this.g);var h=this.g.Ba();const Vi=this.g.Z();if(!(3>Mt)&&(Mt!=3||this.g&&(this.h.h||this.g.oa()||Sg(this.g)))){this.J||Mt!=4||h==7||(h==8||0>=Vi?Dr(3):Dr(2)),ie(this);var p=this.g.Z();this.X=p;t:if(j(this)){var E=Sg(this.g);l="";var M=E.length,L=or(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Le(this),Pe(this);var J="";break t}this.h.i=new a.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,l+=this.h.i.decode(E[h],{stream:!(L&&h==M-1)});E.length=0,this.h.g+=l,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=p==200,Gd(this.i,this.u,this.A,this.l,this.R,Mt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,At=this.g;if((Be=At.g?At.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Be)){var De=Be;break t}}De=null}if(p=De)jr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gt(this,p);else{this.o=!1,this.s=3,Ct(12),Le(this),Pe(this);break e}}if(this.P){p=!0;let Rn;for(;!this.J&&this.C<J.length;)if(Rn=U(this,J),Rn==xt){Mt==4&&(this.s=4,Ct(14),p=!1),jr(this.i,this.l,null,"[Incomplete Response]");break}else if(Rn==ec){this.s=4,Ct(15),jr(this.i,this.l,J,"[Invalid Chunk]"),p=!1;break}else jr(this.i,this.l,Rn,null),gt(this,Rn);if(j(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||J.length!=0||this.h.h||(this.s=1,Ct(16),p=!1),this.o=this.o&&p,!p)jr(this.i,this.l,J,"[Invalid Chunked Response]"),Le(this),Pe(this);else if(0<J.length&&!this.W){this.W=!0;var Vt=this.j;Vt.g==this&&Vt.ba&&!Vt.M&&(Vt.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Jd(Vt),Vt.M=!0,Ct(11))}}else jr(this.i,this.l,J,null),gt(this,J);Mt==4&&Le(this),this.o&&!this.J&&(Mt==4?Pg(this.j,this):(this.o=!1,Q(this)))}else NT(this.g),p==400&&0<J.indexOf("Unknown SID")?(this.s=3,Ct(12)):(this.s=0,Ct(13)),Le(this),Pe(this)}}}catch{}finally{}};function j(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function U(l,h){var p=l.C,E=h.indexOf(`
`,p);return E==-1?xt:(p=Number(h.substring(p,E)),isNaN(p)?ec:(E+=1,E+p>h.length?xt:(h=h.slice(E,E+p),l.C=E+p,h)))}qn.prototype.cancel=function(){this.J=!0,Le(this)};function Q(l){l.S=Date.now()+l.I,te(l,l.I)}function te(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Os(y(l.ba,l),h)}function ie(l){l.B&&(a.clearTimeout(l.B),l.B=null)}qn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Kd(this.i,this.A),this.L!=2&&(Dr(),Ct(17)),Le(this),this.s=2,Pe(this)):te(this,this.S-l)};function Pe(l){l.j.G==0||l.J||Pg(l.j,l)}function Le(l){ie(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,qt(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function gt(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Vr(p.h,l))){if(!l.K&&Vr(p.h,l)&&p.G==3){try{var E=p.Da.g.parse(h)}catch{E=null}if(Array.isArray(E)&&E.length==3){var M=E;if(M[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)cc(p),ac(p);else break e;Yd(p),Ct(18)}}else p.za=M[1],0<p.za-p.T&&37500>M[2]&&p.F&&p.v==0&&!p.C&&(p.C=Os(y(p.Za,p),6e3));if(1>=Ri(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else zs(p,11)}else if((l.K||p.g==l)&&cc(p),!v(h))for(M=p.Da.g.parse(h),h=0;h<M.length;h++){let De=M[h];if(p.T=De[0],De=De[1],p.G==2)if(De[0]=="c"){p.K=De[1],p.ia=De[2];const Vt=De[3];Vt!=null&&(p.la=Vt,p.j.info("VER="+p.la));const Mt=De[4];Mt!=null&&(p.Aa=Mt,p.j.info("SVER="+p.Aa));const Vi=De[5];Vi!=null&&typeof Vi=="number"&&0<Vi&&(E=1.5*Vi,p.L=E,p.j.info("backChannelRequestTimeoutMs_="+E)),E=p;const Rn=l.g;if(Rn){const dc=Rn.g?Rn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(dc){var L=E.h;L.g||dc.indexOf("spdy")==-1&&dc.indexOf("quic")==-1&&dc.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Fs(L,L.h),L.h=null))}if(E.D){const Xd=Rn.g?Rn.g.getResponseHeader("X-HTTP-Session-Id"):null;Xd&&(E.ya=Xd,Ke(E.I,E.D,Xd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),E=p;var J=l;if(E.qa=Vg(E,E.J?E.ia:null,E.W),J.K){Gn(E.h,J);var Be=J,At=E.L;At&&(Be.I=At),Be.B&&(ie(Be),Q(Be)),E.g=J}else Ag(E);0<p.i.length&&lc(p)}else De[0]!="stop"&&De[0]!="close"||zs(p,7);else p.G==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?zs(p,7):Qd(p):De[0]!="noop"&&p.l&&p.l.ta(De),p.v=0)}}Dr(4)}catch{}}var An=class{constructor(l,h){this.g=l,this.map=h}};function xn(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ri(l){return l.h?1:l.g?l.g.size:0}function Vr(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Fs(l,h){l.g?l.g.add(h):l.h=h}function Gn(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}xn.prototype.cancel=function(){if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Pi(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return R(l.i)}function et(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],p=l.length,E=0;E<p;E++)h.push(l[E]);return h}h=[],p=0;for(E in l)h[p++]=l[E];return h}function Ae(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const E in l)h[p++]=E;return h}}}function ln(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=Ae(l),E=et(l),M=E.length,L=0;L<M;L++)h.call(void 0,E[L],p&&p[L],l)}var fg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pT(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var E=l[p].indexOf("="),M=null;if(0<=E){var L=l[p].substring(0,E);M=l[p].substring(E+1)}else L=l[p];h(L,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Us(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Us){this.h=l.h,tc(this,l.j),this.o=l.o,this.g=l.g,nc(this,l.s),this.l=l.l;var h=l.i,p=new aa;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),pg(this,p),this.m=l.m}else l&&(h=String(l).match(fg))?(this.h=!1,tc(this,h[1]||"",!0),this.o=ia(h[2]||""),this.g=ia(h[3]||"",!0),nc(this,h[4]),this.l=ia(h[5]||"",!0),pg(this,h[6]||"",!0),this.m=ia(h[7]||"")):(this.h=!1,this.i=new aa(null,this.h))}Us.prototype.toString=function(){var l=[],h=this.j;h&&l.push(oa(h,mg,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(oa(h,mg,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(oa(p,p.charAt(0)=="/"?yT:gT,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",oa(p,_T)),l.join("")};function ir(l){return new Us(l)}function tc(l,h,p){l.j=p?ia(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function nc(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function pg(l,h,p){h instanceof aa?(l.i=h,xT(l.i,l.h)):(p||(h=oa(h,vT)),l.i=new aa(h,l.h))}function Ke(l,h,p){l.i.set(h,p)}function rc(l){return Ke(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ia(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function oa(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,mT),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function mT(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var mg=/[#\/\?@]/g,gT=/[#\?:]/g,yT=/[#\?]/g,vT=/[#\?@]/g,_T=/#/g;function aa(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Mr(l){l.g||(l.g=new Map,l.h=0,l.i&&pT(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=aa.prototype,n.add=function(l,h){Mr(this),this.i=null,l=Di(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function gg(l,h){Mr(l),h=Di(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function yg(l,h){return Mr(l),h=Di(l,h),l.g.has(h)}n.forEach=function(l,h){Mr(this),this.g.forEach(function(p,E){p.forEach(function(M){l.call(h,M,E,this)},this)},this)},n.na=function(){Mr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let E=0;E<h.length;E++){const M=l[E];for(let L=0;L<M.length;L++)p.push(h[E])}return p},n.V=function(l){Mr(this);let h=[];if(typeof l=="string")yg(this,l)&&(h=h.concat(this.g.get(Di(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Mr(this),this.i=null,l=Di(this,l),yg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function vg(l,h,p){gg(l,h),0<p.length&&(l.i=null,l.g.set(Di(l,h),R(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var E=h[p];const L=encodeURIComponent(String(E)),J=this.V(E);for(E=0;E<J.length;E++){var M=L;J[E]!==""&&(M+="="+encodeURIComponent(String(J[E]))),l.push(M)}}return this.i=l.join("&")};function Di(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function xT(l,h){h&&!l.j&&(Mr(l),l.i=null,l.g.forEach(function(p,E){var M=E.toLowerCase();E!=M&&(gg(this,E),vg(this,M,p))},l)),l.j=h}function wT(l,h){const p=new Ls;if(a.Image){const E=new Image;E.onload=x(Or,p,"TestLoadImage: loaded",!0,h,E),E.onerror=x(Or,p,"TestLoadImage: error",!1,h,E),E.onabort=x(Or,p,"TestLoadImage: abort",!1,h,E),E.ontimeout=x(Or,p,"TestLoadImage: timeout",!1,h,E),a.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=l}else h(!1)}function IT(l,h){const p=new Ls,E=new AbortController,M=setTimeout(()=>{E.abort(),Or(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:E.signal}).then(L=>{clearTimeout(M),L.ok?Or(p,"TestPingServer: ok",!0,h):Or(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),Or(p,"TestPingServer: error",!1,h)})}function Or(l,h,p,E,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),E(p)}catch{}}function ET(){this.g=new Vs}function TT(l,h,p){const E=p||"";try{ln(l,function(M,L){let J=M;d(M)&&(J=$n(M)),h.push(E+L+"="+encodeURIComponent(J))})}catch(M){throw h.push(E+"type="+encodeURIComponent("_badmap")),M}}function sc(l){this.l=l.Ub||null,this.j=l.eb||!1}A(sc,ea),sc.prototype.g=function(){return new ic(this.l,this.j)},sc.prototype.i=function(l){return function(){return l}}({});function ic(l,h){$e.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(ic,$e),n=ic.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ca(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,la(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_g(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function _g(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?la(this):ca(this),this.readyState==3&&_g(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,la(this))},n.Qa=function(l){this.g&&(this.response=l,la(this))},n.ga=function(){this.g&&la(this)};function la(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ca(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function ca(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ic.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function xg(l){let h="";return P(l,function(p,E){h+=E,h+=":",h+=p,h+=`\r
`}),h}function Wd(l,h,p){e:{for(E in p){var E=!1;break e}E=!0}E||(p=xg(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Ke(l,h,p))}function at(l){$e.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(at,$e);var ST=/^https?$/i,bT=["POST","PUT"];n=at.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ra.g(),this.v=this.o?bi(this.o):bi(ra),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(L){wg(this,L);return}if(l=p||"",p=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var M in E)p.set(M,E[M]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const L of E.keys())p.set(L,E.get(L));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),M=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(bT,h,void 0))||E||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,J]of p)this.g.setRequestHeader(L,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Tg(this),this.u=!0,this.g.send(l),this.u=!1}catch(L){wg(this,L)}};function wg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Ig(l),oc(l)}function Ig(l){l.A||(l.A=!0,ze(l,"complete"),ze(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ze(this,"complete"),ze(this,"abort"),oc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),oc(this,!0)),at.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Eg(this):this.bb())},n.bb=function(){Eg(this)};function Eg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||or(l)!=4||l.Z()!=2)){if(l.u&&or(l)==4)Rr(l.Ea,0,l);else if(ze(l,"readystatechange"),or(l)==4){l.h=!1;try{const J=l.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var E;if(E=J===0){var M=String(l.D).match(fg)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),E=!ST.test(M?M.toLowerCase():"")}p=E}if(p)ze(l,"complete"),ze(l,"success");else{l.m=6;try{var L=2<or(l)?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.Z()+"]",Ig(l)}}finally{oc(l)}}}}function oc(l,h){if(l.g){Tg(l);const p=l.g,E=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||ze(l,"ready");try{p.onreadystatechange=E}catch{}}}function Tg(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function or(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<or(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Zo(h)}};function Sg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function NT(l){const h={};l=(l.g&&2<=or(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<l.length;E++){if(v(l[E]))continue;var p=C(l[E]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const L=h[M]||[];h[M]=L,L.push(p)}w(h,function(E){return E.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ua(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function bg(l){this.Aa=0,this.i=[],this.j=new Ls,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ua("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ua("baseRetryDelayMs",5e3,l),this.cb=ua("retryDelaySeedMs",1e4,l),this.Wa=ua("forwardChannelMaxRetries",2,l),this.wa=ua("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new xn(l&&l.concurrentRequestLimit),this.Da=new ET,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=bg.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,E){Ct(0),this.W=l,this.H=h||{},p&&E!==void 0&&(this.H.OSID=p,this.H.OAID=E),this.F=this.X,this.I=Vg(this,null,this.W),lc(this)};function Qd(l){if(Ng(l),l.G==3){var h=l.U++,p=ir(l.I);if(Ke(p,"SID",l.K),Ke(p,"RID",h),Ke(p,"TYPE","terminate"),da(l,p),h=new qn(l,l.j,h),h.L=2,h.v=rc(ir(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Mg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Q(h)}jg(l)}function ac(l){l.g&&(Jd(l),l.g.cancel(),l.g=null)}function Ng(l){ac(l),l.u&&(a.clearTimeout(l.u),l.u=null),cc(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function lc(l){if(!wn(l.h)&&!l.s){l.s=!0;var h=l.Ga;pe||le(),G||(pe(),G=!0),W.add(h,l),l.B=0}}function kT(l,h){return Ri(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Os(y(l.Ga,l,h),Dg(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const M=new qn(this,this.j,l);let L=this.o;if(this.S&&(L?(L=g(L),b(L,this.S)):L=this.S),this.m!==null||this.O||(M.H=L,L=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var E=this.i[p];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(h+=E,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Cg(this,M,h),p=ir(this.I),Ke(p,"RID",l),Ke(p,"CVER",22),this.D&&Ke(p,"X-HTTP-Session-Id",this.D),da(this,p),L&&(this.O?h="headers="+encodeURIComponent(String(xg(L)))+"&"+h:this.m&&Wd(p,this.m,L)),Fs(this.h,M),this.Ua&&Ke(p,"TYPE","init"),this.P?(Ke(p,"$req",h),Ke(p,"SID","null"),M.T=!0,Ai(M,p,null)):Ai(M,p,h),this.G=2}}else this.G==3&&(l?kg(this,l):this.i.length==0||wn(this.h)||kg(this))};function kg(l,h){var p;h?p=h.l:p=l.U++;const E=ir(l.I);Ke(E,"SID",l.K),Ke(E,"RID",p),Ke(E,"AID",l.T),da(l,E),l.m&&l.o&&Wd(E,l.m,l.o),p=new qn(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Cg(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Fs(l.h,p),Ai(p,E,h)}function da(l,h){l.H&&P(l.H,function(p,E){Ke(h,E,p)}),l.l&&ln({},function(p,E){Ke(h,E,p)})}function Cg(l,h,p){p=Math.min(l.i.length,p);var E=l.l?y(l.l.Na,l.l,l):null;e:{var M=l.i;let L=-1;for(;;){const J=["count="+p];L==-1?0<p?(L=M[0].g,J.push("ofs="+L)):L=0:J.push("ofs="+L);let Be=!0;for(let At=0;At<p;At++){let De=M[At].g;const Vt=M[At].map;if(De-=L,0>De)L=Math.max(0,M[At].g-100),Be=!1;else try{TT(Vt,J,"req"+De+"_")}catch{E&&E(Vt)}}if(Be){E=J.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,E}function Ag(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;pe||le(),G||(pe(),G=!0),W.add(h,l),l.v=0}}function Yd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Os(y(l.Fa,l),Dg(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,Rg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Os(y(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ct(10),ac(this),Rg(this))};function Jd(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Rg(l){l.g=new qn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=ir(l.qa);Ke(h,"RID","rpc"),Ke(h,"SID",l.K),Ke(h,"AID",l.T),Ke(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ke(h,"TO",l.ja),Ke(h,"TYPE","xmlhttp"),da(l,h),l.m&&l.o&&Wd(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=rc(ir(h)),p.m=null,p.P=!0,sa(p,l)}n.Za=function(){this.C!=null&&(this.C=null,ac(this),Yd(this),Ct(19))};function cc(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Pg(l,h){var p=null;if(l.g==h){cc(l),Jd(l),l.g=null;var E=2}else if(Vr(l.h,h))p=h.D,Gn(l.h,h),E=1;else return;if(l.G!=0){if(h.o)if(E==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var M=l.B;E=Ni(),ze(E,new Jl(E,p)),lc(l)}else Ag(l);else if(M=h.s,M==3||M==0&&0<h.X||!(E==1&&kT(l,h)||E==2&&Yd(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),M){case 1:zs(l,5);break;case 4:zs(l,10);break;case 3:zs(l,6);break;default:zs(l,2)}}}function Dg(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function zs(l,h){if(l.j.info("Error code "+h),h==2){var p=y(l.fb,l),E=l.Xa;const M=!E;E=new Us(E||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||tc(E,"https"),rc(E),M?wT(E.toString(),p):IT(E.toString(),p)}else Ct(2);l.G=0,l.l&&l.l.sa(h),jg(l),Ng(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))};function jg(l){if(l.G=0,l.ka=[],l.l){const h=Pi(l.h);(h.length!=0||l.i.length!=0)&&(k(l.ka,h),k(l.ka,l.i),l.h.i.length=0,R(l.i),l.i.length=0),l.l.ra()}}function Vg(l,h,p){var E=p instanceof Us?ir(p):new Us(p);if(E.g!="")h&&(E.g=h+"."+E.g),nc(E,E.s);else{var M=a.location;E=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var L=new Us(null);E&&tc(L,E),h&&(L.g=h),M&&nc(L,M),p&&(L.l=p),E=L}return p=l.D,h=l.ya,p&&h&&Ke(E,p,h),Ke(E,"VER",l.la),da(l,E),E}function Mg(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new at(new sc({eb:p})):new at(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Og(){}n=Og.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function uc(){}uc.prototype.g=function(l,h){return new cn(l,h)};function cn(l,h){$e.call(this),this.g=new bg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!v(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ji(this)}A(cn,$e),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Qd(this.g)},cn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=$n(l),l=p);h.i.push(new An(h.Ya++,l)),h.G==3&&lc(h)},cn.prototype.N=function(){this.g.l=null,delete this.j,Qd(this.g),delete this.g,cn.aa.N.call(this)};function Lg(l){ta.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}A(Lg,ta);function Fg(){na.call(this),this.status=1}A(Fg,na);function ji(l){this.g=l}A(ji,Og),ji.prototype.ua=function(){ze(this.g,"a")},ji.prototype.ta=function(l){ze(this.g,new Lg(l))},ji.prototype.sa=function(l){ze(this.g,new Fg)},ji.prototype.ra=function(){ze(this.g,"b")},uc.prototype.createWebChannel=uc.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Jw=function(){return new uc},Yw=function(){return Ni()},Qw=sr,Bf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ki.NO_ERROR=0,ki.TIMEOUT=8,ki.HTTP_ERROR=6,Zc=ki,Xl.COMPLETE="complete",Ww=Xl,Hl.EventType=Ms,Ms.OPEN="a",Ms.CLOSE="b",Ms.ERROR="c",Ms.MESSAGE="d",$e.prototype.listen=$e.prototype.K,Ca=Hl,at.prototype.listenOnce=at.prototype.L,at.prototype.getLastError=at.prototype.Ka,at.prototype.getLastErrorCode=at.prototype.Ba,at.prototype.getStatus=at.prototype.Z,at.prototype.getResponseJson=at.prototype.Oa,at.prototype.getResponseText=at.prototype.oa,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Ha,Hw=at}).apply(typeof Ac<"u"?Ac:typeof self<"u"?self:typeof window<"u"?window:{});const Ev="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ut=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ho="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=new lm("@firebase/firestore");function Bi(){return di.logLevel}function q(n,...e){if(di.logLevel<=Ne.DEBUG){const t=e.map(vm);di.debug(`Firestore (${Ho}): ${n}`,...t)}}function ft(n,...e){if(di.logLevel<=Ne.ERROR){const t=e.map(vm);di.error(`Firestore (${Ho}): ${n}`,...t)}}function yl(n,...e){if(di.logLevel<=Ne.WARN){const t=e.map(vm);di.warn(`Firestore (${Ho}): ${n}`,...t)}}function vm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(n="Unexpected state"){const e=`FIRESTORE (${Ho}) INTERNAL ASSERTION FAILED: `+n;throw ft(e),new Error(e)}function ue(n,e){n||se()}function ae(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends rr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ut.UNAUTHENTICATED))}shutdown(){}}class jC{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ue(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new fs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new PC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new Ut(e)}}class VC{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class MC{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new VC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class OC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ue(this.o===void 0);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ue(typeof t.token=="string"),this.R=t.token,new OC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=FC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(n,e){return n<e?-1:n>e?1:0}function bo(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Zw(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ee(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ee(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ee(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new st(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new st(0,0))}static max(){return new fe(new st(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t,r){t===void 0?t=0:t>e.length&&se(),r===void 0?r=e.length-t:r>e.length-t&&se(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return vl.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vl?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Me extends vl{construct(e,t,r){return new Me(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ee(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Me(t)}static emptyPath(){return new Me([])}}const UC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nt extends vl{construct(e,t,r){return new nt(e,t,r)}static isValidIdentifier(e){return UC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new nt(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ee(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ee(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ee(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ee(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nt(t)}static emptyPath(){return new nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Me.fromString(e))}static fromName(e){return new Z(Me.fromString(e).popFirst(5))}static empty(){return new Z(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Me(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function $f(n){return n.fields.find(e=>e.kind===2)}function Ks(n){return n.fields.filter(e=>e.kind!==2)}Lu.UNKNOWN_ID=-1;class eu{constructor(e,t){this.fieldPath=e,this.kind=t}}class _l{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _l(0,yn.min())}}function eI(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new st(t+1,0):new st(t,r));return new yn(s,Z.empty(),e)}function tI(n){return new yn(n.readTime,n.key,-1)}class yn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new yn(fe.min(),Z.empty(),-1)}static max(){return new yn(fe.max(),Z.empty(),-1)}}function _m(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Z.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ns(n){if(n.code!==B.FAILED_PRECONDITION||n.message!==nI)throw n;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&se(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):O.reject(t)}static resolve(e){return new O((t,r)=>{t(e)})}static reject(e){return new O((t,r)=>{r(e)})}static waitFor(e){return new O((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=O.resolve(!1);for(const r of e)t=t.next(s=>s?O.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const d=u;t(e[d]).next(f=>{o[d]=f,++a,a===i&&r(o)},f=>s(f))}})}static doWhile(e,t){return new O((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new fs,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new qa(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=xm(r.target.error);this.V.reject(new qa(e,s))}}static open(e,t,r,s){try{return new Id(t,e.transaction(s,r))}catch(i){throw new qa(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new BC(t)}}class ps{constructor(e,t,r){this.name=e,this.version=t,this.p=r,ps.S(Et())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return q("SimpleDb","Removing database:",e),Hs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ow())return!1;if(ps.v())return!0;const e=Et(),t=ps.S(e),r=0<t&&t<10,s=sI(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(q("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new qa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ee(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ee(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new qa(e,o))},s.onupgradeneeded=i=>{q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Id.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(d=>(a.g(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,d=u.name!=="FirebaseError"&&o<3;if(q("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zC{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Hs(this.B.delete())}}class qa extends ee{constructor(e,t){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ks(n){return n.name==="IndexedDbTransactionError"}class BC{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(q("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hs(r)}add(e){return q("SimpleDb","ADD",this.store.name,e,e),Hs(this.store.add(e))}get(e){return Hs(this.store.get(e)).next(t=>(t===void 0&&(t=null),q("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return q("SimpleDb","DELETE",this.store.name,e),Hs(this.store.delete(e))}count(){return q("SimpleDb","COUNT",this.store.name),Hs(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new O((r,s)=>{t.onerror=i=>{const o=xm(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new zC(a),d=t(a.primaryKey,a.value,u);if(d instanceof O){const f=d.catch(m=>(u.done(),O.reject(m)));r.push(f)}u.isDone?s():u.K===null?a.continue():a.continue(u.K)}}).next(()=>O.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hs(n){return new O((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=xm(r.target.error);t(s)}})}let Tv=!1;function xm(n){const e=ps.S(Et());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Tv||(Tv=!0,setTimeout(()=>{throw r},0)),r}}return n}class $C{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){ks(t)?q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ns(t)}await this.X(6e4)})}}class qC{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=tI(i);_m(o,r)>0&&(r=o)}),new yn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}nn.oe=-1;function Ed(n){return n==null}function xl(n){return n===0&&1/n==-1/0}function iI(n){return typeof n=="number"&&Number.isInteger(n)&&!xl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Sv(e)),e=GC(n.get(t),e);return Sv(e)}function GC(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function Sv(n){return n+""}function Qn(n){const e=n.length;if(ue(e>=2),e===2)return ue(n.charAt(0)===""&&n.charAt(1)===""),Me.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&se(),n.charAt(o+1)){case"":const a=n.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:se()}i=o+2}return new Me(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(n,e){return[n,Ht(e)]}function oI(n,e,t){return[n,Ht(e),t]}const KC={},HC=["prefixPath","collectionGroup","readTime","documentId"],WC=["prefixPath","collectionGroup","documentId"],QC=["collectionGroup","readTime","prefixPath","documentId"],YC=["canonicalId","targetId"],JC=["targetId","path"],XC=["path","targetId"],ZC=["collectionId","parent"],eA=["indexId","uid"],tA=["uid","sequenceNumber"],nA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rA=["indexId","uid","orderedDocumentKey"],sA=["userId","collectionPath","documentId"],iA=["userId","collectionPath","largestBatchId"],oA=["userId","collectionGroup","largestBatchId"],aI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aA=[...aI,"documentOverlays"],lI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],cI=lI,wm=[...cI,"indexConfiguration","indexState","indexEntries"],lA=wm,cA=[...wm,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends rI{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Tt(n,e){const t=ae(n);return ps.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,t){this.comparator=e,this.root=t||Pt.EMPTY}insert(e,t){return new Ge(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Pt.BLACK,null,null))}remove(e){return new Ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rc(this.root,e,this.comparator,!0)}}class Rc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Pt.RED,this.left=s??Pt.EMPTY,this.right=i??Pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Pt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Pt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw se();const e=this.left.check();if(e!==this.right.check())throw se();return e+(this.isRed()?0:1)}}Pt.EMPTY=null,Pt.RED=!0,Pt.BLACK=!1;Pt.EMPTY=new class{constructor(){this.size=0}get key(){throw se()}get value(){throw se()}get color(){throw se()}get left(){throw se()}get right(){throw se()}copy(e,t,r,s,i){return this}insert(e,t,r){return new Pt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.comparator=e,this.data=new Ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kv(this.data.getIterator())}getIteratorFrom(e){return new kv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ue)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ue(this.comparator);return t.data=e,t}}class kv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Oi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(nt.comparator)}static empty(){return new rn([])}unionWith(e){let t=new Ue(nt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new rn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bo(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new dI("Invalid base64 string: "+i):i}}(e);return new mt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new mt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const uA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nr(n){if(ue(!!n),typeof n=="string"){let e=0;const t=uA.exec(n);if(ue(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ws(n){return typeof n=="string"?mt.fromBase64String(n):mt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Em(n){const e=n.mapValue.fields.__previous_value__;return Im(e)?Em(e):e}function wl(n){const e=Nr(n.mapValue.fields.__local_write_time__.timestampValue);return new st(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,t,r,s,i,o,a,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=d}}class hi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new hi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},nu={nullValue:"NULL_VALUE"};function fi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Im(n)?4:hI(n)?9007199254740991:Td(n)?10:11:se()}function nr(n,e){if(n===e)return!0;const t=fi(n);if(t!==fi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wl(n).isEqual(wl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Nr(s.timestampValue),a=Nr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return ws(s.bytesValue).isEqual(ws(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Qe(s.geoPointValue.latitude)===Qe(i.geoPointValue.latitude)&&Qe(s.geoPointValue.longitude)===Qe(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qe(s.integerValue)===Qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Qe(s.doubleValue),a=Qe(i.doubleValue);return o===a?xl(o)===xl(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return bo(n.arrayValue.values||[],e.arrayValue.values||[],nr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Nv(o)!==Nv(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!nr(o[u],a[u])))return!1;return!0}(n,e);default:return se()}}function Il(n,e){return(n.values||[]).find(t=>nr(t,e))!==void 0}function Is(n,e){if(n===e)return 0;const t=fi(n),r=fi(e);if(t!==r)return xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Qe(i.integerValue||i.doubleValue),u=Qe(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return Cv(n.timestampValue,e.timestampValue);case 4:return Cv(wl(n),wl(e));case 5:return xe(n.stringValue,e.stringValue);case 6:return function(i,o){const a=ws(i),u=ws(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let d=0;d<a.length&&d<u.length;d++){const f=xe(a[d],u[d]);if(f!==0)return f}return xe(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=xe(Qe(i.latitude),Qe(o.latitude));return a!==0?a:xe(Qe(i.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Av(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,u,d,f;const m=i.fields||{},y=o.fields||{},x=(a=m.value)===null||a===void 0?void 0:a.arrayValue,A=(u=y.value)===null||u===void 0?void 0:u.arrayValue,R=xe(((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0,((f=A==null?void 0:A.values)===null||f===void 0?void 0:f.length)||0);return R!==0?R:Av(x,A)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===es.mapValue&&o===es.mapValue)return 0;if(i===es.mapValue)return 1;if(o===es.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const y=xe(u[m],f[m]);if(y!==0)return y;const x=Is(a[u[m]],d[f[m]]);if(x!==0)return x}return xe(u.length,f.length)}(n.mapValue,e.mapValue);default:throw se()}}function Cv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=Nr(n),r=Nr(e),s=xe(t.seconds,r.seconds);return s!==0?s:xe(t.nanos,r.nanos)}function Av(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Is(t[s],r[s]);if(i)return i}return xe(t.length,r.length)}function No(n){return Gf(n)}function Gf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Nr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ws(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Gf(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Gf(t.fields[o])}`;return s+"}"}(n.mapValue):se()}function Tm(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Kf(n){return!!n&&"integerValue"in n}function El(n){return!!n&&"arrayValue"in n}function Rv(n){return!!n&&"nullValue"in n}function Pv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ru(n){return!!n&&"mapValue"in n}function Td(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ga(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return wi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ga(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ga(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const fI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function hA(n){return"nullValue"in n?nu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Tm(hi.empty(),Z.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Td(n)?fI:{mapValue:{}}:se()}function fA(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Tm(hi.empty(),Z.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fI:"mapValue"in n?Td(n)?{mapValue:{}}:es:se()}function Dv(n,e){const t=Is(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function jv(n,e){const t=Is(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ga(t)}setAll(e){let t=nt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ga(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ru(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){wi(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Bt(Ga(this.value))}}function pI(n){const e=[];return wi(n.fields,(t,r)=>{const s=new nt([t]);if(ru(r)){const i=pI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dt(e,0,fe.min(),fe.min(),fe.min(),Bt.empty(),0)}static newFoundDocument(e,t,r,s){return new dt(e,1,t,fe.min(),r,s,0)}static newNoDocument(e,t){return new dt(e,2,t,fe.min(),fe.min(),Bt.empty(),0)}static newUnknownDocument(e,t){return new dt(e,3,t,fe.min(),fe.min(),Bt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e,t){this.position=e,this.inclusive=t}}function Vv(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),t.key):r=Is(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t="asc"){this.field=e,this.dir=t}}function pA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{}class ke extends mI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new mA(e,t,r):t==="array-contains"?new vA(e,r):t==="in"?new wI(e,r):t==="not-in"?new _A(e,r):t==="array-contains-any"?new xA(e,r):new ke(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new gA(e,r):new yA(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Is(t,this.value)):t!==null&&fi(this.value)===fi(t)&&this.matchesComparison(Is(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fe extends mI{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Fe(e,t)}matches(e){return Co(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Co(n){return n.op==="and"}function Hf(n){return n.op==="or"}function Sm(n){return gI(n)&&Co(n)}function gI(n){for(const e of n.filters)if(e instanceof Fe)return!1;return!0}function Wf(n){if(n instanceof ke)return n.field.canonicalString()+n.op.toString()+No(n.value);if(Sm(n))return n.filters.map(e=>Wf(e)).join(",");{const e=n.filters.map(t=>Wf(t)).join(",");return`${n.op}(${e})`}}function yI(n,e){return n instanceof ke?function(r,s){return s instanceof ke&&r.op===s.op&&r.field.isEqual(s.field)&&nr(r.value,s.value)}(n,e):n instanceof Fe?function(r,s){return s instanceof Fe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&yI(o,s.filters[a]),!0):!1}(n,e):void se()}function vI(n,e){const t=n.filters.concat(e);return Fe.create(t,n.op)}function _I(n){return n instanceof ke?function(t){return`${t.field.canonicalString()} ${t.op} ${No(t.value)}`}(n):n instanceof Fe?function(t){return t.op.toString()+" {"+t.getFilters().map(_I).join(" ,")+"}"}(n):"Filter"}class mA extends ke{constructor(e,t,r){super(e,t,r),this.key=Z.fromName(r.referenceValue)}matches(e){const t=Z.comparator(e.key,this.key);return this.matchesComparison(t)}}class gA extends ke{constructor(e,t){super(e,"in",t),this.keys=xI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class yA extends ke{constructor(e,t){super(e,"not-in",t),this.keys=xI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Z.fromName(r.referenceValue))}class vA extends ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return El(t)&&Il(t.arrayValue,this.value)}}class wI extends ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Il(this.value.arrayValue,t)}}class _A extends ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Il(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Il(this.value.arrayValue,t)}}class xA extends ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!El(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Il(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Qf(n,e=null,t=[],r=[],s=null,i=null,o=null){return new wA(n,e,t,r,s,i,o)}function pi(n){const e=ae(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Wf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ed(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>No(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>No(r)).join(",")),e.ue=t}return e.ue}function Ll(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pA(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mv(n.startAt,e.startAt)&&Mv(n.endAt,e.endAt)}function Uu(n){return Z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function zu(n,e){return n.filters.filter(t=>t instanceof ke&&t.field.isEqual(e))}function Ov(n,e,t){let r=nu,s=!0;for(const i of zu(n,e)){let o=nu,a=!0;switch(i.op){case"<":case"<=":o=hA(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=nu}Dv({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Dv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function Lv(n,e,t){let r=es,s=!0;for(const i of zu(n,e)){let o=es,a=!0;switch(i.op){case">=":case">":o=fA(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=es}jv({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];jv({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function II(n,e,t,r,s,i,o,a){return new Sd(n,e,t,r,s,i,o,a)}function bd(n){return new Sd(n)}function Fv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function IA(n){return n.collectionGroup!==null}function Ka(n){const e=ae(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ue(nt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Fu(i,r))}),t.has(nt.keyField().canonicalString())||e.ce.push(new Fu(nt.keyField(),r))}return e.ce}function pn(n){const e=ae(n);return e.le||(e.le=EA(e,Ka(n))),e.le}function EA(n,e){if(n.limitType==="F")return Qf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Fu(s.field,i)});const t=n.endAt?new ko(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ko(n.startAt.position,n.startAt.inclusive):null;return Qf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yf(n,e,t){return new Sd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nd(n,e){return Ll(pn(n),pn(e))&&n.limitType===e.limitType}function EI(n){return`${pi(pn(n))}|lt:${n.limitType}`}function $i(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>_I(s)).join(", ")}]`),Ed(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>No(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>No(s)).join(",")),`Target(${r})`}(pn(n))}; limitType=${n.limitType})`}function Fl(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Ka(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const d=Vv(o,a,u);return o.inclusive?d<=0:d<0}(r.startAt,Ka(r),s)||r.endAt&&!function(o,a,u){const d=Vv(o,a,u);return o.inclusive?d>=0:d>0}(r.endAt,Ka(r),s))}(n,e)}function TI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function SI(n){return(e,t)=>{let r=!1;for(const s of Ka(n)){const i=TA(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function TA(n,e,t){const r=n.field.isKeyField()?Z.comparator(e.key,t.key):function(i,o,a){const u=o.data.field(i),d=a.data.field(i);return u!==null&&d!==null?Is(u,d):se()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return se()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){wi(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return uI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Ge(Z.comparator);function hn(){return SA}const bI=new Ge(Z.comparator);function Aa(...n){let e=bI;for(const t of n)e=e.insert(t.key,t);return e}function NI(n){let e=bI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Yn(){return Ha()}function kI(){return Ha()}function Ha(){return new Cs(n=>n.toString(),(n,e)=>n.isEqual(e))}const bA=new Ge(Z.comparator),NA=new Ue(Z.comparator);function we(...n){let e=NA;for(const t of n)e=e.add(t);return e}const kA=new Ue(xe);function bm(){return kA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xl(e)?"-0":e}}function CI(n){return{integerValue:""+n}}function AI(n,e){return iI(e)?CI(e):Nm(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(){this._=void 0}}function CA(n,e,t){return n instanceof Tl?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Im(i)&&(i=Em(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Ao?PI(n,e):n instanceof Ro?DI(n,e):function(s,i){const o=RI(s,i),a=Uv(o)+Uv(s.Pe);return Kf(o)&&Kf(s.Pe)?CI(a):Nm(s.serializer,a)}(n,e)}function AA(n,e,t){return n instanceof Ao?PI(n,e):n instanceof Ro?DI(n,e):t}function RI(n,e){return n instanceof Po?function(r){return Kf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Tl extends kd{}class Ao extends kd{constructor(e){super(),this.elements=e}}function PI(n,e){const t=jI(e);for(const r of n.elements)t.some(s=>nr(s,r))||t.push(r);return{arrayValue:{values:t}}}class Ro extends kd{constructor(e){super(),this.elements=e}}function DI(n,e){let t=jI(e);for(const r of n.elements)t=t.filter(s=>!nr(s,r));return{arrayValue:{values:t}}}class Po extends kd{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Uv(n){return Qe(n.integerValue||n.doubleValue)}function jI(n){return El(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t){this.field=e,this.transform=t}}function RA(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ao&&s instanceof Ao||r instanceof Ro&&s instanceof Ro?bo(r.elements,s.elements,nr):r instanceof Po&&s instanceof Po?nr(r.Pe,s.Pe):r instanceof Tl&&s instanceof Tl}(n.transform,e.transform)}class PA{constructor(e,t){this.version=e,this.transformResults=t}}class Nt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Nt}static exists(e){return new Nt(void 0,e)}static updateTime(e){return new Nt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function su(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Cd{}function MI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ul(n.key,Nt.none()):new Wo(n.key,n.data,Nt.none());{const t=n.data,r=Bt.empty();let s=new Ue(nt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Cr(n.key,r,new rn(s.toArray()),Nt.none())}}function DA(n,e,t){n instanceof Wo?function(s,i,o){const a=s.value.clone(),u=Bv(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Cr?function(s,i,o){if(!su(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Bv(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(OI(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wa(n,e,t,r){return n instanceof Wo?function(i,o,a,u){if(!su(i.precondition,o))return a;const d=i.value.clone(),f=$v(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Cr?function(i,o,a,u){if(!su(i.precondition,o))return a;const d=$v(i.fieldTransforms,u,o),f=o.data;return f.setAll(OI(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(i,o,a){return su(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function jA(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=RI(r.transform,s||null);i!=null&&(t===null&&(t=Bt.empty()),t.set(r.field,i))}return t||null}function zv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bo(r,s,(i,o)=>RA(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Wo extends Cd{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Cr extends Cd{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function OI(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Bv(n,e,t){const r=new Map;ue(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,AA(o,a,t[s]))}return r}function $v(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,CA(i,o,e))}return r}class Ul extends Cd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends Cd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&DA(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=kI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=MI(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),we())}isEqual(e){return this.batchId===e.batchId&&bo(this.mutations,e.mutations,(t,r)=>zv(t,r))&&bo(this.baseMutations,e.baseMutations,(t,r)=>zv(t,r))}}class Cm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ue(e.mutations.length===r.length);let s=function(){return bA}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Cm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt,Ce;function MA(n){switch(n){default:return se();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function FI(n){if(n===void 0)return ft("GRPC error has no .code"),B.UNKNOWN;switch(n){case yt.OK:return B.OK;case yt.CANCELLED:return B.CANCELLED;case yt.UNKNOWN:return B.UNKNOWN;case yt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case yt.INTERNAL:return B.INTERNAL;case yt.UNAVAILABLE:return B.UNAVAILABLE;case yt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case yt.NOT_FOUND:return B.NOT_FOUND;case yt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case yt.ABORTED:return B.ABORTED;case yt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case yt.DATA_LOSS:return B.DATA_LOSS;default:return se()}}(Ce=yt||(yt={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=new ni([4294967295,4294967295],0);function qv(n){const e=OA().encode(n),t=new Kw;return t.update(e),new Uint8Array(t.digest())}function Gv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ni([t,r],0),new ni([s,i],0)]}class Rm{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ra(`Invalid padding: ${t}`);if(r<0)throw new Ra(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ra(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ra(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ni.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(ni.fromNumber(r)));return s.compare(LA)===1&&(s=new ni([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=qv(e),[r,s]=Gv(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Rm(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=qv(e),[r,s]=Gv(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Bl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new zl(fe.min(),s,new Ge(xe),hn(),we())}}class Bl{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Bl(r,t,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class UI{constructor(e,t){this.targetId=e,this.me=t}}class zI{constructor(e,t,r=mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Kv{constructor(){this.fe=0,this.ge=Wv(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),t=we(),r=we();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:se()}}),new Bl(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Wv()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class FA{constructor(e){this.Le=e,this.Be=new Map,this.ke=hn(),this.qe=Hv(),this.Qe=new Ge(xe)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:se()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Uu(i))if(r===0){const o=new Z(i.path);this.Ue(t,o,dt.newNoDocument(o,fe.min()))}else ue(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=ws(r).toUint8Array()}catch(u){if(u instanceof dI)return yl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Rm(o,s,i)}catch(u){return yl(u instanceof Ra?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Uu(a.target)){const u=new Z(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,dt.newNoDocument(u,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=we();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new zl(e,t,this.Qe,this.ke,r);return this.ke=hn(),this.qe=Hv(),this.Qe=new Ge(xe),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Kv,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ue(xe),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Kv),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Hv(){return new Ge(Z.comparator)}function Wv(){return new Ge(Z.comparator)}const UA={asc:"ASCENDING",desc:"DESCENDING"},zA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BA={and:"AND",or:"OR"};class $A{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Jf(n,e){return n.useProto3Json||Ed(e)?e:{value:e}}function Do(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function qA(n,e){return Do(n,e.toTimestamp())}function Wt(n){return ue(!!n),fe.fromTimestamp(function(t){const r=Nr(t);return new st(r.seconds,r.nanos)}(n))}function Pm(n,e){return Xf(n,e).canonicalString()}function Xf(n,e){const t=function(s){return new Me(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function $I(n){const e=Me.fromString(n);return ue(XI(e)),e}function Bu(n,e){return Pm(n.databaseId,e.path)}function ri(n,e){const t=$I(e);if(t.get(1)!==n.databaseId.projectId)throw new ee(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ee(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Z(KI(t))}function qI(n,e){return Pm(n.databaseId,e)}function GI(n){const e=$I(n);return e.length===4?Me.emptyPath():KI(e)}function Zf(n){return new Me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function KI(n){return ue(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Qv(n,e,t){return{name:Bu(n,e),fields:t.value.mapValue.fields}}function GA(n,e,t){const r=ri(n,e.name),s=Wt(e.updateTime),i=e.createTime?Wt(e.createTime):fe.min(),o=new Bt({mapValue:{fields:e.fields}}),a=dt.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function KA(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:se()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(ue(f===void 0||typeof f=="string"),mt.fromBase64String(f||"")):(ue(f===void 0||f instanceof Buffer||f instanceof Uint8Array),mt.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const f=d.code===void 0?B.UNKNOWN:FI(d.code);return new ee(f,d.message||"")}(o);t=new zI(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ri(n,r.document.name),i=Wt(r.document.updateTime),o=r.document.createTime?Wt(r.document.createTime):fe.min(),a=new Bt({mapValue:{fields:r.document.fields}}),u=dt.newFoundDocument(s,i,o,a),d=r.targetIds||[],f=r.removedTargetIds||[];t=new iu(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ri(n,r.document),i=r.readTime?Wt(r.readTime):fe.min(),o=dt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new iu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ri(n,r.document),i=r.removedTargetIds||[];t=new iu([],i,s,null)}else{if(!("filter"in e))return se();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new VA(s,i),a=r.targetId;t=new UI(a,o)}}return t}function $u(n,e){let t;if(e instanceof Wo)t={update:Qv(n,e.key,e.value)};else if(e instanceof Ul)t={delete:Bu(n,e.key)};else if(e instanceof Cr)t={update:Qv(n,e.key,e.data),updateMask:XA(e.fieldMask)};else{if(!(e instanceof LI))return se();t={verify:Bu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Tl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ao)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Po)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw se()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:qA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:se()}(n,e.precondition)),t}function ep(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Nt.updateTime(Wt(i.updateTime)):i.exists!==void 0?Nt.exists(i.exists):Nt.none()}(e.currentDocument):Nt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)ue(a.setToServerValue==="REQUEST_TIME"),u=new Tl;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];u=new Ao(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];u=new Ro(f)}else"increment"in a?u=new Po(o,a.increment):se();const d=nt.fromServerFormat(a.fieldPath);return new VI(d,u)}(n,s)):[];if(e.update){e.update.name;const s=ri(n,e.update.name),i=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const d=u.fieldPaths||[];return new rn(d.map(f=>nt.fromServerFormat(f)))}(e.updateMask);return new Cr(s,i,o,t,r)}return new Wo(s,i,t,r)}if(e.delete){const s=ri(n,e.delete);return new Ul(s,t)}if(e.verify){const s=ri(n,e.verify);return new LI(s,t)}return se()}function HA(n,e){return n&&n.length>0?(ue(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Wt(s.updateTime):Wt(i);return o.isEqual(fe.min())&&(o=Wt(i)),new PA(o,s.transformResults||[])}(t,e))):[]}function HI(n,e){return{documents:[qI(n,e.path)]}}function WI(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=qI(n,s);const i=function(d){if(d.length!==0)return JI(Fe.create(d,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(y){return{field:qi(y.field),direction:QA(y.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Jf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:s}}function QI(n){let e=GI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ue(r===1);const f=t.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=function(m){const y=YI(m);return y instanceof Fe&&Sm(y)?y.getFilters():[y]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(y=>function(A){return new Fu(Gi(A.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(y))}(t.orderBy));let a=null;t.limit&&(a=function(m){let y;return y=typeof m=="object"?m.value:m,Ed(y)?null:y}(t.limit));let u=null;t.startAt&&(u=function(m){const y=!!m.before,x=m.values||[];return new ko(x,y)}(t.startAt));let d=null;return t.endAt&&(d=function(m){const y=!m.before,x=m.values||[];return new ko(x,y)}(t.endAt)),II(e,s,o,i,a,"F",u,d)}function WA(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function YI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Gi(t.unaryFilter.field);return ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Gi(t.unaryFilter.field);return ke.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gi(t.unaryFilter.field);return ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Gi(t.unaryFilter.field);return ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return se()}}(n):n.fieldFilter!==void 0?function(t){return ke.create(Gi(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return se()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Fe.create(t.compositeFilter.filters.map(r=>YI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return se()}}(t.compositeFilter.op))}(n):se()}function QA(n){return UA[n]}function YA(n){return zA[n]}function JA(n){return BA[n]}function qi(n){return{fieldPath:n.canonicalString()}}function Gi(n){return nt.fromServerFormat(n.fieldPath)}function JI(n){return n instanceof ke?function(t){if(t.op==="=="){if(Pv(t.value))return{unaryFilter:{field:qi(t.field),op:"IS_NAN"}};if(Rv(t.value))return{unaryFilter:{field:qi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Pv(t.value))return{unaryFilter:{field:qi(t.field),op:"IS_NOT_NAN"}};if(Rv(t.value))return{unaryFilter:{field:qi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qi(t.field),op:YA(t.op),value:t.value}}}(n):n instanceof Fe?function(t){const r=t.getFilters().map(s=>JI(s));return r.length===1?r[0]:{compositeFilter:{op:JA(t.op),filters:r}}}(n):se()}function XA(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function XI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,t,r,s,i=fe.min(),o=fe.min(),a=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.ct=e}}function ZA(n,e){let t;if(e.document)t=GA(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Z.fromSegments(e.noDocument.path),s=gi(e.noDocument.readTime);t=dt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return se();{const r=Z.fromSegments(e.unknownDocument.path),s=gi(e.unknownDocument.version);t=dt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new st(s[0],s[1]);return fe.fromTimestamp(i)}(e.readTime)),t}function Yv(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:qu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Bu(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Do(i,o.version.toTimestamp()),createTime:Do(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:mi(e.version)};else{if(!e.isUnknownDocument())return se();r.unknownDocument={path:t.path.toArray(),version:mi(e.version)}}return r}function qu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function mi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gi(n){const e=new st(n.seconds,n.nanoseconds);return fe.fromTimestamp(e)}function Ws(n,e){const t=(e.baseMutations||[]).map(i=>ep(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>ep(n.ct,i)),s=st.fromMillis(e.localWriteTimeMs);return new km(e.batchId,s,t,r)}function Pa(n){const e=gi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?gi(n.lastLimboFreeSnapshotVersion):fe.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return ue(i.documents.length===1),pn(bd(GI(i.documents[0])))}(n.query):function(i){return pn(QI(i))}(n.query),new gr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,mt.fromBase64String(n.resumeToken))}function eE(n,e){const t=mi(e.snapshotVersion),r=mi(e.lastLimboFreeSnapshotVersion);let s;s=Uu(e.target)?HI(n.ct,e.target):WI(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pi(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function tE(n){const e=QI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Yf(e,e.limit,"L"):e}function Ph(n,e){return new Am(e.largestBatchId,ep(n.ct,e.overlayMutation))}function Jv(n,e){const t=e.path.lastSegment();return[n,Ht(e.path.popLast()),t]}function Xv(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:mi(r.readTime),documentKey:Ht(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{getBundleMetadata(e,t){return Zv(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:gi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Zv(e).put(function(s){return{bundleId:s.id,createTime:mi(Wt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return e0(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:tE(i.bundledQuery),readTime:gi(i.readTime)}}(r)})}saveNamedQuery(e,t){return e0(e).put(function(s){return{name:s.name,readTime:mi(Wt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Zv(n){return Tt(n,"bundles")}function e0(n){return Tt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Ad(e,r)}getOverlay(e,t){return xa(e).get(Jv(this.userId,t)).next(r=>r?Ph(this.serializer,r):null)}getOverlays(e,t){const r=Yn();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new Am(t,o);s.push(this.ht(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Ht(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(xa(e).j("collectionPathOverlayIndex",a))}),O.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Yn(),i=Ht(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return xa(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const d=Ph(this.serializer,u);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Yn();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xa(e).J({index:"collectionGroupOverlayIndex",range:a},(u,d,f)=>{const m=Ph(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>i)}ht(e,t){return xa(e).put(function(s,i,o){const[a,u,d]=Jv(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$u(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function xa(n){return Tt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{Pt(e){return Tt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?mt.fromUint8Array(r):mt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Qe(e.integerValue));else if("doubleValue"in e){const r=Qe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),xl(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Nr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ws(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?hI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Td(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):se()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Qe(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),Z.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Qs.vt=new Qs;function nR(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function t0(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=nR(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class rR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=t0(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=t0(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class sR{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class iR{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class wa{constructor(){this.jt=new rR,this.Ht=new sR(this.jt),this.Jt=new iR(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ys(this.indexId,this.documentKey,this.arrayValue,r)}}function Ur(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=n0(n.arrayValue,e.arrayValue),t!==0?t:(t=n0(n.directionalValue,e.directionalValue),t!==0?t:Z.comparator(n.documentKey,e.documentKey)))}function n0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e){this.Xt=new Ue((t,r)=>nt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ue(e.collectionGroup===this.collectionId),this.nn)return!1;const t=$f(e);if(t!==void 0&&!this.sn(t))return!1;const r=Ks(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ue(nt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new eu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new eu(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new eu(r.field,r.dir==="asc"?0:1)));return new Lu(Lu.UNKNOWN_ID,this.collectionId,t,_l.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(n){var e,t;if(ue(n instanceof ke||n instanceof Fe),n instanceof ke){if(n instanceof wI){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ke.create(n.field,"==",i)))||[];return Fe.create(s,"or")}return n}const r=n.filters.map(s=>nE(s));return Fe.create(r,n.op)}function oR(n){if(n.getFilters().length===0)return[];const e=rp(nE(n));return ue(rE(e)),tp(e)||np(e)?[e]:e.getFilters()}function tp(n){return n instanceof ke}function np(n){return n instanceof Fe&&Sm(n)}function rE(n){return tp(n)||np(n)||function(t){if(t instanceof Fe&&Hf(t)){for(const r of t.getFilters())if(!tp(r)&&!np(r))return!1;return!0}return!1}(n)}function rp(n){if(ue(n instanceof ke||n instanceof Fe),n instanceof ke)return n;if(n.filters.length===1)return rp(n.filters[0]);const e=n.filters.map(r=>rp(r));let t=Fe.create(e,n.op);return t=Gu(t),rE(t)?t:(ue(t instanceof Fe),ue(Co(t)),ue(t.filters.length>1),t.filters.reduce((r,s)=>Dm(r,s)))}function Dm(n,e){let t;return ue(n instanceof ke||n instanceof Fe),ue(e instanceof ke||e instanceof Fe),t=n instanceof ke?e instanceof ke?function(s,i){return Fe.create([s,i],"and")}(n,e):s0(n,e):e instanceof ke?s0(e,n):function(s,i){if(ue(s.filters.length>0&&i.filters.length>0),Co(s)&&Co(i))return vI(s,i.getFilters());const o=Hf(s)?s:i,a=Hf(s)?i:s,u=o.filters.map(d=>Dm(d,a));return Fe.create(u,"or")}(n,e),Gu(t)}function s0(n,e){if(Co(e))return vI(e,n.getFilters());{const t=e.filters.map(r=>Dm(n,r));return Fe.create(t,"or")}}function Gu(n){if(ue(n instanceof ke||n instanceof Fe),n instanceof ke)return n;const e=n.getFilters();if(e.length===1)return Gu(e[0]);if(gI(n))return n;const t=e.map(s=>Gu(s)),r=[];return t.forEach(s=>{s instanceof ke?r.push(s):s instanceof Fe&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Fe.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(){this.un=new jm}addToCollectionParentIndex(e,t){return this.un.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(yn.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(yn.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class jm{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ue(Me.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ue(Me.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc=new Uint8Array(0);class lR{constructor(e,t){this.databaseId=t,this.cn=new jm,this.ln=new Cs(r=>pi(r),(r,s)=>Ll(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:Ht(s)};return i0(e).put(i)}return O.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Zw(t),""],!1,!0);return i0(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Qn(o.parent))}return r})}addFieldIndex(e,t){const r=Ia(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Fi(e);return i.next(a=>{o.put(Xv(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Ia(e),s=Fi(e),i=Li(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ia(e),r=Li(e),s=Fi(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return O.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new r0(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Li(e);let s=!0;const i=new Map;return O.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=we();const a=[];return O.forEach(i,(u,d)=>{q("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(u)} to execute ${pi(t)}`);const f=function(T,I){const D=$f(I);if(D===void 0)return null;for(const P of zu(T,D.fieldPath))switch(P.op){case"array-contains-any":return P.value.arrayValue.values||[];case"array-contains":return[P.value]}return null}(d,u),m=function(T,I){const D=new Map;for(const P of Ks(I))for(const w of zu(T,P.fieldPath))switch(w.op){case"==":case"in":D.set(P.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return D.set(P.fieldPath.canonicalString(),w.value),Array.from(D.values())}return null}(d,u),y=function(T,I){const D=[];let P=!0;for(const w of Ks(I)){const g=w.kind===0?Ov(T,w.fieldPath,T.startAt):Lv(T,w.fieldPath,T.startAt);D.push(g.value),P&&(P=g.inclusive)}return new ko(D,P)}(d,u),x=function(T,I){const D=[];let P=!0;for(const w of Ks(I)){const g=w.kind===0?Lv(T,w.fieldPath,T.endAt):Ov(T,w.fieldPath,T.endAt);D.push(g.value),P&&(P=g.inclusive)}return new ko(D,P)}(d,u),A=this.In(u,d,y),R=this.In(u,d,x),k=this.Tn(u,d,m),S=this.En(u.indexId,f,A,y.inclusive,R,x.inclusive,k);return O.forEach(S,v=>r.G(v,t.limit).next(T=>{T.forEach(I=>{const D=Z.fromSegments(I.documentKey);o.has(D)||(o=o.add(D),a.push(D))})}))}).next(()=>a)}return O.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=oR(Fe.create(e.filters,"and")).map(r=>Qf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,i.length),d=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){const y=t?this.dn(t[m/d]):Pc,x=this.An(e,y,r[m%d],s),A=this.Rn(e,y,i[m%d],o),R=a.map(k=>this.An(e,y,k,!0));f.push(...this.createRange(x,A,R))}return f}An(e,t,r,s){const i=new Ys(e,Z.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new Ys(e,Z.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new r0(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return O.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let d=new Ue(nt.comparator),f=!1;for(const m of u.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:d=d.add(y.field));for(const m of u.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new wa;for(const s of Ks(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Qs.vt.It(i,o)}return r.zt()}dn(e){const t=new wa;return Qs.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new wa;return Qs.vt.It(Tm(this.databaseId,t),r.Yt(function(i){const o=Ks(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new wa);let i=0;for(const o of Ks(e)){const a=r[i++];for(const u of s)if(this.fn(t,o.fieldPath)&&El(a))s=this.gn(s,o,a);else{const d=u.Yt(o.kind);Qs.vt.It(a,d)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new wa;u.seed(a.zt()),Qs.vt.It(o,u.Yt(t.kind)),i.push(u)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ke&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ia(e),s=Fi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(f,m){const y=m?new _l(m.sequenceNumber,new yn(gi(m.readTime),new Z(Qn(m.documentKey)),m.largestBatchId)):_l.empty(),x=f.fields.map(([A,R])=>new eu(nt.fromServerFormat(A),R));return new Lu(f.indexId,f.collectionGroup,x,y)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:xe(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Ia(e),i=Fi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>O.forEach(a,u=>i.put(Xv(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return O.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,u=>this.wn(e,s,u).next(d=>{const f=this.Sn(i,u);return d.isEqual(f)?O.resolve():this.bn(e,i,u,d,f)}))))})}Dn(e,t,r,s){return Li(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return Li(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=Li(e);let i=new Ue(Ur);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new Ys(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new Ue(Ur);const s=this.Vn(t,e);if(s==null)return r;const i=$f(t);if(i!=null){const o=e.data.field(i.fieldPath);if(El(o))for(const a of o.arrayValue.values||[])r=r.add(new Ys(t.indexId,e.key,this.dn(a),s))}else r=r.add(new Ys(t.indexId,e.key,Pc,s));return r}bn(e,t,r,s,i){q("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,d,f,m,y){const x=u.getIterator(),A=d.getIterator();let R=Oi(x),k=Oi(A);for(;R||k;){let S=!1,v=!1;if(R&&k){const T=f(R,k);T<0?v=!0:T>0&&(S=!0)}else R!=null?v=!0:S=!0;S?(m(k),k=Oi(A)):v?(y(R),R=Oi(x)):(R=Oi(x),k=Oi(A))}}(s,i,Ur,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),O.waitFor(o)}yn(e){let t=1;return Fi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Ur(o,a)).filter((o,a,u)=>!a||Ur(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Ur(o,e),u=Ur(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&u<0)s.push(o),s.push(o.Zt());else if(u>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Pc,[]],u=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Pc,[]];i.push(IDBKeyRange.bound(a,u))}return i}Cn(e,t){return Ur(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(o0)}getMinOffset(e,t){return O.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||se())).next(o0)}}function i0(n){return Tt(n,"collectionParents")}function Li(n){return Tt(n,"indexEntries")}function Ia(n){return Tt(n,"indexConfiguration")}function Fi(n){return Tt(n,"indexState")}function o0(n){ue(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;_m(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new yn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Zt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Zt(e,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.J({range:o},(f,m,y)=>(a++,y.delete()));i.push(u.next(()=>{ue(a===1)}));const d=[];for(const f of t.mutations){const m=oI(e,f.key.path,t.batchId);i.push(s.delete(m)),d.push(f.key)}return O.waitFor(i).next(()=>d)}function Ku(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw se();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt.DEFAULT_COLLECTION_PERCENTILE=10,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zt.DEFAULT=new Zt(41943040,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zt.DISABLED=new Zt(-1,0,0);class Rd{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){ue(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Rd(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zr(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=Ki(e),o=zr(e);return o.add({}).next(a=>{ue(typeof a=="number");const u=new km(a,t,r,s),d=function(x,A,R){const k=R.baseMutations.map(v=>$u(x.ct,v)),S=R.mutations.map(v=>$u(x.ct,v));return{userId:A,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:k,mutations:S}}(this.serializer,this.userId,u),f=[];let m=new Ue((y,x)=>xe(y.canonicalString(),x.canonicalString()));for(const y of s){const x=oI(this.userId,y.key.path,a);m=m.add(y.key.path.popLast()),f.push(o.put(d)),f.push(i.put(x,KC))}return m.forEach(y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),O.waitFor(f).next(()=>u)})}lookupMutationBatch(e,t){return zr(e).get(t).next(r=>r?(ue(r.userId===this.userId),Ws(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?O.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return zr(e).J({index:"userMutationsIndex",range:s},(o,a,u)=>{a.userId===this.userId&&(ue(a.batchId>=r),i=Ws(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return zr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zr(e).U("userMutationsIndex",t).next(r=>r.map(s=>Ws(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=tu(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Ki(e).J({range:s},(o,a,u)=>{const[d,f,m]=o,y=Qn(f);if(d===this.userId&&t.path.isEqual(y))return zr(e).get(m).next(x=>{if(!x)throw se();ue(x.userId===this.userId),i.push(Ws(this.serializer,x))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(xe);const s=[];return t.forEach(i=>{const o=tu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=Ki(e).J({range:a},(d,f,m)=>{const[y,x,A]=d,R=Qn(x);y===this.userId&&i.path.isEqual(R)?r=r.add(A):m.done()});s.push(u)}),O.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=tu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ue(xe);return Ki(e).J({range:o},(u,d,f)=>{const[m,y,x]=u,A=Qn(y);m===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(x)):f.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(zr(e).get(i).next(o=>{if(o===null)throw se();ue(o.userId===this.userId),r.push(Ws(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return sE(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ki(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=Qn(i[1]);s.push(u)}else a.done()}).next(()=>{ue(s.length===0)})})}containsKey(e,t){return iE(e,this.userId,t)}Nn(e){return oE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function iE(n,e,t){const r=tu(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ki(n).J({range:i,H:!0},(a,u,d)=>{const[f,m,y]=a;f===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function zr(n){return Tt(n,"mutations")}function Ki(n){return Tt(n,"documentMutations")}function oE(n){return Tt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new yi(0)}static kn(){return new yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new yi(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>fe.fromTimestamp(new st(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ui(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ue(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Ui(e).J((o,a)=>{const u=Pa(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Ui(e).J((r,s)=>{const i=Pa(s);t(i)})}qn(e){return l0(e).get("targetGlobalKey").next(t=>(ue(t!==null),t))}Qn(e,t){return l0(e).put("targetGlobalKey",t)}Kn(e,t){return Ui(e).put(eE(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=pi(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ui(e).J({range:s,index:"queryTargetsIndex"},(o,a,u)=>{const d=Pa(a);Ll(t,d.target)&&(i=d,u.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=Jr(e);return t.forEach(o=>{const a=Ht(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,t,r){const s=Jr(e);return O.forEach(t,i=>{const o=Ht(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=Jr(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Jr(e);let i=we();return s.J({range:r,H:!0},(o,a,u)=>{const d=Qn(o[1]),f=new Z(d);i=i.add(f)}).next(()=>i)}containsKey(e,t){const r=Ht(t.path),s=IDBKeyRange.bound([r],[Zw(r)],!1,!0);let i=0;return Jr(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],u,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,t){return Ui(e).get(t).next(r=>r?Pa(r):null)}}function Ui(n){return Tt(n,"targets")}function l0(n){return Tt(n,"targetGlobal")}function Jr(n){return Tt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0([n,e],[t,r]){const s=xe(n,t);return s===0?xe(e,r):s}class uR{constructor(e){this.Un=e,this.buffer=new Ue(c0),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();c0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dR{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ks(t)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ns(t)}await this.Hn(3e5)})}}class hR{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return O.resolve(nn.oe);const r=new uR(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(a0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),a0):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,t))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Bi()<=Ne.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function fR(n,e){return new hR(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,t){this.db=e,this.garbageCollector=fR(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Dc(e,r)}removeReference(e,t,r){return Dc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Dc(e,t)}nr(e,t){return function(s,i){let o=!1;return oE(s).Y(a=>iE(s,a,i).next(u=>(u&&(o=!0),O.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const u=this.nr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,fe.min()),Jr(e).delete(function(m){return[0,Ht(m.path)]}(o))))});s.push(u)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Dc(e,t)}tr(e,t){const r=Jr(e);let s,i=nn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:d})=>{o===0?(i!==nn.oe&&t(new Z(Qn(s)),i),i=d,s=u):i=nn.oe}).next(()=>{i!==nn.oe&&t(new Z(Qn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Dc(n,e){return Jr(n).put(function(r,s){return{targetId:0,path:Ht(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(){this.changes=new Cs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Bs(e).put(r)}removeEntry(e,t,r){return Bs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],qu(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=dt.newInvalidDocument(t);return Bs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ea(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:dt.newInvalidDocument(t)};return Bs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ea(t))},(s,i)=>{r={document:this.ir(t,i),size:Ku(i)}}).next(()=>r)}getEntries(e,t){let r=hn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=hn(),s=new Ge(Z.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Ku(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return O.resolve();let s=new Ue(h0);t.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(Ea(s.first()),Ea(s.last())),o=s.getIterator();let a=o.getNext();return Bs(e).J({index:"documentKeyIndex",range:i},(u,d,f)=>{const m=Z.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&h0(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?f.$(Ea(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),qu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Bs(e).U(IDBKeyRange.bound(a,u,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let f=hn();for(const m of d){const y=this.ir(Z.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(Fl(t,y)||s.has(y.key))&&(f=f.insert(y.key,y))}return f})}getAllFromCollectionGroup(e,t,r,s){let i=hn();const o=d0(t,r),a=d0(t,yn.max());return Bs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,d,f)=>{const m=this.ir(Z.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&f.done()}).next(()=>i)}newChangeBuffer(e){return new gR(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return u0(e).get("remoteDocumentGlobalKey").next(t=>(ue(!!t),t))}rr(e,t){return u0(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=ZA(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(fe.min())))return r}return dt.newInvalidDocument(e)}}function lE(n){return new mR(n)}class gR extends aE{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Cs(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new Ue((i,o)=>xe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=Yv(this.cr.serializer,o);s=s.add(i.path.popLast());const d=Ku(u);r+=d-a.size,t.push(this.cr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=Yv(this.cr.serializer,o.convertToNoDocument(fe.min()));t.push(this.cr.addEntry(e,i,u))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),O.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function u0(n){return Tt(n,"remoteDocumentGlobal")}function Bs(n){return Tt(n,"remoteDocumentsV14")}function Ea(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function d0(n,e){const t=e.documentKey.path.toArray();return[n,qu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function h0(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=xe(t[i],r[i]),s)return s;return s=xe(t.length,r.length),s||(s=xe(t[t.length-2],r[r.length-2]),s||xe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Wa(r.mutation,s,rn.empty(),st.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,t,r=we()){const s=Yn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Aa();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Yn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,we()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=hn();const o=Ha(),a=function(){return Ha()}();return t.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Cr)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),Wa(f.mutation,d,f.mutation.getFieldMask(),st.now())):o.set(d.key,rn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),t.forEach((d,f)=>{var m;return a.set(d,new yR(f,(m=o.get(d))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Ha();let s=new Ge((o,a)=>o-a),i=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const d=t.get(u);if(d===null)return;let f=r.get(u)||rn.empty();f=a.applyToLocalView(d,f),r.set(u,f);const m=(s.get(a.batchId)||we()).add(u);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),d=u.key,f=u.value,m=kI();f.forEach(y=>{if(!i.has(y)){const x=MI(t.get(y),r.get(y));x!==null&&m.set(y,x),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return Z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):IA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):O.resolve(Yn());let a=-1,u=i;return o.next(d=>O.forEach(d,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(f)?O.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{u=u.insert(f,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,we())).next(f=>({batchId:a,changes:NI(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Z(t)).next(r=>{let s=Aa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Aa();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,u=>{const d=function(m,y){return new Sd(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,y)=>{o=o.insert(m,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,dt.newInvalidDocument(f)))});let a=Aa();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Wa(f.mutation,d,rn.empty(),st.now()),Fl(t,d)&&(a=a.insert(u,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return O.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Wt(s.createTime)}}(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:tE(s.bundledQuery),readTime:Wt(s.readTime)}}(t)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(){this.overlays=new Ge(Z.comparator),this.Ir=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Yn();return O.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),O.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){const s=Yn(),i=t.length+1,o=new Z(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return O.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ge((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Yn(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const a=Yn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>a.set(d,f)),!(a.size()>=s)););return O.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Am(t,r));let i=this.Ir.get(t);i===void 0&&(i=we(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(){this.Tr=new Ue(St.Er),this.dr=new Ue(St.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new St(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new St(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Z(new Me([])),r=new St(t,e),s=new St(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Z(new Me([])),r=new St(t,e),s=new St(t,e+1);let i=we();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new St(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class St{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Z.comparator(e.key,t.key)||xe(e.wr,t.wr)}static Ar(e,t){return xe(e.wr,t.wr)||Z.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ue(St.Er)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new km(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new St(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,t){return O.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new St(t,0),s=new St(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(xe);return t.forEach(s=>{const i=new St(s,0),o=new St(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),O.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Z.isDocumentKey(i)||(i=i.child(""));const o=new St(new Z(i),0);let a=new Ue(xe);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(u.wr)),!0)},o),O.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ue(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return O.forEach(t.mutations,s=>{const i=new St(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new St(t,0),s=this.br.firstAfterOrEqual(r);return O.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.Mr=e,this.docs=function(){return new Ge(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(t))}getEntries(e,t){let r=hn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():dt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=hn();const o=t.path,a=new Z(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||_m(tI(f),r)<=0||(s.has(f.key)||Fl(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,t,r,s){se()}Or(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ER(this)}getSize(e){return O.resolve(this.size)}}class ER extends aE{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e){this.persistence=e,this.Nr=new Cs(t=>pi(t),Ll),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vm,this.targetCount=0,this.kr=yi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),O.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new yi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Kn(t),O.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),O.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,t){this.qr={},this.overlays={},this.Qr=new nn(0),this.Kr=!1,this.Kr=!0,this.$r=new xR,this.referenceDelegate=e(this),this.Ur=new TR(this),this.indexManager=new aR,this.remoteDocumentCache=function(s){return new IR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ZI(t),this.Gr=new vR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _R,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new wR(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("MemoryPersistence","Starting transaction:",e);const s=new SR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return O.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class SR extends rI{constructor(e){super(),this.currentSequenceNumber=e}}class Pd{constructor(e){this.persistence=e,this.Jr=new Vm,this.Yr=null}static Zr(e){return new Pd(e)}get Xr(){if(this.Yr)return this.Yr;throw se()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),O.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Xr,r=>{const s=Z.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,fe.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return O.or([()=>O.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Id("createOrUpgrade",t);r<1&&s>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bv,{unique:!0}),u.createObjectStore("documentMutations")}(e),f0(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),f0(e)),o=o.next(()=>function(u){const d=u.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",f)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,d){return d.store("mutations").U().next(f=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bv,{unique:!0});const m=d.store("mutations"),y=f.map(x=>m.put(x));return O.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const d=u.createObjectStore("documentOverlays",{keyPath:sA});d.createIndex("collectionPathOverlayIndex",iA,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",oA,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const d=u.createObjectStore("remoteDocumentsV14",{keyPath:HC});d.createIndex("documentKeyIndex",WC),d.createIndex("collectionGroupIndex",QC)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:eA}).createIndex("sequenceNumberIndex",tA,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:nA}).createIndex("documentKeyIndex",rA,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Ku(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>O.forEach(a,u=>{ue(u.userId===i.userId);const d=Ws(this.serializer,u);return sE(e,i.userId,d).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const u=new Me(o),d=function(m){return[0,Ht(m)]}(u);i.push(t.get(d).next(f=>f?O.resolve():(m=>t.put({targetId:0,path:Ht(m),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>O.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:ZC});const r=t.store("collectionParents"),s=new jm,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ht(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new Me(o);return i(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],d)=>{const f=Qn(a);return i(f.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Pa(s),o=eE(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),u=function(m){return m.document?new Z(Me.fromString(m.document.name).popFirst(5)):m.noDocument?Z.fromSegments(m.noDocument.path):m.unknownDocument?Z.fromSegments(m.unknownDocument.path):se()}(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=lE(this.serializer),i=new uE(Pd.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var d;let f=(d=a.get(u.userId))!==null&&d!==void 0?d:we();Ws(this.serializer,u).keys().forEach(m=>f=f.add(m)),a.set(u.userId,f)}),O.forEach(a,(u,d)=>{const f=new Ut(d),m=Ad.lt(this.serializer,f),y=i.getIndexManager(f),x=Rd.lt(f,this.serializer,y,i.referenceDelegate);return new cE(s,x,m,y).recalculateAndSaveOverlaysForDocumentKeys(new qf(t,nn.oe),u).next()})})}}function f0(n){n.createObjectStore("targetDocuments",{keyPath:JC}).createIndex("documentTargetsIndex",XC,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",YC,{unique:!0}),n.createObjectStore("targetGlobal")}const Dh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Mm{constructor(e,t,r,s,i,o,a,u,d,f,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=d,this.li=f,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=y=>Promise.resolve(),!Mm.D())throw new ee(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pR(this,s),this.Ai=t+"main",this.serializer=new ZI(u),this.Ri=new ps(this.Ai,this.hi,new bR(this.serializer)),this.$r=new tR,this.Ur=new cR(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lE(this.serializer),this.Gr=new eR,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,f===!1&&ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ee(B.FAILED_PRECONDITION,Dh);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new nn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(ks(e))return q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ta(e).get("owner").next(t=>O.resolve(this.vi(t)))}Ci(e){return jc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Tt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?O.resolve(!0):Ta(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ee(B.FAILED_PRECONDITION,Dh);return!1}}return!(!this.networkEnabled||!this.inForeground)||jc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&q("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new qf(e,nn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>jc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Rd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lR(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ad.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(u){return u===17?cA:u===16?lA:u===15?wm:u===14?cI:u===13?lI:u===12?aA:u===11?aI:void se()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new qf(a,this.Qr?this.Qr.next():nn.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ee(B.FAILED_PRECONDITION,nI);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Ta(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ee(B.FAILED_PRECONDITION,Dh)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ta(e).put("owner",t)}static D(){return ps.D()}bi(e){const t=Ta(e);return t.get("owner").next(r=>this.vi(r)?(q("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):O.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(ft(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;iw()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ft("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ta(n){return Tt(n,"owner")}function jc(n){return Tt(n,"clientMetadata")}function dE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=we(),s=we();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Om(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return iw()?8:sI(Et())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NR;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Bi()<=Ne.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",$i(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),O.resolve()):(Bi()<=Ne.DEBUG&&q("QueryEngine","Query:",$i(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Bi()<=Ne.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",$i(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(t))):O.resolve())}Yi(e,t){if(Fv(t))return O.resolve(null);let r=pn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Yf(t,null,"F"),r=pn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=we(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(t,a);return this.ns(t,d,o,u.readTime)?this.Yi(e,Yf(t,null,"F")):this.rs(e,d,t,u)}))})))}Zi(e,t,r,s){return Fv(t)||s.isEqual(fe.min())?O.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?O.resolve(null):(Bi()<=Ne.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$i(t)),this.rs(e,o,t,eI(s,-1)).next(a=>a))})}ts(e,t){let r=new Ue(SI(e));return t.forEach((s,i)=>{Fl(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Bi()<=Ne.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",$i(t)),this.Ji.getDocumentsMatchingQuery(e,t,yn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Ge(xe),this._s=new Cs(i=>pi(i),Ll),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function fE(n,e,t,r){return new kR(n,e,t,r)}async function pE(n,e){const t=ae(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=we();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:a}))})})}function CR(n,e){const t=ae(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,d,f){const m=d.batch,y=m.keys();let x=O.resolve();return y.forEach(A=>{x=x.next(()=>f.getEntry(u,A)).next(R=>{const k=d.docVersions.get(A);ue(k!==null),R.version.compareTo(k)<0&&(m.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),f.addEntry(R)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(u,m))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=we();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(u=u.add(a.batch.mutations[d].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function mE(n){const e=ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function AR(n,e){const t=ae(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((f,m)=>{const y=s.get(m);if(!y)return;a.push(t.Ur.removeMatchingKeys(i,f.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(i,f.addedDocuments,m)));let x=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(mt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):f.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(f.resumeToken,r)),s=s.insert(m,x),function(R,k,S){return R.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(y,x,f)&&a.push(t.Ur.updateTargetData(i,x))});let u=hn(),d=we();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))}),a.push(RR(i,o,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(fe.min())){const f=t.Ur.getLastRemoteSnapshotVersion(i).next(m=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(f)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(t.os=s,i))}function RR(n,e,t){let r=we(),s=we();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=hn();return t.forEach((a,u)=>{const d=i.get(a);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(fe.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function PR(n,e){const t=ae(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Hu(n,e){const t=ae(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new gr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function jo(n,e,t){const r=ae(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ks(o))throw o;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function sp(n,e,t){const r=ae(n);let s=fe.min(),i=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const m=ae(u),y=m._s.get(f);return y!==void 0?O.resolve(m.os.get(y)):m.Ur.getTargetData(d,f)}(r,o,pn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:fe.min(),t?i:we())).next(a=>(vE(r,TI(e),a),{documents:a,Ts:i})))}function gE(n,e){const t=ae(n),r=ae(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function yE(n,e){const t=ae(n),r=t.us.get(e)||fe.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.cs.getAllFromCollectionGroup(s,e,eI(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(vE(t,e,s),s))}function vE(n,e,t){let r=n.us.get(e)||fe.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}function p0(n,e){return`firestore_clients_${n}_${e}`}function m0(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function jh(n,e){return`firestore_targets_${n}_${e}`}class Wu{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Rs(e,t,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new ee(s.error.code,s.error.message))),o?new Wu(e,t,s.state,i):(ft("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qa{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new ee(r.error.code,r.error.message))),i?new Qa(e,r.state,s):(ft("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=bm();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=iI(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Qu(e,i):(ft("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Lm{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Lm(t.clientId,t.onlineState):(ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ip{constructor(){this.activeTargetIds=bm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Vh{constructor(e,t,r,s,i){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ge(xe),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=p0(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ip),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(p0(this.persistenceKey,r));if(s){const i=Qu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(jh(this.persistenceKey,e));if(s){const i=Qa.Rs(e,s);i&&(r=i.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(jh(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return q("SharedClientState","READ",e,t),t}setItem(e,t){q("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){q("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(q("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(i){let o=nn.oe;if(i!=null)try{const a=JSON.parse(i);ue(typeof a=="number"),o=a}catch(a){ft("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==nn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const s=new Wu(this.currentUser,e,t,r),i=m0(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const t=m0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const s=jh(this.persistenceKey,e),i=new Qa(e,t,r);this.setItem(s,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Qu.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Wu.Rs(new Ut(i),s,t)}Ys(e,t){const r=this.Ms.exec(e),s=Number(r[1]);return Qa.Rs(s,t)}Ls(e){return Lm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);q("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{i.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=bm();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class _E{constructor(){this.so=new ip,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ip,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vc=null;function Mh(){return Vc===null?Vc=function(){return 268435456+Math.round(2147483648*Math.random())}():Vc++,"0x"+Vc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft="WebChannelConnection";class MR extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Mh(),u=this.xo(t,r.toUriEncodedString());q("RestConnection",`Sending RPC '${t}' ${a}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(t,u,d,s).then(f=>(q("RestConnection",`Received RPC '${t}' ${a}: `,f),f),f=>{throw yl("RestConnection",`RPC '${t}' ${a} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ho}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=jR[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Mh();return new Promise((o,a)=>{const u=new Hw;u.setWithCredentials(!0),u.listenOnce(Ww.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Zc.NO_ERROR:const f=u.getResponseJson();q(Ft,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),o(f);break;case Zc.TIMEOUT:q(Ft,`RPC '${e}' ${i} timed out`),a(new ee(B.DEADLINE_EXCEEDED,"Request time out"));break;case Zc.HTTP_ERROR:const m=u.getStatus();if(q(Ft,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y==null?void 0:y.error;if(x&&x.status&&x.message){const A=function(k){const S=k.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(S)>=0?S:B.UNKNOWN}(x.status);a(new ee(A,x.message))}else a(new ee(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new ee(B.UNAVAILABLE,"Connection failed."));break;default:se()}}finally{q(Ft,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);q(Ft,`RPC '${e}' ${i} sending request:`,s),u.send(t,"POST",d,r,15)})}Bo(e,t,r){const s=Mh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jw(),a=Yw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const f=i.join("");q(Ft,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=o.createWebChannel(f,u);let y=!1,x=!1;const A=new VR({Io:k=>{x?q(Ft,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(y||(q(Ft,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),q(Ft,`RPC '${e}' stream ${s} sending:`,k),m.send(k))},To:()=>m.close()}),R=(k,S,v)=>{k.listen(S,T=>{try{v(T)}catch(I){setTimeout(()=>{throw I},0)}})};return R(m,Ca.EventType.OPEN,()=>{x||(q(Ft,`RPC '${e}' stream ${s} transport opened.`),A.yo())}),R(m,Ca.EventType.CLOSE,()=>{x||(x=!0,q(Ft,`RPC '${e}' stream ${s} transport closed`),A.So())}),R(m,Ca.EventType.ERROR,k=>{x||(x=!0,yl(Ft,`RPC '${e}' stream ${s} transport errored:`,k),A.So(new ee(B.UNAVAILABLE,"The operation could not be completed")))}),R(m,Ca.EventType.MESSAGE,k=>{var S;if(!x){const v=k.data[0];ue(!!v);const T=v,I=T.error||((S=T[0])===null||S===void 0?void 0:S.error);if(I){q(Ft,`RPC '${e}' stream ${s} received error:`,I);const D=I.status;let P=function(_){const b=yt[_];if(b!==void 0)return FI(b)}(D),w=I.message;P===void 0&&(P=B.INTERNAL,w="Unknown error status: "+D+" with message "+I.message),x=!0,A.So(new ee(P,w)),m.close()}else q(Ft,`RPC '${e}' stream ${s} received:`,v),A.bo(v)}}),R(a,Qw.STAT_EVENT,k=>{k.stat===Bf.PROXY?q(Ft,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===Bf.NOPROXY&&q(Ft,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(){return typeof window<"u"?window:null}function ou(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(n){return new $A(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e,t,r,s,i,o,a,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new wE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(ft(t.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new ee(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OR extends IE{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=KA(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?Wt(o.readTime):fe.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Zf(this.serializer),t.addTarget=function(i,o){let a;const u=o.target;if(a=Uu(u)?{documents:HI(i,u)}:{query:WI(i,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=BI(i,o.resumeToken);const d=Jf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=Do(i,o.snapshotVersion.toTimestamp());const d=Jf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=WA(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Zf(this.serializer),t.removeTarget=e,this.a_(t)}}class LR extends IE{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ue(!!e.streamToken),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=HA(e.writeResults,e.commitTime),r=Wt(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Zf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>$u(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ee(B.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Xf(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ee(B.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Xf(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ee(B.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class UR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ft(t),this.D_=!1):q("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ii(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ae(u);d.L_.add(4),await $l(d),d.q_.set("Unknown"),d.L_.delete(4),await jd(d)}(this))})}),this.q_=new UR(r,s)}}async function jd(n){if(Ii(n))for(const e of n.B_)await e(!0)}async function $l(n){for(const e of n.B_)await e(!1)}function Vd(n,e){const t=ae(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),zm(t)?Um(t):Yo(t).r_()&&Fm(t,e))}function Vo(n,e){const t=ae(n),r=Yo(t);t.N_.delete(e),r.r_()&&EE(t,e),t.N_.size===0&&(r.r_()?r.o_():Ii(t)&&t.q_.set("Unknown"))}function Fm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yo(n).A_(e)}function EE(n,e){n.Q_.xe(e),Yo(n).R_(e)}function Um(n){n.Q_=new FA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Yo(n).start(),n.q_.v_()}function zm(n){return Ii(n)&&!Yo(n).n_()&&n.N_.size>0}function Ii(n){return ae(n).L_.size===0}function TE(n){n.Q_=void 0}async function BR(n){n.q_.set("Online")}async function $R(n){n.N_.forEach((e,t)=>{Fm(n,e)})}async function qR(n,e){TE(n),zm(n)?(n.q_.M_(e),Um(n)):n.q_.set("Unknown")}async function GR(n,e,t){if(n.q_.set("Online"),e instanceof zI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Yu(n,r)}else if(e instanceof iu?n.Q_.Ke(e):e instanceof UI?n.Q_.He(e):n.Q_.We(e),!t.isEqual(fe.min()))try{const r=await mE(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(mt.EMPTY_BYTE_STRING,f.snapshotVersion)),EE(i,u);const m=new gr(f.target,u,d,f.sequenceNumber);Fm(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){q("RemoteStore","Failed to raise snapshot:",r),await Yu(n,r)}}async function Yu(n,e,t){if(!ks(e))throw e;n.L_.add(1),await $l(n),n.q_.set("Offline"),t||(t=()=>mE(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await jd(n)})}function SE(n,e){return e().catch(t=>Yu(n,t,e))}async function Qo(n){const e=ae(n),t=Es(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;KR(e);)try{const s=await PR(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,HR(e,s)}catch(s){await Yu(e,s)}bE(e)&&NE(e)}function KR(n){return Ii(n)&&n.O_.length<10}function HR(n,e){n.O_.push(e);const t=Es(n);t.r_()&&t.V_&&t.m_(e.mutations)}function bE(n){return Ii(n)&&!Es(n).n_()&&n.O_.length>0}function NE(n){Es(n).start()}async function WR(n){Es(n).p_()}async function QR(n){const e=Es(n);for(const t of n.O_)e.m_(t.mutations)}async function YR(n,e,t){const r=n.O_.shift(),s=Cm.from(r,e,t);await SE(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Qo(n)}async function JR(n,e){e&&Es(n).V_&&await async function(r,s){if(function(o){return MA(o)&&o!==B.ABORTED}(s.code)){const i=r.O_.shift();Es(r).s_(),await SE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Qo(r)}}(n,e),bE(n)&&NE(n)}async function y0(n,e){const t=ae(n);t.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const r=Ii(t);t.L_.add(3),await $l(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await jd(t)}async function op(n,e){const t=ae(n);e?(t.L_.delete(2),await jd(t)):e||(t.L_.add(2),await $l(t),t.q_.set("Unknown"))}function Yo(n){return n.K_||(n.K_=function(t,r,s){const i=ae(t);return i.w_(),new OR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:BR.bind(null,n),Ro:$R.bind(null,n),mo:qR.bind(null,n),d_:GR.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),zm(n)?Um(n):n.q_.set("Unknown")):(await n.K_.stop(),TE(n))})),n.K_}function Es(n){return n.U_||(n.U_=function(t,r,s){const i=ae(t);return i.w_(),new LR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:WR.bind(null,n),mo:JR.bind(null,n),f_:QR.bind(null,n),g_:YR.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Qo(n)):(await n.U_.stop(),n.O_.length>0&&(q("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Bm(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ee(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $m(n,e){if(ft("AsyncQueue",`${e}: ${n}`),ks(n))return new ee(B.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Z.comparator(t.key,r.key):(t,r)=>Z.comparator(t.key,r.key),this.keyedMap=Aa(),this.sortedSet=new Ge(this.comparator)}static emptySet(e){return new yo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof yo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new yo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(){this.W_=new Ge(Z.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):se():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Mo{constructor(e,t,r,s,i,o,a,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Mo(e,t,yo.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ZR{constructor(){this.queries=_0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=ae(t),i=s.queries;s.queries=_0(),i.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new ee(B.ABORTED,"Firestore shutting down"))}}function _0(){return new Cs(n=>EI(n),Nd)}async function eP(n,e){const t=ae(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new XR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=$m(o,`Initialization of query '${$i(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&qm(t)}async function tP(n,e){const t=ae(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function nP(n,e){const t=ae(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&qm(t)}function rP(n,e,t){const r=ae(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function qm(n){n.Y_.forEach(e=>{e.next()})}var ap,x0;(x0=ap||(ap={})).ea="default",x0.Cache="cache";class sP{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Mo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ap.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.key=e}}class CE{constructor(e){this.key=e}}class iP{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=SI(e),this.Ra=new yo(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new v0,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const y=s.get(f),x=Fl(this.query,m)?m:null,A=!!y&&this.mutatedKeys.has(y.key),R=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let k=!1;y&&x?y.data.isEqual(x.data)?A!==R&&(r.track({type:3,doc:x}),k=!0):this.ga(y,x)||(r.track({type:2,doc:x}),k=!0,(u&&this.Aa(x,u)>0||d&&this.Aa(x,d)<0)&&(a=!0)):!y&&x?(r.track({type:0,doc:x}),k=!0):y&&!x&&(r.track({type:1,doc:y}),k=!0,(u||d)&&(a=!0)),k&&(x?(o=o.add(x),i=R?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,m)=>function(x,A){const R=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se()}};return R(x)-R(A)}(f.type,m.type)||this.Aa(f.doc,m.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Mo(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new v0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new CE(r))}),this.da.forEach(r=>{e.has(r)||t.push(new kE(r))}),t}ba(e){this.Ta=e.Ts,this.da=we();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Mo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class oP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class aP{constructor(e){this.key=e,this.va=!1}}class lP{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Cs(a=>EI(a),Nd),this.Ma=new Map,this.xa=new Set,this.Oa=new Ge(Z.comparator),this.Na=new Map,this.La=new Vm,this.Ba={},this.ka=new Map,this.qa=yi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function cP(n,e,t=!0){const r=Md(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await AE(r,e,t,!0),s}async function uP(n,e){const t=Md(n);await AE(t,e,!0,!1)}async function AE(n,e,t,r){const s=await Hu(n.localStore,pn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await Gm(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Vd(n.remoteStore,s),a}async function Gm(n,e,t,r,s){n.Ka=(m,y,x)=>async function(R,k,S,v){let T=k.view.ma(S);T.ns&&(T=await sp(R.localStore,k.query,!1).then(({documents:w})=>k.view.ma(w,T)));const I=v&&v.targetChanges.get(k.targetId),D=v&&v.targetMismatches.get(k.targetId)!=null,P=k.view.applyChanges(T,R.isPrimaryClient,I,D);return lp(R,k.targetId,P.wa),P.snapshot}(n,m,y,x);const i=await sp(n.localStore,e,!0),o=new iP(e,i.Ts),a=o.ma(i.documents),u=Bl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),d=o.applyChanges(a,n.isPrimaryClient,u);lp(n,t,d.wa);const f=new oP(e,t,o);return n.Fa.set(e,f),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot}async function dP(n,e,t){const r=ae(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Nd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await jo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Vo(r.remoteStore,s.targetId),Oo(r,s.targetId)}).catch(Ns)):(Oo(r,s.targetId),await jo(r.localStore,s.targetId,!0))}async function hP(n,e){const t=ae(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Vo(t.remoteStore,r.targetId))}async function fP(n,e,t){const r=Qm(n);try{const s=await function(o,a){const u=ae(o),d=st.now(),f=a.reduce((x,A)=>x.add(A.key),we());let m,y;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let A=hn(),R=we();return u.cs.getEntries(x,f).next(k=>{A=k,A.forEach((S,v)=>{v.isValidDocument()||(R=R.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,A)).next(k=>{m=k;const S=[];for(const v of a){const T=jA(v,m.get(v.key).overlayedDocument);T!=null&&S.push(new Cr(v.key,T,pI(T.value.mapValue),Nt.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,S,a)}).next(k=>{y=k;const S=k.applyToLocalDocumentSet(m,R);return u.documentOverlayCache.saveOverlays(x,k.batchId,S)})}).then(()=>({batchId:y.batchId,changes:NI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Ge(xe)),d=d.insert(a,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,t),await As(r,s.changes),await Qo(r.remoteStore)}catch(s){const i=$m(s,"Failed to persist write");t.reject(i)}}async function RE(n,e){const t=ae(n);try{const r=await AR(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ue(o.va):s.removedDocuments.size>0&&(ue(o.va),o.va=!1))}),await As(t,r,e)}catch(r){await Ns(r)}}function w0(n,e,t){const r=ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=ae(o);u.onlineState=a;let d=!1;u.queries.forEach((f,m)=>{for(const y of m.j_)y.Z_(a)&&(d=!0)}),d&&qm(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pP(n,e,t){const r=ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Ge(Z.comparator);o=o.insert(i,dt.newNoDocument(i,fe.min()));const a=we().add(i),u=new zl(fe.min(),new Map,new Ge(xe),o,a);await RE(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Wm(r)}else await jo(r.localStore,e,!1).then(()=>Oo(r,e,t)).catch(Ns)}async function mP(n,e){const t=ae(n),r=e.batch.batchId;try{const s=await CR(t.localStore,e);Hm(t,r,null),Km(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await As(t,s)}catch(s){await Ns(s)}}async function gP(n,e,t){const r=ae(n);try{const s=await function(o,a){const u=ae(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,a).next(m=>(ue(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);Hm(r,e,t),Km(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await As(r,s)}catch(s){await Ns(s)}}function Km(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Hm(n,e,t){const r=ae(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Oo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||PE(n,r)})}function PE(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Vo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Wm(n))}function lp(n,e,t){for(const r of t)r instanceof kE?(n.La.addReference(r.key,e),yP(n,r)):r instanceof CE?(q("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||PE(n,r.key)):se()}function yP(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(q("SyncEngine","New document in limbo: "+t),n.xa.add(r),Wm(n))}function Wm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Z(Me.fromString(e)),r=n.qa.next();n.Na.set(r,new aP(t)),n.Oa=n.Oa.insert(t,r),Vd(n.remoteStore,new gr(pn(bd(t.path)),r,"TargetPurposeLimboResolution",nn.oe))}}async function As(n,e,t){const r=ae(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(d=>{var f;if((d||t)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=t==null?void 0:t.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Om.Wi(u.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const f=ae(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(d,y=>O.forEach(y.$i,x=>f.persistence.referenceDelegate.addReference(m,y.targetId,x)).next(()=>O.forEach(y.Ui,x=>f.persistence.referenceDelegate.removeReference(m,y.targetId,x)))))}catch(m){if(!ks(m))throw m;q("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const y=m.targetId;if(!m.fromCache){const x=f.os.get(y),A=x.snapshotVersion,R=x.withLastLimboFreeSnapshotVersion(A);f.os=f.os.insert(y,R)}}}(r.localStore,i))}async function vP(n,e){const t=ae(n);if(!t.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const r=await pE(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(u=>{u.reject(new ee(B.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await As(t,r.hs)}}function _P(n,e){const t=ae(n),r=t.Na.get(e);if(r&&r.va)return we().add(r.key);{let s=we();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function xP(n,e){const t=ae(n),r=await sp(t.localStore,e.query,!0),s=e.view.ba(r);return t.isPrimaryClient&&lp(t,e.targetId,s.wa),s}async function wP(n,e){const t=ae(n);return yE(t.localStore,e).then(r=>As(t,r))}async function IP(n,e,t,r){const s=ae(n),i=await function(a,u){const d=ae(a),f=ae(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>f.Mn(m,u).next(y=>y?d.localDocuments.getDocuments(m,y):O.resolve(null)))}(s.localStore,e);i!==null?(t==="pending"?await Qo(s.remoteStore):t==="acknowledged"||t==="rejected"?(Hm(s,e,r||null),Km(s,e),function(a,u){ae(ae(a).mutationQueue).On(u)}(s.localStore,e)):se(),await As(s,i)):q("SyncEngine","Cannot apply mutation batch with id: "+e)}async function EP(n,e){const t=ae(n);if(Md(t),Qm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await I0(t,r.toArray());t.Qa=!0,await op(t.remoteStore,!0);for(const i of s)Vd(t.remoteStore,i)}else if(e===!1&&t.Qa!==!1){const r=[];let s=Promise.resolve();t.Ma.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Oo(t,o),jo(t.localStore,o,!0))),Vo(t.remoteStore,o)}),await s,await I0(t,r),function(o){const a=ae(o);a.Na.forEach((u,d)=>{Vo(a.remoteStore,d)}),a.La.pr(),a.Na=new Map,a.Oa=new Ge(Z.comparator)}(t),t.Qa=!1,await op(t.remoteStore,!1)}}async function I0(n,e,t){const r=ae(n),s=[],i=[];for(const o of e){let a;const u=r.Ma.get(o);if(u&&u.length!==0){a=await Hu(r.localStore,pn(u[0]));for(const d of u){const f=r.Fa.get(d),m=await xP(r,f);m.snapshot&&i.push(m.snapshot)}}else{const d=await gE(r.localStore,o);a=await Hu(r.localStore,d),await Gm(r,DE(d),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function DE(n){return II(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function TP(n){return function(t){return ae(ae(t).persistence).Qi()}(ae(n).localStore)}async function SP(n,e,t,r){const s=ae(n);if(s.Qa)return void q("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=await yE(s.localStore,TI(i[0])),a=zl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",mt.EMPTY_BYTE_STRING);await As(s,o,a);break}case"rejected":await jo(s.localStore,e,!0),Oo(s,e,r);break;default:se()}}async function bP(n,e,t){const r=Md(n);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){q("SyncEngine","Adding an already active target "+s);continue}const i=await gE(r.localStore,s),o=await Hu(r.localStore,i);await Gm(r,DE(i),o.targetId,!1,o.resumeToken),Vd(r.remoteStore,o)}for(const s of t)r.Ma.has(s)&&await jo(r.localStore,s,!1).then(()=>{Vo(r.remoteStore,s),Oo(r,s)}).catch(Ns)}}function Md(n){const e=ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=RE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_P.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pP.bind(null,e),e.Ca.d_=nP.bind(null,e.eventManager),e.Ca.$a=rP.bind(null,e.eventManager),e}function Qm(n){const e=ae(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gP.bind(null,e),e}class Sl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return fE(this.persistence,new hE,e.initialUser,this.serializer)}Ga(e){return new uE(Pd.Zr,this.serializer)}Wa(e){return new _E}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sl.provider={build:()=>new Sl};class jE extends Sl{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Qm(this.Ja.syncEngine),await Qo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return fE(this.persistence,new hE,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new dR(r,e.asyncQueue,t)}Ha(e,t){const r=new qC(t,this.persistence);return new $C(e.asyncQueue,r)}Ga(e){const t=dE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new Mm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,xE(),ou(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new _E}}class NP extends jE{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Vh&&(this.sharedClientState.syncEngine={no:IP.bind(null,t),ro:SP.bind(null,t),io:bP.bind(null,t),Qi:TP.bind(null,t),eo:wP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await EP(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=xE();if(!Vh.D(t))throw new ee(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=dE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Vh(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class bl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>w0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=vP.bind(null,this.syncEngine),await op(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZR}()}createDatastore(e){const t=Dd(e.databaseInfo.databaseId),r=function(i){return new MR(i)}(e.databaseInfo);return function(i,o,a,u){return new FR(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new zR(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>w0(this.syncEngine,t,0),function(){return g0.D()?new g0:new DR}())}createSyncEngine(e,t){return function(s,i,o,a,u,d,f){const m=new lP(s,i,o,a,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=ae(s);q("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await $l(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}bl.provider={build:()=>new bl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ft("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=Xw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=$m(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Oh(n,e){n.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await pE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function E0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await AP(n);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>y0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>y0(e.remoteStore,s)),n._onlineComponents=e}async function AP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await Oh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;yl("Error using user provided cache. Falling back to memory cache: "+t),await Oh(n,new Sl)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await Oh(n,new Sl);return n._offlineComponents}async function VE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await E0(n,n._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await E0(n,new bl))),n._onlineComponents}function RP(n){return VE(n).then(e=>e.syncEngine)}async function T0(n){const e=await VE(n),t=e.eventManager;return t.onListen=cP.bind(null,e.syncEngine),t.onUnlisten=dP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=hP.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n,e,t){if(!t)throw new ee(B.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PP(n,e,t,r){if(e===!0&&r===!0)throw new ee(B.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function b0(n){if(!Z.isDocumentKey(n))throw new ee(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N0(n){if(Z.isDocumentKey(n))throw new ee(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ym(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":se()}function ms(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ee(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ym(n);throw new ee(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ee(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ee(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ME((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ee(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ee(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ee(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new k0({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ee(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ee(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new k0(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new DC;switch(r.type){case"firstParty":return new MC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ee(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=S0.get(t);r&&(q("ComponentProvider","Removing Datastore"),S0.delete(t),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Od(this.firestore,e,this._query)}}class mn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}}class gs extends Od{constructor(e,t,r){super(e,t,bd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new Z(e))}withConverter(e){return new gs(this.firestore,e,this._path)}}function lt(n,e,...t){if(n=pt(n),OE("collection","path",e),n instanceof Jm){const r=Me.fromString(e,...t);return N0(r),new gs(n,null,r)}{if(!(n instanceof mn||n instanceof gs))throw new ee(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Me.fromString(e,...t));return N0(r),new gs(n.firestore,null,r)}}function Te(n,e,...t){if(n=pt(n),arguments.length===1&&(e=Xw.newId()),OE("doc","path",e),n instanceof Jm){const r=Me.fromString(e,...t);return b0(r),new mn(n,null,new Z(r))}{if(!(n instanceof mn||n instanceof gs))throw new ee(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Me.fromString(e,...t));return b0(r),new mn(n.firestore,n instanceof gs?n.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new wE(this,"async_queue_retry"),this.Vu=()=>{const r=ou();r&&q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=ou();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=ou();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new fs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ks(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ft("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Bm.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&se()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function A0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class vi extends Jm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new C0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new C0(e),this._firestoreClient=void 0,await e}}}function DP(n,e,t){const r=yd(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),i=r.getOptions(t);if(pl(i,e))return s;throw new ee(B.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ee(B.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ee(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function Xm(n){if(n._terminated)throw new ee(B.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||jP(n),n._firestoreClient}function jP(n){var e,t,r;const s=n._freezeSettings(),i=function(a,u,d,f){return new dA(a,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,ME(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new CP(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Lo(mt.fromBase64String(e))}catch(t){throw new ee(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Lo(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ee(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ee(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ee(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=/^__.*__$/;class MP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Cr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wo(e,this.data,t,this.fieldTransforms)}}class LE{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Cr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se()}}class tg{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new tg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ju(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(FE(this.Cu)&&VP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class OP{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Dd(e)}Qu(e,t,r,s=!1){return new tg({Cu:e,methodName:t,qu:r,path:nt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ng(n){const e=n._freezeSettings(),t=Dd(n._databaseId);return new OP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function UE(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);sg("Data must be an object, but it was:",o,r);const a=$E(r,o);let u,d;if(i.merge)u=new rn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const y=cp(e,m,t);if(!o.contains(y))throw new ee(B.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);GE(f,y)||f.push(y)}u=new rn(f),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new MP(new Bt(a),u,d)}class Fd extends Ld{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fd}}class rg extends Ld{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Po(e.serializer,AI(e.serializer,this.$u));return new VI(e.path,t)}isEqual(e){return e instanceof rg&&this.$u===e.$u}}function zE(n,e,t,r){const s=n.Qu(1,e,t);sg("Data must be an object, but it was:",s,r);const i=[],o=Bt.empty();wi(r,(u,d)=>{const f=ig(e,u,t);d=pt(d);const m=s.Nu(f);if(d instanceof Fd)i.push(f);else{const y=Ud(d,m);y!=null&&(i.push(f),o.set(f,y))}});const a=new rn(i);return new LE(o,a,s.fieldTransforms)}function BE(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[cp(e,r,t)],u=[s];if(i.length%2!=0)throw new ee(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)a.push(cp(e,i[y])),u.push(i[y+1]);const d=[],f=Bt.empty();for(let y=a.length-1;y>=0;--y)if(!GE(d,a[y])){const x=a[y];let A=u[y];A=pt(A);const R=o.Nu(x);if(A instanceof Fd)d.push(x);else{const k=Ud(A,R);k!=null&&(d.push(x),f.set(x,k))}}const m=new rn(d);return new LE(f,m,o.fieldTransforms)}function Ud(n,e){if(qE(n=pt(n)))return sg("Unsupported field value:",e,n),$E(n,e);if(n instanceof Ld)return function(r,s){if(!FE(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=Ud(a,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=st.fromDate(r);return{timestampValue:Do(s.serializer,i)}}if(r instanceof st){const i=new st(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Do(s.serializer,i)}}if(r instanceof Zm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Lo)return{bytesValue:BI(s.serializer,r._byteString)};if(r instanceof mn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Pm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof eg)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Nm(a.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ym(r)}`)}(n,e)}function $E(n,e){const t={};return uI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wi(n,(r,s)=>{const i=Ud(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function qE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof st||n instanceof Zm||n instanceof Lo||n instanceof mn||n instanceof Ld||n instanceof eg)}function sg(n,e,t){if(!qE(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Ym(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function cp(n,e,t){if((e=pt(e))instanceof ql)return e._internalPath;if(typeof e=="string")return ig(n,e);throw Ju("Field path arguments must be of type string or ",n,!1,void 0,t)}const LP=new RegExp("[~\\*/\\[\\]]");function ig(n,e,t){if(e.search(LP)>=0)throw Ju(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ql(...e.split("."))._internalPath}catch{throw Ju(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ju(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new ee(B.INVALID_ARGUMENT,a+n+u)}function GE(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new FP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(HE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class FP extends KE{data(){return super.data()}}function HE(n,e){return typeof e=="string"?ig(n,e):e instanceof ql?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ee(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zP{convertValue(e,t="none"){switch(fi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw se()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return wi(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Qe(o.doubleValue));return new eg(i)}convertGeoPoint(e){return new Zm(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Em(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(wl(e));default:return null}}convertTimestamp(e){const t=Nr(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Me.fromString(e);ue(XI(r));const s=new hi(r.get(1),r.get(3)),i=new Z(r.popFirst(5));return s.isEqual(t)||ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class QE extends KE{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new au(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(HE("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class au extends QE{data(e={}){return super.data(e)}}class BP{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Da(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new au(this._firestore,this._userDataWriter,r.key,r,new Da(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ee(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new au(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Da(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new au(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Da(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:$P(a.type),doc:u,oldIndex:d,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function $P(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se()}}class YE extends zP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,t)}}function ct(n,e,t,...r){n=ms(n,mn);const s=ms(n.firestore,vi),i=ng(s);let o;return o=typeof(e=pt(e))=="string"||e instanceof ql?BE(i,"updateDoc",n._key,e,t,r):zE(i,"updateDoc",n._key,e),zd(s,[o.toMutation(n._key,Nt.exists(!0))])}function Mc(n){return zd(ms(n.firestore,vi),[new Ul(n._key,Nt.none())])}function Dn(n,e){const t=ms(n.firestore,vi),r=Te(n),s=WE(n.converter,e);return zd(t,[UE(ng(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Nt.exists(!1))]).then(()=>r)}function Br(n,...e){var t,r,s;n=pt(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||A0(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(A0(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,d,f;if(n instanceof mn)d=ms(n.firestore,vi),f=bd(n._key.path),u={next:m=>{e[o]&&e[o](qP(d,n,m))},error:e[o+1],complete:e[o+2]};else{const m=ms(n,Od);d=ms(m.firestore,vi),f=m._query;const y=new YE(d);u={next:x=>{e[o]&&e[o](new BP(d,y,m,x))},error:e[o+1],complete:e[o+2]},UP(n._query)}return function(y,x,A,R){const k=new kP(R),S=new sP(x,k,A);return y.asyncQueue.enqueueAndForget(async()=>eP(await T0(y),S)),()=>{k.Za(),y.asyncQueue.enqueueAndForget(async()=>tP(await T0(y),S))}}(Xm(d),f,a,u)}function zd(n,e){return function(r,s){const i=new fs;return r.asyncQueue.enqueueAndForget(async()=>fP(await RP(r),s,i)),i.promise}(Xm(n),e)}function qP(n,e,t){const r=t.docs.get(e._key),s=new YE(n);return new QE(n,s,e._key,r,new Da(t.hasPendingWrites,t.fromCache),e.converter)}class GP{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=QP(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function KP(n){return new GP(n)}class HP{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bl.provider,this._offlineComponentProvider={build:t=>new jE(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class WP{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bl.provider,this._offlineComponentProvider={build:t=>new NP(t,e==null?void 0:e.cacheSizeBytes)}}}function QP(n){return new HP(void 0)}function YP(){return new WP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ng(e)}set(e,t,r){this._verifyNotCommitted();const s=Lh(e,this._firestore),i=WE(s.converter,t,r),o=UE(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Nt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=Lh(e,this._firestore);let o;return o=typeof(t=pt(t))=="string"||t instanceof ql?BE(this._dataReader,"WriteBatch.update",i._key,t,r,s):zE(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Nt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Lh(e,this._firestore);return this._mutations=this._mutations.concat(new Ul(t._key,Nt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ee(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Lh(n,e){if((n=pt(n)).firestore!==e)throw new ee(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function ar(n){return new rg("increment",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(n){return Xm(n=ms(n,vi)),new JP(n,e=>zd(n,e))}(function(e,t=!0){(function(s){Ho=s})(Go),ci(new _s("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new vi(new jC(r.getProvider("auth-internal")),new LC(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ee(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hi(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Zn(Ev,"4.7.3",e),Zn(Ev,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP="type.googleapis.com/google.protobuf.Int64Value",ZP="type.googleapis.com/google.protobuf.UInt64Value";function JE(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function up(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>up(e));if(typeof n=="function"||typeof n=="object")return JE(n,e=>up(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Xu(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case XP:case ZP:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Xu(e)):typeof n=="function"||typeof n=="object"?JE(n,e=>Xu(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vo extends rr{constructor(e,t,r){super(`${og}/${e}`,t||""),this.details=r}}function e2(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function t2(n,e){let t=e2(n),r=t,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!R0[o])return new vo("internal","internal");t=R0[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Xu(s))}}catch{}return t==="ok"?null:new vo(t,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||t.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="us-central1";function r2(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new vo("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class s2{constructor(e,t,r,s,i=dp,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new n2(t,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=dp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function i2(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}function o2(n,e,t){return r=>l2(n,e,r,{})}async function a2(n,e,t,r){t["Content-Type"]="application/json";let s;try{s=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function l2(n,e,t,r){const s=n._url(e);return c2(n,s,t,r)}async function c2(n,e,t,r){t=up(t);const s={data:t},i={},o=await n.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,u=r2(a),d=await Promise.race([a2(e,s,i,n.fetchImpl),u.promise,n.cancelAllRequests]);if(u.cancel(),!d)throw new vo("cancelled","Firebase Functions instance was deleted.");const f=t2(d.status,d.json);if(f)throw f;if(!d.json)throw new vo("internal","Response is not valid JSON object.");let m=d.json.data;if(typeof m>"u"&&(m=d.json.result),typeof m>"u")throw new vo("internal","Response is missing data field.");return{data:Xu(m)}}const P0="@firebase/functions",D0="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="auth-internal",d2="app-check-internal",h2="messaging-internal";function f2(n,e){const t=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(u2),a=r.getProvider(h2),u=r.getProvider(d2);return new s2(i,o,a,u,s,n)};ci(new _s(og,t,"PUBLIC").setMultipleInstances(!0)),Zn(P0,D0,e),Zn(P0,D0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(n=uw(),e=dp){const r=yd(pt(n),og).getImmediate({identifier:e}),s=lb("functions");return s&&m2(r,...s),r}function m2(n,e,t){i2(pt(n),e,t)}function g2(n,e,t){return o2(pt(n),e)}f2(fetch.bind(self));/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var y2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ye=(n,e)=>{const t=z.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:u,...d},f)=>z.createElement("svg",{ref:f,...y2,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${v2(n)}`,a].join(" "),...d},[...e.map(([m,y])=>z.createElement(m,y)),...Array.isArray(u)?u:[u]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=ye("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=ye("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=ye("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=ye("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=ye("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=ye("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=ye("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=ye("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=ye("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ye("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=ye("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=ye("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=ye("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=ye("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=ye("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=ye("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=ye("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=ye("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=ye("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=ye("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=ye("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=ye("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=ye("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=ye("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=ye("Magnet",[["path",{d:"m6 15-4-4 6.75-6.77a7.79 7.79 0 0 1 11 11L13 22l-4-4 6.39-6.36a2.14 2.14 0 0 0-3-3L6 15",key:"1i3lhw"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}],["path",{d:"m12 15 4 4",key:"lnac28"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=ye("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=ye("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=ye("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=ye("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=ye("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=ye("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=ye("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=ye("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=ye("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=ye("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=ye("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=ye("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=ye("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=ye("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=ye("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zu=ye("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=ye("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=ye("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=ye("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=ye("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=ye("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=ye("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=ye("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),oe="w-full px-4 py-3 bg-white border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all text-sm shadow-sm font-medium text-slate-700 no-spinner",me="block text-xs font-bold text-slate-500 mb-2 uppercase tracking-wide ml-1",Je={ru:{dashboard:"",rooms:"",calendar:"",reports:"",debts:"",tasks:"",expenses:"",clients:"",staff:"",shifts:"",logout:"",login:"",pass:"",enter:"  ",guests:"",occupancy:"",revenue:"",today:"",cash:"",card:"",qr:"QR",checkin:"",booking:"",debt:"",paid:"",save:"",cancel:"",delete:"",edit:"",guestName:" ",passport:"",birthDate:" ",country:"",room:"",bed:"",days:"",price:"",total:"",comment:"",category:"",amount:"",success:"",error:"",splitTitle:" ()",splitAfter:"  (.)",splitGap:" (.)",splitInfo:"  {x} .,    {y} .,     {z} .",confirmSplit:" ",checkoutWarn:"",timeOut:" ",shiftClose:" ",cashInHand:" ",shift:"",payment:"",extend:"",move:"",checkout:"",confirmDelete:" ?",search:"...",allHostels:" ",welcome:" ",initDb:" ",addTask:" ",priority:"",description:"",low:"",medium:"",high:"",printCheck:"",printForm:"",printRef:"",income:"",expense:"",balance:"",done:"",role:"",action:"",admin:"",cashier:"",noData:" ",createdBy:"",date:"",moveDate:" ",newDate:" ",manualRefund:" ",payDebt:" ",addDebt:" ",history:"",reduceNoRefund:" ( )",allCashiers:" ",selectCashier:" ",assignTo:"",householdGoods:"",groceries:"",repair:"",salary:"",utilities:"",other:"",freeFor:"",future:"",import:" (CSV)",preview:"",new:"",update:"",importSuccess:" ",deduplicate:" ",deleteSelected:" ",normalizeCountries:" ",createDebt:" ",print:"",printReport:" ",checkinNew:" ",startShift:" ",endShift:" ",transferShift:" ",working:" ",workedHours:"",salaryCalc:" "},uz:{dashboard:"Boshqaruv",rooms:"Xonalar",calendar:"Kalendar",reports:"Hisobotlar",debts:"Qarzlar",tasks:"Vazifalar",expenses:"Xarajatlar",clients:"Mijozlar",staff:"Xodimlar",shifts:"Smenalar",logout:"Chiqish",login:"Login",pass:"Parol",enter:"Tizimga kirish",guests:"Mehmonlar",occupancy:"Bandlik",revenue:"Tushum",today:"Bugun",cash:"Naqd",card:"Terminal",qr:"QR",checkin:"Joylashtirish",booking:"Band qilish",debt:"Qarz",paid:"To'langan",save:"Saqlash",cancel:"Bekor qilish",delete:"O'chirish",edit:"Tahrirlash",guestName:"F.I.SH",passport:"Pasport",birthDate:"Tug'ilgan sana",country:"Davlat",room:"Xona",bed:"Joy",days:"Kun",price:"Narx",total:"Jami",comment:"Izoh",category:"Toifa",amount:"Summa",success:"Muvaffaqiyatli",error:"Xato",splitTitle:"Bo'lish (Pauza)",splitAfter:"Chiqish (kun)",splitGap:"Tanaffus (kun)",splitInfo:"Mehmon {x} kun yashaydi, keyin joy {y} kun bo'sh turadi, so'ng yana {z} kunga joylashadi.",confirmSplit:"Bo'lishni tasdiqlash",checkoutWarn:"Qoldi",timeOut:"Vaqt tugadi",shiftClose:"Smenani yopish",cashInHand:"Kassada",shift:"Smena",payment:"To'lov",extend:"Uzaytirish",move:"Ko'chirish",checkout:"Chiqarish",confirmDelete:"Ishonchingiz komilmi?",search:"Qidirish...",allHostels:"Barcha filiallar",welcome:"Xush kelibsiz",initDb:"MB ishga tushirish",addTask:"Vazifa qo'shish",priority:"Muhimlik",description:"Tavsif",low:"Past",medium:"O'rta",high:"Yuqori",printCheck:"Chek",printForm:"Anketa",printRef:"Ma'lumotnoma",income:"Kirim",expense:"Chiqim",balance:"Balans",done:"Bajarildi",role:"Rol",action:"Amal",admin:"Admin",cashier:"Kassir",noData:"Ma'lumot yo'q",createdBy:"Yaratdi",date:"Sana",moveDate:"Sanani ko'chirish",newDate:"Yangi sana",manualRefund:"Qaytarish summasi",payDebt:"Qarzni to'lash",addDebt:"Qarzni o'zgartirish",history:"Tarix",reduceNoRefund:"Qisqartirish (Qaytim yo'q)",allCashiers:"Barcha kassirlar",selectCashier:"Kassirni tanlash",assignTo:"Tayinlash",householdGoods:" ",groceries:"-",repair:"",salary:" ",utilities:"",other:"",freeFor:"Bo'sh",future:"Bo'ladi",import:"Import (CSV)",preview:"Ko'rib chiqish",new:"Yangi",update:"Yangilash",importSuccess:"Import bajarildi",deduplicate:"Dublikatlarni topish",deleteSelected:"Tanlanganlarni o'chirish",normalizeCountries:"Davlatlarni to'g'irlash",createDebt:"Qarz yaratish",print:"Chop etish",printReport:"Hisobotni chop etish",checkinNew:"Yangi mehmon",startShift:"Smenani boshlash",endShift:"Smenani tugatish",transferShift:"Smenani topshirish",working:"Ishlamoqda",workedHours:"Soat",salaryCalc:"Maosh hisobi"}},V0="8483864240:AAGotoLWbAVH4iA6gh3GF-eNL5fAASHW468",O2=["7029598539","6953132612"],hp=async n=>{if(!V0.includes("YOUR_TELEGRAM"))try{await Promise.all(O2.map(e=>fetch(`https://api.telegram.org/bot${V0}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:e,text:n,parse_mode:"HTML"})})))}catch(e){console.error("Telegram Error:",e)}},L2={apiKey:"AIzaSyAoVj92dmnl5gBB7zYul0iG2Ekp5cbmkp0",authDomain:"hostella-app-a1e07.firebaseapp.com",projectId:"hostella-app-a1e07",storageBucket:"hostella-app-a1e07.firebasestorage.app",messagingSenderId:"826787873496",appId:"1:826787873496:web:51a0c6e42631a28919cdad"},hg=cw(L2),M0=AC(hg),F2=p2(hg),ce=DP(hg,{localCache:KP({tabManager:YP()})},"hostella"),U2="hostella-multi-v4",de=["artifacts",U2,"public","data"],z2=266666,Fh=[{login:"admin",pass:"admin",name:"Aziz Yuldashev",role:"admin",hostelId:"all"},{login:"dilafruz",pass:"123",name:"Dilafruz",role:"cashier",hostelId:"hostel1"},{login:"nargiza",pass:"123",name:"Nargiza",role:"cashier",hostelId:"hostel1"},{login:"fazliddin",pass:"123",name:"Fazliddin",role:"cashier",hostelId:"hostel2"},{login:"olimjon",pass:"123",name:"Olimjon",role:"cashier",hostelId:"hostel2"}],O0={turkmenistan:"",turkmenia:"",uzbekistan:"",russia:"","russian federation":"",kazakhstan:"",tajikistan:"",kyrgyzstan:"",kirgizstan:"",usa:"","united states":"","united states of america":"",china:"",turkey:"",korea:" ()","south korea":" ()",india:"",pakistan:"",afghanistan:"",germany:"",uk:"","united kingdom":"",england:"",france:"",italy:"",spain:"",japan:"",uae:"","united arab emirates":""},$d=["","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ()","","","","","","","","","","","",""," ","","","","","",""," ","","","","","","","","","","","","","","","","","","","-","",""],On={hostel1:{name:" 1",address:",   , 43",currency:"UZS"},hostel2:{name:" 2",address:", 6- .  , 39",currency:"UZS"}},zo=n=>typeof n.amountPaid=="number"?n.amountPaid:(n.paidCash||0)+(n.paidCard||0)+(n.paidQR||0),fp=n=>{if(!n)return"";const e=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-e).toISOString().slice(0,10)},oo=n=>{if(!n)return"";const e=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-e).toISOString().slice(0,16)},yr=(n,e,t=new Date)=>{const r=new Date(n);r.setHours(12,0,0,0);const s=new Date(r),i=new Date(r);return i.setDate(i.getDate()+parseInt(e)),i.setHours(12,0,0,0),{start:r,end:i,startDateNormalized:s}},hT=(n,e,t,r)=>{const s=yr(n,e),i=yr(t,r),o=s.start.getTime(),a=s.end.getTime(),u=i.start.getTime(),d=i.end.getTime();return o<d&&a>u},Uh=(n,e)=>{const t=new Date(n),i=((e?new Date(e):new Date)-t)/(1e3*60*60),o=z2/24;return Math.round(i*o)},B2=(n,e)=>{let t=`
        <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <style>
                body { font-family: Arial, sans-serif; }
                table { border-collapse: collapse; width: 100%; }
                th, td { border: 1px solid #000000; padding: 8px; text-align: left; vertical-align: top; }
                th { background-color: #4f46e5; color: #ffffff; font-weight: bold; }
                .income { color: #166534; font-weight: bold; }
                .expense { color: #9f1239; font-weight: bold; }
                .amount { text-align: right; }
            </style>
        </head>
        <body>
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
    `;n.forEach(i=>{const o=i.type==="income"?"income":"expense",a=i.type==="income"?"":"";t+=`
            <tr>
                <td>${i.date}</td>
                <td class="${o}">${a}</td>
                <td>${i.staff}</td>
                <td class="amount">${parseInt(i.amount).toLocaleString()}</td>
                <td>${i.method}</td>
                <td>${i.comment}</td>
            </tr>
        `}),t+="</tbody></table></body></html>";const r=new Blob([t],{type:"application/vnd.ms-excel"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)},$2=(n,e,t)=>{const r=window.open("","","width=800,height=600");r.document.write("<html><head><title>Print</title></head><body>"),r.document.write(`<h2>${n}</h2><p>Guest: ${e.fullName}</p>`),r.document.write("</body></html>"),r.document.close(),r.print()},q2=(n,e)=>{const t=window.open("","","width=800,height=600");let s=`
    <html>
    <head>
        <title> </title>
        <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #000; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; }
            .header { text-align: center; margin-bottom: 30px; }
            .total { text-align: right; font-size: 18px; font-weight: bold; margin-top: 20px; }
            .debt { color: #d63031; font-weight: bold; }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>  </h1>
            <p>: ${new Date().toLocaleDateString()}</p>
        </div>
        <table>
            <thead>
                <tr>
                    <th> </th>
                    <th></th>
                    <th>/</th>
                    <th> </th>
                </tr>
            </thead>
            <tbody>
    `;n.forEach(i=>{s+=`
            <tr>
                <td>${i.fullName}</td>
                <td>${i.passport||"-"}</td>
                <td>${i.roomNumber?` ${i.roomNumber}`:"-"}</td>
                <td class="debt">${i.totalDebt.toLocaleString()}</td>
            </tr>
        `}),s+=`
            </tbody>
        </table>
        <div class="total"> : ${e.toLocaleString()}</div>
    </body>
    </html>
    `,t.document.write(s),t.document.close(),t.print()},G2=(n,e,t,r,s)=>{const i=window.open("","","width=800,height=600"),o=new Date(r.start).toLocaleString(),a=new Date(r.end).toLocaleString();let u=`
    <html>
    <head>
        <title> </title>
        <style>
            body { font-family: Arial, sans-serif; padding: 20px; font-size: 12px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
            th { background-color: #f2f2f2; }
            .header { text-align: center; margin-bottom: 20px; }
            .summary { display: flex; justify-content: space-between; margin: 20px 0; border: 1px solid #000; padding: 10px; }
            .income { color: green; }
            .expense { color: red; }
            .balance { font-weight: bold; font-size: 14px; }
        </style>
    </head>
    <body>
        <div class="header">
            <h2> </h2>
            <p>${o}  ${a}</p>
        </div>
        
        <div class="summary">
            <div>: <span class="income">+${e.toLocaleString()}</span></div>
            <div>: <span class="expense">-${t.toLocaleString()}</span></div>
            <div class="balance">: ${(e-t).toLocaleString()}</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
    `;n.forEach(d=>{var x;const f=((x=s.find(A=>A.id===d.staffId||A.login===d.staffId))==null?void 0:x.name)||d.staffId,m=d.type==="income"?"":"",y=d.type==="income"?"income":"expense";u+=`
            <tr>
                <td>${new Date(d.date).toLocaleString()}</td>
                <td class="${y}">${m}</td>
                <td>${parseInt(d.amount).toLocaleString()}</td>
                <td>${d.method}</td>
                <td>${f}</td>
                <td>${d.comment||"-"}</td>
            </tr>
        `}),u+=`
            </tbody>
        </table>
    </body>
    </html>
    `,i.document.write(u),i.document.close(),i.print()},fT=n=>{if(!n)return"";const e=n.trim().replace(/['"]/g,""),t=e.toLowerCase();if(O0[t])return O0[t];const r=$d.find(s=>s.toLowerCase()===t);return r||e},ts=({children:n,className:e=""})=>c.jsx("div",{className:`bg-white rounded-2xl shadow-sm border border-slate-300 p-5 ${e}`,children:n}),X=({children:n,onClick:e,variant:t="primary",className:r="",icon:s,disabled:i,type:o="button",title:a,size:u="md"})=>{const d=`rounded-xl font-medium transition-all duration-200 flex items-center justify-center gap-2 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 shadow-sm border ${u==="sm"?"px-3 py-1.5 text-sm":"px-4 py-2.5"}`,f={primary:"bg-indigo-600 text-white border-transparent hover:bg-indigo-700 shadow-indigo-200",secondary:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50",danger:"bg-rose-500 text-white border-transparent hover:bg-rose-600 shadow-rose-200",success:"bg-emerald-600 text-white border-transparent hover:bg-emerald-700 shadow-emerald-200",ghost:"text-slate-500 border-transparent hover:bg-slate-100 shadow-none",warning:"bg-amber-500 text-white border-transparent hover:bg-amber-600 shadow-amber-200"};return c.jsxs("button",{type:o,onClick:e,disabled:i,className:`${d} ${f[t]} ${r}`,title:a,children:[s&&c.jsx(s,{size:u==="sm"?16:18}),n]})},K2=({icon:n,label:e,active:t,onClick:r,badge:s})=>c.jsxs("button",{onClick:r,className:`whitespace-nowrap w-full flex flex-col md:flex-row items-center gap-1 md:gap-3 px-3 py-2.5 rounded-lg text-[10px] md:text-sm font-medium transition-all relative ${t?"bg-indigo-50 text-indigo-700 font-bold":"text-slate-600 hover:bg-slate-50"}`,children:[c.jsx(n,{size:20,className:t?"text-indigo-600":"text-slate-400"}),c.jsx("span",{children:e}),s>0&&c.jsx("span",{className:"absolute right-2 top-0 md:top-1/2 md:-translate-y-1/2 bg-rose-500 text-white text-[10px] font-bold rounded-full w-4 h-4 md:w-5 md:h-5 flex items-center justify-center",children:s>9?"9+":s})]}),H2=({message:n,type:e,onClose:t})=>(z.useEffect(()=>{const r=setTimeout(t,3e3);return()=>clearTimeout(r)},[t]),c.jsxs("div",{className:`fixed top-12 right-4 z-[60] px-6 py-4 rounded-xl shadow-2xl flex items-center gap-3 animate-in slide-in-from-right-10 fade-in duration-300 ${e==="error"?"bg-rose-500 text-white":"bg-slate-900 text-white"}`,children:[e==="error"?c.jsx(XE,{size:24}):c.jsx(Fo,{size:24,className:"text-emerald-400"}),c.jsx("span",{className:"font-bold",children:n})]})),W2=({currentUser:n,activeTab:e,setActiveTab:t,pendingTasksCount:r,lang:s})=>{const i=d=>Je[s][d],o=[{id:"dashboard",label:i("dashboard"),icon:iT,role:"admin"},{id:"rooms",label:i("rooms"),icon:Bd,role:"all"},{id:"calendar",label:i("calendar"),icon:ZE,role:"all"},{id:"tasks",label:i("tasks"),icon:dT,role:"all",badge:r},{id:"shifts",label:i("shifts"),icon:ug,role:"all"}],a=d=>n.role==="super"||d==="all"?!0:d===n.role,u=o.filter(d=>a(d.role)).slice(0,5);return c.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 pb-safe pt-2 px-2 flex justify-between items-center z-50 md:hidden h-16 shadow-[0_-5px_15px_rgba(0,0,0,0.05)]",children:[u.map(d=>c.jsxs("button",{onClick:()=>t(d.id),className:`flex-1 flex flex-col items-center justify-center py-1 relative ${e===d.id?"text-indigo-600":"text-slate-400"}`,children:[c.jsx(d.icon,{size:20,strokeWidth:e===d.id?2.5:2}),c.jsx("span",{className:"text-[9px] font-bold mt-1 truncate max-w-[60px]",children:d.label}),d.badge>0&&c.jsx("span",{className:"absolute top-0 right-1/4 w-2 h-2 bg-rose-500 rounded-full"})]},d.id)),c.jsxs("button",{onClick:()=>t(n.role==="admin"?"staff":"debts"),className:`flex-1 flex flex-col items-center justify-center py-1 ${e==="more"?"text-indigo-600":"text-slate-400"}`,children:[c.jsx(cT,{size:20}),c.jsx("span",{className:"text-[9px] font-bold mt-1",children:"Menu"})]})]})},Q2=({currentUser:n,activeTab:e,setActiveTab:t,onLogout:r,lang:s,setLang:i,pendingTasksCount:o})=>{const a=f=>Je[s][f],u=[{id:"dashboard",label:a("dashboard"),icon:iT,role:"admin"},{id:"rooms",label:a("rooms"),icon:Bd,role:"all"},{id:"calendar",label:a("calendar"),icon:ZE,role:"all"},{id:"reports",label:a("reports"),icon:T2,role:"admin"},{id:"debts",label:a("debts"),icon:E2,role:"all"},{id:"shifts",label:a("shifts"),icon:ug,role:"all"},{id:"tasks",label:a("tasks"),icon:dT,role:"all",badge:o},{id:"expenses",label:a("expenses"),icon:Kl,role:"admin"},{id:"clients",label:a("clients"),icon:uT,role:"admin"},{id:"staff",label:a("staff"),icon:cT,role:"admin"}],d=f=>n.role==="super"||f==="all"?!0:f===n.role;return c.jsxs("div",{className:"w-56 bg-white h-screen border-r border-slate-200 flex flex-col p-4 fixed md:relative z-20 hidden md:flex",children:[c.jsxs("div",{className:"text-2xl font-bold text-indigo-600 mb-8 flex items-center gap-2 pl-2",children:[c.jsx(lg,{})," Hostella"]}),c.jsxs("div",{className:"mb-4 flex bg-slate-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>i("ru"),className:`flex-1 py-1 text-xs font-bold rounded ${s==="ru"?"bg-white shadow text-indigo-600":"text-slate-500"}`,children:"RU"}),c.jsx("button",{onClick:()=>i("uz"),className:`flex-1 py-1 text-xs font-bold rounded ${s==="uz"?"bg-white shadow text-indigo-600":"text-slate-500"}`,children:"UZ"})]}),c.jsx("div",{className:"space-y-1 flex-1 overflow-y-auto",children:u.filter(f=>d(f.role)).map(f=>c.jsx(K2,{icon:f.icon,label:f.label,active:e===f.id,onClick:()=>t(f.id),badge:f.badge},f.id))}),c.jsxs("div",{className:"border-t border-slate-100 pt-4 mt-auto",children:[c.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 mb-2 bg-slate-50 rounded-xl",children:[c.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-700 font-bold uppercase shrink-0",children:n.name[0]}),c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("div",{className:"font-bold text-sm truncate text-slate-700",children:n.name}),c.jsx("div",{className:"text-[10px] text-slate-500 capitalize uppercase tracking-wider",children:n.role==="super"?"Super Admin":n.role==="admin"?a("admin"):a("cashier")})]})]}),c.jsx(X,{variant:"ghost",className:"w-full justify-start text-orange-600 hover:bg-orange-50 hover:text-orange-700",icon:cg,onClick:r,children:a("logout")})]})]})},Y2=({users:n,onLogin:e,onSeed:t,lang:r,setLang:s})=>{const i=m=>Je[r][m],[o,a]=z.useState(""),[u,d]=z.useState(""),f=m=>{if(m.preventDefault(),o==="Super"&&u==="super"){e({name:"Super Admin",login:"Super",role:"super",hostelId:"all"});return}const y=n.find(x=>x.login.toLowerCase()===o.toLowerCase()&&x.pass===u);y?e(y):alert(i("error"))};return c.jsxs("div",{className:"fixed inset-0 w-screen h-screen bg-slate-50 flex items-center justify-center z-[100] p-4",children:[c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[c.jsx("button",{onClick:()=>s("ru"),className:`px-3 py-1 rounded ${r==="ru"?"bg-indigo-600 text-white":"bg-white"}`,children:"RU"}),c.jsx("button",{onClick:()=>s("uz"),className:`px-3 py-1 rounded ${r==="uz"?"bg-indigo-600 text-white":"bg-white"}`,children:"UZ"})]}),c.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md border border-slate-100 flex flex-col items-center",children:[c.jsx("div",{className:"bg-indigo-600 p-4 rounded-2xl mb-6 shadow-lg shadow-indigo-200",children:c.jsx(lg,{className:"text-white",size:40})}),c.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Hostella"}),c.jsx("p",{className:"text-slate-500 mb-8 text-center",children:"  "}),c.jsxs("form",{onSubmit:f,className:"space-y-5 w-full",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("login")}),c.jsx("input",{className:oe,value:o,onChange:m=>a(m.target.value),placeholder:"admin",autoFocus:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("pass")}),c.jsx("input",{type:"password",className:oe,value:u,onChange:m=>d(m.target.value),placeholder:""})]}),c.jsx(X,{type:"submit",className:"w-full py-4 text-lg shadow-xl shadow-indigo-100 mt-4",children:i("enter")})]}),c.jsx("div",{className:"mt-8 text-center pt-6 border-t border-slate-100 w-full",children:c.jsx("button",{onClick:t,className:"text-xs text-slate-400 hover:text-indigo-500 transition-colors",children:i("initDb")})})]})]})},J2=({rooms:n,guests:e,payments:t,lang:r,currentHostelId:s})=>{const i=S=>Je[r][S],o=On[s],a=s==="all"?n:n.filter(S=>S.hostelId===s),u=a.reduce((S,v)=>S+parseInt(v.capacity),0),d=new Date,f=e.filter(S=>{if(s!=="all"&&S.hostelId!==s||S.status!=="active")return!1;const v=S.checkInDate||S.checkInDateTime||S.checkIn,T=S.checkOutDate;if(!v||!T)return!1;const I=new Date(v),D=new Date(T);return typeof v=="string"&&!v.includes("T")&&I.setHours(12,0,0,0),typeof T=="string"&&!T.includes("T")&&D.setHours(12,0,0,0),d>=I&&d<D}).length,m=S=>{if(!S)return"";const v=new Date(S),T=v.getTimezoneOffset()*6e4;return new Date(v.getTime()-T).toISOString().slice(0,10)},y=m(new Date),x=t?t.filter(S=>s!=="all"&&S.hostelId!==s?!1:m(S.date)===y).reduce((S,v)=>S+(parseInt(v.amount)||0),0):0,A=e.filter(S=>s!=="all"&&S.hostelId!==s?!1:m(S.checkInDate||S.checkIn)===y&&S.status==="active").length,R=u?Math.round(f/u*100):0,k=Math.max(0,u-f);return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[c.jsxs(ts,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(uT,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("guests")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800 mt-1",children:f})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:[i("today"),": +",A]})]}),c.jsxs(ts,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(Bd,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("occupancy")}),c.jsxs("div",{className:"text-2xl font-bold text-indigo-600 mt-1",children:[R,"%"]})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:[": ",f," / : ",k]})]}),c.jsxs(ts,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(Kl,{size:64})}),c.jsxs("div",{children:[c.jsxs("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:[i("revenue")," (",i("today"),")"]}),c.jsx("div",{className:"text-2xl font-bold text-emerald-600 mt-1",children:x.toLocaleString()})]}),c.jsxs("div",{className:"text-xs text-slate-400 mt-auto",children:["Hostel: ",(o==null?void 0:o.name)||s]})]}),c.jsxs(ts,{className:"flex flex-col justify-between h-32 relative overflow-hidden group",children:[c.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:c.jsx(lg,{size:64})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider",children:i("rooms")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800 mt-1",children:a.length})]}),c.jsx("div",{className:"text-xs text-slate-400 mt-auto",children:i("total")})]})]})},X2=({guests:n,rooms:e,payments:t=[],lang:r})=>{const s=I=>Je[r][I],[i,o]=z.useState(7),a=e.reduce((I,D)=>I+parseInt(D.capacity),0),u=new Date,d=n.filter(I=>{if(I.status!=="active")return!1;const D=I.checkInDate||I.checkInDateTime||I.checkIn;if(!D)return!1;const P=new Date(D);typeof D=="string"&&!D.includes("T")&&P.setHours(12,0,0,0);const w=I.checkOutDate;if(!w)return!1;const g=new Date(w);return typeof w=="string"&&!w.includes("T")&&g.setHours(12,0,0,0),u>=P&&u<g}).length,f=a>0?d/a*100:0,m=Array.from({length:i},(I,D)=>{const P=new Date;return P.setDate(P.getDate()-(i-1-D)),{iso:P.toISOString().split("T")[0],label:P.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"})}}),y=m.map(I=>{const D=t.filter(P=>P.date&&P.date.startsWith(I.iso)).reduce((P,w)=>P+(parseInt(w.amount)||0),0);return{date:I.label,value:D}}),x=Math.max(...y.map(I=>I.value),1e5),A=t.filter(I=>I.date>=m[0].iso),R={cash:0,card:0,qr:0};A.forEach(I=>{I.method==="cash"&&(R.cash+=parseInt(I.amount)||0),I.method==="card"&&(R.card+=parseInt(I.amount)||0),I.method==="qr"&&(R.qr+=parseInt(I.amount)||0)});const k=R.cash+R.card+R.qr||1,S={};n.filter(I=>I.status==="active").forEach(I=>{const D=I.country||"Unknown";S[D]=(S[D]||0)+1});const v=Object.entries(S).sort((I,D)=>D[1]-I[1]).slice(0,4),T=v.length>0?v[0][1]:1;return c.jsxs(c.Fragment,{children:[c.jsxs(ts,{className:"flex flex-col items-center justify-center relative",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:s("occupancy")}),c.jsxs("div",{className:"relative w-40 h-40",children:[c.jsxs("svg",{viewBox:"0 0 36 36",className:"w-full h-full transform -rotate-90",children:[c.jsx("path",{className:"text-slate-100",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3"}),c.jsx("path",{className:"text-indigo-600",strokeDasharray:`${isNaN(f)?0:f}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-indigo-900",children:[c.jsxs("span",{className:"text-3xl font-bold",children:[Math.round(f),"%"]}),c.jsxs("span",{className:"text-xs text-slate-400",children:[d,"/",a]})]})]})]}),c.jsxs(ts,{className:"flex flex-col justify-end",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase",children:s("revenue")}),c.jsxs("div",{className:"flex bg-slate-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>o(7),className:`px-2 py-0.5 text-xs rounded-md transition-all ${i===7?"bg-white shadow-sm font-bold":"text-slate-500"}`,children:"7"}),c.jsx("button",{onClick:()=>o(14),className:`px-2 py-0.5 text-xs rounded-md transition-all ${i===14?"bg-white shadow-sm font-bold":"text-slate-500"}`,children:"14"})]})]}),c.jsx("div",{className:"flex justify-between items-end h-40 gap-1",children:y.map((I,D)=>c.jsxs("div",{className:"flex flex-col items-center flex-1 group relative h-full justify-end",children:[c.jsx("div",{className:"w-full bg-emerald-100 rounded-t-sm hover:bg-emerald-200 transition-all relative",style:{height:`${I.value/x*100}%`,minHeight:I.value>0?"4px":"0"},children:c.jsx("div",{className:"hidden group-hover:block absolute bottom-full mb-1 left-1/2 -translate-x-1/2 text-xs bg-slate-800 text-white p-1 rounded z-10 whitespace-nowrap",children:I.value.toLocaleString()})}),c.jsx("span",{className:"text-[10px] text-slate-400 mt-2 whitespace-nowrap",children:I.date})]},D))})]}),c.jsxs(ts,{className:"flex flex-col",children:[c.jsxs("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:[s("payment")," (",i," d)"]}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("cash")}),c.jsxs("span",{children:[Math.round(R.cash/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${R.cash/k*100}%`}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("card")}),c.jsxs("span",{children:[Math.round(R.card/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-500",style:{width:`${R.card/k*100}%`}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[c.jsx("span",{children:s("qr")}),c.jsxs("span",{children:[Math.round(R.qr/k*100),"%"]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-amber-500",style:{width:`${R.qr/k*100}%`}})})]})]})]}),c.jsxs(ts,{className:"flex flex-col",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-500 mb-4 uppercase",children:"Top Country"}),c.jsxs("div",{className:"space-y-3",children:[v.map(([I,D])=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 text-xs text-slate-600 truncate",children:I}),c.jsx("div",{className:"flex-[2] h-2 bg-slate-100 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-indigo-500",style:{width:`${D/T*100}%`}})}),c.jsx("div",{className:"text-xs font-bold text-slate-700",children:D})]},I)),v.length===0&&c.jsx("div",{className:"text-xs text-slate-400 text-center mt-10",children:s("noData")})]})]})]})},Z2=({targetDate:n,lang:e})=>{const[t,r]=z.useState(""),s=i=>Je[e][i];return z.useEffect(()=>{const i=()=>{const a=new Date,d=new Date(n)-a;if(d<=0)r(s("timeOut"));else{const f=Math.floor(d/36e5),m=Math.floor(d%(1e3*60*60)/(1e3*60));r(`${f}h ${m}m`)}};i();const o=setInterval(i,6e4);return()=>clearInterval(o)},[n,e]),c.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[c.jsx(Nl,{size:12,className:"text-rose-500 animate-pulse"}),c.jsxs("span",{className:"text-[10px] font-bold text-rose-600",children:[s("checkoutWarn"),": ",t]})]})},eD=({room:n,guests:e,isAdmin:t,onEdit:r,onClone:s,onDelete:i,onBedClick:o,lang:a})=>{const u=y=>Je[a][y],d=Array.from({length:n.capacity},(y,x)=>x+1),f=new Date,m=new Date;return m.setDate(m.getDate()-2),c.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col hover:shadow-md transition-all",children:[c.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[c.jsxs("h3",{className:"font-bold text-lg text-slate-700 flex items-center gap-2",children:[c.jsxs("span",{className:"bg-slate-200 px-3 py-1 rounded-md text-sm text-slate-700 font-bold border border-slate-200",children:[u("room")," ",n.number]}),c.jsxs("span",{className:"text-xs font-normal text-slate-400",children:["(",n.capacity,")"]})]}),t&&c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:r,className:"p-2 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded transition-all",children:c.jsx(Gl,{size:16})}),c.jsx("button",{onClick:s,className:"p-2 bg-emerald-100 text-emerald-700 hover:bg-emerald-200 rounded transition-all",children:c.jsx(tT,{size:16})}),c.jsx("button",{onClick:i,className:"p-2 bg-rose-100 text-rose-700 hover:bg-rose-200 rounded transition-all",children:c.jsx(Jo,{size:16})})]})]}),c.jsx("div",{className:"p-4 grid grid-cols-2 gap-3 flex-1",children:d.map(y=>{const x=e.find(_=>{const b=String(_.bedId)===String(y),C=_.status==="active"||_.status==="booking";if(!b||!C)return!1;const V=new Date(_.checkInDate||_.checkInDateTime||_.checkIn);_.checkInDate.includes("T")||V.setHours(12,0,0,0);const N=parseInt(_.days),Ee=new Date(V.getTime()+N*24*60*60*1e3);return f>=V&&f<Ee});let A=null;if(!x){const _=e.filter(b=>String(b.roomId)===String(n.id)&&String(b.bedId)===String(y)&&b.status==="checked_out"&&new Date(b.checkOutDate)>m).sort((b,C)=>new Date(C.checkOutDate)-new Date(b.checkOutDate));_.length>0&&(A=_[0])}let R=null;if(!x){const _=e.filter(b=>{if(String(b.roomId)!==String(n.id)||String(b.bedId)!==String(y)||b.status!=="active"&&b.status!=="booking")return!1;const C=new Date(b.checkInDate||b.checkInDateTime||b.checkIn);return b.checkInDate.includes("T")||C.setHours(12,0,0,0),C>f}).sort((b,C)=>new Date(b.checkInDate)-new Date(C.checkInDate));_.length>0&&(R=_[0])}const k=(x==null?void 0:x.status)==="booking",S=x?zo(x):0,v=x?x.totalPrice-S:0;let T=null;if(x){const _=new Date(x.checkInDate||x.checkInDateTime||x.checkIn);_.setHours(12,0,0,0),T=new Date(_.getTime()+parseInt(x.days)*24*60*60*1e3),T.setHours(12,0,0,0)}const I=T&&T<new Date;let D="bg-white border-slate-100 hover:border-indigo-300 hover:shadow-sm",P="bg-slate-100 text-slate-400",w="text-slate-700",g=!1;if(x&&!k){I?v<=0?(D="bg-slate-200 border-slate-300",P="bg-slate-300 text-slate-500",w="text-slate-500"):(D="bg-rose-50 border-rose-200",P="bg-white/50 text-rose-700",w="text-rose-900"):v>0?(D="bg-rose-50 border-rose-200",P="bg-white/50 text-rose-700",w="text-rose-900"):(D="bg-emerald-50 border-emerald-200",P="bg-white/50 text-emerald-700",w="text-emerald-900");const _=T-f,b=12*60*60*1e3;_>0&&_<b&&(g=!0)}else k?(D="bg-amber-50 border-amber-200",P="bg-white/50 text-amber-600",w="text-amber-900"):A&&(D="bg-slate-50 border-slate-200 opacity-70",P="bg-slate-200 text-slate-400",w="text-slate-400 italic");return c.jsxs("div",{onClick:()=>o(y,x||A,!!A),className:`cursor-pointer rounded-xl p-3 border transition-all relative min-h-[90px] flex flex-col justify-between group overflow-hidden ${D}`,children:[(x&&I&&v<=0||A)&&c.jsxs("div",{className:"absolute inset-0 bg-slate-800/90 z-10 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity p-2 gap-2",children:[c.jsx("span",{className:"text-white text-[10px] font-bold text-center mb-1",children:A?"Checked Out":"Time Out"}),c.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[x&&c.jsx("button",{className:"bg-emerald-500 text-white text-[10px] py-1.5 rounded font-bold hover:bg-emerald-600 w-full",children:u("extend")}),c.jsxs("button",{onClick:_=>{_.stopPropagation(),o(y,null,!1)},className:"bg-indigo-500 text-white text-[10px] py-1.5 rounded font-bold hover:bg-indigo-600 w-full flex items-center justify-center gap-1",children:[c.jsx(Uo,{size:12})," ",u("checkinNew")]})]})]}),c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded uppercase tracking-wide ${P}`,children:[y," ",y%2===0?"Up":"Dn"]}),x&&(k?c.jsx(Nl,{size:14,className:"text-amber-500"}):c.jsx(Zu,{size:14,className:I&&v<=0?"text-slate-400":v>0?"text-rose-400":"text-emerald-400"})),A&&c.jsx(sT,{size:14,className:"text-slate-300"})]}),x||A?c.jsxs("div",{className:"mt-2 overflow-hidden",children:[c.jsx("div",{className:`font-bold text-sm leading-tight truncate ${w}`,children:(x||A).fullName}),c.jsxs("div",{className:"flex justify-between items-end mt-1",children:[c.jsx("div",{className:"text-[10px] opacity-70",children:k?u("booking"):`${(x||A).days} ${u("days")}`}),!k&&v>0&&c.jsxs("div",{className:"text-[10px] font-bold text-rose-600 bg-rose-100 px-1 rounded",children:["-",v.toLocaleString()]})]}),g&&T&&c.jsx(Z2,{targetDate:T,lang:a}),I&&v<=0&&c.jsx("div",{className:"text-[9px] font-bold text-slate-500 mt-1 uppercase tracking-wide",children:"Time Out"})]}):c.jsx("div",{className:"mt-auto text-center",children:R?c.jsxs("div",{className:"text-left",children:[c.jsxs("div",{className:"text-[10px] text-slate-400 font-medium uppercase",children:[u("freeFor")," ",Math.max(0,Math.ceil((new Date(R.checkInDate)-f)/(1e3*60*60*24)))," ",u("days")]}),c.jsxs("div",{className:"text-xs font-bold text-slate-500 truncate flex items-center gap-1",children:[c.jsx(Nl,{size:10})," ",R.fullName]})]}):c.jsx(Uo,{className:"mx-auto text-slate-200 group-hover:text-indigo-400 transition-colors",size:20})})]},y)})})]})},tD=({rooms:n,guests:e,onSlotClick:t,lang:r,currentUser:s,onDeleteGuest:i})=>{const o=P=>Je[r][P],[a,u]=z.useState({}),[d,f]=z.useState(new Date),m=P=>{const w=new Date(d);w.setDate(w.getDate()+P),f(w)},y=14,x=Array.from({length:y},(P,w)=>{const g=new Date(d);return g.setDate(g.getDate()+w),{date:g,str:fp(g),day:g.getDate(),month:g.getMonth()+1,week:g.toLocaleDateString("ru-RU",{weekday:"short"})}}),A=P=>{u(w=>({...w,[P]:!w[P]}))},R=new Date;R.setDate(R.getDate()-7);const k=e.filter(P=>P.status==="checked_out"?new Date(P.checkOutDate)>R:!0),S=s.role==="admin"||s.role==="super",v=P=>{if(P.status==="booking")return"bg-amber-400 border-amber-500";if(P.status==="checked_out")return"bg-slate-400 border-slate-500";const w=new Date,g=new Date(P.checkOutDate);if(typeof P.checkOutDate=="string"&&!P.checkOutDate.includes("T")&&g.setHours(12,0,0,0),w>g)return"bg-slate-400 border-slate-500 opacity-90";const _=P.totalPrice||0,b=zo(P);return _-b<=0?"bg-emerald-500 border-emerald-600":"bg-rose-500 border-rose-600"},T=P=>{let w=new Date(P.checkInDate||P.checkInDateTime||P.checkIn);w.setHours(12,0,0,0);const g=new Date(x[0].str);g.setHours(0,0,0,0);const _=parseInt(P.days)*24*60*60*1e3,b=new Date(w.getTime()+_);b.setHours(12,0,0,0);const C=new Date(x[x.length-1].str);if(C.setHours(23,59,59,999),b<g||w>C)return null;const N=1e3*60*60*24*y;let Ee=w.getTime()-g.getTime(),F=b.getTime()-w.getTime();Ee<0&&(F+=Ee,Ee=0);const _e=Ee/N*100,pe=F/N*100,G=100-_e,W=Math.min(pe,G);return{leftPercent:_e,widthPercent:W}},I=(P,w,g,_)=>{const b=new Date(g);_||b.setDate(b.getDate()-1),b.setHours(12,0,0,0),t(P,w,null,b.toISOString())},D=(P,w)=>{P.stopPropagation(),confirm(o("confirmDelete"))&&i(w)};return c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-slate-200 shadow-sm",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>m(-1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:c.jsx(x2,{size:20})}),c.jsx("button",{onClick:()=>{const P=new Date;P.setHours(0,0,0,0),f(P)},className:"px-4 py-1.5 bg-indigo-50 text-indigo-700 rounded-lg text-sm font-bold hover:bg-indigo-100",children:o("today")}),c.jsx("button",{onClick:()=>m(7),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:c.jsx(w2,{size:20})})]}),c.jsxs("div",{className:"text-sm font-bold text-slate-700 bg-slate-50 px-3 py-1 rounded-md border border-slate-200",children:[x[0].date.toLocaleDateString(),"  ",x[x.length-1].date.toLocaleDateString()]})]}),c.jsx("div",{className:"flex-1 overflow-auto relative",children:c.jsxs("div",{className:"min-w-[1600px]",children:[c.jsxs("div",{className:"flex sticky top-0 bg-white z-40 border-b border-slate-200 shadow-sm h-12",children:[c.jsxs("div",{className:"w-40 p-3 font-bold text-xs text-slate-500 bg-slate-50 border-r border-slate-200 sticky left-0 z-50",children:[o("room")," / ",o("bed")]}),x.map(P=>c.jsxs("div",{className:`flex-1 min-w-[80px] flex flex-col items-start justify-center px-2 border-r border-slate-100 ${["",""].includes(P.week)?"bg-rose-50":""}`,children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:P.week}),c.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[P.day,".",P.month]})]},P.str))]}),n.map(P=>{const w=a[P.id],g=r==="uz"?`Xona ${P.number}`:` ${P.number}`;return c.jsxs("div",{className:"border-b border-slate-200",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-100 hover:bg-slate-200 cursor-pointer font-bold text-slate-700 text-sm sticky left-0 z-30 border-r border-slate-200 w-40 border-b border-slate-200",onClick:()=>A(P.id),children:[c.jsx("span",{children:g}),w?c.jsx(_2,{size:16}):c.jsx(I2,{size:16})]}),!w&&Array.from({length:P.capacity},(_,b)=>b+1).map(_=>{const b=k.filter(C=>C.roomId===P.id&&String(C.bedId)===String(_));return c.jsxs("div",{className:"flex h-16 border-b border-slate-50 last:border-b-0 relative",children:[c.jsxs("div",{className:"w-40 px-4 flex items-center justify-between border-r border-slate-200 bg-white sticky left-0 z-30 text-xs font-bold text-slate-500",children:[c.jsxs("span",{children:[o("bed")," ",_]}),c.jsx("span",{className:"text-[9px] px-1.5 py-0.5 bg-slate-100 rounded text-slate-400",children:_%2===0?"Up":"Dn"})]}),c.jsxs("div",{className:"flex-1 relative",children:[c.jsx("div",{className:"absolute inset-0 flex",children:x.map(C=>c.jsxs("div",{className:`flex-1 min-w-[80px] border-r border-slate-100 h-full flex ${["",""].includes(C.week)?"bg-rose-50":""}`,children:[c.jsx("div",{className:"w-1/2 h-full cursor-pointer hover:bg-indigo-50 border-r border-slate-200/30",onClick:()=>I(P,_,C.str,!1)}),c.jsx("div",{className:"w-1/2 h-full cursor-pointer hover:bg-indigo-50",onClick:()=>I(P,_,C.str,!0)})]},C.str))}),b.map(C=>{const V=T(C);if(!V)return null;const N=v(C),Ee=(C.totalPrice||0)-zo(C),F=Ee>0,_e=C.status==="checked_out";return c.jsxs("div",{className:`absolute top-1 bottom-1 z-20 rounded-md shadow-sm cursor-pointer hover:z-50 hover:shadow-lg border group/block overflow-hidden ${N} flex items-center`,style:{left:`${V.leftPercent}%`,width:`${V.widthPercent}%`},onClick:pe=>{pe.stopPropagation(),t(P,_,C,null)},title:C.fullName,children:[c.jsxs("div",{className:"sticky left-0 pl-1 pr-1 flex flex-col justify-center h-full w-full max-w-full z-50",children:[c.jsxs("span",{className:"font-bold text-[10px] text-white whitespace-nowrap overflow-hidden text-ellipsis px-1.5 py-0.5 rounded-sm bg-black/40 w-fit block relative",children:[C.status==="booking"&&" ",C.fullName]}),!_e&&F&&c.jsxs("span",{className:"text-[9px] font-bold mt-0.5 px-1.5 py-px rounded w-fit bg-white text-rose-600 shadow-sm border border-rose-200 relative",children:["-",Ee.toLocaleString()]}),!_e&&!F&&c.jsx("span",{className:"text-[9px] font-bold mt-0.5 px-1 py-px rounded w-fit bg-white/90 text-emerald-700 shadow-sm relative",children:" OK"}),_e&&c.jsx("span",{className:"text-[9px] text-white/90 italic ml-1",children:"OUT"})]}),_e&&S&&c.jsx("button",{onClick:pe=>D(pe,C.id),className:"absolute right-1 top-1 p-1 bg-white hover:bg-rose-500 hover:text-white rounded-full text-slate-700 shadow-md hidden group-hover/block:block z-50",title:o("delete"),children:c.jsx(M2,{size:10,strokeWidth:3})})]},C.id)})]})]},_)})]},P.id)})]})})]})},nD=({users:n,onAdd:e,onDelete:t,lang:r})=>{const s=u=>Je[r][u],[i,o]=z.useState({name:"",login:"",pass:"",role:"cashier",hostelId:"hostel1"}),a=n.filter(u=>u.login!=="Super");return c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[c.jsx("h3",{className:"font-bold text-lg",children:s("staff")}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:s("guestName")}),c.jsx("th",{className:"p-4",children:s("login")}),c.jsx("th",{className:"p-4",children:s("role")}),c.jsx("th",{className:"p-4",children:"Hostel"}),c.jsx("th",{className:"p-4",children:s("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:a.map(u=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-4 font-medium",children:u.name}),c.jsx("td",{className:"p-4 text-slate-500 font-mono",children:u.login}),c.jsx("td",{className:"p-4",children:c.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded text-xs",children:u.role==="admin"?s("admin"):s("cashier")})}),c.jsx("td",{className:"p-4 text-slate-500",children:u.hostelId}),c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>t(u.id),className:"text-rose-500 hover:bg-rose-50 p-2 rounded",children:c.jsx(Jo,{size:16})})})]},u.id||u.login))})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 h-min",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:"Add"}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:oe,placeholder:"Name",value:i.name,onChange:u=>o({...i,name:u.target.value})}),c.jsx("input",{className:oe,placeholder:"Login",value:i.login,onChange:u=>o({...i,login:u.target.value})}),c.jsx("input",{className:oe,placeholder:"Pass",value:i.pass,onChange:u=>o({...i,pass:u.target.value})}),c.jsxs("select",{className:oe,value:i.role,onChange:u=>o({...i,role:u.target.value}),children:[c.jsx("option",{value:"cashier",children:s("cashier")}),c.jsx("option",{value:"admin",children:s("admin")})]}),c.jsx(X,{onClick:()=>e(i),className:"w-full",children:s("save")})]})]})]})},rD=({onClose:n,onImport:e,lang:t})=>{const r=f=>Je[t][f],[s,i]=z.useState([]),[o,a]=z.useState(""),u=f=>{const m=f.target.files[0];if(!m)return;const y=new FileReader;y.onload=x=>{const A=x.target.result;a(A);const k=A.split(`
`).map(S=>S.split(",")).filter(S=>S.length>=2).map(S=>{var T,I,D,P,w,g;const v=((T=S[3])==null?void 0:T.replace(/['"]/g,"").trim())||"";return{fullName:(D=(I=S[0])==null?void 0:I.replace(/['"]/g,"").trim())==null?void 0:D.toUpperCase(),passport:(w=(P=S[1])==null?void 0:P.replace(/['"]/g,"").trim())==null?void 0:w.toUpperCase(),birthDate:(g=S[2])==null?void 0:g.replace(/['"]/g,"").trim(),country:fT(v)}}).filter(S=>S.fullName&&S.passport);i(k)},y.readAsText(m)},d=()=>{e(s),n()};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl p-6 shadow-xl flex flex-col max-h-[90vh]",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[c.jsx(D2,{size:20})," ",r("import")]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-slate-500 mb-2",children:"CSV Format: Name,Passport,BirthDate,Country"}),c.jsx("input",{type:"file",accept:".csv",onChange:u,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]}),s.length>0&&c.jsx("div",{className:"flex-1 overflow-auto border border-slate-200 rounded-lg mb-4",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2",children:"Name"}),c.jsx("th",{className:"p-2",children:"Passport"}),c.jsx("th",{className:"p-2",children:"Country"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:s.map((f,m)=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-2",children:f.fullName}),c.jsx("td",{className:"p-2",children:f.passport}),c.jsx("td",{className:"p-2",children:f.country})]},m))})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(X,{onClick:d,disabled:s.length===0,className:"flex-1",children:[r("save")," (",s.length,")"]}),c.jsx(X,{variant:"secondary",onClick:n,className:"flex-1",children:r("cancel")})]})]})})},sD=({clients:n,onUpdateClient:e,onImportClients:t,onDeduplicate:r,onBulkDelete:s,onNormalizeCountries:i,lang:o})=>{const a=D=>Je[o][D],[u,d]=z.useState(""),[f,m]=z.useState(null),[y,x]=z.useState(!1),[A,R]=z.useState(new Set),k=n.filter(D=>(D.fullName||"").toLowerCase().includes(u.toLowerCase())||(D.passport||"").includes(u.toUpperCase())),S=D=>{D.target.checked?R(new Set(k.map(P=>P.id))):R(new Set)},v=D=>{const P=new Set(A);P.has(D)?P.delete(D):P.add(D),R(P)},T=()=>{confirm(`${a("deleteSelected")} (${A.size})?`)&&(s(Array.from(A)),R(new Set))},I=()=>{confirm("Normalize all countries?")&&i()};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(R2,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),c.jsx("input",{className:`${oe} pl-10`,placeholder:a("search"),value:u,onChange:D=>d(D.target.value)})]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx(X,{icon:N2,variant:"secondary",onClick:r,title:"Merge duplicates",children:a("deduplicate")}),c.jsx(X,{icon:S2,variant:"secondary",onClick:I,title:"Fix country names",children:a("normalizeCountries")}),c.jsx(X,{icon:rT,variant:"secondary",onClick:()=>x(!0),children:"Import CSV"}),A.size>0&&c.jsx(X,{icon:Jo,variant:"danger",onClick:T,children:a("deleteSelected")})]})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left min-w-[600px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4 w-10",children:c.jsx("input",{type:"checkbox",onChange:S,checked:A.size>0&&A.size===k.length,className:"rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"})}),c.jsx("th",{className:"p-4",children:a("guestName")}),c.jsx("th",{className:"p-4",children:a("passport")}),c.jsx("th",{className:"p-4",children:a("birthDate")}),c.jsx("th",{className:"p-4",children:a("country")}),c.jsx("th",{className:"p-4",children:"Visits"}),c.jsx("th",{className:"p-4",children:"Last Visit"}),c.jsx("th",{className:"p-4",children:a("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:k.map(D=>c.jsxs("tr",{className:A.has(D.id)?"bg-indigo-50":"",children:[c.jsx("td",{className:"p-4",children:c.jsx("input",{type:"checkbox",checked:A.has(D.id),onChange:()=>v(D.id),className:"rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"})}),c.jsx("td",{className:"p-4 font-bold",children:D.fullName}),c.jsx("td",{className:"p-4 font-mono text-indigo-600",children:D.passport}),c.jsx("td",{className:"p-4",children:D.birthDate||"-"}),c.jsx("td",{className:"p-4",children:D.country}),c.jsx("td",{className:"p-4",children:D.visits}),c.jsx("td",{className:"p-4 text-slate-500",children:new Date(D.lastVisit).toLocaleDateString()}),c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>m(D),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded",children:c.jsx(Gl,{size:16})})})]},D.id))})]})}),f&&c.jsx(iD,{client:f,onClose:()=>m(null),onSave:D=>{e(f.id,D),m(null)},lang:o}),y&&c.jsx(rD,{onClose:()=>x(!1),onImport:D=>{t(D),x(!1)},lang:o})]})},iD=({client:n,onClose:e,onSave:t,lang:r})=>{const s=a=>Je[r][a],[i,o]=z.useState({...n});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:s("edit")}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("guestName")}),c.jsx("input",{className:oe,value:i.fullName,onChange:a=>o({...i,fullName:a.target.value.toUpperCase()})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("passport")}),c.jsx("input",{className:oe,value:i.passport,onChange:a=>o({...i,passport:a.target.value.toUpperCase()})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("birthDate")}),c.jsx("input",{type:"date",className:oe,value:i.birthDate,onChange:a=>o({...i,birthDate:a.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:s("country")}),c.jsx("select",{className:oe,value:i.country,onChange:a=>o({...i,country:a.target.value}),children:$d.map(a=>c.jsx("option",{children:a},a))})]}),c.jsx(X,{onClick:()=>t(i),children:s("save")}),c.jsx(X,{variant:"secondary",onClick:e,children:s("cancel")})]})]})})},oD=({tasks:n,users:e,currentUser:t,onAddTask:r,onCompleteTask:s,onUpdateTask:i,onDeleteTask:o,lang:a,selectedHostelFilter:u})=>{const d=I=>Je[a][I],f=z.useMemo(()=>{const I=t.role==="admin"||t.role==="super"?u:t.hostelId;return e.filter(D=>D.role==="cashier"&&(D.hostelId===I||D.hostelId==="all"))},[e,u,t]),[m,y]=z.useState({description:"",roomNumber:"",priority:"medium",hostelId:t.role==="admin"||t.role==="super"?"hostel1":t.hostelId,assignedTo:""}),[x,A]=z.useState(null),R=n.sort((I,D)=>D.createdAt.localeCompare(I.createdAt)),k=t.role==="admin"||t.role==="super",S=I=>I==="low"||I===""?d("low"):I==="medium"||I===""?d("medium"):I==="high"||I===""?d("high"):I,v=()=>{m.description&&(r({...m,status:"pending",createdBy:t.name,createdAt:new Date().toISOString(),hostelId:k?m.hostelId:t.hostelId}),y({description:"",roomNumber:"",priority:"medium",hostelId:k?"hostel1":t.hostelId,assignedTo:""}))},T=()=>{x&&(i(x.id,{description:x.description,roomNumber:x.roomNumber,priority:x.priority,assignedTo:x.assignedTo}),A(null))};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:d("addTask")}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{className:me,children:d("description")}),c.jsx("input",{className:oe,value:m.description,onChange:I=>y({...m,description:I.target.value}),placeholder:"..."})]}),c.jsxs("div",{className:"w-full md:w-32",children:[c.jsx("label",{className:me,children:d("room")}),c.jsx("input",{className:oe,value:m.roomNumber,onChange:I=>y({...m,roomNumber:I.target.value}),placeholder:""})]}),c.jsxs("div",{className:"w-full md:w-40",children:[c.jsx("label",{className:me,children:d("priority")}),c.jsxs("select",{className:oe,value:m.priority,onChange:I=>y({...m,priority:I.target.value}),children:[c.jsx("option",{value:"low",children:d("low")}),c.jsx("option",{value:"medium",children:d("medium")}),c.jsx("option",{value:"high",children:d("high")})]})]}),k&&c.jsxs("div",{className:"w-full md:w-48",children:[c.jsx("label",{className:me,children:d("assignTo")}),c.jsxs("select",{className:oe,value:m.assignedTo,onChange:I=>y({...m,assignedTo:I.target.value}),children:[c.jsx("option",{value:"",children:d("allCashiers")}),f.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsx(X,{onClick:v,icon:Uo,children:d("save")})]})]}),x&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-md shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:d("edit")}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:oe,value:x.description,onChange:I=>A({...x,description:I.target.value})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{className:oe,value:x.roomNumber,onChange:I=>A({...x,roomNumber:I.target.value}),placeholder:"Room"}),c.jsxs("select",{className:oe,value:x.priority,onChange:I=>A({...x,priority:I.target.value}),children:[c.jsx("option",{value:"low",children:d("low")}),c.jsx("option",{value:"medium",children:d("medium")}),c.jsx("option",{value:"high",children:d("high")})]})]}),k&&c.jsxs("div",{children:[c.jsx("label",{className:me,children:d("assignTo")}),c.jsxs("select",{className:oe,value:x.assignedTo||"",onChange:I=>A({...x,assignedTo:I.target.value}),children:[c.jsx("option",{value:"",children:d("allCashiers")}),f.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsx(X,{onClick:T,className:"w-full",children:d("save")}),c.jsx(X,{variant:"secondary",onClick:()=>A(null),className:"w-full",children:d("cancel")})]})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(I=>{const D=I.assignedTo?e.find(P=>P.id===I.assignedTo):null;return c.jsxs("div",{className:`p-4 rounded-xl border flex flex-col justify-between ${I.status==="done"?"bg-slate-50 border-slate-200 opacity-70":"bg-white border-indigo-100 shadow-sm"}`,children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${I.priority==="high"?"bg-rose-100 text-rose-600":"bg-slate-100 text-slate-500"}`,children:S(I.priority)}),I.roomNumber&&c.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[d("room")," ",I.roomNumber]})]}),c.jsx("p",{className:`font-medium ${I.status==="done"?"line-through text-slate-400":"text-slate-800"}`,children:I.description}),c.jsxs("div",{className:"text-[10px] text-slate-400 mt-2",children:[d("createdBy"),": ",I.createdBy,"  ",new Date(I.createdAt).toLocaleDateString(),D&&c.jsxs("div",{className:"mt-1 text-indigo-600",children:[" ",D.name]})]})]}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[I.status!=="done"?c.jsx(X,{size:"sm",variant:"success",onClick:()=>s(I.id),icon:eT,children:d("done")}):c.jsx("span",{}),k&&c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>A(I),className:"p-1.5 text-blue-500 hover:bg-blue-50 rounded",children:c.jsx(Gl,{size:16})}),c.jsx("button",{onClick:()=>o(I.id),className:"p-1.5 text-rose-500 hover:bg-rose-50 rounded",children:c.jsx(Jo,{size:16})})]})]})]},I.id)})})]})},aD=({clients:n,onClose:e,onCreate:t,lang:r})=>{const s=x=>Je[r][x],[i,o]=z.useState(""),[a,u]=z.useState(null),[d,f]=z.useState(""),m=n.filter(x=>x.fullName.toLowerCase().includes(i.toLowerCase())||x.passport.toLowerCase().includes(i.toLowerCase())).slice(0,5),y=()=>{!a||!d||(t(a,parseInt(d)),e())};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:s("createDebt")}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("label",{className:me,children:"Search Client"}),c.jsx("input",{className:oe,value:i,onChange:x=>{o(x.target.value),u(null)},placeholder:"Name or Passport"}),i.length>1&&!a&&c.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-slate-200 rounded-xl shadow-xl mt-1 z-50 max-h-40 overflow-y-auto",children:m.map(x=>c.jsxs("div",{onClick:()=>{u(x),o(x.fullName)},className:"p-3 hover:bg-indigo-50 cursor-pointer border-b border-slate-50 last:border-0",children:[c.jsx("div",{className:"font-bold text-sm",children:x.fullName}),c.jsx("div",{className:"text-xs text-slate-500",children:x.passport})]},x.id))})]}),a&&c.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200 text-sm",children:["Selected: ",c.jsx("b",{children:a.fullName})," (",a.passport,")"]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Debt Amount"}),c.jsx("input",{type:"number",className:oe,value:d,onChange:x=>f(x.target.value),placeholder:"0"})]}),c.jsx(X,{onClick:y,disabled:!a||!d,className:"w-full",children:s("save")}),c.jsx(X,{variant:"secondary",onClick:e,className:"w-full",children:s("cancel")})]})]})})},lD=({guests:n,users:e,lang:t,onPayDebt:r,currentUser:s,onAdminAdjustDebt:i,clients:o,onCreateDebt:a})=>{const u=K=>Je[t][K],[d,f]=z.useState(""),[m,y]=z.useState(""),x=z.useMemo(()=>{const K={};return n.forEach(re=>{var ot;if(re.status==="booking")return;const Ie=zo(re),be=re.totalPrice-Ie;if(be>0){const je=m?re.checkInDate>=m:!0,Xe=d?re.staffId===d||((ot=e.find(Ve=>Ve.id===d))==null?void 0:ot.login)===re.staffId:!0;if(je&&Xe){const Ve=re.passport||re.fullName;K[Ve]||(K[Ve]={...re,totalDebt:0,records:[]}),K[Ve].totalDebt+=be,K[Ve].records.push(re)}}}),Object.values(K)},[n,m,d,e]),A=x.reduce((K,re)=>K+re.totalDebt,0),R=s.role==="admin"||s.role==="super",[k,S]=z.useState(null),[v,T]=z.useState(""),[I,D]=z.useState(""),[P,w]=z.useState(""),[g,_]=z.useState(""),[b,C]=z.useState(!1),[V,N]=z.useState(!1),[Ee,F]=z.useState(null),[_e,pe]=z.useState(!1),G=K=>{S(K),C(!0),T(""),D(""),w(""),F(null)},W=K=>{S(K),N(!0),_("")},le=()=>{if(!k)return;const K=parseInt(v)||0,re=parseInt(I)||0,Ie=parseInt(P)||0,be=K+re+Ie;if(be<=0)return;const ot=k.records.map(je=>({id:je.id,currentDebt:je.totalPrice-zo(je)}));r(ot,be,{cash:K,card:re,qr:Ie}),C(!1)},ge=()=>{if(!k||!g)return;const K=k.records[0];i(K.id,parseInt(g)),N(!1)},he=K=>{const re=K==="payCash"?0:parseInt(v)||0,Ie=K==="payCard"?0:parseInt(I)||0,be=K==="payQR"?0:parseInt(P)||0,ot=re+Ie+be,je=Math.max(0,k.totalDebt-ot);K==="payCash"&&T(String(je)),K==="payCard"&&D(String(je)),K==="payQR"&&w(String(je)),F(K)},$=K=>{K.currentTarget.blur()};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-slate-200 flex flex-col md:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{className:me,children:u("staff")}),c.jsxs("select",{className:oe,value:d,onChange:K=>f(K.target.value),children:[c.jsx("option",{value:"",children:"All"}),e.map(K=>c.jsx("option",{value:K.id,children:K.name},K.id))]})]}),c.jsxs("div",{className:"w-full md:w-auto",children:[c.jsx("label",{className:me,children:u("date")}),c.jsx("input",{type:"date",className:oe,value:m,onChange:K=>y(K.target.value)})]}),c.jsxs("div",{className:"px-6 py-2 bg-rose-50 border border-rose-200 rounded-xl text-center w-full md:w-auto min-w-[200px]",children:[c.jsxs("div",{className:"text-xs font-bold text-rose-500 uppercase",children:[u("total")," ",u("debt")]}),c.jsx("div",{className:"text-2xl font-bold text-rose-700",children:A.toLocaleString()})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(X,{icon:Uo,onClick:()=>pe(!0),children:u("createDebt")}),c.jsx(X,{variant:"secondary",icon:Ya,onClick:()=>q2(x,A),children:u("print")})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:[c.jsxs("table",{className:"w-full text-sm text-left min-w-[600px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:u("guestName")}),c.jsx("th",{className:"p-4",children:u("passport")}),c.jsx("th",{className:"p-4",children:u("staff")}),c.jsx("th",{className:"p-4 text-right",children:u("debt")}),c.jsx("th",{className:"p-4 text-right",children:u("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:x.map(K=>{var re;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"p-4 font-bold",children:K.fullName}),c.jsx("td",{className:"p-4 font-mono",children:K.passport}),c.jsx("td",{className:"p-4",children:((re=e.find(Ie=>Ie.id===K.staffId||Ie.login===K.staffId))==null?void 0:re.name)||K.staffId}),c.jsx("td",{className:"p-4 text-right font-bold text-rose-600",children:K.totalDebt.toLocaleString()}),c.jsxs("td",{className:"p-4 text-right flex justify-end gap-2",children:[c.jsx(X,{size:"sm",onClick:()=>G(K),children:u("payDebt")}),R&&c.jsx(X,{size:"sm",variant:"secondary",onClick:()=>W(K),children:u("addDebt")})]})]},K.id)})})]}),x.length===0&&c.jsx("div",{className:"p-8 text-center text-slate-400",children:u("noData")})]}),b&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-sm shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:u("payDebt")}),c.jsxs("p",{className:"mb-4 text-sm",children:[k==null?void 0:k.fullName," (Total: ",k==null?void 0:k.totalDebt.toLocaleString(),")"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("cash")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:v,onChange:K=>{T(K.target.value),F(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payCash"),disabled:Ee&&Ee!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("card")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:I,onChange:K=>{D(K.target.value),F(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payCard"),disabled:Ee&&Ee!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:u("qr")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:P,onChange:K=>{w(K.target.value),F(null)},placeholder:"0",onWheel:$}),c.jsx("button",{type:"button",onClick:()=>he("payQR"),disabled:Ee&&Ee!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx(X,{className:"flex-1",onClick:le,children:u("save")}),c.jsx(X,{variant:"secondary",className:"flex-1",onClick:()=>C(!1),children:u("cancel")})]})]})}),V&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-sm shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4",children:[u("addDebt")," (Admin)"]}),c.jsx("p",{className:"mb-4 text-sm text-slate-500",children:"Enter +/- amount to adjust total price."}),c.jsx("input",{className:oe,type:"number",value:g,onChange:K=>_(K.target.value),placeholder:"+/- Amount"}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx(X,{className:"flex-1",onClick:ge,children:u("save")}),c.jsx(X,{variant:"secondary",className:"flex-1",onClick:()=>N(!1),children:u("cancel")})]})]})}),_e&&c.jsx(aD,{clients:o,onClose:()=>pe(!1),onCreate:a,lang:t}),c.jsx("style",{children:`
                .no-spinner::-webkit-outer-spin-button, .no-spinner::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
                .no-spinner { -moz-appearance: textfield; }
            `})]})},cD=({payments:n,expenses:e,users:t,guests:r,currentUser:s,onDeletePayment:i,lang:o})=>{const a=I=>Je[o][I],u=[{id:"hostel1",name:" 1"},{id:"hostel2",name:" 2"}],[d,f]=z.useState({start:oo(new Date(new Date().setHours(0,0,0,0))),end:oo(new Date(new Date().setHours(23,59,59,999))),staffId:"",method:"",hostelId:s.role==="admin"&&s.hostelId!=="all"?s.hostelId:""}),[m,y]=z.useState({start:oo(new Date(new Date().setHours(0,0,0,0))),end:oo(new Date(new Date().setHours(23,59,59,999))),staffId:"",method:"",hostelId:s.role==="admin"&&s.hostelId!=="all"?s.hostelId:""}),x=()=>{y(d)},R=z.useMemo(()=>{const I=n.map(P=>{let w=P.hostelId;if(!w&&P.staffId){const g=t.find(_=>_.id===P.staffId||_.login===P.staffId);g&&(w=g.hostelId)}return{...P,type:"income",id:P.id,hostelId:w}}),D=e.map(P=>{let w=P.hostelId;if(!w&&P.staffId){const g=t.find(_=>_.id===P.staffId||_.login===P.staffId);g&&(w=g.hostelId)}return{...P,type:"expense",method:"cash",id:P.id,hostelId:w}});return[...I,...D].sort((P,w)=>new Date(w.date)-new Date(P.date))},[n,e,t]).filter(I=>{var V;const D=new Date(I.date).getTime(),P=m.start?new Date(m.start).getTime():0,w=m.end?new Date(m.end).getTime():1/0,g=D>=P&&D<=w,_=m.staffId?I.staffId===m.staffId||((V=t.find(N=>N.id===m.staffId))==null?void 0:V.login)===I.staffId:!0,b=m.method?I.method===m.method:!0,C=m.hostelId?I.hostelId===m.hostelId:!0;return parseInt(I.amount)===0?!1:g&&_&&b&&C}),k=z.useMemo(()=>d.hostelId?t.filter(I=>I.hostelId===d.hostelId||I.hostelId==="all"):t,[t,d.hostelId]),S=R.filter(I=>I.type==="income").reduce((I,D)=>I+(parseInt(D.amount)||0),0),v=R.filter(I=>I.type==="expense").reduce((I,D)=>I+(parseInt(D.amount)||0),0),T=()=>{const I=R.map(D=>{var P,w,g;return{date:new Date(D.date).toLocaleString(),type:D.type,staff:((P=t.find(_=>_.id===D.staffId||_.login===D.staffId))==null?void 0:P.name)||D.staffId,hostel:((w=u.find(_=>_.id===D.hostelId))==null?void 0:w.name)||D.hostelId||"-",amount:D.amount,method:D.method||"-",comment:D.comment||(D.guestId?(g=r.find(_=>_.id===D.guestId))==null?void 0:g.fullName:"-")}});B2(I,`Otchet_${m.hostelId||"All"}.xls`)};return c.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[c.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end mb-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:"From"}),c.jsx("input",{type:"datetime-local",className:oe,value:d.start,onChange:I=>f({...d,start:I.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"To"}),c.jsx("input",{type:"datetime-local",className:oe,value:d.end,onChange:I=>f({...d,end:I.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:a("staff")}),c.jsxs("select",{className:oe,value:d.staffId,onChange:I=>f({...d,staffId:I.target.value}),children:[c.jsx("option",{value:"",children:"All"}),k.map(I=>c.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Payment Method"}),c.jsxs("select",{className:oe,value:d.method,onChange:I=>f({...d,method:I.target.value}),children:[c.jsx("option",{value:"",children:"All"}),c.jsx("option",{value:"cash",children:a("cash")}),c.jsx("option",{value:"card",children:a("card")}),c.jsx("option",{value:"qr",children:a("qr")})]})]})]}),c.jsxs("div",{className:"flex gap-2 justify-end border-t border-slate-100 pt-4",children:[c.jsx(X,{onClick:x,icon:eT,className:"flex-1 md:flex-none",children:a("save")}),c.jsx(X,{icon:Ya,variant:"secondary",onClick:()=>G2(R,S,v,m,t),className:"flex-1 md:flex-none",children:a("printReport")}),c.jsx(X,{icon:nT,variant:"secondary",onClick:T,className:"flex-1 md:flex-none",children:"Export (XLS)"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-emerald-600 font-bold uppercase",children:a("income")}),c.jsxs("div",{className:"text-2xl font-bold text-emerald-800",children:["+",S.toLocaleString()]})]}),c.jsxs("div",{className:"bg-rose-50 border border-rose-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-rose-600 font-bold uppercase",children:a("expense")}),c.jsxs("div",{className:"text-2xl font-bold text-rose-800",children:["-",v.toLocaleString()]})]}),c.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-xl text-center",children:[c.jsx("div",{className:"text-sm text-slate-600 font-bold uppercase",children:a("balance")}),c.jsx("div",{className:"text-2xl font-bold text-slate-800",children:(S-v).toLocaleString()})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden overflow-x-auto",children:[c.jsxs("table",{className:"w-full text-sm text-left min-w-[700px]",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:a("date")}),c.jsx("th",{className:"p-4",children:"Hostel"}),c.jsx("th",{className:"p-4",children:"Type"}),c.jsx("th",{className:"p-4",children:a("amount")}),c.jsx("th",{className:"p-4",children:"Method"}),c.jsx("th",{className:"p-4",children:a("staff")}),c.jsx("th",{className:"p-4",children:"Details"}),s.role==="super"&&c.jsx("th",{className:"p-4",children:a("action")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:R.map((I,D)=>{var P,w,g;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"p-4 text-slate-500",children:new Date(I.date).toLocaleString()}),c.jsx("td",{className:"p-4 font-bold text-slate-600",children:((P=u.find(_=>_.id===I.hostelId))==null?void 0:P.name)||"N/A"}),c.jsx("td",{className:"p-4",children:I.type==="income"?c.jsx("span",{className:"bg-emerald-100 text-emerald-700 px-2 py-1 rounded text-xs font-bold",children:"IN"}):c.jsx("span",{className:"bg-rose-100 text-rose-700 px-2 py-1 rounded text-xs font-bold",children:"OUT"})}),c.jsx("td",{className:`p-4 font-bold ${I.type==="income"?"text-emerald-700":"text-rose-700"}`,children:parseInt(I.amount).toLocaleString()}),c.jsx("td",{className:"p-4 uppercase text-xs font-bold text-slate-500",children:I.method}),c.jsx("td",{className:"p-4",children:((w=t.find(_=>_.id===I.staffId||_.login===I.staffId))==null?void 0:w.name)||"N/A"}),c.jsx("td",{className:"p-4 text-slate-600 truncate max-w-[200px]",children:I.comment||(I.guestId?(g=r.find(_=>_.id===I.guestId))==null?void 0:g.fullName:"-")}),s.role==="super"&&c.jsx("td",{className:"p-4",children:c.jsx("button",{onClick:()=>i(I.id,I.type),className:"text-rose-500 hover:bg-rose-50 p-2 rounded",title:"Delete",children:c.jsx(Jo,{size:16})})})]},D)})})]}),R.length===0&&c.jsx("div",{className:"p-8 text-center text-slate-400",children:a("noData")})]})]})},uD=({shifts:n,users:e,currentUser:t,onStartShift:r,onEndShift:s,onTransferShift:i,lang:o,hostelId:a,onAdminAddShift:u,onAdminUpdateShift:d})=>{const f=F=>Je[o][F],m=t.role==="admin"||t.role==="super",y=n.find(F=>F.staffId===t.id&&!F.endTime),x=e.filter(F=>F.role==="cashier"&&F.id!==t.id),[A,R]=z.useState(""),[k,S]=z.useState({start:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[v,T]=z.useState(""),[I,D]=z.useState(!1),[P,w]=z.useState(null),[g,_]=z.useState({staffId:"",startTime:"",endTime:"",hostelId:"hostel1"}),b=z.useMemo(()=>{let F=n;if(!m)F=F.filter(_e=>_e.staffId===t.id);else{const _e=new Date(k.start);_e.setHours(0,0,0,0);const pe=new Date(k.end);pe.setHours(23,59,59,999),F=F.filter(G=>{const W=new Date(G.startTime);return W>=_e&&W<=pe}),v&&(F=F.filter(G=>G.staffId===v))}return F.sort((_e,pe)=>new Date(pe.startTime)-new Date(_e.startTime))},[n,m,t.id,k,v]),C=z.useMemo(()=>b.reduce((F,_e)=>_e.endTime?F+Uh(_e.startTime,_e.endTime):F,0),[b]),V=()=>{const F=b.map(W=>{var re,Ie;const le=((re=e.find(be=>be.id===W.staffId))==null?void 0:re.name)||"Unknown",ge=new Date(W.startTime),he=W.endTime?new Date(W.endTime):null,$=he?((he-ge)/(1e3*60*60)).toFixed(1):"Active",K=he?Uh(W.startTime,W.endTime):0;return{staff:le,hostel:((Ie=On[W.hostelId])==null?void 0:Ie.name)||W.hostelId,date:ge.toLocaleDateString(),start:ge.toLocaleTimeString(),end:he?he.toLocaleTimeString():"Active",hours:$,salary:K}});let _e=`
            <html>
            <head><meta charset="UTF-8"></head>
            <body>
            <h2 style="text-align:center">  (${k.start} - ${k.end})</h2>
            <table border="1" style="border-collapse: collapse; width: 100%;">
                <thead style="background-color: #4f46e5; color: white;">
                    <tr>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                        <th style="padding:10px"></th>
                    </tr>
                </thead>
                <tbody>
        `;F.forEach(W=>{_e+=`
                <tr>
                    <td style="padding:5px">${W.staff}</td>
                    <td style="padding:5px">${W.hostel}</td>
                    <td style="padding:5px">${W.date}</td>
                    <td style="padding:5px">${W.start}</td>
                    <td style="padding:5px">${W.end}</td>
                    <td style="text-align:center">${W.hours}</td>
                    <td style="text-align:right;">${W.salary.toLocaleString()}</td>
                </tr>
            `}),_e+=`
            <tr style="background-color: #f3f4f6; font-weight: bold;">
                <td colspan="6" style="padding:10px; text-align:right;">:</td>
                <td style="padding:10px; text-align:right;">${C.toLocaleString()}</td>
            </tr>
        </tbody></table></body></html>`;const pe=new Blob([_e],{type:"application/vnd.ms-excel"}),G=document.createElement("a");G.href=URL.createObjectURL(pe),G.download="Shifts_Report.xls",G.click()},N=()=>{const F={...g,startTime:new Date(g.startTime).toISOString(),endTime:g.endTime?new Date(g.endTime).toISOString():null};P?d(P.id,F):u(F),D(!1),w(null)},Ee=F=>{w(F),_({staffId:F.staffId,hostelId:F.hostelId||"hostel1",startTime:oo(new Date(F.startTime)),endTime:F.endTime?oo(new Date(F.endTime)):""}),D(!0)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[c.jsx("div",{children:c.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[c.jsx(ug,{className:"text-indigo-600"})," ",f("shifts")]})}),!m&&c.jsxs("div",{className:"flex gap-2",children:[!y&&c.jsx(X,{icon:lT,onClick:r,children:f("startShift")}),y&&c.jsxs("div",{className:"flex gap-2 items-center bg-slate-100 p-1 rounded-xl",children:[c.jsxs("select",{className:"bg-white border-0 rounded-lg text-sm py-2 px-3 focus:ring-0",value:A,onChange:F=>R(F.target.value),children:[c.jsx("option",{value:"",children:" ..."}),x.map(F=>{var _e;return c.jsxs("option",{value:F.id,children:[F.name," (",(_e=On[F.hostelId])==null?void 0:_e.name,")"]},F.id)})]}),c.jsx(X,{size:"sm",variant:"secondary",onClick:()=>i(y.id,A),disabled:!A,children:f("transferShift")}),c.jsx("div",{className:"w-px h-6 bg-slate-300 mx-1"}),c.jsx(X,{size:"sm",variant:"danger",onClick:s,children:f("endShift")})]})]}),m&&c.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[c.jsx("input",{type:"date",className:"border rounded-lg px-2 py-2 text-sm",value:k.start,onChange:F=>S({...k,start:F.target.value})}),c.jsx("span",{children:"-"}),c.jsx("input",{type:"date",className:"border rounded-lg px-2 py-2 text-sm",value:k.end,onChange:F=>S({...k,end:F.target.value})}),c.jsxs("select",{className:"border rounded-lg px-2 py-2 text-sm max-w-[150px]",value:v,onChange:F=>T(F.target.value),children:[c.jsx("option",{value:"",children:" "}),e.filter(F=>F.role!=="super").map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]}),c.jsx(X,{icon:Uo,onClick:()=>{var F;w(null),_({staffId:(F=e[0])==null?void 0:F.id,startTime:"",endTime:"",hostelId:"hostel1"}),D(!0)},children:""}),c.jsx(X,{icon:rT,variant:"secondary",onClick:V,children:"Excel"})]})]}),c.jsx("div",{className:"overflow-hidden border rounded-xl",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-xs",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-4",children:f("staff")}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:""}),c.jsx("th",{className:"p-4",children:f("workedHours")}),c.jsx("th",{className:"p-4 text-right",children:f("salaryCalc")}),m&&c.jsx("th",{className:"p-4 text-right",children:"Edit"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-100",children:[b.map(F=>{var W,le;const _e=((W=e.find(ge=>ge.id===F.staffId))==null?void 0:W.name)||"Unknown",pe=F.endTime?((new Date(F.endTime)-new Date(F.startTime))/(1e3*60*60)).toFixed(1):"-",G=F.endTime?Uh(F.startTime,F.endTime).toLocaleString():"...";return c.jsxs("tr",{className:F.endTime?"hover:bg-slate-50":"bg-emerald-50",children:[c.jsx("td",{className:"p-4 font-bold",children:_e}),c.jsx("td",{className:"p-4 text-xs text-slate-500",children:(le=On[F.hostelId])==null?void 0:le.name}),c.jsx("td",{className:"p-4",children:new Date(F.startTime).toLocaleString()}),c.jsx("td",{className:"p-4",children:F.endTime?new Date(F.endTime).toLocaleString():c.jsx("span",{className:"text-emerald-600 font-bold",children:" ..."})}),c.jsx("td",{className:"p-4 font-mono",children:pe}),c.jsx("td",{className:"p-4 text-right font-bold text-indigo-600",children:G}),m&&c.jsx("td",{className:"p-4 text-right",children:c.jsx("button",{onClick:()=>Ee(F),className:"text-blue-500 hover:bg-blue-50 p-1 rounded",children:c.jsx(Gl,{size:16})})})]},F.id)}),m&&c.jsxs("tr",{className:"bg-slate-100 border-t-2 border-slate-300 font-bold",children:[c.jsx("td",{colSpan:"5",className:"p-4 text-right uppercase text-slate-600",children:"  :"}),c.jsx("td",{className:"p-4 text-right text-emerald-700 text-lg",children:C.toLocaleString()}),c.jsx("td",{className:"p-4"})]})]})]})})]}),I&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-4",children:P?" ":" "}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("select",{className:oe,value:g.staffId,onChange:F=>_({...g,staffId:F.target.value}),children:e.filter(F=>F.role!=="super").map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("select",{className:oe,value:g.hostelId,onChange:F=>_({...g,hostelId:F.target.value}),children:Object.keys(On).map(F=>c.jsx("option",{value:F,children:On[F].name},F))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("input",{type:"datetime-local",className:oe,value:g.startTime,onChange:F=>_({...g,startTime:F.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:""}),c.jsx("input",{type:"datetime-local",className:oe,value:g.endTime,onChange:F=>_({...g,endTime:F.target.value})})]}),c.jsx(X,{onClick:N,className:"w-full mt-4",children:""}),c.jsx(X,{variant:"secondary",onClick:()=>D(!1),className:"w-full",children:""})]})]})})]})},dD=({initialRoom:n,preSelectedBedId:e,initialDate:t,allRooms:r,guests:s,clients:i,onClose:o,onSubmit:a,notify:u,lang:d})=>{var he;const f=$=>Je[d][$],[m,y]=z.useState((n==null?void 0:n.id)||((he=r[0])==null?void 0:he.id)||""),x=r.find($=>$.id===m),[A,R]=z.useState(""),[k,S]=z.useState(!1),[v,T]=z.useState(!1),I=new Date,D=fp(I),P=fp(new Date(I.getTime()-24*60*60*1e3)),w=I.getHours()<12?P:D,[g,_]=z.useState({fullName:"",birthDate:"",passport:"",country:"",bedId:String(e||"1"),checkInDate:t||w,days:1,pricePerNight:0,payCash:"",payCard:"",payQR:""}),[b,C]=z.useState(null);z.useEffect(()=>{var $,K;if(x){const Ie=parseInt(g.bedId)%2===0?(($=x.prices)==null?void 0:$.upper)||0:((K=x.prices)==null?void 0:K.lower)||0;_(be=>({...be,pricePerNight:Ie}))}},[x,g.bedId]);const V=$=>{const K=$.target.value.toUpperCase();_(re=>({...re,fullName:K})),R(K),S(!0)},N=$=>{_(K=>({...K,fullName:$.fullName,passport:$.passport,birthDate:$.birthDate,country:$.country})),S(!1)},Ee=async $=>{const K=$.target.files[0];if(K){T(!0);try{const re=new FileReader;re.readAsDataURL(K),re.onload=async()=>{const be=re.result.toString().split(",")[1];if(!be){u("Error processing image file","error"),T(!1);return}try{const je=await g2(F2,"scanPassport")({image:be}),{success:Xe,data:Ve,error:Ze}=je.data;if(Xe)_(Jt=>({...Jt,fullName:Ve.fullName||Jt.fullName,passport:Ve.passport||Jt.passport,birthDate:Ve.birthDate||Jt.birthDate,country:Ve.country||Jt.country})),u("Passport Scanned Successfully!","success");else throw new Error(Ze||"Unknown server error")}catch(ot){console.error("Cloud Function Error:",ot),u("Scan failed: "+(ot.message||"Server Error"),"error")}finally{T(!1)}},re.onerror=()=>{u("File Read Error","error"),T(!1)}}catch(re){console.error(re),u("System Error","error"),T(!1)}}},F=A.length>1?i.filter($=>$.fullName.includes(A)||$.passport.includes(A)).slice(0,5):[],_e=(parseInt(g.pricePerNight)||0)*(parseInt(g.days)||1),pe=(parseInt(g.payCash)||0)+(parseInt(g.payCard)||0)+(parseInt(g.payQR)||0),G=_e-pe,W=$=>{const K=$==="payCash"?0:parseInt(g.payCash)||0,re=$==="payCard"?0:parseInt(g.payCard)||0,Ie=$==="payQR"?0:parseInt(g.payQR)||0,be=K+re+Ie,ot=Math.max(0,_e-be);_(je=>({...je,[$]:String(ot)})),C($)},le=($,K=!1)=>{$&&$.preventDefault();try{if(!x)return u(f("error"),"error");if(!g.fullName.trim())return u("Fill Name!","error");const re=new Date(g.checkInDate);re.setHours(12,0,0,0);const Ie=yr(re.toISOString(),g.days),be=s.filter(Ze=>Ze.roomId!==x.id||String(Ze.bedId)!==String(g.bedId)||Ze.status!=="active"&&Ze.status!=="booking"?!1:hT(Ze.checkInDate||Ze.checkInDateTime||Ze.checkIn,Ze.days,re.toISOString(),g.days));if(be.length>0)return u(`Occupied! (${be[0].fullName})`,"error");const ot=K?0:parseInt(g.payCash)||0,je=K?0:parseInt(g.payCard)||0,Xe=K?0:parseInt(g.payQR)||0,Ve=K?0:pe;a({...g,checkInDate:Ie.start.toISOString(),checkOutDate:Ie.end.toISOString(),roomId:x.id,roomNumber:x.number,hostelId:x.hostelId,bedId:String(g.bedId),paidCash:ot,paidCard:je,paidQR:Xe,amountPaid:Ve,totalPrice:_e,status:K?"booking":"active"})}catch(re){console.error(re)}},ge=$=>{$.currentTarget.blur()};return c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in fade-in zoom-in-95",children:[c.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-5xl overflow-hidden flex flex-col max-h-[95vh]",children:[c.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-20",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-2xl font-bold text-slate-900 flex items-center gap-3",children:[f("checkin")," ",x&&c.jsxs("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 text-sm rounded-full font-bold",children:["Room ",x.number]})]}),c.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"New Guest"})]}),c.jsx("button",{onClick:o,type:"button",className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:c.jsx(dg,{className:"text-slate-400 hover:text-slate-600",size:32})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-50/50 p-8",children:c.jsxs("form",{onSubmit:$=>le($,!1),className:"flex flex-col gap-6",children:[c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm h-full relative flex flex-col",children:[v&&c.jsxs("div",{className:"absolute inset-0 z-50 bg-white/90 backdrop-blur-sm flex flex-col items-center justify-center rounded-2xl animate-in fade-in",children:[c.jsx(oT,{className:"animate-spin text-indigo-600 mb-4",size:50}),c.jsx("span",{className:"font-bold text-slate-800 text-lg",children:"AI ..."}),c.jsx("span",{className:"text-slate-500 text-sm mt-1",children:", "})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(Zu,{className:"text-indigo-600",size:24}),c.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:f("guestName")})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("label",{className:"relative flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-indigo-300 rounded-xl cursor-pointer bg-indigo-50 hover:bg-indigo-100 transition-all group overflow-hidden",children:[c.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[c.jsx("div",{className:"bg-white p-3 rounded-full mb-2 shadow-sm group-hover:scale-110 transition-transform",children:c.jsx(C2,{className:"text-indigo-600",size:24})}),c.jsx("p",{className:"mb-1 text-sm font-bold text-indigo-700",children:"  / "}),c.jsx("p",{className:"text-xs text-indigo-400",children:"  ID "})]}),c.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:Ee,className:"hidden",disabled:v})]})}),c.jsxs("div",{className:"space-y-5 flex-1",children:[c.jsxs("div",{className:"relative",children:[c.jsxs("label",{className:me,children:[f("guestName")," (Search DB)"]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{className:`${oe} pl-10 py-3 text-lg font-bold text-slate-700`,value:g.fullName,onChange:V,placeholder:"IVANOV IVAN",onBlur:()=>setTimeout(()=>S(!1),200)}),c.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:c.jsx(Zu,{size:18})})]}),k&&F.length>0&&c.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-slate-200 rounded-xl shadow-xl mt-2 z-50 overflow-hidden",children:F.map($=>c.jsxs("div",{onClick:()=>N($),className:"p-3 hover:bg-indigo-50 cursor-pointer border-b border-slate-50 last:border-0 flex justify-between items-center group",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-slate-800",children:$.fullName}),c.jsx("div",{className:"text-xs text-slate-400",children:$.country})]}),c.jsx("div",{className:"bg-slate-100 px-2 py-1 rounded text-xs font-mono text-slate-500 group-hover:bg-white",children:$.passport})]},$.id))})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("passport")}),c.jsx("input",{className:`${oe} uppercase font-mono text-lg`,value:g.passport,onChange:$=>_({...g,passport:$.target.value.toUpperCase()}),placeholder:"AA1234567"})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("birthDate")}),c.jsx("input",{type:"date",className:oe,value:g.birthDate,onChange:$=>_({...g,birthDate:$.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("country")}),c.jsx("select",{className:oe,value:g.country,onChange:$=>_({...g,country:$.target.value}),children:$d.map($=>c.jsx("option",{value:$,children:$},$))})]})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm h-full",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[c.jsx(Bd,{className:"text-indigo-600",size:20}),c.jsx("h4",{className:"font-bold text-slate-800",children:"Placement"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("room")}),c.jsx("select",{className:`${oe} font-bold`,value:m,onChange:$=>y($.target.value),children:r.map($=>c.jsxs("option",{value:$.id,children:[" ",$.number]},$.id))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("bed")}),c.jsx("select",{className:oe,value:g.bedId,onChange:$=>_({...g,bedId:$.target.value}),children:x&&Array.from({length:x.capacity}).map(($,K)=>{const re=K+1;return c.jsxs("option",{value:re,children:[" ",re," ",re%2===0?"(Up)":"(Down)"]},re)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Date In"}),c.jsx("input",{type:"date",className:oe,value:g.checkInDate.split("T")[0],onChange:$=>_({...g,checkInDate:$.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:f("days")}),c.jsx("input",{type:"number",min:"1",className:`${oe} font-bold text-lg`,value:g.days,onChange:$=>_({...g,days:$.target.value}),onWheel:ge})]}),c.jsxs("div",{className:"col-span-2",children:[c.jsx("label",{className:me,children:f("price")}),c.jsx("input",{type:"number",className:oe,value:g.pricePerNight,onChange:$=>_({...g,pricePerNight:$.target.value}),onWheel:ge})]})]})]})]}),c.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-6 rounded-3xl w-full",children:[c.jsxs("h4",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2 text-lg",children:[c.jsx(Kl,{className:"text-indigo-600"})," ",f("payment")]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("cash")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payCash,onChange:$=>{_({...g,payCash:$.target.value}),C(null)},placeholder:"0",onWheel:ge}),c.jsx("button",{type:"button",onClick:()=>W("payCash"),disabled:b&&b!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:18})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("card")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payCard,onChange:$=>{_({...g,payCard:$.target.value}),C(null)},placeholder:"0",onWheel:ge}),c.jsx("button",{type:"button",onClick:()=>W("payCard"),disabled:b&&b!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:18})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs uppercase font-bold text-slate-500 mb-1 block",children:f("qr")}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-l-xl px-4 py-3 text-slate-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder-slate-400 no-spinner",value:g.payQR,onChange:$=>{_({...g,payQR:$.target.value}),C(null)},placeholder:"0",onWheel:ge}),c.jsx("button",{type:"button",onClick:()=>W("qr"),disabled:b&&b!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r-xl px-3 py-3 hover:bg-slate-50 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:18})})]})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:[c.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-xl p-4 flex justify-around items-center shadow-sm",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("total")}),c.jsx("div",{className:"font-extrabold text-slate-800 text-xl",children:_e.toLocaleString()})]}),c.jsx("div",{className:"w-px h-8 bg-slate-100 mx-2"}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("paid")}),c.jsx("div",{className:"font-extrabold text-emerald-600 text-xl",children:pe.toLocaleString()})]}),c.jsx("div",{className:"w-px h-8 bg-slate-100 mx-2"}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:f("debt")}),c.jsx("div",{className:`font-extrabold text-xl ${G>0?"text-rose-500":"text-slate-300"}`,children:G>0?G.toLocaleString():"0"})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 min-w-[300px]",children:[c.jsxs(X,{type:"button",onClick:$=>le($,!0),variant:"warning",className:"flex-1 py-4 text-lg shadow-sm",title:"Book",children:[c.jsx(Nl,{size:20})," ",f("booking")]}),c.jsx(X,{type:"button",onClick:$=>le($,!1),variant:"primary",className:"flex-[2] py-4 text-lg shadow-lg shadow-indigo-200",icon:Fo,children:f("checkin")})]})]})]})]})})]}),c.jsx("style",{children:`
            .no-spinner::-webkit-outer-spin-button, .no-spinner::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
            .no-spinner { -moz-appearance: textfield; }
          `})]})},hD=({guest:n,room:e,currentUser:t,onClose:r,onUpdate:s,onPayment:i,onCheckOut:o,onSplit:a,onOpenMove:u,onDelete:d,notify:f,onReduceDays:m,onActivateBooking:y,onReduceDaysNoRefund:x,hostelInfo:A,lang:R})=>{var Si;const k=Y=>Je[R][Y],S=zo(n),v=(n.totalPrice||0)-S,[T,I]=z.useState(null),[D,P]=z.useState(""),[w,g]=z.useState(""),[_,b]=z.useState(""),[C,V]=z.useState(1),[N,Ee]=z.useState(""),[F,_e]=z.useState(!1),[pe,G]=z.useState({fullName:n.fullName,birthDate:n.birthDate,passport:n.passport,country:n.country,pricePerNight:n.pricePerNight}),[W,le]=z.useState(1),[ge,he]=z.useState(1),[$,K]=z.useState(1),[re,Ie]=z.useState(1),[be,ot]=z.useState(n.checkInDate.split("T")[0]),je=n.status==="booking",Xe=n.status==="checked_out",[Ve,Ze]=z.useState(null),Jt=new Date,kn=new Date(n.checkInDate);let Rs=Math.max(1,Math.ceil((Jt-kn)/(1e3*60*60*24)));const Ps=Math.min(Rs,parseInt(n.days)),zn=Ps*parseInt(n.pricePerNight),Xt=S-zn,Ei=()=>{const Y=parseInt(D)||0,_t=parseInt(w)||0,qt=parseInt(_)||0;if(Y+_t+qt<=0)return f("Enter Amount","error");i(n.id,{cash:Y,card:_t,qr:qt})},Ds=()=>{const Y=parseInt(C);if(!Y)return;const _t=(n.totalPrice||0)+Y*parseInt(n.pricePerNight),qt={days:parseInt(n.days)+Y,totalPrice:_t,status:"active"},$n=yr(n.checkInDate,qt.days);qt.checkOutDate=$n.end.toISOString(),s(n.id,qt)},Ti=()=>{if(Xt<0)return f(`! : ${Math.abs(Xt).toLocaleString()}.    .`,"error");const Y=N?parseInt(N):Math.max(0,Xt),_t={totalPrice:zn,paidCash:(n.paidCash||0)-Y,amountPaid:(n.amountPaid||0)-Y};o(n,_t)},Xo=()=>{const Y=parseInt(W),_t=parseInt(ge),qt=parseInt(n.days);if(Y>=qt)return f("Split day must be less than total days","error");a(n,Y,_t),r()},Bn=()=>{const _t=parseInt(pe.pricePerNight)*parseInt(n.days);s(n.id,{...pe,totalPrice:_t}),_e(!1)},Ar=()=>{confirm(k("confirmDelete"))&&d(n)},js=async()=>{const Y=parseInt($);if(!Y||Y<=0)return f("Error days","error");if(Y>=n.days)return f("Can't remove all days","error");m(n,Y),r()},$e=async()=>{const Y=parseInt(re);if(!Y||Y<=0)return f("Error days","error");if(Y>=n.days)return f("Can't remove all days","error");x(n,Y),r()},ze=Y=>{$2(Y,n)},Cn=()=>{const Y=new Date(be);Y.setHours(12,0,0,0);const _t=yr(Y.toISOString(),n.days);s(n.id,{checkInDate:Y.toISOString(),checkOutDate:_t.end.toISOString()}),f("Date Changed!"),I(null)},Rr=Y=>{const _t=Y==="payCash"?0:parseInt(D)||0,qt=Y==="payCard"?0:parseInt(w)||0,$n=Y==="payQR"?0:parseInt(_)||0,Zo=_t+qt+$n,Vs=Math.max(0,v-Zo);Y==="payCash"&&P(String(Vs)),Y==="payCard"&&g(String(Vs)),Y==="payQR"&&b(String(Vs)),Ze(Y)},Pr=Y=>{Y.currentTarget.blur()};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in fade-in zoom-in-95",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:`${je?"bg-amber-500":Xe?"bg-slate-500":"bg-slate-900"} text-white p-6 flex justify-between items-start relative`,children:[c.jsxs("div",{className:"flex-1",children:[je&&c.jsxs("div",{className:"text-xs uppercase font-bold text-white/80 mb-1 flex items-center gap-1",children:[c.jsx(Nl,{size:12})," ",k("booking")]}),Xe&&c.jsxs("div",{className:"text-xs uppercase font-bold text-white/80 mb-1 flex items-center gap-1",children:[c.jsx(sT,{size:12})," Checked Out"]}),F?c.jsxs("div",{className:"space-y-2 text-slate-900",children:[c.jsx("input",{className:oe,value:pe.fullName,onChange:Y=>G({...pe,fullName:Y.target.value.toUpperCase()})}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("input",{className:oe,value:pe.passport,onChange:Y=>G({...pe,passport:Y.target.value.toUpperCase()})}),c.jsx("input",{type:"date",className:oe,value:pe.birthDate,onChange:Y=>G({...pe,birthDate:Y.target.value})})]}),c.jsx("select",{className:oe,value:pe.country,onChange:Y=>G({...pe,country:Y.target.value}),children:$d.map(Y=>c.jsx("option",{children:Y},Y))}),(t.role==="admin"||t.role==="super")&&c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("price")}),c.jsx("input",{type:"number",className:oe,value:pe.pricePerNight,onChange:Y=>G({...pe,pricePerNight:Y.target.value})})]}),c.jsx(X,{size:"sm",onClick:Bn,children:k("save")})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h2",{className:"text-xl font-bold",children:n.fullName}),c.jsx("button",{onClick:()=>_e(!0),className:"bg-transparent border-none p-1 text-white/60 hover:text-white transition-colors cursor-pointer",title:"",children:c.jsx(Gl,{size:18})})]}),c.jsxs("div",{className:"flex gap-4 text-sm text-white/70 mt-1 flex-wrap",children:[c.jsxs("span",{children:["Room ",n.roomNumber]}),c.jsxs("span",{children:["Bed ",n.bedId]}),c.jsx("span",{children:new Date(n.checkInDate).toLocaleDateString()}),c.jsx("span",{children:n.passport})]})]})]}),c.jsx("button",{onClick:r,className:"bg-transparent border-none p-2 text-white/60 hover:text-white transition-colors cursor-pointer hover:bg-white/10 rounded-full",children:c.jsx(dg,{size:32})})]}),!je&&c.jsxs("div",{className:`p-4 flex justify-between items-center ${v>0?"bg-rose-50 border-b border-rose-200":"bg-emerald-50 border-b border-emerald-200"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[v>0?c.jsx(XE,{className:"text-rose-600"}):c.jsx(Fo,{className:"text-emerald-600"}),c.jsx("span",{className:`font-bold ${v>0?"text-rose-700":"text-emerald-700"}`,children:v>0?`${k("debt")}: ${v.toLocaleString()}`:k("paid")})]}),c.jsxs("div",{className:"text-xs text-slate-500 text-right",children:[c.jsxs("div",{children:[k("total"),": ",(Si=n.totalPrice)==null?void 0:Si.toLocaleString()]}),c.jsxs("div",{children:[k("paid"),": ",S.toLocaleString()]})]})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[je&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs(X,{className:"w-full py-3 text-lg",onClick:()=>y(n),children:[c.jsx(Fo,{})," ",k("checkin")]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx(X,{variant:"secondary",onClick:()=>I(T==="moveDate"?null:"moveDate"),icon:j0,children:k("moveDate")}),c.jsx(X,{variant:"danger",onClick:Ar,icon:Jo,children:k("cancel")})]})]}),!je&&c.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[c.jsx(X,{variant:T==="pay"?"primary":"secondary",onClick:()=>I(T==="pay"?null:"pay"),disabled:v<=0,children:k("payment")}),c.jsx(X,{variant:T==="extend"?"primary":"secondary",onClick:()=>I(T==="extend"?null:"extend"),children:k("extend")}),!Xe&&c.jsx(X,{variant:T==="split"?"primary":"secondary",onClick:()=>I(T==="split"?null:"split"),title:"Split",children:c.jsx(P2,{size:18})}),!Xe&&c.jsx(X,{variant:T==="checkout"?"primary":"secondary",onClick:()=>I(T==="checkout"?null:"checkout"),className:"text-rose-600 border-rose-300 hover:bg-rose-50",children:k("checkout")})]}),!je&&c.jsxs("div",{className:"flex gap-2 justify-center",children:[c.jsx(X,{size:"sm",variant:"ghost",onClick:()=>ze("check"),icon:Ya,children:k("printCheck")}),c.jsx(X,{size:"sm",variant:"ghost",onClick:()=>ze("regcard"),icon:Ya,children:k("printForm")}),c.jsx(X,{size:"sm",variant:"ghost",onClick:()=>ze("ref"),icon:Ya,children:k("printRef")})]}),c.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-300",children:[!T&&!je&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-center gap-2",children:[!Xe&&c.jsx(X,{variant:"ghost",icon:ag,onClick:u,children:k("move")}),!Xe&&(t.role==="admin"||t.role==="super")&&c.jsx(X,{variant:"ghost",icon:j0,onClick:()=>I("moveDate"),children:k("moveDate")})]}),(t.role==="admin"||t.role==="super")&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"border-t border-slate-200 pt-4 flex justify-center gap-4",children:[!Xe&&c.jsxs("button",{onClick:()=>I("reduceNoRefund"),className:"text-xs text-amber-600 hover:text-amber-700 font-bold flex items-center gap-1",children:[c.jsx(A2,{size:14})," ",k("reduceNoRefund")]}),c.jsx("button",{onClick:Ar,className:"text-xs text-rose-400 hover:text-rose-600 underline",children:k("delete")})]})})]}),T==="split"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-slate-700",children:k("splitTitle")}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("splitAfter")}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:oe,value:W,onChange:Y=>le(Y.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("splitGap")}),c.jsx("input",{type:"number",min:"1",className:oe,value:ge,onChange:Y=>he(Y.target.value)})]})]}),c.jsx("div",{className:"text-xs text-slate-500 bg-white p-2 rounded border border-slate-200",children:k("splitInfo").replace("{x}",W).replace("{y}",ge).replace("{z}",n.days-W)}),c.jsx(X,{className:"w-full",onClick:Xo,children:k("confirmSplit")})]}),T==="moveDate"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-slate-700",children:k("moveDate")}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:k("newDate")}),c.jsx("input",{type:"date",className:oe,value:be,onChange:Y=>ot(Y.target.value)})]}),c.jsx(X,{className:"w-full",onClick:Cn,children:k("save")})]}),T==="pay"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:me,children:[k("amount")," (",k("debt"),": ",v,")"]}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("cash")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:D,onChange:Y=>{P(Y.target.value),Ze(null)},placeholder:"0",onWheel:Pr}),c.jsx("button",{onClick:()=>Rr("payCash"),disabled:Ve&&Ve!=="payCash",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("card")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:w,onChange:Y=>{g(Y.target.value),Ze(null)},placeholder:"0",onWheel:Pr}),c.jsx("button",{onClick:()=>Rr("payCard"),disabled:Ve&&Ve!=="payCard",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-[10px] uppercase font-bold text-slate-400",children:k("qr")}),c.jsx("input",{type:"number",className:"flex-1 px-3 py-2 bg-white border border-slate-300 rounded-l focus:ring-1 focus:ring-indigo-500 outline-none text-sm no-spinner",value:_,onChange:Y=>{b(Y.target.value),Ze(null)},placeholder:"0",onWheel:Pr}),c.jsx("button",{onClick:()=>Rr("payQR"),disabled:Ve&&Ve!=="payQR",className:"bg-white border border-l-0 border-slate-300 rounded-r px-2 py-2 text-indigo-600 disabled:opacity-40",children:c.jsx(_r,{size:16})})]})]}),c.jsx(X,{className:"w-full",onClick:Ei,children:k("payment")})]}),T==="extend"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:me,children:[k("extend")," (",k("days"),")"]}),c.jsx("input",{type:"number",min:"1",className:oe,value:C,onChange:Y=>V(Y.target.value)}),c.jsxs("div",{className:"text-right text-sm text-slate-500",children:["+ ",(C*parseInt(n.pricePerNight)).toLocaleString()]}),c.jsx(X,{className:"w-full",onClick:Ds,children:"OK"})]}),T==="checkout"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-sm space-y-1 pb-3 border-b border-slate-300",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" ():"})," ",c.jsxs("b",{children:[Ps," ."]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" :"})," ",c.jsx("b",{children:S.toLocaleString()})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:" :"})," ",c.jsx("b",{children:zn.toLocaleString()})]})]}),Xt<0?c.jsxs("div",{className:"bg-rose-100 text-rose-800 p-3 rounded-lg text-center font-bold border border-rose-200",children:[": ",Math.abs(Xt).toLocaleString()," ",c.jsx("br",{}),c.jsx("span",{className:"text-xs font-normal",children:"   ."})]}):c.jsxs("div",{className:"bg-emerald-100 text-emerald-800 p-3 rounded-lg border border-emerald-200",children:[c.jsxs("div",{className:"text-center font-bold mb-2",children:[" : ",Xt.toLocaleString()]}),Xt>0&&c.jsxs("div",{children:[c.jsx("label",{className:`${me} mb-1`,children:k("manualRefund")}),c.jsx("input",{type:"number",className:oe,value:N,placeholder:Xt,onChange:Y=>Ee(Y.target.value)})]})]}),c.jsx(X,{variant:"danger",className:"w-full",onClick:Ti,disabled:Xt<0,children:k("checkout")})]}),(t.role==="admin"||t.role==="super")&&!je&&!T&&c.jsxs("div",{className:"mt-6 p-4 border-t border-slate-100",children:[c.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:"Reduce Days (Refund)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 items-end",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Reduce by (days)"}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:oe,value:$,onChange:Y=>K(Y.target.value)})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Refund:"}),c.jsx("div",{className:"font-bold",children:((parseInt(n.pricePerNight)||0)*(parseInt($)||0)).toLocaleString()})]}),c.jsx("div",{className:"col-span-2",children:c.jsx(X,{className:"w-full",variant:"secondary",onClick:js,children:"Apply & Refund"})})]})]}),T==="reduceNoRefund"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-bold text-amber-700",children:k("reduceNoRefund")}),c.jsx("p",{className:"text-xs text-slate-500",children:"Money stays in register. Guest stay is shortened."}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:"Reduce by (days)"}),c.jsx("input",{type:"number",min:"1",max:n.days-1,className:oe,value:re,onChange:Y=>Ie(Y.target.value)})]}),c.jsx(X,{className:"w-full",variant:"warning",onClick:$e,children:"Apply (No Refund)"})]})]})]})]})})},fD=({user:n,payments:e=[],expenses:t,onClose:r,onLogout:s,notify:i,onEndShift:o,lang:a})=>{const u=v=>Je[a][v],d=n.lastShiftEnd||"1970-01-01T00:00:00.000Z",f=e.filter(v=>(v.staffId===n.id||v.staffId===n.login)&&v.date>d),m=t.filter(v=>(v.staffId===n.id||v.staffId===n.login)&&v.date>d),y={cash:f.reduce((v,T)=>v+(T.method==="cash"&&parseInt(T.amount)||0),0),card:f.reduce((v,T)=>v+(T.method==="card"&&parseInt(T.amount)||0),0),qr:f.reduce((v,T)=>v+(T.method==="qr"&&parseInt(T.amount)||0),0)},x=m.reduce((v,T)=>v+(parseInt(T.amount)||0),0),A=y.cash+y.card+y.qr,R=y.cash-x,k=()=>{const v=`<b>  </b>
: ${n.name}
---
 : ${y.cash.toLocaleString()}
 : ${y.card.toLocaleString()}
 QR: ${y.qr.toLocaleString()}
---
<b> : ${A.toLocaleString()}</b>
 : ${x.toLocaleString()}
<b>  : ${R.toLocaleString()}</b>`;hp(v),o()},S=()=>{const T=[`User: ${n.name}`,`Cash: ${y.cash.toLocaleString()}`,`Card: ${y.card.toLocaleString()}`,`QR: ${y.qr.toLocaleString()}`,`TOTAL: ${A.toLocaleString()}`,`Exp: ${x.toLocaleString()}`,`HAND: ${R.toLocaleString()}`].join(`
`),I=document.createElement("textarea");I.value=T,document.body.appendChild(I),I.select();try{document.execCommand("copy"),i("Copied!","success")}catch{}document.body.removeChild(I)};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/80 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-lg shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"bg-slate-900 p-6 text-white flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[c.jsx(aT,{size:20,className:"text-rose-400"})," ",u("shiftClose")]}),c.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[u("staff"),": ",n.name]})]}),c.jsx("button",{onClick:r,className:"p-2 bg-white/10 rounded-full hover:bg-white/20",children:c.jsx(dg,{size:20})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto bg-slate-50 space-y-6",children:[c.jsxs("div",{className:"bg-indigo-50 p-5 rounded-2xl border border-indigo-200 shadow-sm text-center",children:[c.jsx("h3",{className:"text-xs font-bold text-indigo-500 uppercase tracking-wider mb-1",children:u("total")}),c.jsx("div",{className:"text-3xl font-extrabold text-indigo-700",children:A.toLocaleString()}),c.jsxs("div",{className:"text-xs text-indigo-400 mt-1",children:[u("cash")," + ",u("card")," + ",u("qr")]})]}),c.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm",children:[c.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4",children:["Kassa (",u("cash"),")"]}),c.jsxs("div",{className:"flex justify-between items-center mb-2 text-sm",children:[c.jsxs("span",{className:"text-slate-600",children:[u("income"),":"]}),c.jsxs("span",{className:"font-bold text-slate-900",children:["+",y.cash.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between items-center mb-4 text-sm",children:[c.jsxs("span",{className:"text-rose-600",children:[u("expense"),":"]}),c.jsxs("span",{className:"font-bold text-rose-600",children:["-",x.toLocaleString()]})]}),c.jsxs("div",{className:"pt-3 border-t border-dashed border-slate-300 flex justify-between items-center",children:[c.jsxs("span",{className:"font-bold text-lg text-slate-800",children:[u("cashInHand"),":"]}),c.jsx("span",{className:"font-bold text-2xl text-emerald-600",children:R.toLocaleString()})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[c.jsx("div",{className:"text-slate-400 text-xs font-bold uppercase mb-1",children:u("card")}),c.jsx("div",{className:"text-lg font-bold text-slate-800",children:y.card.toLocaleString()})]}),c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[c.jsx("div",{className:"text-slate-400 text-xs font-bold uppercase mb-1",children:u("qr")}),c.jsx("div",{className:"text-lg font-bold text-slate-800",children:y.qr.toLocaleString()})]})]})]}),c.jsxs("div",{className:"p-4 bg-white border-t border-slate-200 flex flex-col gap-3",children:[c.jsx(X,{variant:"secondary",onClick:S,icon:tT,className:"w-full",children:"Copy"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(X,{variant:"ghost",className:"flex-1",onClick:r,children:u("cancel")}),c.jsx(X,{variant:"danger",className:"flex-1",icon:cg,onClick:k,children:u("shiftClose")})]})]})]})})},pD=({onClose:n,onSubmit:e,lang:t})=>{const r=a=>Je[t][a],s=t==="uz"?[" ","-",""," ","",""]:["","","","","",""],[i,o]=z.useState({amount:"",category:s[0],comment:""});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2",children:[c.jsx(Kl,{size:20,className:"text-rose-500"})," ",r("expense")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("amount")}),c.jsx("input",{type:"number",className:oe,value:i.amount,onChange:a=>o({...i,amount:a.target.value}),placeholder:"0"})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("category")}),c.jsx("select",{className:oe,value:i.category,onChange:a=>o({...i,category:a.target.value}),children:s.map(a=>c.jsx("option",{value:a,children:a},a))})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:r("comment")}),c.jsx("input",{className:oe,value:i.comment,onChange:a=>o({...i,comment:a.target.value}),placeholder:"..."})]}),c.jsx(X,{onClick:()=>e(i),className:"w-full mt-4",disabled:!i.amount,children:r("save")}),c.jsx(X,{variant:"secondary",onClick:n,className:"w-full",children:r("cancel")})]})]})})},L0=({title:n,initialData:e={},onClose:t,onSubmit:r,lang:s})=>{const i=u=>Je[s][u],[o,a]=z.useState({number:e.number||"",capacity:e.capacity||"4",prices:e.prices||{lower:0,upper:0}});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-xl",children:[c.jsx("h3",{className:"font-bold text-lg mb-6",children:n}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("room")}),c.jsx("input",{className:oe,value:o.number,onChange:u=>a({...o,number:u.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:me,children:i("bed")}),c.jsx("input",{type:"number",className:oe,value:o.capacity,onChange:u=>a({...o,capacity:u.target.value})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:me,children:[i("price")," (Down)"]}),c.jsx("input",{type:"number",className:oe,value:o.prices.lower,onChange:u=>a({...o,prices:{...o.prices,lower:u.target.value}})})]}),c.jsxs("div",{children:[c.jsxs("label",{className:me,children:[i("price")," (Up)"]}),c.jsx("input",{type:"number",className:oe,value:o.prices.upper,onChange:u=>a({...o,prices:{...o.prices,upper:u.target.value}})})]})]}),c.jsx(X,{onClick:()=>r(o),className:"w-full mt-4",children:i("save")}),c.jsx(X,{variant:"secondary",onClick:t,className:"w-full",children:i("cancel")})]})]})})},mD=({guest:n,allRooms:e,guests:t,onClose:r,onMove:s,notify:i,lang:o})=>{const a=R=>Je[o][R],[u,d]=z.useState(n.roomId),[f,m]=z.useState(""),y=e.find(R=>R.id===u),x=y?Array.from({length:y.capacity},(R,k)=>k+1):[],A=()=>{if(!u||!f)return i("Select Destination","error");const R=t.filter(k=>k.roomId===u&&String(k.bedId)===String(f)&&(k.status==="active"||k.status==="booking")&&k.id!==n.id&&hT(k.checkInDate,k.days,n.checkInDate,n.days));if(R.length>0)return i(`Occupied! (${R[0].fullName})`,"error");s(n,u,y.number,String(f))};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-xl",children:[c.jsxs("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2",children:[c.jsx(ag,{size:20})," ",a("move")]}),c.jsxs("p",{className:"text-sm text-slate-500 mb-4",children:[a("guestName"),": ",c.jsx("b",{children:n.fullName})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:me,children:["New ",a("room")]}),c.jsx("select",{className:oe,value:u,onChange:R=>{d(R.target.value),m("")},children:e.map(R=>c.jsxs("option",{value:R.id,children:["Room ",R.number]},R.id))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:me,children:["New ",a("bed")]}),c.jsxs("select",{className:oe,value:f,onChange:R=>m(R.target.value),children:[c.jsx("option",{value:"",children:"Select Bed"}),x.map(R=>c.jsxs("option",{value:R,children:["Bed ",R," ",R%2===0?"(Up)":"(Down)"]},R))]})]}),c.jsx(X,{onClick:A,className:"w-full mt-4",children:a("move")}),c.jsx(X,{variant:"secondary",onClick:r,className:"w-full",children:a("cancel")})]})]})})},gD=({activeShift:n,activeUser:e,currentUser:t,onLogout:r,onTransferToMe:s})=>c.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-900 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-3xl max-w-md w-full p-8 text-center shadow-2xl relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-rose-500"}),c.jsx("div",{className:"mb-6 flex justify-center",children:c.jsx("div",{className:"w-20 h-20 bg-rose-100 rounded-full flex items-center justify-center text-rose-600 animate-pulse",children:c.jsx(aT,{size:40})})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:" "}),c.jsxs("p",{className:"text-slate-500 mb-6",children:["       ",c.jsx("b",{children:(e==null?void 0:e.name)||" "}),".",c.jsx("br",{}),"   ,       ."]}),c.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6 text-left",children:[c.jsx("div",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:" :"}),c.jsxs("div",{className:"font-bold text-slate-700",children:[": ",new Date(n.startTime).toLocaleString()]}),c.jsx("div",{className:"text-sm text-emerald-600 font-bold mt-1",children:" "})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(X,{onClick:()=>s(n.id,t.id),className:"w-full py-3",variant:"primary",icon:ag,children:"  ( )"}),c.jsx(X,{onClick:r,className:"w-full py-3",variant:"secondary",icon:cg,children:""})]})]})});function yD(){var Ai,sa;const[n,e]=z.useState(null),[t,r]=z.useState(null),[s,i]=z.useState("dashboard"),[o,a]=z.useState("hostel1"),[u,d]=z.useState(navigator.onLine),[f,m]=z.useState(!1),[y,x]=z.useState(!0),[A,R]=z.useState(null),[k,S]=z.useState("ru"),v=(j,U="success")=>{R({message:j,type:U})},[T,I]=z.useState([]),[D,P]=z.useState([]),[w,g]=z.useState([]),[_,b]=z.useState([]),[C,V]=z.useState([]),[N,Ee]=z.useState([]),[F,_e]=z.useState([]),[pe,G]=z.useState([]),[W,le]=z.useState({open:!1,room:null,bedId:null,date:null}),[ge,he]=z.useState({open:!1,guest:null}),[$,K]=z.useState({open:!1,guest:null}),[re,Ie]=z.useState(!1),[be,ot]=z.useState(!1),[je,Xe]=z.useState(!1),[Ve,Ze]=z.useState({open:!1,room:null}),Jt=z.useMemo(()=>F.filter(j=>j.status!=="done").length,[F]),kn=z.useMemo(()=>!t||t.role==="admin"||t.role==="super"?null:pe.find(j=>j.hostelId===t.hostelId&&!j.endTime&&j.staffId!==t.id),[pe,t]),Rs=z.useMemo(()=>kn?N.find(j=>j.id===kn.staffId):null,[kn,N]);z.useEffect(()=>{const j=U=>{U.key==="Escape"&&(W.open&&le({open:!1,room:null,bedId:null,date:null}),ge.open&&he({open:!1,guest:null}),$.open&&K({open:!1,guest:null}),re&&Ie(!1),be&&ot(!1),je&&Xe(!1),Ve.open&&Ze({open:!1,room:null}))};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[W,ge,$,re,be,je,Ve]),z.useEffect(()=>{fk(M0).catch(ie=>console.error(ie));const j=_k(M0,ie=>{e(ie),x(!1)}),U=localStorage.getItem("hostella_user_v4");U&&r(JSON.parse(U));const Q=()=>d(!0),te=()=>d(!1);return window.addEventListener("online",Q),window.addEventListener("offline",te),()=>{j(),window.removeEventListener("online",Q),window.removeEventListener("offline",te)}},[]);const Ps=j=>{r(j),localStorage.setItem("hostella_user_v4",JSON.stringify(j)),j.role==="cashier"?i("calendar"):i("dashboard")},zn=()=>{r(null),localStorage.removeItem("hostella_user_v4")},Xt=async()=>{t&&t.id&&await ct(Te(ce,...de,"users",t.id),{lastShiftEnd:new Date().toISOString()});const j=pe.find(U=>U.staffId===t.id&&!U.endTime);j&&await ct(Te(ce,...de,"shifts",j.id),{endTime:new Date().toISOString()}),zn()},Ei=async j=>{if(t)try{const U=zi(ce);U.update(Te(ce,...de,"shifts",j),{endTime:new Date().toISOString()});const Q=Te(lt(ce,...de,"shifts"));U.set(Q,{staffId:t.id,hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),await U.commit(),v("  !","success")}catch(U){v("  : "+U.message,"error")}};z.useEffect(()=>{if(!n)return;const j=lt(ce,...de,"users"),U=Br(j,et=>{const Ae=et.docs.map(ln=>({id:ln.id,...ln.data()}));Ee(Ae.length?Ae:Fh)});if(!t)return U;const Q=lt(ce,...de,"rooms"),te=lt(ce,...de,"guests"),ie=lt(ce,...de,"expenses"),Pe=lt(ce,...de,"clients"),Le=lt(ce,...de,"payments"),gt=lt(ce,...de,"tasks"),An=lt(ce,...de,"shifts"),xn=Br(Q,{includeMetadataChanges:!0},et=>{m(!1),I(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>parseInt(Ae.number)-parseInt(ln.number))),d(!et.metadata.fromCache)},et=>{et.code==="permission-denied"&&m(!0),d(!1)}),wn=Br(te,et=>P(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>new Date(ln.checkInDate)-new Date(Ae.checkInDate)))),Ri=Br(ie,et=>g(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>new Date(ln.date)-new Date(Ae.date)))),Vr=Br(Pe,et=>b(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})).sort((Ae,ln)=>Ae.fullName.localeCompare(ln.fullName)))),Fs=Br(Le,et=>V(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})))),Gn=Br(gt,et=>_e(et.docs.map(Ae=>({id:Ae.id,...Ae.data()})))),Pi=Br(An,et=>G(et.docs.map(Ae=>({id:Ae.id,...Ae.data()}))));return()=>{U(),xn(),wn(),Ri(),Vr(),Fs(),Gn(),Pi()}},[n,t]);const Ds=async()=>{if(N.length===Fh.length&&N[0].id===void 0)try{for(const j of Fh)await Dn(lt(ce,...de,"users"),j);alert("Init done")}catch{}},Ti=async j=>{await Dn(lt(ce,...de,"users"),j)},Xo=async j=>{confirm("Del?")&&await Mc(Te(ce,...de,"users",j))},Bn=j=>{if(!t)return[];if(t.role==="super")return j;const U=t.role==="admin"?o:t.hostelId;return j.filter(Q=>Q.hostelId===U)},Ar=z.useMemo(()=>{if(!t)return[];const j=t.role==="admin"?o:t.hostelId;return t.role==="super"?N:N.filter(U=>U.hostelId===j||U.role==="super"||U.hostelId==="all")},[N,t,o]),js=z.useMemo(()=>{if(!t)return[];const j=t.role==="admin"?o:t.hostelId;return t.role==="super"?C:C.filter(U=>{const Q=N.find(te=>te.id===U.staffId||te.login===U.staffId);return Q&&(Q.hostelId===j||Q.hostelId==="all")})},[C,N,t,o]),$e=z.useMemo(()=>Bn(T),[T,t,o]),ze=z.useMemo(()=>Bn(D),[D,t,o]),Cn=z.useMemo(()=>Bn(w),[w,t,o]),Rr=z.useMemo(()=>Bn(F),[F,t,o]),Pr=async(j,U)=>{await ct(Te(ce,...de,"clients",j),U),v("Updated")},Si=async j=>{if(j.length!==0)try{const U=zi(ce);let Q=0,te=0;j.forEach(ie=>{const Pe=_.find(Le=>Le.passport&&ie.passport&&Le.passport===ie.passport||Le.fullName===ie.fullName&&Le.passport===ie.passport);Pe?(U.update(Te(ce,...de,"clients",Pe.id),{fullName:Pe.fullName||ie.fullName,passport:Pe.passport||ie.passport,birthDate:Pe.birthDate||ie.birthDate,country:Pe.country||ie.country}),Q++):(U.set(Te(lt(ce,...de,"clients")),{...ie,visits:0,lastVisit:new Date().toISOString()}),te++)}),await U.commit(),v(`Success! New: ${te}, Merged: ${Q}`,"success")}catch(U){console.error(U),v("Import failed","error")}},Y=async()=>{if(confirm("Start auto deduplication?"))try{const j={},U=[];if(_.forEach(te=>{const ie=te.passport?`P:${te.passport}`:`N:${te.fullName}`;j[ie]?U.push({original:j[ie],duplicate:te}):j[ie]=te}),U.length===0)return v("No duplicates found!");const Q=zi(ce);U.forEach(({original:te,duplicate:ie})=>{Q.update(Te(ce,...de,"clients",te.id),{visits:(te.visits||0)+(ie.visits||0),lastVisit:new Date(te.lastVisit)>new Date(ie.lastVisit)?te.lastVisit:ie.lastVisit}),Q.delete(Te(ce,...de,"clients",ie.id))}),await Q.commit(),v(`Merged ${U.length} duplicates!`,"success")}catch(j){console.error(j),v("Deduplication failed","error")}},_t=async j=>{try{const U=zi(ce);j.forEach(Q=>U.delete(Te(ce,...de,"clients",Q))),await U.commit(),v(`Deleted ${j.length} clients`,"success")}catch{v("Bulk delete failed","error")}},qt=async()=>{try{const j=zi(ce);let U=0;_.forEach(Q=>{const te=fT(Q.country);te!==Q.country&&(j.update(Te(ce,...de,"clients",Q.id),{country:te}),U++)}),U>0?(await j.commit(),v(`Normalized ${U} countries`,"success")):v("All normalized")}catch{v("Normalization failed","error")}},$n=async j=>{Xe(!1),await Dn(lt(ce,...de,"rooms"),{...j,hostelId:t.role==="admin"?o:t.hostelId,occupied:0})},Zo=async j=>{},Vs=async j=>{},ea=async j=>{},bi=async(j,U,Q)=>{const{cash:te,card:ie,qr:Pe}=U,Le=new Date().toISOString(),gt=[];te>0&&gt.push({guestId:j,staffId:Q,amount:te,method:"cash",date:Le,hostelId:t.hostelId}),ie>0&&gt.push({guestId:j,staffId:Q,amount:ie,method:"card",date:Le,hostelId:t.hostelId}),Pe>0&&gt.push({guestId:j,staffId:Q,amount:Pe,method:"qr",date:Le,hostelId:t.hostelId});for(const An of gt)await Dn(lt(ce,...de,"payments"),An)},Hl=async j=>{le({open:!1,room:null,bedId:null,date:null});try{const U=t.id||t.login||"unknown",Q=await Dn(lt(ce,...de,"guests"),{...j,staffId:U});if((j.paidCash||0)+(j.paidCard||0)+(j.paidQR||0)>0&&await bi(Q.id,{cash:j.paidCash,card:j.paidCard,qr:j.paidQR},U),j.status==="active"){const ie=T.find(Pe=>Pe.id===j.roomId);ie&&await ct(Te(ce,...de,"rooms",ie.id),{occupied:(ie.occupied||0)+1})}v(j.status==="booking"?"Booking created":"Checked In!")}catch(U){v(U.message,"error")}},Ms=async(j,U)=>{try{const Q=t.id||t.login||"unknown",te={fullName:j.fullName,passport:j.passport,country:j.country,birthDate:j.birthDate,staffId:Q,checkInDate:new Date().toISOString(),days:0,roomId:"DEBT_ONLY",roomNumber:"-",bedId:"-",pricePerNight:0,totalPrice:U,paidCash:0,paidCard:0,paidQR:0,amountPaid:0,status:"active",hostelId:t.role==="admin"?o:t.hostelId};await Dn(lt(ce,...de,"guests"),te),v("Debt created successfully")}catch{v("Error creating debt","error")}},ta=async j=>{await ct(Te(ce,...de,"guests",j.id),{status:"active"});const U=T.find(Q=>Q.id===j.roomId);U&&await ct(Te(ce,...de,"rooms",U.id),{occupied:(U.occupied||0)+1}),he({open:!1,guest:null}),v("Activated")},na=async(j,U)=>{ge.open&&he({open:!1,guest:null}),await ct(Te(ce,...de,"guests",j),U)},sr=async(j,U)=>{try{const Q=t.id||t.login,{cash:te,card:ie,qr:Pe}=U;await ct(Te(ce,...de,"guests",j),{paidCash:ar(te),paidCard:ar(ie),paidQR:ar(Pe),amountPaid:ar(te+ie+Pe)}),await bi(j,U,Q),he({open:!1,guest:null}),v("Payment success")}catch(Q){v(Q.message,"error")}},Wl=async(j,U)=>{he({open:!1,guest:null}),await ct(Te(ce,...de,"guests",j.id),{...U,status:"checked_out",checkOutDate:new Date().toISOString()});const Q=T.find(ie=>ie.id===j.roomId);Q&&await ct(Te(ce,...de,"rooms",Q.id),{occupied:Math.max(0,(Q.occupied||1)-1)});const te=(j.amountPaid||0)-U.totalPrice;te>0&&hp(` <b>Refund</b>
Guest: ${j.fullName}
Amount: ~${te}`)},Ni=async(j,U,Q)=>{try{const te=parseInt(j.pricePerNight),ie=parseInt(U),Pe=parseInt(Q),Le=parseInt(j.days),gt=Le-ie;if(gt<=0)return;const An=j.amountPaid||0,xn=ie/Le,wn=gt/Le,Ri=ie*te,Vr=yr(j.checkInDate,ie);await ct(Te(ce,...de,"guests",j.id),{days:ie,totalPrice:Ri,amountPaid:Math.floor(An*xn),paidCash:Math.floor((j.paidCash||0)*xn),paidCard:Math.floor((j.paidCard||0)*xn),paidQR:Math.floor((j.paidQR||0)*xn),checkOutDate:Vr.end.toISOString()});const Fs=new Date(Vr.end),Gn=new Date(Fs);Gn.setDate(Gn.getDate()+Pe),Gn.setHours(12,0,0,0);const Pi=yr(Gn.toISOString(),gt),et={...j,checkInDate:Gn.toISOString(),checkOutDate:Pi.end.toISOString(),days:gt,pricePerNight:te,totalPrice:gt*te,amountPaid:Math.floor(An*wn),paidCash:Math.floor((j.paidCash||0)*wn),paidCard:Math.floor((j.paidCard||0)*wn),paidQR:Math.floor((j.paidQR||0)*wn),status:"active",checkInDateTime:null,checkIn:null};delete et.id,await Dn(lt(ce,...de,"guests"),et),v("Split successful!")}catch(te){console.error(te),v("Split Error","error")}},Ql=async(j,U,Q,te)=>{try{await ct(Te(ce,...de,"guests",j.id),{roomId:U,roomNumber:Q,bedId:te}),K({open:!1,guest:null}),he({open:!1,guest:null}),v("Moved!")}catch(ie){v("Error: "+ie.message,"error")}},Dr=async j=>{let U=typeof j=="string"?j:j.id,Q=typeof j=="object"?j:D.find(te=>te.id===U);if(await Mc(Te(ce,...de,"guests",U)),Q&&Q.status==="active"&&Q.roomId!=="DEBT_ONLY"){const te=T.find(ie=>ie.id===Q.roomId);te&&await ct(Te(ce,...de,"rooms",te.id),{occupied:Math.max(0,(te.occupied||1)-1)})}he({open:!1,guest:null}),v("Deleted")},Yl=async(j,U)=>{confirm("Delete?")&&(await Mc(Te(ce,...de,U==="income"?"payments":"expenses",j)),hp(` <b>Delete Record</b>
ID: ${j}
Type: ${U}`),v("Deleted"))},Ct=async j=>{Ie(!1),await Dn(lt(ce,...de,"expenses"),{...j,hostelId:t.role==="admin"?o:t.hostelId,staffId:t.id||t.login,date:new Date().toISOString()})},Jl=async j=>{await Dn(lt(ce,...de,"tasks"),j),v("Task Added")},Os=async j=>{await ct(Te(ce,...de,"tasks",j),{status:"done"})},Ls=async(j,U)=>{await ct(Te(ce,...de,"tasks",j),U),v("Task Updated")},qd=async j=>{await Mc(Te(ce,...de,"tasks",j)),v("Task Deleted")},Gd=async()=>{if(pe.find(U=>U.staffId===t.id&&!U.endTime))return v("Shift already started","error");await Dn(lt(ce,...de,"shifts"),{staffId:t.id,hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),v("Shift Started")},jr=async(j,U)=>{if(!U)return;const Q=zi(ce),te=Te(ce,...de,"shifts",j);Q.update(te,{endTime:new Date().toISOString()});const ie=N.find(Le=>Le.id===U),Pe=Te(lt(ce,...de,"shifts"));Q.set(Pe,{staffId:U,hostelId:ie?ie.hostelId:t.hostelId,startTime:new Date().toISOString(),endTime:null}),await Q.commit(),v("Shift Transferred")},Kd=async j=>{await Dn(lt(ce,...de,"shifts"),j),v("  ")},Hd=async(j,U)=>{await ct(Te(ce,...de,"shifts",j),U),v(" ")},ki=async(j,U)=>{const Q=parseInt(j.days)-parseInt(U),te=Q*parseInt(j.pricePerNight),ie=parseInt(U)*parseInt(j.pricePerNight);await ct(Te(ce,...de,"guests",j.id),{days:Q,totalPrice:te,amountPaid:(j.amountPaid||0)-ie,paidCash:(j.paidCash||0)-ie});const Pe=yr(j.checkInDate,Q);await ct(Te(ce,...de,"guests",j.id),{checkOutDate:Pe.end.toISOString()}),v("Days reduced")},Xl=async(j,U)=>{const Q=parseInt(j.days)-parseInt(U),te=Q*parseInt(j.pricePerNight);await ct(Te(ce,...de,"guests",j.id),{days:Q,totalPrice:te});const ie=yr(j.checkInDate,Q);await ct(Te(ce,...de,"guests",j.id),{checkOutDate:ie.end.toISOString()}),v("Reduced (No Refund)")},ra=async(j,U,Q={cash:U,card:0,qr:0})=>{try{const te=t.id||t.login;let ie=U;for(const Pe of j){if(ie<=0)break;const Le=Math.min(ie,Pe.currentDebt),gt=Le/U,An=Math.floor(Q.cash*gt),xn=Math.floor(Q.card*gt),wn=Math.floor(Q.qr*gt);await ct(Te(ce,...de,"guests",Pe.id),{paidCash:ar(An),paidCard:ar(xn),paidQR:ar(wn),amountPaid:ar(Le)}),await bi(Pe.id,{cash:An,card:xn,qr:wn},te),ie-=Le}v("Debt Paid!")}catch{v("Error paying debt","error")}},Ci=async(j,U)=>{try{await ct(Te(ce,...de,"guests",j),{totalPrice:ar(U)}),v("Debt Adjusted")}catch{v("Error adjusting","error")}},qn=()=>{alert("Export feature pending")};if(y)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:c.jsx(oT,{className:"animate-spin text-indigo-600",size:40})});if(!t)return c.jsx(Y2,{users:N,onLogin:Ps,onSeed:Ds,lang:k,setLang:S});if(kn)return c.jsx(gD,{activeShift:kn,activeUser:Rs,currentUser:t,onLogout:zn,onTransferToMe:Ei});const Zl=N.find(j=>j.id===(t==null?void 0:t.id))||t,ec=On[t.role==="admin"?o:t.hostelId]||On.hostel1,xt=j=>Je[k][j];return c.jsxs("div",{className:"h-screen w-screen bg-slate-50 text-slate-800 font-sans flex flex-col md:flex-row overflow-hidden",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Q2,{currentUser:t,activeTab:s,setActiveTab:i,onLogout:zn,lang:k,setLang:S,pendingTasksCount:Jt})}),c.jsx(W2,{currentUser:t,activeTab:s,setActiveTab:i,pendingTasksCount:Jt,lang:k}),A&&c.jsx(H2,{message:A.message,type:A.type,onClose:()=>R(null)}),c.jsxs("main",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[c.jsx("div",{className:"flex-shrink-0 p-4 md:p-6 pb-0 bg-slate-50 z-10",children:c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:s==="dashboard"?xt("dashboard").toUpperCase():s==="rooms"?xt("rooms").toUpperCase():s==="calendar"?xt("calendar").toUpperCase():s==="reports"?xt("reports").toUpperCase():s==="debts"?xt("debts").toUpperCase():s==="tasks"?xt("tasks").toUpperCase():s==="expenses"?xt("expenses").toUpperCase():s==="clients"?xt("clients").toUpperCase():s==="staff"?xt("staff").toUpperCase():s==="shifts"?xt("shifts").toUpperCase():""}),c.jsxs("div",{className:"flex items-center gap-4 text-slate-500 text-sm mt-1",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(b2,{size:14})," ",((Ai=On[t.role==="admin"?o:t.hostelId])==null?void 0:Ai.name)||"All"]}),c.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold flex items-center gap-1.5 border ${u?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-rose-50 text-rose-700 border-rose-200"}`,children:[u?c.jsx(V2,{size:12}):c.jsx(j2,{size:12}),u?"ONLINE":"OFFLINE"]}),t.role==="cashier"&&c.jsxs("div",{className:"bg-white px-2 py-0.5 rounded border border-slate-200 text-[10px] font-bold text-slate-600 flex items-center gap-1",children:[c.jsx(Zu,{size:10}),"Current: ",((sa=N.find(j=>pe.find(U=>U.staffId===j.id&&!U.endTime)))==null?void 0:sa.name)||"Nobody"]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.role==="cashier"&&c.jsxs(c.Fragment,{children:[c.jsx(X,{variant:"danger",icon:Kl,onClick:()=>Ie(!0),children:xt("expense")}),c.jsx(X,{variant:"primary",icon:Fo,onClick:()=>le({open:!0,room:null,bedId:null,date:null}),children:xt("checkin")}),c.jsx(X,{variant:"secondary",icon:lT,onClick:()=>ot(!0),children:xt("shift")})]}),(t.role==="admin"||t.role==="super")&&c.jsx("div",{className:"flex bg-white p-1 rounded-xl border border-slate-300 shadow-sm",children:Object.keys(On).map(j=>c.jsx("button",{onClick:()=>a(j),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${o===j?"bg-slate-800 text-white shadow-md":"text-slate-500 hover:bg-slate-50"}`,children:On[j].name},j))})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 md:p-6 pt-2 pb-20",children:[s==="dashboard"&&t.role==="admin"&&c.jsxs("div",{className:"space-y-8 animate-in fade-in",children:[c.jsx(J2,{rooms:$e,guests:D,payments:C,lang:k,currentHostelId:o}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:c.jsx(X2,{guests:ze,rooms:$e,payments:js,lang:k})})]}),s==="rooms"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[c.jsx(Fo,{size:18})," ",c.jsx("span",{children:"Click bed for actions"})]}),(t.role==="admin"||t.role==="super")&&c.jsx(X,{icon:k2,onClick:()=>Xe(!0),children:"Add Room"})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:$e.map(j=>c.jsx(eD,{room:j,guests:ze.filter(U=>U.roomId===j.id),isAdmin:t.role==="admin"||t.role==="super",onEdit:()=>Ze({open:!0,room:j}),onClone:()=>Zo(),onDelete:()=>ea(),lang:k,onBedClick:(U,Q,te)=>{Q?he(te?{open:!0,guest:Q}:{open:!0,guest:Q}):t.role==="admin"||t.role==="super"?alert("Admin cannot check-in"):le({open:!0,room:j,bedId:U,date:null})}},j.id))})]}),s==="calendar"&&c.jsx("div",{className:"h-full flex flex-col bg-white rounded-2xl border border-slate-300 shadow-sm overflow-hidden",children:c.jsx(tD,{rooms:$e,guests:ze,onSlotClick:(j,U,Q,te)=>{Q?he({open:!0,guest:Q}):t.role==="admin"||t.role==="super"?alert("Admin cannot check-in"):le({open:!0,room:j,bedId:U,date:te})},lang:k,currentUser:t,onDeleteGuest:Dr})}),s==="reports"&&(t.role==="admin"||t.role==="super")&&c.jsx(cD,{payments:js,expenses:Cn,users:Ar,guests:ze,currentUser:t,onDeletePayment:Yl,lang:k}),s==="debts"&&c.jsx(lD,{guests:ze,users:N,lang:k,onPayDebt:ra,currentUser:t,onAdminAdjustDebt:Ci,clients:_,onCreateDebt:Ms}),s==="tasks"&&c.jsx(oD,{tasks:Rr,users:N,currentUser:t,onAddTask:Jl,onCompleteTask:Os,onUpdateTask:Ls,onDeleteTask:qd,lang:k,selectedHostelFilter:o}),s==="shifts"&&c.jsx(uD,{shifts:pe,users:N,currentUser:t,onStartShift:Gd,onEndShift:Xt,onTransferShift:jr,lang:k,hostelId:t.hostelId,onAdminAddShift:Kd,onAdminUpdateShift:Hd}),s==="clients"&&(t.role==="admin"||t.role==="super")&&c.jsx(sD,{clients:_,onUpdateClient:Pr,onImportClients:Si,onDeduplicate:Y,onBulkDelete:_t,onNormalizeCountries:qt,lang:k}),s==="staff"&&t.role==="admin"&&c.jsx(nD,{users:N,onAdd:Ti,onDelete:Xo,lang:k}),s==="expenses"&&(t.role==="admin"||t.role==="super")&&c.jsxs("div",{className:"animate-in slide-in-from-bottom-2 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-bold",children:xt("expenses")}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(X,{icon:nT,variant:"secondary",onClick:qn,children:"Export"}),c.jsx(X,{icon:Uo,onClick:()=>Ie(!0),children:xt("expense")})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Cn.length>0?Cn.map(j=>{var U;return c.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-300 shadow-sm flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("span",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-bold text-slate-600",children:j.category}),c.jsx("span",{className:"text-xs text-slate-400",children:new Date(j.date).toLocaleDateString()})]}),c.jsx("p",{className:"font-medium text-slate-800",children:j.comment})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex justify-between items-center",children:[c.jsxs("span",{className:"font-bold text-rose-600",children:["-",parseInt(j.amount).toLocaleString()]}),c.jsx("span",{className:"text-xs text-slate-400",children:((U=N.find(Q=>Q.id===j.staffId))==null?void 0:U.name)||"N/A"})]})]},j.id)}):c.jsx("div",{className:"text-slate-400 col-span-3 text-center py-10",children:"No Expenses"})})]})]})]}),W.open&&c.jsx(dD,{initialRoom:W.room,preSelectedBedId:W.bedId,initialDate:W.date,allRooms:$e,guests:ze,clients:_,onClose:()=>le({open:!1,room:null,bedId:null,date:null}),onSubmit:Hl,notify:v,lang:k}),ge.open&&c.jsx(hD,{guest:ge.guest,room:$e.find(j=>j.id===ge.guest.roomId),currentUser:t,onClose:()=>he({open:!1,guest:null}),onUpdate:na,onPayment:sr,onCheckOut:Wl,onSplit:Ni,onOpenMove:()=>K({open:!0,guest:ge.guest}),onDelete:Dr,notify:v,onReduceDays:ki,onActivateBooking:ta,onReduceDaysNoRefund:Xl,hostelInfo:ec,lang:k}),$.open&&c.jsx(mD,{guest:$.guest,allRooms:$e,guests:ze,onClose:()=>K({open:!1,guest:null}),onMove:Ql,notify:v,lang:k}),re&&c.jsx(pD,{onClose:()=>Ie(!1),onSubmit:Ct,lang:k}),je&&c.jsx(L0,{title:"Add Room",onClose:()=>Xe(!1),onSubmit:$n,lang:k}),Ve.open&&c.jsx(L0,{title:"Edit Room",initialData:Ve.room,onClose:()=>Ze({open:!1,room:null}),onSubmit:Vs,lang:k}),be&&c.jsx(fD,{user:Zl,payments:C,expenses:Cn,onClose:()=>ot(!1),onEndShift:Xt,onLogout:zn,notify:v,lang:k})]})}Jx(document.getElementById("root")).render(c.jsx(z.StrictMode,{children:c.jsx(yD,{})}));
